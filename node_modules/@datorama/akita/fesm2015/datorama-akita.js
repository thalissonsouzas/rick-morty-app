import { Observable, Subject, of, BehaviorSubject, ReplaySubject, combineLatest, from } from 'rxjs';
import { __decorate, __metadata, __rest } from 'tslib';
import { distinctUntilChanged, map, take, auditTime, switchMap, withLatestFrom, filter, delay, debounceTime, skip, pairwise } from 'rxjs/operators';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * Wraps the provided value in an array, unless the provided _value is an array.
 * @template T
 * @param {?} value
 * @return {?}
 */
function coerceArray(value) {
    return Array.isArray(value) ? value : [value];
}
/**
 * Check if a value is an object
 * @param {?} value
 * @return {?}
 */
function isObject(value) {
    return Object.prototype.toString.call(value) === '[object Object]';
}
/**
 * @param {?} value
 * @return {?}
 */
function isPlainObject(value) {
    return toBoolean(value) && value.constructor.name === 'Object';
}
/**
 * @param {?} value
 * @return {?}
 */
function isFunction(value) {
    return typeof value === 'function';
}
/**
 * @param {?} value
 * @return {?}
 */
function toBoolean(value) {
    return value != null && `${value}` !== 'false';
}
/**
 * @param {?} value
 * @return {?}
 */
function isUndefined(value) {
    return value === undefined;
}
/**
 * @param {?} v
 * @return {?}
 */
function isNil(v) {
    return v === null || v === undefined;
}
/**
 * Check if entity exists
 * @template E
 * @param {?} id
 * @param {?} entities
 * @return {?}
 */
function entityExists(id, entities) {
    return entities.hasOwnProperty(id);
}
/**
 * Observable that emits empty value and complete
 * @template T
 * @return {?}
 */
function noop() {
    return new Observable(observer => {
        observer.next();
        observer.complete();
    });
}
/**
 * @param {?} value
 * @return {?}
 */
function isObservable(value) {
    return toBoolean(value) && isFunction(value.subscribe);
}
/**
 * @param {?} val
 * @return {?}
 */
function isString(val) {
    return typeof val === 'string';
}
/**
 * @param {?} value
 * @return {?}
 */
function isNumber(value) {
    return typeof value === 'number';
}
/**
 * @param {?} val
 * @return {?}
 */
function isDefined(val) {
    return val !== null && typeof val !== 'undefined';
}
/**
 * Check if the active entity exist
 * @template E
 * @param {?} state
 * @return {?}
 */
function resetActive(state) {
    return isActiveState(state) && entityExists(((/** @type {?} */ (state))).active, state.entities) === false;
}
/**
 * Check if the store supports active entity
 * @template E
 * @param {?} state
 * @return {?}
 */
function isActiveState(state) {
    return ((/** @type {?} */ (state))).hasOwnProperty('active');
}
/**
 * setValue(state, 'todos.ui', { filter: {}})
 * @type {?}
 */
const setValue = (obj, prop, val) => {
    /** @type {?} */
    const split = prop.split('.');
    if (split.length === 1)
        return val;
    obj = Object.assign({}, obj);
    /** @type {?} */
    const lastIndex = split.length - 2;
    /** @type {?} */
    const removeStoreName = prop.split('.').slice(1);
    removeStoreName.reduce((acc, part, index) => {
        if (index === lastIndex) {
            acc[part] = val;
        }
        else {
            acc[part] = Object.assign({}, acc[part]);
        }
        return acc && acc[part];
    }, obj);
    return obj;
};
/**
 * getValue(state, 'todos.ui')
 * @type {?}
 */
const getValue = (obj, prop) => {
    /** return the whole state  */
    if (prop.split('.').length === 1) {
        return obj;
    }
    /** @type {?} */
    const removeStoreName = prop
        .split('.')
        .slice(1)
        .join('.');
    return removeStoreName.split('.').reduce((acc, part) => acc && acc[part], obj);
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
class AkitaError extends Error {
    /**
     * @param {?} message
     */
    constructor(message) {
        super(message);
    }
}
class AkitaImmutabilityError extends AkitaError {
    /**
     * @param {?} storeName
     */
    constructor(storeName) {
        super(`The new state should be immutable. Make sure to return a new immutable state. \n store: \n ${storeName}`);
    }
}
class AkitaEntityNotExistsError extends AkitaError {
    /**
     * @param {?} id
     */
    constructor(id) {
        super(`Entity ${id} does not exists`);
    }
}
class AkitaNoActiveError extends AkitaError {
    constructor() {
        super(`Active is null/undefined`);
    }
}
class AkitaInvalidEntityState extends AkitaError {
    constructor() {
        super(`Entity state is invalid`);
    }
}
class AkitaUpdateIdKeyError extends AkitaError {
    constructor() {
        super(`Updating entity id is not permitted when updating many entities`);
    }
}
/**
 * @param {?} id
 * @param {?} entities
 * @return {?}
 */
function assertEntityExists(id, entities) {
    if (!entityExists(id, entities)) {
        throw new AkitaEntityNotExistsError(id);
    }
}
/**
 * @param {?} store
 * @return {?}
 */
function assertActive(store) {
    if (!toBoolean(store.active)) {
        throw new AkitaNoActiveError();
    }
}
/**
 * @param {?} state
 * @return {?}
 */
function assertEntityState(state) {
    /** @type {?} */
    const assertEntities = isObject(state);
    if (!assertEntities) {
        throw new AkitaInvalidEntityState();
    }
}
/**
 * @param {?} name
 * @param {?} className
 * @return {?}
 */
function assertDecorator(name, className) {
    if (!name) {
        console.error(`@StoreConfig({ name }) is missing in ${className}`);
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
class CRUD {
    /**
     * @template S, E
     * @param {?} state
     * @param {?} entities
     * @param {?} entityClass
     * @param {?} idKey
     * @return {?}
     */
    _set(state, entities, entityClass, idKey) {
        /** @type {?} */
        let ids;
        /** @type {?} */
        let normalized;
        if (((/** @type {?} */ (entities))).ids && ((/** @type {?} */ (entities))).entities) {
            ids = ((/** @type {?} */ (entities))).ids;
            normalized = ((/** @type {?} */ (entities))).entities;
        }
        else {
            /** @type {?} */
            const isArray = Array.isArray(entities);
            normalized = entities;
            if (isArray) {
                normalized = (/** @type {?} */ (this.keyBy((/** @type {?} */ (entities)), entityClass, idKey)));
            }
            else {
                assertEntityState(entities);
            }
            ids = isArray ? ((/** @type {?} */ (entities))).map(entity => entity[idKey]) : Object.keys((/** @type {?} */ (normalized))).map(id => entities[id][idKey]);
        }
        /** @type {?} */
        const newState = Object.assign({}, ((/** @type {?} */ (state))), { entities: normalized, ids, loading: false });
        if (resetActive(newState)) {
            newState.active = null;
        }
        return newState;
    }
    /**
     * @template T
     * @param {?} state
     * @param {?} id
     * @param {?} entity
     * @return {?}
     */
    _replaceEntity(state, id, entity) {
        return Object.assign({}, ((/** @type {?} */ (state))), { entities: Object.assign({}, state.entities, { [id]: entity }) });
    }
    /**
     * @template S, E
     * @param {?} state
     * @param {?} entities
     * @param {?} idKey
     * @param {?=} options
     * @return {?}
     */
    _add(state, entities, idKey, options = {}) {
        /** @type {?} */
        let addedEntities = {};
        /** @type {?} */
        let addedIds = [];
        for (let i = 0; i < entities.length; i++) {
            /** @type {?} */
            const entity = entities[i];
            /** @type {?} */
            const entityId = entity[idKey];
            if (!entityExists(entityId, state.entities)) {
                addedEntities[entityId] = entity;
                if (options.prepend)
                    addedIds.unshift(entityId);
                else
                    addedIds.push(entityId);
            }
        }
        return Object.assign({}, ((/** @type {?} */ (state))), { entities: Object.assign({}, state.entities, addedEntities), ids: options.prepend ? [...addedIds, ...state.ids] : [...state.ids, ...addedIds] });
    }
    /**
     * @template T
     * @param {?} state
     * @param {?} ids
     * @param {?} newStateOrFn
     * @param {?} idKey
     * @return {?}
     */
    _update(state, ids, newStateOrFn, idKey) {
        /** @type {?} */
        const updatedEntities = {};
        /** @type {?} */
        let isUpdatingIdKey = false;
        /** @type {?} */
        let idToUpdate;
        for (let i = 0; i < ids.length; i++) {
            /** @type {?} */
            const id = ids[i];
            idToUpdate = id;
            assertEntityExists(id, state.entities);
            /** @type {?} */
            const oldEntity = state.entities[id];
            /** @type {?} */
            const newState = isFunction(newStateOrFn) ? newStateOrFn(oldEntity) : newStateOrFn;
            if (newState.hasOwnProperty(idKey) && newState[idKey] !== oldEntity[idKey]) {
                if (ids.length > 1) {
                    throw new AkitaUpdateIdKeyError();
                }
                isUpdatingIdKey = true;
                idToUpdate = newState[idKey];
            }
            /** @type {?} */
            let newEntity;
            /** @type {?} */
            const merged = Object.assign({}, oldEntity, newState);
            if (isPlainObject(oldEntity)) {
                newEntity = merged;
            }
            else {
                /**
                 * In case that new state is class of it's own, there's
                 * a possibility that it will be different than the old
                 * class.
                 * For example, Old state is an instance of animal class
                 * and new state is instance of person class.
                 * To avoid run over new person class with the old animal
                 * class we check if the new state is a class of it's own.
                 * If so, use it. Otherwise, use the old state class
                 */
                if (isPlainObject(newState)) {
                    newEntity = new oldEntity.constructor(merged);
                }
                else {
                    newEntity = new ((/** @type {?} */ (newState))).constructor(merged);
                }
            }
            updatedEntities[idToUpdate] = newEntity;
        }
        /** @type {?} */
        let updatedIds = state.ids;
        /** @type {?} */
        let stateEntities = state.entities;
        if (isUpdatingIdKey) {
            const [id] = ids;
            const _a = state.entities, _b = id, deletedEntity = _a[_b], rest = __rest(_a, [typeof _b === "symbol" ? _b : _b + ""]);
            stateEntities = rest;
            updatedIds = state.ids.map(current => (current === id ? idToUpdate : current));
        }
        return Object.assign({}, ((/** @type {?} */ (state))), { entities: Object.assign({}, stateEntities, updatedEntities), ids: updatedIds });
    }
    /**
     * @template T
     * @param {?} state
     * @param {?} ids
     * @return {?}
     */
    _remove(state, ids) {
        if (!ids)
            return this._removeAll(state);
        /** @type {?} */
        const removed = ids.reduce((acc, id) => {
            const _a = id, entity = acc[_a], rest = __rest(acc, [typeof _a === "symbol" ? _a : _a + ""]);
            return rest;
        }, state.entities);
        /** @type {?} */
        const newState = Object.assign({}, ((/** @type {?} */ (state))), { entities: removed, ids: state.ids.filter(current => ids.indexOf(current) === -1) });
        if (resetActive(newState)) {
            newState.active = null;
        }
        return newState;
    }
    /**
     * @template T
     * @param {?} state
     * @return {?}
     */
    _removeAll(state) {
        /** @type {?} */
        const newState = Object.assign({}, ((/** @type {?} */ (state))), { entities: {}, ids: [], active: null });
        return newState;
    }
    /**
     * @param {?} entities
     * @param {?=} entityClass
     * @param {?=} id
     * @return {?}
     */
    keyBy(entities, entityClass, id = 'id') {
        /** @type {?} */
        const acc = {};
        for (let i = 0, len = entities.length; i < len; i++) {
            /** @type {?} */
            const entity = entities[i];
            acc[entity[id]] = entityClass ? new entityClass(entity) : entity;
        }
        return acc;
    }
}
/** @type {?} */
const _crud = new CRUD();

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
class AkitaGlobals {
    constructor() {
        this.skipAction = false;
        this.skipTransactionMsg = false;
        this.currentT = [];
        this.activeTransactions = 0;
    }
    /**
     * @param {?} _action
     * @return {?}
     */
    setAction(_action) {
        if (this.customAction) {
            this.currentAction = this.customAction;
            this.customAction = null;
            this.skipTransactionMsg = false;
        }
        else {
            if (this.activeTransactions === 0) {
                this.currentAction = _action;
            }
        }
        if (this.activeTransactions > 0) {
            this.currentT.push(_action);
        }
    }
    /**
     * @param {?} action
     * @param {?=} skipTransactionMsg
     * @return {?}
     */
    setCustomAction(action, skipTransactionMsg = false) {
        this.currentAction = this.customAction = action;
        this.skipTransactionMsg = skipTransactionMsg;
    }
    /**
     * @param {?=} skip
     * @return {?}
     */
    setSkipAction(skip$$1 = true) {
        this.skipAction = skip$$1;
    }
}
/** @type {?} */
const __globalState = new AkitaGlobals();

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * Start a new transaction batch
 * @return {?}
 */
function startBatch() {
    if (!isTransactionInProcess()) {
        __globalState.batchTransaction = new Subject();
    }
    __globalState.activeTransactions++;
}
/**
 * End the transaction
 * @return {?}
 */
function endBatch() {
    if (--__globalState.activeTransactions === 0) {
        __globalState.batchTransaction.next(true);
        __globalState.batchTransaction.complete();
    }
}
/**
 * Whether we're inside batch
 * @return {?}
 */
function isTransactionInProcess() {
    return __globalState.activeTransactions > 0;
}
/**
 *
 * @return {?}
 */
function commit() {
    return __globalState.batchTransaction ? __globalState.batchTransaction.asObservable() : of(true);
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * @param {?} o
 * @return {?}
 */
function deepFreeze(o) {
    Object.freeze(o);
    /** @type {?} */
    var oIsFunction = typeof o === 'function';
    /** @type {?} */
    var hasOwnProp = Object.prototype.hasOwnProperty;
    Object.getOwnPropertyNames(o).forEach(function (prop) {
        if (hasOwnProp.call(o, prop) &&
            (oIsFunction ? prop !== 'caller' && prop !== 'callee' && prop !== 'arguments' : true) &&
            o[prop] !== null &&
            (typeof o[prop] === 'object' || typeof o[prop] === 'function') &&
            !Object.isFrozen(o[prop])) {
            deepFreeze(o[prop]);
        }
    });
    return o;
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
const configKey = 'akitaConfig';
/**
 * @param {?} metadata
 * @return {?}
 */
function StoreConfig(metadata) {
    return function (constructor) {
        constructor[configKey] = { idKey: 'id' };
        for (let i = 0, keys = Object.keys(metadata); i < keys.length; i++) {
            /** @type {?} */
            const key = keys[i];
            /* name is preserved read only key */
            if (key === 'name') {
                constructor[configKey]['storeName'] = metadata[key];
            }
            else {
                constructor[configKey][key] = metadata[key];
            }
        }
    };
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
let CONFIG = {
    resettable: false
};
/**
 * @param {?} config
 * @return {?}
 */
function akitaConfig(config) {
    CONFIG = Object.assign({}, CONFIG, config);
}
/**
 * @return {?}
 */
function getAkitaConfig() {
    return CONFIG;
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
let __DEV__ = true;
/** @type {?} */
const isNotBrowser = typeof window === 'undefined';
/** @type {?} */
const __stores__ = {};
/** @type {?} */
const rootDispatcher = new ReplaySubject();
/**
 * @param {?} storeName
 * @param {?=} initialState
 * @return {?}
 */
function nextState(storeName, initialState = false) {
    return {
        type: 2 /* NEW_STATE */,
        payload: {
            name: storeName,
            initialState
        }
    };
}
/**
 * Enable production mode to disable objectFreeze
 * @return {?}
 */
function enableAkitaProdMode() {
    __DEV__ = false;
}
/**
 * @return {?}
 */
function isDev() {
    return __DEV__;
}
/**
 * The Root Store that every sub store needs to inherit and
 * invoke `super` with the initial state.
 * @template S
 */
class Store {
    /**
     *
     * Initial the store with the state
     * @param {?} initialState
     * @param {?=} options
     */
    constructor(initialState, options = {}) {
        this.options = options;
        /**
         * Whether we are inside transaction *
         */
        this.inTransaction = false;
        this._isPristine = true;
        this.destroy = this.ngOnDestroy;
        __globalState.setAction({ type: '@@INIT' });
        __stores__[this.storeName] = this;
        this.setState(() => initialState);
        rootDispatcher.next({
            type: 0 /* NEW_STORE */,
            payload: { store: this }
        });
        isDev() && assertDecorator(this.storeName, this.constructor.name);
        if (this.isRessetable()) {
            this._initialState = initialState;
        }
    }
    /**
     * @param {?=} loading
     * @return {?}
     */
    setLoading(loading = false) {
        if (loading !== ((/** @type {?} */ (this._value()))).loading) {
            isDev() && __globalState.setAction({ type: 'Set Loading' });
            this.setState(s => ((/** @type {?} */ (Object.assign({}, ((/** @type {?} */ (s))), { loading })))));
        }
    }
    /**
     * Update the store's error state.
     * @template T
     * @param {?} error
     * @return {?}
     */
    setError(error) {
        if (error !== ((/** @type {?} */ (this._value()))).error) {
            isDev() && __globalState.setAction({ type: 'Set Error' });
            this.setState(s => ((/** @type {?} */ (Object.assign({}, ((/** @type {?} */ (s))), { error })))));
        }
    }
    /**
     * Select a slice from the store
     *
     * \@example
     * this.store.select(state => state.entities)
     *
     * @template R
     * @param {?} project
     * @return {?}
     */
    _select(project) {
        return this.store$.pipe(map(project), distinctUntilChanged());
    }
    /**
     * @return {?}
     */
    _value() {
        return this.storeValue;
    }
    /**
     * @return {?}
     */
    get config() {
        return this.constructor[configKey];
    }
    /**
     * @return {?}
     */
    get storeName() {
        return this.options.storeName || (this.config && this.config['storeName']);
    }
    /**
     * @return {?}
     */
    get idKey() {
        /**
         * backward compatibility
         * @type {?}
         */
        const newIdKey = this.config && this.config.idKey;
        if (!newIdKey) {
            return this.options.idKey || 'id';
        }
        return newIdKey;
    }
    /**
     * @return {?}
     */
    get isPristine() {
        return this._isPristine;
    }
    /**
     * `setState()` is the only way to update a store; It receives a callback function,
     * which gets the current state, and returns a new immutable state,
     * which will be the new value of the store.
     * @param {?} newStateFn
     * @param {?=} _rootDispatcher
     * @return {?}
     */
    setState(newStateFn, _rootDispatcher = true) {
        /** @type {?} */
        const prevState = this._value();
        this.storeValue = __DEV__ ? deepFreeze(newStateFn(this._value())) : newStateFn(this._value());
        if (prevState === this.storeValue) {
            throw new AkitaImmutabilityError(this.storeName);
        }
        if (!this.store) {
            this.store = new BehaviorSubject(this.storeValue);
            rootDispatcher.next(nextState(this.storeName, true));
            return;
        }
        if (isTransactionInProcess()) {
            this.handleTransaction();
            return;
        }
        this.dispatch(this.storeValue, _rootDispatcher);
    }
    /**
     * Resets the store to it's initial state and set the store to a pristine state.
     * @return {?}
     */
    reset() {
        if (this.isRessetable()) {
            __globalState.setAction({ type: 'Reset Store' });
            this.setState(() => Object.assign({}, this._initialState));
            this.setPristine();
        }
        else {
            throw new AkitaError(`You need to enable the reset functionality`);
        }
    }
    /**
     * @param {?} newStateOrId
     * @param {?=} newState
     * @return {?}
     */
    update(newStateOrId, newState) {
        __globalState.setAction({ type: 'Update Store' });
        this.setState(state => {
            /** @type {?} */
            let value = isFunction(newStateOrId) ? newStateOrId(state) : newStateOrId;
            /** @type {?} */
            let merged = Object.assign({}, state, value);
            return isPlainObject(state) ? merged : new ((/** @type {?} */ (state))).constructor(merged);
        });
        this.setDirty();
    }
    /**
     * Sets the store to a pristine state.
     * @return {?}
     */
    setPristine() {
        this._isPristine = true;
    }
    /**
     * Sets the store to a dirty state, indicating that it is not pristine.
     * @return {?}
     */
    setDirty() {
        this._isPristine = false;
    }
    /**
     * @param {?} state
     * @param {?=} _rootDispatcher
     * @return {?}
     */
    dispatch(state, _rootDispatcher = true) {
        this.store.next(state);
        if (_rootDispatcher) {
            rootDispatcher.next(nextState(this.storeName));
            isDev() && __globalState.setAction({ type: 'Set State' });
        }
    }
    /**
     * @return {?}
     */
    get store$() {
        return this.store.asObservable();
    }
    /**
     * When the transaction ends dispatch the final value once
     * @return {?}
     */
    watchTransaction() {
        commit().subscribe(() => {
            this.inTransaction = false;
            if (isDev() && !__globalState.skipTransactionMsg) {
                __globalState.setAction({ type: '@Transaction' });
            }
            this.dispatch(this._value());
            __globalState.currentT = [];
            __globalState.skipTransactionMsg = false;
        });
    }
    /**
     * @return {?}
     */
    isRessetable() {
        return this.config.resettable || getAkitaConfig().resettable;
    }
    /**
     * Listen to the transaction stream
     * @return {?}
     */
    handleTransaction() {
        if (!this.inTransaction) {
            this.watchTransaction();
            this.inTransaction = true;
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (isNotBrowser)
            return;
        if (!((/** @type {?} */ (window))).hmrEnabled && this === __stores__[this.storeName]) {
            delete __stores__[this.storeName];
            rootDispatcher.next({
                type: 1 /* DELETE_STORE */,
                payload: { storeName: this.storeName }
            });
        }
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * The Root Store that every sub store needs to inherit and
 * invoke `super` with the initial state.
 * @template S, E, ActiveEntity
 */
class EntityStore extends Store {
    /**
     *
     * Initiate the store with the state
     * @param {?=} initialState
     * @param {?=} options
     */
    constructor(initialState = {}, options = {}) {
        super(Object.assign({}, getInitialEntitiesState(), initialState), options);
    }
    /**
     * @return {?}
     */
    get entities() {
        return this._value().entities;
    }
    /**
     *
     * Replace current collection with provided collection
     *
     * \@example
     * this.store.set([Entity, Entity]);
     * this.store.set({1: Entity, 2: Entity});
     * this.store.set([{id: 1}, {id: 2}], { entityClass: Product });
     *
     * @param {?} entities
     * @param {?=} options
     * @return {?}
     */
    set(entities, options = {}) {
        isDev() && __globalState.setAction({ type: 'Set Entities' });
        this.setState(state => _crud._set(state, isNil(entities) ? [] : entities, options.entityClass, this.idKey));
        this.setDirty();
    }
    /**
     * Create or replace an entity in the store.
     *
     * \@example
     * this.store.createOrReplace(3, Entity);
     *
     * @param {?} id
     * @param {?} entity
     * @return {?}
     */
    createOrReplace(id, entity) {
        if (!entityExists(id, this._value().entities)) {
            this.addWhenNotExists(id, entity);
        }
        else {
            isDev() && __globalState.setAction({ type: 'Create or Replace Entity', entityId: [id] });
            this.setState(state => _crud._replaceEntity(state, id, entity));
        }
    }
    /**
     *
     * Insert or Update
     * @param {?} id
     * @param {?} entityOrFn
     * @return {?}
     */
    upsert(id, entityOrFn) {
        if (!entityExists(id, this._value().entities)) {
            /** @type {?} */
            const resolve = isFunction(entityOrFn) ? ((/** @type {?} */ (entityOrFn)))({}) : entityOrFn;
            this.addWhenNotExists(id, resolve);
        }
        else {
            this.update(id, (/** @type {?} */ (entityOrFn)));
        }
    }
    /**
     * Add an entity or entities to the store.
     *
     * \@example
     * this.store.add([Entity, Entity]);
     * this.store.add(Entity);
     * this.store.add(Entity, { prepend: true });
     * @param {?} entities
     * @param {?=} options
     * @return {?}
     */
    add(entities, options) {
        /** @type {?} */
        const toArray = coerceArray(entities);
        if (toArray.length === 0)
            return;
        /**
         * If we pass entities that already exist, we should ignore them
         * @type {?}
         */
        const allExists = toArray.every(entity => this._value().ids.indexOf(entity[this.idKey]) > -1);
        if (allExists)
            return;
        isDev() && __globalState.setAction({ type: 'Add Entity' });
        this.setState(state => _crud._add(state, toArray, this.idKey, options));
    }
    /**
     * @param {?} idsOrFn
     * @param {?=} newStateOrFn
     * @return {?}
     */
    update(idsOrFn, newStateOrFn) {
        /** @type {?} */
        let ids = [];
        /** @type {?} */
        const storeIds = this._value().ids;
        if (isFunction(idsOrFn)) {
            for (let i = 0, len = storeIds.length; i < len; i++) {
                /** @type {?} */
                const id = storeIds[i];
                /** @type {?} */
                const entity = this._value().entities[id];
                if (entity && ((/** @type {?} */ (idsOrFn)))(entity)) {
                    ids.push(id);
                }
            }
        }
        else {
            ids = toBoolean(idsOrFn) ? coerceArray(idsOrFn) : storeIds;
        }
        if (ids.length === 0)
            return;
        isDev() && __globalState.setAction({ type: 'Update Entity', entityId: ids });
        this.setState(state => {
            return _crud._update(state, ids, newStateOrFn, this.idKey);
        });
    }
    /**
     * An alias to update all.
     * @param {?} state
     * @return {?}
     */
    updateAll(state) {
        if (this._value().ids.length === 0)
            return;
        this.update(null, state);
    }
    /**
     * Update the root state (data which is external to the entities).
     *
     * \@example
     * this.store.updateRoot({
     *   metadata: 'new metadata
     * });
     *
     *  this.store.updateRoot(state => {
     *    return {
     *      metadata: {
     *        ...state.metadata,
     *        key: 'new value'
     *      }
     *    }
     *  });
     * @param {?} newStateFn
     * @param {?=} action
     * @return {?}
     */
    updateRoot(newStateFn, action) {
        /** @type {?} */
        const newState = isFunction(newStateFn) ? newStateFn(this._value()) : newStateFn;
        if (newState === this._value()) {
            throw new AkitaImmutabilityError(this.storeName);
        }
        isDev() && __globalState.setAction(action || { type: 'Update Root' });
        this.setState(state => {
            return Object.assign({}, ((/** @type {?} */ (state))), ((/** @type {?} */ (newState))));
        });
    }
    /**
     * @param {?=} idsOrFn
     * @return {?}
     */
    remove(idsOrFn) {
        /** @type {?} */
        const storeIds = this._value().ids;
        if (storeIds.length === 0)
            return;
        /** @type {?} */
        const idPassed = toBoolean(idsOrFn);
        if (!idPassed)
            this.setPristine();
        /** @type {?} */
        let ids = [];
        if (isFunction(idsOrFn)) {
            for (let i = 0, len = storeIds.length; i < len; i++) {
                /** @type {?} */
                const id = storeIds[i];
                /** @type {?} */
                const entity = this._value().entities[id];
                if (entity && idsOrFn(entity)) {
                    ids.push(id);
                }
            }
        }
        else {
            ids = idPassed ? coerceArray(idsOrFn) : null;
        }
        if (ids && ids.length === 0)
            return;
        isDev() && __globalState.setAction({ type: 'Remove Entity', entityId: ids });
        this.setState(state => {
            return _crud._remove(state, ids);
        });
    }
    /**
     *
     * Update the active entity.
     *
     * \@example
     * this.store.updateActive(active => {
     *   return {
     *     config: {
     *      ..active.config,
     *      date
     *     }
     *   }
     * })
     * @param {?} newStateFn
     * @return {?}
     */
    updateActive(newStateFn) {
        assertActive(this._value());
        isDev() && __globalState.setAction({ type: 'Update Active Entity', entityId: this._value().active });
        this.setState(state => {
            /** @type {?} */
            const activeId = (/** @type {?} */ (state.active));
            /** @type {?} */
            const newState = isFunction(newStateFn) ? newStateFn(state.entities[activeId]) : newStateFn;
            if (newState === state) {
                throw new AkitaImmutabilityError(this.storeName);
            }
            return _crud._update(state, [activeId], newState, this.idKey);
        });
    }
    /**
     * Set the given entity as active.
     * @param {?} idOrOptions
     * @return {?}
     */
    setActive(idOrOptions) {
        /** @type {?} */
        let activeId;
        if (isObject(idOrOptions)) {
            if (isNil(this._value().active))
                return;
            ((/** @type {?} */ (idOrOptions))) = Object.assign({ wrap: true }, idOrOptions);
            /** @type {?} */
            const ids = this._value().ids;
            /** @type {?} */
            const currentIdIndex = ids.indexOf(this._value().active);
            if (((/** @type {?} */ (idOrOptions))).prev) {
                /** @type {?} */
                const isFirst = currentIdIndex === 0;
                if (isFirst && !((/** @type {?} */ (idOrOptions))).wrap)
                    return;
                activeId = isFirst ? ids[ids.length - 1] : ((/** @type {?} */ (ids[currentIdIndex - 1])));
            }
            else if (((/** @type {?} */ (idOrOptions))).next) {
                /** @type {?} */
                const isLast = ids.length === currentIdIndex + 1;
                if (isLast && !((/** @type {?} */ (idOrOptions))).wrap)
                    return;
                activeId = isLast ? ids[0] : ((/** @type {?} */ (ids[currentIdIndex + 1])));
            }
        }
        else {
            if (idOrOptions === this._value().active)
                return;
            activeId = (/** @type {?} */ (idOrOptions));
        }
        isDev() && __globalState.setAction({ type: 'Set Active Entity', entityId: activeId });
        this.setState(state => {
            return Object.assign({}, ((/** @type {?} */ (state))), { active: activeId });
        });
    }
    /**
     * @param {?} id
     * @param {?} entity
     * @return {?}
     */
    addWhenNotExists(id, entity) {
        if (!entity[this.idKey]) {
            entity[this.idKey] = id;
        }
        this.add(entity);
    }
}
/** @type {?} */
const getInitialEntitiesState = () => ((/** @type {?} */ ({
    entities: {},
    ids: [],
    loading: true,
    error: null
})));
/** @type {?} */
const getInitialActiveState = () => ((/** @type {?} */ ({
    active: null
})));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @enum {string} */
const Order = {
    ASC: 'asc',
    DESC: 'desc',
};
/**
 * @param {?} key
 * @param {?=} order
 * @return {?}
 */
function compareValues(key, order = Order.ASC) {
    return function (a, b) {
        if (!a.hasOwnProperty(key) || !b.hasOwnProperty(key)) {
            return 0;
        }
        /** @type {?} */
        const varA = typeof a[key] === 'string' ? a[key].toUpperCase() : a[key];
        /** @type {?} */
        const varB = typeof b[key] === 'string' ? b[key].toUpperCase() : b[key];
        /** @type {?} */
        let comparison = 0;
        if (varA > varB) {
            comparison = 1;
        }
        else if (varA < varB) {
            comparison = -1;
        }
        return order == Order.DESC ? comparison * -1 : comparison;
    };
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * @param {?} fn
 * @return {?}
 */
function memoizeOne(fn) {
    /** @type {?} */
    let lastArgs;
    /** @type {?} */
    let changed = false;
    /** @type {?} */
    let firstInit = true;
    /** @type {?} */
    let lastResult;
    return function (...args) {
        if (lastArgs) {
            /** If entities nor ids doesn't change return the last value */
            changed = lastArgs[1] !== args[1] || lastArgs[0] !== args[0];
        }
        if (firstInit || (changed && !firstInit)) {
            lastResult = fn.apply(this, args);
        }
        firstInit = false;
        lastArgs = args;
        return lastResult;
    };
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
const queryConfigKey = 'akitaQueryConfig';
/**
 * @template E
 * @param {?} metadata
 * @return {?}
 */
function QueryConfig(metadata) {
    return function (constructor) {
        constructor[queryConfigKey] = {};
        for (let i = 0, keys = Object.keys(metadata); i < keys.length; i++) {
            /** @type {?} */
            const key = keys[i];
            constructor[queryConfigKey][key] = metadata[key];
        }
    };
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * @template S
 */
class Query {
    /**
     * @param {?} store
     */
    constructor(store) {
        this.store = store;
        this.__store__ = store;
    }
    /**
     * @template R
     * @param {?=} project
     * @return {?}
     */
    select(project) {
        /** @type {?} */
        let state = project ? project : state => state;
        return this.store._select(state);
    }
    /**
     * Select once and complete.
     * @template R
     * @param {?} project
     * @return {?}
     */
    selectOnce(project) {
        return this.select(project).pipe(take(1));
    }
    /**
     * Select the store's loading state.
     * @return {?}
     */
    selectLoading() {
        return this.select(state => ((/** @type {?} */ (state))).loading);
    }
    /**
     * Select the store's error state.
     * @return {?}
     */
    selectError() {
        return this.select(state => ((/** @type {?} */ (state))).error);
    }
    /**
     * Get the raw value of the store.
     * @return {?}
     */
    getSnapshot() {
        return this.store._value();
    }
    /**
     *  Returns whether the state of the store is pristine (the set() method hasn't been explicitly called
     *  since the store creation, or the last time setPristine()was called).
     * @return {?}
     */
    get isPristine() {
        return this.store.isPristine;
    }
    /**
     * Returns whether the state of the store is dirty (the set() method
     * or the setDirty() method has been explicitly called since the store creation,
     * or the last time setPristine() was called).
     * @return {?}
     */
    get isDirty() {
        return !this.store.isPristine;
    }
    /**
     * @return {?}
     */
    get config() {
        return this.constructor[queryConfigKey];
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 *  An abstraction for querying the entities from the store
 * @template S, E, ActiveEntity
 */
class QueryEntity extends Query {
    /**
     * @param {?} store
     */
    constructor(store) {
        super(store);
        this.__store__ = store;
    }
    /**
     * @param {?=} options
     * @return {?}
     */
    selectAll(options = {
        asObject: false
    }) {
        /** @type {?} */
        const selectState$ = this.select(state => state);
        /** @type {?} */
        const selectEntities$ = this.select(state => state.entities);
        this.sortByOptions(options);
        return selectEntities$.pipe(withLatestFrom(selectState$, (entities, state) => {
            const { ids } = state;
            if (options.asObject) {
                return toMap(ids, entities, options);
            }
            else {
                if (!options.filterBy && !options.sortBy) {
                    if (!this.memoized) {
                        this.memoized = memoizeOne(toArray);
                    }
                    return this.memoized(state, options);
                }
                return toArray(state, options);
            }
        }));
    }
    /**
     * @param {?=} options
     * @return {?}
     */
    getAll(options = { asObject: false, filterBy: undefined, limitTo: undefined }) {
        /** @type {?} */
        const state = this.getSnapshot();
        if (options.asObject) {
            return toMap(state.ids, state.entities, options, true);
        }
        this.sortByOptions(options);
        return toArray(state, options);
    }
    /**
     * Select multiple entities from the store.
     *
     * \@example
     * this.store.selectMany([1,2]);
     * @param {?} ids
     * @param {?=} options
     * @return {?}
     */
    selectMany(ids, options = {}) {
        /** @type {?} */
        const filterUndefined = isUndefined(options.filterUndefined) ? true : options.filterUndefined;
        /** @type {?} */
        const entities = ids.map(id => this.selectEntity(id));
        return combineLatest(entities).pipe(map(entities => {
            return filterUndefined ? entities.filter(val => !isUndefined(val)) : entities;
        }), auditTime(0));
    }
    /**
     * @template R
     * @param {?} id
     * @param {?=} project
     * @return {?}
     */
    selectEntity(id, project) {
        if (!project) {
            return this._byId(id);
        }
        return this.select(state => {
            if (this.hasEntity(id)) {
                return project(this.getEntity(id));
            }
            return undefined;
        });
    }
    /**
     * Get an entity by id
     *
     * \@example
     * this.store.getEntity(1);
     * @param {?} id
     * @return {?}
     */
    getEntity(id) {
        return this.getSnapshot().entities[(/** @type {?} */ (id))];
    }
    /**
     * Select the active entity's id.
     * @return {?}
     */
    selectActiveId() {
        return this.select(state => ((/** @type {?} */ (state))).active);
    }
    /**
     * Get the active id
     * @return {?}
     */
    getActiveId() {
        return ((/** @type {?} */ (this.getSnapshot()))).active;
    }
    /**
     * @template R
     * @param {?=} project
     * @return {?}
     */
    selectActive(project) {
        return this.selectActiveId().pipe(switchMap(activeId => this.selectEntity(activeId, project)));
    }
    /**
     * Get the active entity.
     * @return {?}
     */
    getActive() {
        /** @type {?} */
        const activeId = this.getActiveId();
        return toBoolean(activeId) ? this.getEntity(activeId) : undefined;
    }
    /**
     * Select the store's entity collection length.
     * @param {?=} predicate
     * @return {?}
     */
    selectCount(predicate) {
        if (isFunction(predicate)) {
            return this.selectAll({
                filterBy: predicate
            }).pipe(map(entities => entities.length));
        }
        return this.select(store => store.ids.length);
    }
    /**
     * Get the store's entity collection length.
     * @param {?=} predicate
     * @return {?}
     */
    getCount(predicate) {
        if (isFunction(predicate)) {
            return this.getAll().filter(predicate).length;
        }
        return this.getSnapshot().ids.length;
    }
    /**
     * @param {?} projectOrIds
     * @return {?}
     */
    hasEntity(projectOrIds) {
        if (isFunction(projectOrIds)) {
            return this.getAll().some(projectOrIds);
        }
        if (Array.isArray(projectOrIds)) {
            return projectOrIds.every(id => ((/** @type {?} */ (id))) in this.store.entities);
        }
        return ((/** @type {?} */ (projectOrIds))) in this.store.entities;
    }
    /**
     * Returns whether entity store has an active entity.
     * @return {?}
     */
    hasActive() {
        return this.getSnapshot().active != null;
    }
    /**
     * @return {?}
     */
    isEmpty() {
        return this.getSnapshot().ids.length === 0;
    }
    /**
     * @param {?} id
     * @return {?}
     */
    _byId(id) {
        return this.select(state => this.getEntity(id));
    }
    /**
     * @param {?} options
     * @return {?}
     */
    sortByOptions(options) {
        options.sortBy = options.sortBy || (this.config && ((/** @type {?} */ (this.config.sortBy))));
        options.sortByOrder = options.sortByOrder || (this.config && this.config.sortByOrder);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.memoized = null;
    }
}
/**
 * @template E, S
 * @param {?} state
 * @param {?} options
 * @return {?}
 */
function toArray(state, options) {
    /** @type {?} */
    let arr = [];
    const { ids, entities } = state;
    const { filterBy, limitTo, sortBy, sortByOrder } = options;
    for (let i = 0; i < ids.length; i++) {
        /** @type {?} */
        const id = ids[i];
        if (!entityExists(id, entities)) {
            continue;
        }
        if (!filterBy) {
            arr.push(entities[id]);
            continue;
        }
        if (Array.isArray(filterBy)) {
            /** @type {?} */
            const allPass = filterBy.every(fn => fn(entities[id], i));
            if (allPass) {
                arr.push(entities[id]);
            }
        }
        else {
            if (filterBy(entities[id], i)) {
                arr.push(entities[id]);
            }
        }
    }
    if (sortBy) {
        /** @type {?} */
        let _sortBy = isFunction(sortBy) ? sortBy : compareValues(sortBy, sortByOrder);
        arr = arr.sort((a, b) => _sortBy(a, b, state));
    }
    /** @type {?} */
    const length = Math.min(limitTo || arr.length, arr.length);
    return length === arr.length ? arr : arr.slice(0, length);
}
/**
 * @template E
 * @param {?} ids
 * @param {?} entities
 * @param {?} options
 * @param {?=} get
 * @return {?}
 */
function toMap(ids, entities, options, get = false) {
    /** @type {?} */
    const map$$1 = {};
    const { filterBy, limitTo } = options;
    if (get && !filterBy && !limitTo) {
        return entities;
    }
    /** @type {?} */
    const length = Math.min(limitTo || ids.length, ids.length);
    if (filterBy && isUndefined(limitTo) === false) {
        /** @type {?} */
        let count = 0;
        for (let i = 0, length = ids.length; i < length; i++) {
            if (count === limitTo)
                break;
            /** @type {?} */
            const id = ids[i];
            if (!entityExists(id, entities)) {
                continue;
            }
            if (Array.isArray(filterBy)) {
                /** @type {?} */
                const allPass = filterBy.every(fn => fn(entities[id], i));
                if (allPass) {
                    map$$1[id] = entities[id];
                    count++;
                }
            }
            else {
                if (filterBy(entities[id], i)) {
                    map$$1[id] = entities[id];
                    count++;
                }
            }
        }
    }
    else {
        for (let i = 0; i < length; i++) {
            /** @type {?} */
            const id = ids[i];
            if (!entityExists(id, entities)) {
                continue;
            }
            if (!filterBy) {
                map$$1[id] = entities[id];
                continue;
            }
            if (Array.isArray(filterBy)) {
                /** @type {?} */
                const allPass = filterBy.every(fn => fn(entities[id], i));
                if (allPass) {
                    map$$1[id] = entities[id];
                }
            }
            else {
                if (filterBy(entities[id], i)) {
                    map$$1[id] = entities[id];
                }
            }
        }
    }
    return map$$1;
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 *  A logical transaction.
 *  Use this transaction to optimize the dispatch of all the stores.
 *  The following code will update the store, BUT  emits only once
 *
 * \@example
 *  applyTransaction(() => {
 *    this.todosStore.add(new Todo(1, title));
 *    this.todosStore.add(new Todo(2, title));
 *  });
 *
 * @template T
 * @param {?} action
 * @param {?=} thisArg
 * @return {?}
 */
function applyTransaction(action, thisArg = undefined) {
    startBatch();
    try {
        return action.apply(thisArg);
    }
    finally {
        endBatch();
    }
}
/**
 *  A logical transaction.
 *  Use this transaction to optimize the dispatch of all the stores.
 *
 *  The following code will update the store, BUT  emits only once.
 *
 * \@example
 * \@transaction
 *  addTodos() {
 *    this.todosStore.add(new Todo(1, title));
 *    this.todosStore.add(new Todo(2, title));
 *  }
 *
 *
 * @return {?}
 */
function transaction() {
    return function (target, propertyKey, descriptor) {
        /** @type {?} */
        const originalMethod = descriptor.value;
        descriptor.value = function (...args) {
            return applyTransaction(() => {
                return originalMethod.apply(this, args);
            }, this);
        };
        return descriptor;
    };
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
// https://github.com/georapbox/immutable-arrays
/**
 * Adds one or more elements to the end of an array by returning
 * a new array instead of mutating the original one.
 *
 * \@example
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = push(originalArray, 'f', 'g');
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['a', 'b', 'c', 'd', 'e', 'f', 'g']
 * @template T
 * @param {?} array
 * @param {...?} elementN
 * @return {?}
 */
function push(array, ...elementN) {
    return [...array, ...elementN];
}
/**
 * Deletes an element from an array by its index in the array.
 *
 * \@example
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = remove(originalArray, 2);
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['a', 'b', 'd', 'e']
 * @template T
 * @param {?} array
 * @param {?} index
 * @return {?}
 */
function remove(array, index) {
    return index >= 0 ? [...array.slice(0, index), ...array.slice(index + 1)] : [...array];
}
/**
 * Removes the last element from an array by returning
 * a new array instead of mutating the original one.
 *
 * \@example
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = pop(originalArray);
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['a', 'b', 'c', 'd']
 * @template T
 * @param {?} array
 * @return {?}
 */
function pop(array) {
    return array.slice(0, -1);
}
/**
 * Adds one or more elements to the beginning of an array.
 *
 * \@example
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = unshift(originalArray, 'f', 'g');
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['f', 'g', 'a', 'b', 'c', 'd', 'e']
 * @template T
 * @param {?} array
 * @param {...?} elementN
 * @return {?}
 */
function unshift(array, ...elementN) {
    return [...elementN, ...array];
}
/**
 * Sorts the elements of an array (not in place) and returns a sorted array.
 *
 * \@example
 * const numberArray = [20, 3, 4, 10, -3, 1, 0, 5];
 * const stringArray = ['Blue', 'Humpback', 'Beluga'];
 *
 * const resultArray = sort(numberArray, (a, b) => a - b);
 * // -> numberArray [20, 3, 4, 10, -3, 1, 0, 5]
 * // -> resultArray [-3, 0, 1, 3, 4, 5, 10, 20]
 *
 * const resultArray = sort(numberArray, (a, b) => b - a);
 * // -> numberArray [20, 3, 4, 10, -3, 1, 0, 5]
 * // -> resultArray [20, 10, 5, 4, 3, 1, 0, -3]
 *
 * const resultArray = sort(stringArray);
 * // -> stringArray ['Blue', 'Humpback', 'Beluga']
 * // -> resultArray ['Beluga', 'Blue', 'Humpback']
 *
 * const resultArray = sort(stringArray, (a, b) => a.toLowerCase() < b.toLowerCase());
 * // -> stringArray ['Blue', 'Humpback', 'Beluga']
 * // -> resultArray ['Humpback', 'Blue', 'Beluga']
 * @template T
 * @param {?} array
 * @param {?=} compareFunction
 * @return {?}
 */
function sort(array, compareFunction) {
    return [...array].sort(compareFunction);
}
/**
 * Reverses an array (not in place).
 * The first array element becomes the last, and the last array element becomes the first.
 *
 * \@example
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = reverse(originalArray);
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['e', 'd', 'c', 'b', 'a']
 * @template T
 * @param {?} array
 * @return {?}
 */
function reverse(array) {
    return [...array].reverse();
}
/**
 * Swap items in the array
 *
 * \@example
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = swap(originalArray, 1, 4);
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['a', 'e', 'c', 'd', 'b']
 * @template T
 * @param {?} array
 * @param {?} firstIndex
 * @param {?} secondIndex
 * @return {?}
 */
function swap(array, firstIndex, secondIndex) {
    /** @type {?} */
    const results = array.slice();
    /** @type {?} */
    const firstItem = array[firstIndex];
    results[firstIndex] = array[secondIndex];
    results[secondIndex] = firstItem;
    return results;
}
/**
 * Update item in the array
 *
 * \@example
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = update(originalArray, 1, 'newItem');
 * // -> resultArray ['a', 'newItem', 'c', 'd', 'b']
 *
 * const originalArray = [{title: 1}, {title: 2}];
 * const resultArray = update(originalArray, originalArray[0], {title: 3});
 * // -> resultArray  [{title: 3}, {title: 2}];
 * @template T
 * @param {?} array
 * @param {?} indexOrItem
 * @param {?} updated
 * @return {?}
 */
function update(array, indexOrItem, updated) {
    return array.map((current, idx) => {
        if (typeof indexOrItem === 'number' && idx === indexOrItem) {
            return updated;
        }
        if (isObject(indexOrItem) && ((/** @type {?} */ (indexOrItem))) === current) {
            return Object.assign({}, ((/** @type {?} */ (indexOrItem))), ((/** @type {?} */ (updated))));
        }
        return current;
    });
}
/**
 * Removes existing elements and/or adds new elements to an array.
 *
 * \@example
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = splice(originalArray, 0);
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray []
 *
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = splice(originalArray, 0, 1);
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['b', 'c', 'd', 'e']
 *
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = splice(originalArray, 0, 3);
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['d', 'e']
 *
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = splice(originalArray, 0, originalArray.length);
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray []
 *
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = splice(originalArray, 0, -3);
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['a', 'b', 'c', 'd', 'e']
 *
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = splice(originalArray, 0, 0, 'lorem', 'ipsum');
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['lorem', 'ipsum', 'a', 'b', 'c', 'd', 'e']
 *
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = splice(originalArray, originalArray.length, 0, 'lorem', 'ipsum');
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['a', 'b', 'c', 'd', 'e', 'lorem', 'ipsum']
 *
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = splice(originalArray, 0, 2, 'lorem', 'ipsum');
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['lorem', 'ipsum', 'c', 'd', 'e']
 *
 * const originalArray = ['a', 'b', 'c', 'd', 'e'];
 * const resultArray = splice(originalArray, originalArray.length - 2, 2, 'lorem', 'ipsum');
 * // -> originalArray ['a', 'b', 'c', 'd', 'e']
 * // -> resultArray ['a', 'b', 'c', 'lorem', 'ipsum']
 * @template T
 * @param {?} array
 * @param {?=} start
 * @param {?=} deleteCount
 * @param {...?} elementN
 * @return {?}
 */
function splice(array, start = array.length, deleteCount = array.length - start, ...elementN) {
    return [...array.slice(0, start), ...elementN, ...array.slice(start + (deleteCount < 0 ? 0 : deleteCount))];
}
/**
 * @template T
 * @param {?} arr
 * @param {?} item
 * @return {?}
 */
function toggle(arr, item) {
    return arr.indexOf(item) > -1 ? arr.filter(current => item !== current) : push(arr, item);
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
const filterNil = (source) => source.pipe(filter(value => value !== null && typeof value !== 'undefined'));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * @template T
 * @param {?} func
 * @param {?} action
 * @param {?=} thisArg
 * @return {?}
 */
function applyAction(func, action, thisArg = undefined) {
    __globalState.setCustomAction(action, true);
    return func.apply(thisArg);
}
/**
 * @param {?} action
 * @param {?=} skipTransactionMsg
 * @return {?}
 */
function action(action, skipTransactionMsg = true) {
    return function (target, propertyKey, descriptor) {
        /** @type {?} */
        const originalMethod = descriptor.value;
        descriptor.value = function (...args) {
            __globalState.setCustomAction(action, skipTransactionMsg);
            return originalMethod.apply(this, args);
        };
        return descriptor;
    };
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * @param {?} object
 * @return {?}
 */
function serialize(object) {
    return JSON.stringify(object, function (key, value) {
        if (typeof value === 'function') {
            return value.toString();
        }
        return value;
    });
}
/**
 * @return {?}
 */
function createWorker() {
    /** @type {?} */
    const blob = new Blob([
        `self.onmessage = function(e) {

      function deserialize(str) {
        return JSON.parse(str || '', function(key, value) {
          if (value &&
            typeof value === "string" &&
            value.substr(0, 8) == "function") {
            var startBody = value.indexOf('{') + 1;
            var endBody = value.lastIndexOf('}');
            var startArgs = value.indexOf('(') + 1;
            var endArgs = value.indexOf(')');
            return new Function(value.substring(startArgs, endArgs), value.substring(startBody, endBody));
          }
          return value;
        });
      }

      var deserialized = deserialize(e.data);
      var mapped = deserialized.data.map(function(d) {
        return deserialized.factory(d);
      });

      self.postMessage(mapped);
    }`
    ], {
        type: 'text/javascript'
    });
    /** @type {?} */
    const url = URL.createObjectURL(blob);
    return new Worker(url);
}
/**
 * \@example
 *   const mockTodos = Array.from({length: 10000}, (_, x) => ({id: x}));
 *
 *   of(mockTodos).pipe(mapInWorker<Todo>(createTodo))
 *   .subscribe(res => console.log(res));
 * @template T
 * @param {?} factoryFn
 * @return {?}
 */
function mapInWorker(factoryFn) {
    return function (source) {
        return new Observable(observer => {
            /** @type {?} */
            const worker = createWorker();
            worker.onmessage = function (e) {
                observer.next(e.data);
                observer.complete();
                worker.terminate();
            };
            worker.onerror = function (err) {
                observer.error(err);
                observer.complete();
                worker.terminate();
            };
            return source.subscribe(value => {
                /** @type {?} */
                const input = {
                    factory: factoryFn,
                    data: value
                };
                /** @type {?} */
                const serialized = serialize(input);
                worker.postMessage(serialized);
            });
        });
    };
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
class SnapshotManager {
    /**
     * Get a snapshot of the whole state or a specific stores
     * Use it ONLY for things like saving the state in the server
     * @param {?=} stores
     * @return {?}
     */
    getStoresSnapshot(stores = []) {
        /** @type {?} */
        let acc = {};
        /** @type {?} */
        const hasInclude = stores.length > 0;
        /** @type {?} */
        const keys = hasInclude ? stores : Object.keys(__stores__);
        for (let i = 0; i < keys.length; i++) {
            /** @type {?} */
            let storeName = keys[i];
            acc[storeName] = __stores__[storeName]._value();
        }
        return acc;
    }
    /**
     * Set snapshot we get from the server
     * @param {?} stores
     * @return {?}
     */
    setStoresSnapshot(stores) {
        /** @type {?} */
        let normalizedStores = stores;
        if (isString(stores)) {
            normalizedStores = JSON.parse((/** @type {?} */ (normalizedStores)));
        }
        for (let i = 0, keys = Object.keys(normalizedStores); i < keys.length; i++) {
            /** @type {?} */
            const storeName = keys[i];
            if (__stores__[storeName]) {
                __stores__[storeName].setState(() => normalizedStores[storeName]);
            }
        }
    }
}
/** @type {?} */
const snapshotManager = new SnapshotManager();

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * @abstract
 * @template E, S
 */
class AkitaPlugin {
    /**
     * @param {?} query
     * @param {?=} config
     */
    constructor(query, config) {
        this.query = query;
        if (config && config.resetFn) {
            if (getAkitaConfig().resettable) {
                this.onReset(config.resetFn);
            }
        }
    }
    /**
     * This method is responsible for getting access to the query.
     * @return {?}
     */
    getQuery() {
        return this.query;
    }
    /**
     * This method is responsible for getting access to the store.
     * @return {?}
     */
    getStore() {
        return this.getQuery().__store__;
    }
    /**
     * This method is responsible tells whether the plugin is entityBased or not.
     * @param {?} entityId
     * @return {?}
     */
    isEntityBased(entityId) {
        return toBoolean(entityId);
    }
    /**
     * This method is responsible for selecting the source; it can be the whole store or one entity.
     * @param {?} entityId
     * @return {?}
     */
    selectSource(entityId) {
        if (this.isEntityBased(entityId)) {
            return ((/** @type {?} */ (this.getQuery()))).selectEntity(entityId).pipe(filterNil);
        }
        return ((/** @type {?} */ (this.getQuery()))).select(state => state);
    }
    /**
     * @param {?} entityId
     * @return {?}
     */
    getSource(entityId) {
        if (this.isEntityBased(entityId)) {
            return ((/** @type {?} */ (this.getQuery()))).getEntity(entityId);
        }
        return this.getQuery().getSnapshot();
    }
    /**
     * This method is responsible for updating the store or one entity; it can be the whole store or one entity.
     * @param {?} newState
     * @param {?=} entityId
     * @return {?}
     */
    updateStore(newState, entityId) {
        if (this.isEntityBased(entityId)) {
            this.getStore().update(entityId, newState);
        }
        else {
            this.getStore().setState(state => (Object.assign({}, state, newState)));
        }
    }
    /**
     * Function to invoke upon reset
     * @param {?} fn
     * @return {?}
     */
    onReset(fn) {
        /** @type {?} */
        const original = this.getStore().reset;
        this.getStore().reset = (...params) => {
            /** It should run after the plugin destroy method */
            setTimeout(() => {
                original.apply(this.getStore(), params);
                fn();
            });
        };
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
const paginatorDefaults = {
    pagesControls: false,
    range: false,
    startWith: 1,
    cacheTimeout: undefined
};
/**
 * @template E
 */
class PaginatorPlugin extends AkitaPlugin {
    /**
     * @param {?} query
     * @param {?=} config
     */
    constructor(query, config = {}) {
        super(query, {
            resetFn: () => {
                this.initial = false;
                this.destroy({ clearCache: true, currentPage: 1 });
            }
        });
        this.query = query;
        this.config = config;
        /**
         * Save current filters, sorting, etc. in cache
         */
        this.metadata = new Map();
        this.pages = new Map();
        this.pagination = {
            currentPage: 1,
            perPage: 0,
            total: 0,
            lastPage: 0,
            data: []
        };
        /**
         * When the user navigates to a different page and return
         * we don't want to call `clearCache` on first time.
         */
        this.initial = false;
        /**
         * Proxy to the query loading
         */
        this.isLoading$ = this.query.selectLoading().pipe(delay(0));
        this.config = Object.assign(paginatorDefaults, config);
        const { startWith, cacheTimeout } = this.config;
        this.page = new BehaviorSubject(startWith);
        if (isObservable(cacheTimeout)) {
            this.clearCacheSubscription = cacheTimeout.subscribe(_ => this.clearCache());
        }
    }
    /**
     * Listen to page changes
     * @return {?}
     */
    get pageChanges() {
        return this.page.asObservable();
    }
    /**
     * Get the current page number
     * @return {?}
     */
    get currentPage() {
        return this.pagination.currentPage;
    }
    /**
     * Check if current page is the first one
     * @return {?}
     */
    get isFirst() {
        return this.currentPage === 1;
    }
    /**
     * Check if current page is the last one
     * @return {?}
     */
    get isLast() {
        return this.currentPage === this.pagination.lastPage;
    }
    /**
     * Whether to generate an array of pages for *ngFor
     * [1, 2, 3, 4]
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    withControls() {
        (/** @type {?} */ (this)).config.pagesControls = true;
        return (/** @type {?} */ (this));
    }
    /**
     * Whether to generate the `from` and `to` keys
     * [1, 2, 3, 4]
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    withRange() {
        (/** @type {?} */ (this)).config.range = true;
        return (/** @type {?} */ (this));
    }
    /**
     * Set the loading state
     * @param {?=} value
     * @return {?}
     */
    setLoading(value = true) {
        this.getStore().setLoading(value);
    }
    /**
     * Update the pagination object and add the page
     * @param {?} response
     * @return {?}
     */
    update(response) {
        this.pagination = response;
        this.addPage(response.data);
    }
    /**
     *
     * Set the ids and add the page to store
     * @param {?} data
     * @return {?}
     */
    addPage(data) {
        this.pages.set(this.currentPage, { ids: data.map(entity => entity[this.getStore().idKey]) });
        this.getStore().add(data);
    }
    /**
     * Clear the cache.
     * @return {?}
     */
    clearCache() {
        if (!this.initial) {
            applyAction(() => {
                this.getStore().remove();
            }, { type: '@Pagination - Clear Cache' });
            this.pages = new Map();
            this.metadata = new Map();
        }
        this.initial = false;
    }
    /**
     * @param {?} page
     * @return {?}
     */
    clearPage(page) {
        this.pages.delete(page);
    }
    /**
     * Clear the cache timeout and optionally the pages
     * @param {?=} __0
     * @return {?}
     */
    destroy({ clearCache, currentPage } = {}) {
        if (this.clearCacheSubscription) {
            this.clearCacheSubscription.unsubscribe();
        }
        if (clearCache) {
            this.clearCache();
        }
        if (!isUndefined(currentPage)) {
            this.setPage(currentPage);
        }
        this.initial = true;
    }
    /**
     * Whether the provided page is active
     * @param {?} page
     * @return {?}
     */
    isPageActive(page) {
        return this.currentPage === page;
    }
    /**
     * Set the current page
     * @param {?} page
     * @return {?}
     */
    setPage(page) {
        if (page !== this.currentPage || !this.hasPage(page)) {
            this.page.next((this.pagination.currentPage = page));
        }
    }
    /**
     * Increment current page
     * @return {?}
     */
    nextPage() {
        if (this.currentPage !== this.pagination.lastPage) {
            this.setPage(this.pagination.currentPage + 1);
        }
    }
    /**
     * Decrement current page
     * @return {?}
     */
    prevPage() {
        if (this.pagination.currentPage > 1) {
            this.setPage(this.pagination.currentPage - 1);
        }
    }
    /**
     * Set current page to last
     * @return {?}
     */
    setLastPage() {
        this.setPage(this.pagination.lastPage);
    }
    /**
     * Set current page to first
     * @return {?}
     */
    setFirstPage() {
        this.setPage(1);
    }
    /**
     * Check if page exists in cache
     * @param {?} page
     * @return {?}
     */
    hasPage(page) {
        return this.pages.has(page);
    }
    /**
     * Get the current page if it's in cache, otherwise invoke the request
     * @param {?} req
     * @return {?}
     */
    getPage(req) {
        /** @type {?} */
        const page = this.pagination.currentPage;
        if (this.hasPage(page)) {
            return this.selectPage(page);
        }
        else {
            this.setLoading(true);
            return from(req()).pipe(switchMap((config) => {
                applyTransaction(() => {
                    this.setLoading(false);
                    this.update(config);
                });
                return this.selectPage(page);
            }));
        }
    }
    /**
     * @return {?}
     */
    getQuery() {
        return this.query;
    }
    /**
     * @return {?}
     */
    getFrom() {
        if (this.isFirst) {
            return 1;
        }
        return (this.currentPage - 1) * this.pagination.perPage + 1;
    }
    /**
     * @return {?}
     */
    getTo() {
        return this.currentPage * this.pagination.perPage;
    }
    /**
     * Select the page
     * @param {?} page
     * @return {?}
     */
    selectPage(page) {
        return this.query.selectAll({ asObject: true }).pipe(take(1), map(entities => {
            /** @type {?} */
            let response = Object.assign({}, this.pagination, { data: this.pages.get(page).ids.map(id => entities[id]) });
            const { range, pagesControls } = this.config;
            /** If no total - calc it */
            if (isNaN(this.pagination.total)) {
                if (response.lastPage === 1) {
                    response.total = response.data ? response.data.length : 0;
                }
                else {
                    response.total = response.perPage * response.lastPage;
                }
                this.pagination.total = response.total;
            }
            if (range) {
                response.from = this.getFrom();
                response.to = this.getTo();
            }
            if (pagesControls) {
                response.pageControls = generatePages(this.pagination.total, this.pagination.perPage);
            }
            return response;
        }));
    }
}
__decorate([
    action({ type: '@Pagination - New Page' }, true),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], PaginatorPlugin.prototype, "update", null);
/**
 * Generate an array so we can ngFor them to navigate between pages
 * @param {?} total
 * @param {?} perPage
 * @return {?}
 */
function generatePages(total, perPage) {
    /** @type {?} */
    const len = Math.ceil(total / perPage);
    /** @type {?} */
    let arr = [];
    for (let i = 0; i < len; i++) {
        arr.push(i + 1);
    }
    return arr;
}
/**
 * backward compatibility
 * @type {?}
 */
const Paginator = PaginatorPlugin;

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
// Todo: Return  AbstractControl interface
/**
 * @template T
 */
class PersistNgFormPlugin extends AkitaPlugin {
    /**
     * @param {?} query
     * @param {?=} factoryFnOrPath
     * @param {?=} params
     */
    constructor(query, factoryFnOrPath, params = {}) {
        super(query);
        this.query = query;
        this.factoryFnOrPath = factoryFnOrPath;
        this.params = params;
        this.params = Object.assign({ debounceTime: 300, formKey: 'akitaForm', emitEvent: false, arrControlFactory: v => this.builder.control(v) }, params);
        this.isRootKeys = toBoolean(factoryFnOrPath) === false;
        this.isKeyBased = isString(factoryFnOrPath) || this.isRootKeys;
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?} form
     * @param {?=} builder
     * @return {THIS}
     */
    setForm(form, builder) {
        (/** @type {?} */ (this)).form = form;
        (/** @type {?} */ (this)).builder = builder;
        (/** @type {?} */ (this)).activate();
        return (/** @type {?} */ (this));
    }
    /**
     * @param {?=} initialState
     * @return {?}
     */
    reset(initialState) {
        /** @type {?} */
        let value;
        if (initialState) {
            value = initialState;
        }
        else {
            value = this.isKeyBased ? this.initialValue : ((/** @type {?} */ (this))).factoryFnOrPath();
        }
        if (this.isKeyBased) {
            Object.keys(this.initialValue).forEach(stateKey => {
                /** @type {?} */
                const value = this.initialValue[stateKey];
                if (Array.isArray(value) && this.builder) {
                    /** @type {?} */
                    const formArray = this.form.controls[stateKey];
                    this.cleanArray(formArray);
                    value.forEach((v, i) => {
                        this.form.get(stateKey).insert(i, ((/** @type {?} */ (this.params.arrControlFactory)))(v));
                    });
                }
            });
        }
        this.form.patchValue(value, { emitEvent: this.params.emitEvent });
        /** @type {?} */
        const storeValue = this.isKeyBased ? setValue(this.getQuery().getSnapshot(), `${this.getStore().storeName}.${this.factoryFnOrPath}`, value) : { [this.params.formKey]: value };
        this.updateStore(storeValue);
    }
    /**
     * @param {?} control
     * @return {?}
     */
    cleanArray(control) {
        while (control.length !== 0) {
            control.removeAt(0);
        }
    }
    /**
     * @param {?} formValue
     * @param {?} root
     * @return {?}
     */
    resolveInitialValue(formValue, root) {
        if (!formValue)
            return;
        return Object.keys(formValue).reduce((acc, stateKey) => {
            /** @type {?} */
            const value = root[stateKey];
            if (Array.isArray(value) && this.builder) {
                /** @type {?} */
                const factory = this.params.arrControlFactory;
                this.cleanArray(this.form.get(stateKey));
                value.forEach((v, i) => {
                    this.form.get(stateKey).insert(i, ((/** @type {?} */ (factory)))(v));
                });
            }
            acc[stateKey] = root[stateKey];
            return acc;
        }, {});
    }
    /**
     * @return {?}
     */
    activate() {
        /** @type {?} */
        let path;
        if (this.isKeyBased) {
            if (this.isRootKeys) {
                this.initialValue = this.resolveInitialValue(this.form.value, this.getQuery().getSnapshot());
                this.form.patchValue(this.initialValue, { emitEvent: this.params.emitEvent });
            }
            else {
                path = `${this.getStore().storeName}.${this.factoryFnOrPath}`;
                /** @type {?} */
                const root = getValue(this.getQuery().getSnapshot(), path);
                this.initialValue = this.resolveInitialValue(root, root);
                this.form.patchValue(this.initialValue, { emitEvent: this.params.emitEvent });
            }
        }
        else {
            if (!((/** @type {?} */ (this.getQuery().getSnapshot())))[this.params.formKey]) {
                __globalState.setAction({ type: '@PersistNgFormPlugin activate' });
                this.updateStore({ [this.params.formKey]: ((/** @type {?} */ (this))).factoryFnOrPath() });
            }
            /** @type {?} */
            const value = this.getQuery().getSnapshot()[this.params.formKey];
            this.form.patchValue(value);
        }
        this.formChanges = this.form.valueChanges.pipe(debounceTime(this.params.debounceTime)).subscribe(value => {
            __globalState.setAction({ type: '@PersistForm - Update' });
            /** @type {?} */
            let newState;
            if (this.isKeyBased) {
                if (this.isRootKeys) {
                    newState = state => (Object.assign({}, state, value));
                }
                else {
                    newState = state => setValue(state, path, value);
                }
            }
            else {
                newState = () => ({ [this.params.formKey]: value });
            }
            this.updateStore(newState(this.getQuery().getSnapshot()));
        });
    }
    /**
     * @return {?}
     */
    destroy() {
        this.formChanges && this.formChanges.unsubscribe();
        this.form = null;
        this.builder = null;
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
const notBs = typeof localStorage === 'undefined';
/**
 * @param {?=} params
 * @return {?}
 */
function persistState(params) {
    if (notBs)
        return;
    /** @type {?} */
    const defaults = {
        key: 'AkitaStores',
        storage: localStorage,
        deserialize: JSON.parse,
        serialize: JSON.stringify,
        include: [],
        exclude: []
    };
    const { storage, deserialize, serialize, include, exclude, key } = Object.assign({}, defaults, params);
    /** @type {?} */
    const hasInclude = include.length > 0;
    /** @type {?} */
    const hasExclude = exclude.length > 0;
    /** @type {?} */
    let includeStores;
    if (hasInclude && hasExclude) {
        throw new AkitaError("You can't use both include and exclude");
    }
    if (hasInclude) {
        includeStores = include.reduce((acc, path) => {
            /** @type {?} */
            const storeName = path.split('.')[0];
            acc[storeName] = path;
            return acc;
        }, {});
    }
    /** @type {?} */
    const storageState = deserialize(storage.getItem(key) || '{}');
    /** @type {?} */
    let stores = {};
    /** @type {?} */
    let acc = {};
    /**
     * @return {?}
     */
    function save() {
        storage.setItem(key, serialize(Object.assign({}, storageState, acc)));
    }
    /**
     * @param {?} storeName
     * @param {?} path
     * @return {?}
     */
    function subscribe(storeName, path) {
        stores[storeName] = __stores__[storeName]
            ._select(state => getValue(state, path))
            .pipe(skip(1))
            .subscribe(data => {
            acc[storeName] = data;
            save();
        });
    }
    /**
     * @param {?} storeName
     * @param {?} store
     * @param {?} path
     * @return {?}
     */
    function setInitial(storeName, store, path) {
        if (storageState[storeName]) {
            __globalState.setAction({ type: '@PersistState' });
            store.setState(state => {
                return setValue(state, path, storageState[storeName]);
            });
            if (store.setDirty) {
                store.setDirty();
            }
        }
    }
    /** @type {?} */
    const subscription = rootDispatcher.pipe(filter(action => action.type === 0 /* NEW_STORE */)).subscribe(action => {
        /** @type {?} */
        let currentStoreName = action.payload.store.storeName;
        if (hasExclude && exclude.includes(currentStoreName)) {
            return;
        }
        if (hasInclude) {
            /** @type {?} */
            const path = includeStores[currentStoreName];
            if (!path) {
                return;
            }
            setInitial(currentStoreName, action.payload.store, path);
            subscribe(currentStoreName, path);
        }
        else {
            setInitial(currentStoreName, action.payload.store, currentStoreName);
            subscribe(currentStoreName, currentStoreName);
        }
    });
    return {
        /**
         * @return {?}
         */
        destroy() {
            subscription.unsubscribe();
            for (let i = 0, keys = Object.keys(stores); i < keys.length; i++) {
                /** @type {?} */
                const storeName = keys[i];
                stores[storeName].unsubscribe();
            }
            stores = {};
        },
        /**
         * @return {?}
         */
        clear() {
            storage.clear();
        },
        /**
         * @param {?} storeName
         * @return {?}
         */
        clearStore(storeName) {
            /** @type {?} */
            const storageState = deserialize(storage.getItem(key) || '{}');
            if (storageState[storeName]) {
                delete storageState[storeName];
                storage.setItem(key, serialize(storageState));
            }
        }
    };
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
let rootDispatcherSub;
/** @type {?} */
let devtoolsSub;
/**
 * @param {?=} ngZoneOrOptions
 * @param {?=} options
 * @return {?}
 */
function akitaDevtools(ngZoneOrOptions, options = {}) {
    if (!((/** @type {?} */ (window))).__REDUX_DEVTOOLS_EXTENSION__) {
        return;
    }
    rootDispatcherSub && rootDispatcherSub.unsubscribe();
    devtoolsSub && devtoolsSub();
    /** @type {?} */
    const isAngular = ngZoneOrOptions && ngZoneOrOptions['run'];
    if (!isAngular) {
        ngZoneOrOptions = ngZoneOrOptions || {};
        ((/** @type {?} */ (ngZoneOrOptions))).run = cb => cb();
        options = (/** @type {?} */ (ngZoneOrOptions));
    }
    /** @type {?} */
    const defaultOptions = { name: 'Akita' };
    /** @type {?} */
    const merged = Object.assign({}, defaultOptions, options);
    /** @type {?} */
    const devTools = ((/** @type {?} */ (window))).__REDUX_DEVTOOLS_EXTENSION__.connect(merged);
    /** @type {?} */
    let appState = {};
    rootDispatcherSub = rootDispatcher.subscribe(action => {
        if (action.type === 1 /* DELETE_STORE */) {
            /** @type {?} */
            const storeName = action.payload.storeName;
            delete appState[storeName];
            devTools.send({ type: `[${storeName}] - Delete Store` }, appState);
        }
        if (action.type === 2 /* NEW_STATE */) {
            if (__globalState.skipAction) {
                __globalState.setSkipAction(false);
                return;
            }
            appState = Object.assign({}, appState, { [action.payload.name]: __stores__[action.payload.name]._value() });
            const { type, entityId } = __globalState.currentAction;
            /** @type {?} */
            const storeName = capitalize(action.payload.name);
            /** @type {?} */
            let msg = isDefined(entityId) ? `[${storeName}] - ${type} (ids: ${entityId})` : `[${storeName}] - ${type}`;
            if (options.logTrace) {
                console.group(msg);
                console.trace();
                console.groupEnd();
            }
            devTools.send({ type: msg, transaction: __globalState.currentT.map(t => t.type) }, appState);
        }
    });
    devtoolsSub = devTools.subscribe(message => {
        if (message.type === 'ACTION') {
            const [storeName] = message.payload.split('.');
            if (__stores__[storeName]) {
                ((/** @type {?} */ (ngZoneOrOptions))).run(() => {
                    /** @type {?} */
                    const funcCall = message.payload.replace(storeName, `this['${storeName}']`);
                    try {
                        new Function(`${funcCall}`).call(__stores__);
                    }
                    catch (e) {
                        console.warn('Unknown Method ');
                    }
                });
            }
        }
        if (message.type === 'DISPATCH') {
            /** @type {?} */
            const payloadType = message.payload.type;
            if (payloadType === 'COMMIT') {
                devTools.init(appState);
                return;
            }
            if (message.state) {
                /** @type {?} */
                const rootState = JSON.parse(message.state);
                for (let i = 0, keys = Object.keys(rootState); i < keys.length; i++) {
                    /** @type {?} */
                    const storeName = keys[i];
                    if (__stores__[storeName]) {
                        ((/** @type {?} */ (ngZoneOrOptions))).run(() => {
                            __stores__[storeName].setState(() => rootState[storeName], false);
                        });
                    }
                }
            }
        }
    });
}
/**
 * @param {?} string
 * @return {?}
 */
function capitalize(string) {
    return string && string.charAt(0).toUpperCase() + string.slice(1);
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
const 0 = plugin => plugin.destroy();
/** @type {?} */
const defaultActions = { beforeRemove: 0 };
/**
 * @abstract
 * @template E, P
 */
class EntityCollectionPlugin {
    /**
     * @param {?} query
     * @param {?} entityIds
     */
    constructor(query, entityIds) {
        this.query = query;
        this.entityIds = entityIds;
        this.entities = new Map();
    }
    /**
     * Get the entity plugin instance.
     * @param {?} id
     * @return {?}
     */
    getEntity(id) {
        return this.entities.get(id);
    }
    /**
     * Whether the entity plugin exist.
     * @param {?} id
     * @return {?}
     */
    hasEntity(id) {
        return this.entities.has(id);
    }
    /**
     * Remove the entity plugin instance.
     * @param {?} id
     * @return {?}
     */
    removeEntity(id) {
        return this.entities.delete(id);
    }
    /**
     * Set the entity plugin instance.
     * @param {?} id
     * @param {?} plugin
     * @return {?}
     */
    createEntity(id, plugin) {
        return this.entities.set(id, plugin);
    }
    /**
     * If the user passes `entityIds` we take them; otherwise, we take all.
     * @return {?}
     */
    getIds() {
        return isUndefined(this.entityIds) ? this.query.getSnapshot().ids : coerceArray(this.entityIds);
    }
    /**
     * When you call one of the plugin methods, you can pass id/ids or undefined which means all.
     * @param {?=} ids
     * @return {?}
     */
    resolvedIds(ids) {
        return isUndefined(ids) ? this.getIds() : coerceArray(ids);
    }
    /**
     * Call this method when you want to activate the plugin on init or when you need to listen to add/remove of entities dynamically.
     *
     * For example in your plugin you may do the following:
     *
     * this.query.select(state => state.ids).pipe(skip(1)).subscribe(ids => this.activate(ids));
     * @param {?} ids
     * @param {?=} actions
     * @return {?}
     */
    rebase(ids, actions = defaultActions) {
        /**
         *
         * If the user passes `entityIds` & we have new ids check if we need to add/remove instances.
         *
         * This phase will be called only upon update.
         */
        if (toBoolean(ids)) {
            /**
             * Which means all
             */
            if (isUndefined(this.entityIds)) {
                for (let i = 0, len = ids.length; i < len; i++) {
                    /** @type {?} */
                    const entityId = ids[i];
                    if (this.hasEntity(entityId) === false) {
                        isFunction(actions.beforeAdd) && actions.beforeAdd(entityId);
                        /** @type {?} */
                        const plugin = this.instantiatePlugin(entityId);
                        this.entities.set(entityId, plugin);
                        isFunction(actions.afterAdd) && actions.afterAdd(plugin);
                    }
                }
                this.entities.forEach((plugin, entityId) => {
                    if (ids.indexOf(entityId) === -1) {
                        isFunction(actions.beforeRemove) && actions.beforeRemove(plugin);
                        this.removeEntity(entityId);
                    }
                });
            }
            else {
                /**
                 * Which means the user passes specific ids
                 * @type {?}
                 */
                const _ids = coerceArray(this.entityIds);
                for (let i = 0, len = _ids.length; i < len; i++) {
                    /** @type {?} */
                    const entityId = _ids[i];
                    /** The Entity in current ids and doesn't exist, add it. */
                    if (ids.indexOf(entityId) > -1 && this.hasEntity(entityId) === false) {
                        isFunction(actions.beforeAdd) && actions.beforeAdd(entityId);
                        /** @type {?} */
                        const plugin = this.instantiatePlugin(entityId);
                        this.entities.set(entityId, plugin);
                        isFunction(actions.afterAdd) && actions.afterAdd(plugin);
                    }
                    else {
                        this.entities.forEach((plugin, entityId) => {
                            /** The Entity not in current ids and exists, remove it. */
                            if (ids.indexOf(entityId) === -1 && this.hasEntity(entityId) === true) {
                                isFunction(actions.beforeRemove) && actions.beforeRemove(plugin);
                                this.removeEntity(entityId);
                            }
                        });
                    }
                }
            }
        }
        else {
            /**
             * Otherwise, start with the provided ids or all.
             */
            this.getIds().forEach(id => {
                if (!this.hasEntity(id))
                    this.createEntity(id, this.instantiatePlugin(id));
            });
        }
    }
    /**
     * Listen for add/remove entities.
     * @return {?}
     */
    selectIds() {
        return this.query.select(state => state.ids);
    }
    /**
     * Base method for activation, you can override it if you need to.
     * @param {?=} ids
     * @return {?}
     */
    activate(ids) {
        this.rebase(ids);
    }
    /**
     * Loop over each id and invoke the plugin method.
     * @param {?} ids
     * @param {?} cb
     * @return {?}
     */
    forEachId(ids, cb) {
        /** @type {?} */
        const _ids = this.resolvedIds(ids);
        for (let i = 0, len = _ids.length; i < len; i++) {
            /** @type {?} */
            const id = _ids[i];
            if (this.hasEntity(id)) {
                cb(this.getEntity(id));
            }
        }
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * @template E, S
 */
class StateHistoryPlugin extends AkitaPlugin {
    /**
     * @param {?} query
     * @param {?=} params
     * @param {?=} _entityId
     */
    constructor(query, params = {}, _entityId) {
        super(query, {
            resetFn: () => this.clear()
        });
        this.query = query;
        this.params = params;
        this._entityId = _entityId;
        /**
         * Allow skipping an update from outside
         */
        this.skip = false;
        this.history = {
            past: [],
            present: null,
            future: []
        };
        /**
         * Skip the update when redo/undo
         */
        this.skipUpdate = false;
        params.maxAge = toBoolean(params.maxAge) ? params.maxAge : 10;
        this.activate();
    }
    /**
     * @return {?}
     */
    get hasPast() {
        return this.history.past.length > 0;
    }
    /**
     * @return {?}
     */
    get hasFuture() {
        return this.history.future.length > 0;
    }
    /**
     * @return {?}
     */
    activate() {
        this.history.present = this.getSource(this._entityId);
        this.subscription = this.selectSource(this._entityId)
            .pipe(pairwise())
            .subscribe(([past, present]) => {
            if (this.skip) {
                this.skip = false;
                return;
            }
            if (!this.skipUpdate) {
                if (this.history.past.length === this.params.maxAge) {
                    this.history.past = this.history.past.slice(1);
                }
                this.history.past = [...this.history.past, past];
                this.history.present = present;
            }
        });
    }
    /**
     * @return {?}
     */
    undo() {
        if (this.history.past.length > 0) {
            const { past, present, future } = this.history;
            /** @type {?} */
            const previous = past[past.length - 1];
            /** @type {?} */
            const newPast = past.slice(0, past.length - 1);
            this.history.past = newPast;
            this.history.present = previous;
            this.history.future = [present, ...this.history.future];
            this.update();
        }
    }
    /**
     * @return {?}
     */
    redo() {
        if (this.history.future.length > 0) {
            const { past, present, future } = this.history;
            /** @type {?} */
            const next = this.history.future[0];
            /** @type {?} */
            const newFuture = this.history.future.slice(1);
            this.history.past = [...past, present];
            this.history.present = next;
            this.history.future = newFuture;
            this.update('Redo');
        }
    }
    /**
     * @param {?} index
     * @return {?}
     */
    jumpToPast(index) {
        if (index < 0 || index >= this.history.past.length)
            return;
        const { past, future } = this.history;
        /**
         *
         * const past = [1, 2, 3, 4, 5];
         *
         * newPast = past.slice(0, 2) = [1, 2];
         * present = past[index] = 3;
         * [...past.slice(2 + 1), ...future] = [4, 5];
         *
         * @type {?}
         */
        const newPast = past.slice(0, index);
        /** @type {?} */
        const newFuture = [...past.slice(index + 1), ...future];
        /** @type {?} */
        const newPresent = past[index];
        this.history.past = newPast;
        this.history.present = newPresent;
        this.history.future = newFuture;
        this.update();
    }
    /**
     * @param {?} index
     * @return {?}
     */
    jumpToFuture(index) {
        if (index < 0 || index >= this.history.future.length)
            return;
        const { past, future } = this.history;
        /** @type {?} */
        const newPast = [...past, ...future.slice(0, index)];
        /** @type {?} */
        const newPresent = future[index];
        /** @type {?} */
        const newFuture = future.slice(index + 1);
        this.history.past = newPast;
        this.history.present = newPresent;
        this.history.future = newFuture;
        this.update('Redo');
    }
    /**
     * @return {?}
     */
    clear() {
        this.history = {
            past: [],
            present: null,
            future: []
        };
    }
    /**
     * @param {?=} clearHistory
     * @return {?}
     */
    destroy(clearHistory = false) {
        if (clearHistory) {
            this.clear();
        }
        this.subscription.unsubscribe();
    }
    /**
     * @return {?}
     */
    ignoreNext() {
        this.skip = true;
    }
    /**
     * @param {?=} action
     * @return {?}
     */
    update(action = 'Undo') {
        this.skipUpdate = true;
        __globalState.setCustomAction({ type: `@StateHistory - ${action}` });
        this.updateStore(this.history.present, this._entityId);
        this.skipUpdate = false;
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * @template E, P
 */
class EntityStateHistoryPlugin extends EntityCollectionPlugin {
    /**
     * @param {?} query
     * @param {?=} params
     */
    constructor(query, params = {}) {
        super(query, params.entityIds);
        this.query = query;
        this.params = params;
        params.maxAge = toBoolean(params.maxAge) ? params.maxAge : 10;
        this.activate();
        this.selectIds()
            .pipe(skip(1))
            .subscribe(ids => this.activate(ids));
    }
    /**
     * @param {?=} ids
     * @return {?}
     */
    redo(ids) {
        this.forEachId(ids, e => e.redo());
    }
    /**
     * @param {?=} ids
     * @return {?}
     */
    undo(ids) {
        this.forEachId(ids, e => e.undo());
    }
    /**
     * @param {?} id
     * @return {?}
     */
    hasPast(id) {
        if (this.hasEntity(id)) {
            return this.getEntity(id).hasPast;
        }
    }
    /**
     * @param {?} id
     * @return {?}
     */
    hasFuture(id) {
        if (this.hasEntity(id)) {
            return this.getEntity(id).hasFuture;
        }
    }
    /**
     * @param {?} ids
     * @param {?} index
     * @return {?}
     */
    jumpToFuture(ids, index) {
        this.forEachId(ids, e => e.jumpToFuture(index));
    }
    /**
     * @param {?} ids
     * @param {?} index
     * @return {?}
     */
    jumpToPast(ids, index) {
        this.forEachId(ids, e => e.jumpToPast(index));
    }
    /**
     * @param {?=} ids
     * @return {?}
     */
    clear(ids) {
        this.forEachId(ids, e => e.clear());
    }
    /**
     * @param {?=} ids
     * @param {?=} clearHistory
     * @return {?}
     */
    destroy(ids, clearHistory = false) {
        this.forEachId(ids, e => e.destroy(clearHistory));
    }
    /**
     * @param {?=} ids
     * @return {?}
     */
    ignoreNext(ids) {
        this.forEachId(ids, e => e.ignoreNext());
    }
    /**
     * @param {?} id
     * @return {?}
     */
    instantiatePlugin(id) {
        return (/** @type {?} */ (new StateHistoryPlugin(this.query, this.params, id)));
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/** @type {?} */
const dirtyCheckDefaultParams = {
    comparator: (head, current) => JSON.stringify(head) !== JSON.stringify(current)
};
/**
 * @param {?} nestedObj
 * @param {?} path
 * @return {?}
 */
function getNestedPath(nestedObj, path) {
    /** @type {?} */
    const pathAsArray = path.split('.');
    return pathAsArray.reduce((obj, key) => (obj && obj[key] !== 'undefined' ? obj[key] : undefined), nestedObj);
}
/**
 * @template Entity, StoreState
 */
class DirtyCheckPlugin extends AkitaPlugin {
    /**
     * @param {?} query
     * @param {?=} params
     * @param {?=} _entityId
     */
    constructor(query, params, _entityId) {
        super(query);
        this.query = query;
        this.params = params;
        this._entityId = _entityId;
        this.dirty = new BehaviorSubject(false);
        this.active = false;
        this._reset = new Subject();
        this.isDirty$ = this.dirty.asObservable().pipe(distinctUntilChanged());
        this.reset$ = this._reset.asObservable();
        this.params = Object.assign({}, dirtyCheckDefaultParams, params);
        if (this.params.watchProperty) {
            /** @type {?} */
            let watchProp = (/** @type {?} */ (coerceArray(this.params.watchProperty)));
            if (query instanceof QueryEntity && watchProp.includes('entities') && !watchProp.includes('ids')) {
                watchProp.push('ids');
            }
            this.params.watchProperty = watchProp;
        }
    }
    /**
     * @param {?=} params
     * @return {?}
     */
    reset(params = {}) {
        /** @type {?} */
        let currentValue = this.head;
        if (isFunction(params.updateFn)) {
            if (this.isEntityBased(this._entityId)) {
                currentValue = params.updateFn(this.head, ((/** @type {?} */ (this.getQuery()))).getEntity(this._entityId));
            }
            else {
                currentValue = params.updateFn(this.head, ((/** @type {?} */ (this.getQuery()))).getSnapshot());
            }
        }
        __globalState.setCustomAction({ type: `@DirtyCheck - Revert` });
        this.updateStore(currentValue, this._entityId);
        this._reset.next();
    }
    /**
     * @template THIS
     * @this {THIS}
     * @return {THIS}
     */
    setHead() {
        if (!(/** @type {?} */ (this)).active) {
            (/** @type {?} */ (this)).activate();
            (/** @type {?} */ (this)).active = true;
        }
        else {
            (/** @type {?} */ (this)).head = (/** @type {?} */ (this))._getHead();
        }
        (/** @type {?} */ (this)).updateDirtiness(false);
        return (/** @type {?} */ (this));
    }
    /**
     * @return {?}
     */
    isDirty() {
        return toBoolean(this.dirty.value);
    }
    /**
     * @return {?}
     */
    hasHead() {
        return toBoolean(this.getHead());
    }
    /**
     * @return {?}
     */
    destroy() {
        this.head = null;
        this.subscription && this.subscription.unsubscribe();
        this._reset && this._reset.complete();
    }
    /**
     * @param {?} path
     * @return {?}
     */
    isPathDirty(path) {
        /** @type {?} */
        const head = this.getHead();
        /** @type {?} */
        const current = ((/** @type {?} */ (this.getQuery()))).getSnapshot();
        /** @type {?} */
        const currentPathValue = getNestedPath(current, path);
        /** @type {?} */
        const headPathValue = getNestedPath(head, path);
        return this.params.comparator(currentPathValue, headPathValue);
    }
    /**
     * @return {?}
     */
    getHead() {
        return this.head;
    }
    /**
     * @return {?}
     */
    activate() {
        this.head = this._getHead();
        /**
         * if we are tracking specific properties select only the relevant ones
         * @type {?}
         */
        const source = this.params.watchProperty
            ? ((/** @type {?} */ (this.params.watchProperty))).map(prop => this.query.select(state => state[prop]).pipe(map(val => ({
                val,
                __akitaKey: prop
            }))))
            : [this.selectSource(this._entityId)];
        this.subscription = combineLatest(...source)
            .pipe(skip(1))
            .subscribe((currentState) => {
            if (isUndefined(this.head))
                return;
            /**
             * __akitaKey is used to determine if we are tracking a specific property or a store change
             * @type {?}
             */
            const isChange = currentState.some(state => {
                /** @type {?} */
                const head = state.__akitaKey ? this.head[(/** @type {?} */ (state.__akitaKey))] : this.head;
                /** @type {?} */
                const compareTo = state.__akitaKey ? state.val : state;
                return this.params.comparator(head, compareTo);
            });
            this.updateDirtiness(isChange);
        });
    }
    /**
     * @param {?} isDirty
     * @return {?}
     */
    updateDirtiness(isDirty) {
        this.dirty.next(isDirty);
    }
    /**
     * @return {?}
     */
    _getHead() {
        /** @type {?} */
        let head = this.getSource(this._entityId);
        if (this.params.watchProperty) {
            head = this.getWatchedValues((/** @type {?} */ (head)));
        }
        return head;
    }
    /**
     * @param {?} source
     * @return {?}
     */
    getWatchedValues(source) {
        return ((/** @type {?} */ (this.params.watchProperty))).reduce((watched, prop) => {
            watched[prop] = source[prop];
            return watched;
        }, (/** @type {?} */ ({})));
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * @template E, P
 */
class EntityDirtyCheckPlugin extends EntityCollectionPlugin {
    /**
     * @param {?} query
     * @param {?=} params
     */
    constructor(query, params = {}) {
        super(query, params.entityIds);
        this.query = query;
        this.params = params;
        /**
         * @deprecated Use someDirty$ instead
         */
        this.isSomeDirty$ = this.query.select(state => state.entities).pipe(map((entities) => this.checkSomeDirty(entities)));
        this.someDirty$ = this.isSomeDirty$;
        this.someDirty = this.isSomeDirty;
        this.params = Object.assign({}, dirtyCheckDefaultParams, params);
        this.activate();
        this.selectIds()
            .pipe(skip(1))
            .subscribe(ids => {
            this.rebase(ids, { afterAdd: plugin => plugin.setHead() });
        });
    }
    /**
     * @template THIS
     * @this {THIS}
     * @param {?=} ids
     * @return {THIS}
     */
    setHead(ids) {
        (/** @type {?} */ (this)).forEachId(ids, e => e.setHead());
        return (/** @type {?} */ (this));
    }
    /**
     * @param {?} id
     * @return {?}
     */
    hasHead(id) {
        if (this.entities.has(id)) {
            /** @type {?} */
            const entity = this.getEntity(id);
            return entity.hasHead();
        }
        return false;
    }
    /**
     * @param {?=} ids
     * @param {?=} params
     * @return {?}
     */
    reset(ids, params = {}) {
        this.forEachId(ids, e => e.reset(params));
    }
    /**
     * @param {?} id
     * @param {?=} asObservable
     * @return {?}
     */
    isDirty(id, asObservable = true) {
        if (this.entities.has(id)) {
            /** @type {?} */
            const entity = this.getEntity(id);
            return asObservable ? entity.isDirty$ : entity.isDirty();
        }
        return false;
    }
    /**
     * @deprecated Use someDirty() instead
     * @return {?}
     */
    isSomeDirty() {
        /** @type {?} */
        const entities = this.query.getAll({ asObject: true });
        return this.checkSomeDirty(entities);
    }
    /**
     * @param {?} id
     * @param {?} path
     * @return {?}
     */
    isPathDirty(id, path) {
        if (this.entities.has(id)) {
            /** @type {?} */
            const head = ((/** @type {?} */ (this.getEntity(id)))).getHead();
            /** @type {?} */
            const current = this.query.getEntity(id);
            /** @type {?} */
            const currentPathValue = getNestedPath(current, path);
            /** @type {?} */
            const headPathValue = getNestedPath(head, path);
            return this.params.comparator(currentPathValue, headPathValue);
        }
        return null;
    }
    /**
     * @param {?=} ids
     * @return {?}
     */
    destroy(ids) {
        this.forEachId(ids, e => e.destroy());
    }
    /**
     * @param {?} id
     * @return {?}
     */
    instantiatePlugin(id) {
        return (/** @type {?} */ (new DirtyCheckPlugin(this.query, this.params, id)));
    }
    /**
     * @param {?} entities
     * @return {?}
     */
    checkSomeDirty(entities) {
        /** @type {?} */
        const entitiesIds = this.resolvedIds();
        for (const id of entitiesIds) {
            /** @type {?} */
            const dirty = this.params.comparator(((/** @type {?} */ (this.getEntity(id)))).getHead(), entities[id]);
            if (dirty) {
                return true;
            }
        }
        return false;
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
/**
 * \@example
 *
 * this.peopleStore.update(id, person => ({
 *   guests: increment(person.guests)
 * }));
 * @param {?} value
 * @param {?=} params
 * @return {?}
 */
function increment(value, params = { maxValue: undefined }) {
    if (isNumber(value) === false)
        return;
    if (params.maxValue && value === params.maxValue)
        return value;
    return value + 1;
}
/**
 * \@example
 *
 * this.peopleStore.update(id, person => ({
 *   guests: decrement(person.guests)
 * }));
 * @param {?} value
 * @param {?=} params
 * @return {?}
 */
function decrement(value, params = { allowNegative: false }) {
    if (isNumber(value) === false)
        return;
    if (params.allowNegative === false && value === 0) {
        return value;
    }
    return value - 1;
}
/**
 * Generate random guid
 * @return {?}
 */
function guid() {
    return 'xxxxxx4xyx'.replace(/[xy]/g, c => {
        /** @type {?} */
        const r = (Math.random() * 16) | 0;
        /** @type {?} */
        const v = c == 'x' ? r : (r & 0x3) | 0x8;
        return v.toString(16);
    });
}
/**
 *
 * @param {?=} options
 * @return {?}
 */
function resetStores(options) {
    /** @type {?} */
    const defaults = {
        exclude: []
    };
    options = Object.assign({}, defaults, options);
    /** @type {?} */
    const stores = Object.keys(__stores__);
    applyTransaction(() => {
        for (const store of stores) {
            /** @type {?} */
            const s = __stores__[store];
            if (!options.exclude) {
                s.reset();
            }
            else {
                if (options.exclude.indexOf(s.storeName) === -1) {
                    s.reset();
                }
            }
        }
    });
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */

export { __globalState, EntityStore, getInitialEntitiesState, getInitialActiveState, QueryEntity, Query, enableAkitaProdMode, isDev, __stores__, rootDispatcher, Store, applyTransaction, transaction, push, remove, pop, unshift, sort, reverse, swap, update, splice, toggle, filterNil, coerceArray, isObject, isPlainObject, isFunction, toBoolean, isUndefined, isNil, entityExists, noop, isObservable, isString, isNumber, isDefined, resetActive, isActiveState, setValue, getValue, applyAction, action, mapInWorker, memoizeOne, SnapshotManager, snapshotManager, StoreConfig, configKey, QueryConfig, queryConfigKey, akitaConfig, getAkitaConfig, compareValues, Order, AkitaPlugin, PaginatorPlugin, Paginator, PersistNgFormPlugin, persistState, akitaDevtools, EntityCollectionPlugin, StateHistoryPlugin, EntityStateHistoryPlugin, getNestedPath, dirtyCheckDefaultParams, DirtyCheckPlugin, EntityDirtyCheckPlugin, increment, decrement, guid, resetStores, AkitaGlobals as a };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0b3JhbWEtYWtpdGEuanMubWFwIiwic291cmNlcyI6WyJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvaW50ZXJuYWwvdXRpbHMudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvaW50ZXJuYWwvZXJyb3IudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvaW50ZXJuYWwvY3J1ZC50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9pbnRlcm5hbC9nbG9iYWwtc3RhdGUudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvaW50ZXJuYWwvdHJhbnNhY3Rpb24uaW50ZXJuYWwudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvaW50ZXJuYWwvZGVlcC1mcmVlemUudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvYXBpL3N0b3JlLWNvbmZpZy50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvY29uZmlnLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2FwaS9zdG9yZS50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvZW50aXR5LXN0b3JlLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2ludGVybmFsL3NvcnQudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvYXBpL21lbW9pemUudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvYXBpL3F1ZXJ5LWNvbmZpZy50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvcXVlcnkudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvYXBpL3F1ZXJ5LWVudGl0eS50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvdHJhbnNhY3Rpb24udHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvYXBpL2FycmF5cy50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvb3BlcmF0b3JzLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2ludGVybmFsL2FjdGlvbi50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvd29ya2VyLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2FwaS9zbmFwc2hvdC1tYW5hZ2VyLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL3BsdWdpbnMvcGx1Z2luLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL3BsdWdpbnMvcGFnaW5hdG9yL3BhZ2luYXRvci1wbHVnaW4udHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvcGx1Z2lucy9wZXJzaXN0LWZvcm0vcGVyc2lzdC1uZy1mb3JtLXBsdWdpbi50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9lbmhhbmNlcnMvcGVyc2lzdC1zdGF0ZS50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9lbmhhbmNlcnMvZGV2dG9vbHMudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvcGx1Z2lucy9lbnRpdHktY29sbGVjdGlvbi1wbHVnaW4udHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvcGx1Z2lucy9zdGF0ZS1oaXN0b3J5L3N0YXRlLWhpc3RvcnktcGx1Z2luLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL3BsdWdpbnMvc3RhdGUtaGlzdG9yeS9lbnRpdHktc3RhdGUtaGlzdG9yeS1wbHVnaW4udHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvcGx1Z2lucy9kaXJ0eS1jaGVjay9kaXJ0eS1jaGVjay1wbHVnaW4udHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvcGx1Z2lucy9kaXJ0eS1jaGVjay9lbnRpdHktZGlydHktY2hlY2stcGx1Z2luLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2FwaS9zdG9yZS11dGlscy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBBY3RpdmVTdGF0ZSwgRW50aXR5U3RhdGUsIEhhc2hNYXAsIElEIH0gZnJvbSAnLi4vYXBpL3R5cGVzJztcblxuLyoqIFdyYXBzIHRoZSBwcm92aWRlZCB2YWx1ZSBpbiBhbiBhcnJheSwgdW5sZXNzIHRoZSBwcm92aWRlZCBfdmFsdWUgaXMgYW4gYXJyYXkuICovXG5leHBvcnQgZnVuY3Rpb24gY29lcmNlQXJyYXk8VD4odmFsdWU6IFQgfCBUW10pOiBUW10ge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFt2YWx1ZV07XG59XG5cbi8qKiBDaGVjayBpZiBhIHZhbHVlIGlzIGFuIG9iamVjdCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlOiBhbnkpIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT09ICdbb2JqZWN0IE9iamVjdF0nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh2YWx1ZSkge1xuICByZXR1cm4gdG9Cb29sZWFuKHZhbHVlKSAmJiB2YWx1ZS5jb25zdHJ1Y3Rvci5uYW1lID09PSAnT2JqZWN0Jztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpOiB2YWx1ZSBpcyBGdW5jdGlvbiB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbic7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b0Jvb2xlYW4odmFsdWU6IGFueSk6IGJvb2xlYW4ge1xuICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiBgJHt2YWx1ZX1gICE9PSAnZmFsc2UnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc05pbCh2KSB7XG4gIHJldHVybiB2ID09PSBudWxsIHx8IHYgPT09IHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBlbnRpdHkgZXhpc3RzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbnRpdHlFeGlzdHM8RT4oaWQ6IElELCBlbnRpdGllczogSGFzaE1hcDxFPikge1xuICByZXR1cm4gZW50aXRpZXMuaGFzT3duUHJvcGVydHkoaWQpO1xufVxuXG4vKipcbiAqIE9ic2VydmFibGUgdGhhdCBlbWl0cyBlbXB0eSB2YWx1ZSBhbmQgY29tcGxldGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vb3A8VD4oKTogT2JzZXJ2YWJsZTxUPiB7XG4gIHJldHVybiBuZXcgT2JzZXJ2YWJsZShvYnNlcnZlciA9PiB7XG4gICAgb2JzZXJ2ZXIubmV4dCgpO1xuICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNPYnNlcnZhYmxlKHZhbHVlKSB7XG4gIHJldHVybiB0b0Jvb2xlYW4odmFsdWUpICYmIGlzRnVuY3Rpb24odmFsdWUuc3Vic2NyaWJlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3RyaW5nKHZhbDogc3RyaW5nIHwgYW55KTogdmFsIGlzIHN0cmluZyB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNEZWZpbmVkKHZhbCkge1xuICByZXR1cm4gdmFsICE9PSBudWxsICYmIHR5cGVvZiB2YWwgIT09ICd1bmRlZmluZWQnO1xufVxuXG4vKipcbiAqIENoZWNrIGlmIHRoZSBhY3RpdmUgZW50aXR5IGV4aXN0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldEFjdGl2ZTxFPihzdGF0ZTogRW50aXR5U3RhdGU8RT4pIHtcbiAgcmV0dXJuIGlzQWN0aXZlU3RhdGUoc3RhdGUpICYmIGVudGl0eUV4aXN0cygoc3RhdGUgYXMgQWN0aXZlU3RhdGUpLmFjdGl2ZSwgc3RhdGUuZW50aXRpZXMpID09PSBmYWxzZTtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiB0aGUgc3RvcmUgc3VwcG9ydHMgYWN0aXZlIGVudGl0eVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNBY3RpdmVTdGF0ZTxFPihzdGF0ZTogRW50aXR5U3RhdGU8RT4pIHtcbiAgcmV0dXJuIChzdGF0ZSBhcyBBY3RpdmVTdGF0ZSkuaGFzT3duUHJvcGVydHkoJ2FjdGl2ZScpO1xufVxuXG4vKipcbiAqIHNldFZhbHVlKHN0YXRlLCAndG9kb3MudWknLCB7IGZpbHRlcjoge319KVxuICovXG5leHBvcnQgY29uc3Qgc2V0VmFsdWUgPSAob2JqOiBhbnksIHByb3A6IHN0cmluZywgdmFsOiBhbnkpID0+IHtcbiAgY29uc3Qgc3BsaXQgPSBwcm9wLnNwbGl0KCcuJyk7XG5cbiAgaWYgKHNwbGl0Lmxlbmd0aCA9PT0gMSkgcmV0dXJuIHZhbDtcblxuICBvYmogPSB7IC4uLm9iaiB9O1xuXG4gIGNvbnN0IGxhc3RJbmRleCA9IHNwbGl0Lmxlbmd0aCAtIDI7XG4gIGNvbnN0IHJlbW92ZVN0b3JlTmFtZSA9IHByb3Auc3BsaXQoJy4nKS5zbGljZSgxKTtcblxuICByZW1vdmVTdG9yZU5hbWUucmVkdWNlKChhY2MsIHBhcnQsIGluZGV4KSA9PiB7XG4gICAgaWYgKGluZGV4ID09PSBsYXN0SW5kZXgpIHtcbiAgICAgIGFjY1twYXJ0XSA9IHZhbDtcbiAgICB9IGVsc2Uge1xuICAgICAgYWNjW3BhcnRdID0geyAuLi5hY2NbcGFydF0gfTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWNjICYmIGFjY1twYXJ0XTtcbiAgfSwgb2JqKTtcblxuICByZXR1cm4gb2JqO1xufTtcblxuLyoqXG4gKiBnZXRWYWx1ZShzdGF0ZSwgJ3RvZG9zLnVpJylcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFZhbHVlID0gKG9iajogYW55LCBwcm9wOiBzdHJpbmcpID0+IHtcbiAgLyoqIHJldHVybiB0aGUgd2hvbGUgc3RhdGUgICovXG4gIGlmIChwcm9wLnNwbGl0KCcuJykubGVuZ3RoID09PSAxKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfVxuICBjb25zdCByZW1vdmVTdG9yZU5hbWUgPSBwcm9wXG4gICAgLnNwbGl0KCcuJylcbiAgICAuc2xpY2UoMSlcbiAgICAuam9pbignLicpO1xuICByZXR1cm4gcmVtb3ZlU3RvcmVOYW1lLnNwbGl0KCcuJykucmVkdWNlKChhY2M6IGFueSwgcGFydDogc3RyaW5nKSA9PiBhY2MgJiYgYWNjW3BhcnRdLCBvYmopO1xufTtcbiIsImltcG9ydCB7IGVudGl0eUV4aXN0cywgaXNPYmplY3QsIHRvQm9vbGVhbiB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgRW50aXR5U3RhdGUsIElEIH0gZnJvbSAnLi4vYXBpL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEFraXRhRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBa2l0YUltbXV0YWJpbGl0eUVycm9yIGV4dGVuZHMgQWtpdGFFcnJvciB7XG4gIGNvbnN0cnVjdG9yKHN0b3JlTmFtZSkge1xuICAgIHN1cGVyKGBUaGUgbmV3IHN0YXRlIHNob3VsZCBiZSBpbW11dGFibGUuIE1ha2Ugc3VyZSB0byByZXR1cm4gYSBuZXcgaW1tdXRhYmxlIHN0YXRlLiBcXG4gc3RvcmU6IFxcbiAke3N0b3JlTmFtZX1gKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQWtpdGFFbnRpdHlOb3RFeGlzdHNFcnJvciBleHRlbmRzIEFraXRhRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihpZCkge1xuICAgIHN1cGVyKGBFbnRpdHkgJHtpZH0gZG9lcyBub3QgZXhpc3RzYCk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFraXRhTm9BY3RpdmVFcnJvciBleHRlbmRzIEFraXRhRXJyb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihgQWN0aXZlIGlzIG51bGwvdW5kZWZpbmVkYCk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFraXRhSW52YWxpZEVudGl0eVN0YXRlIGV4dGVuZHMgQWtpdGFFcnJvciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKGBFbnRpdHkgc3RhdGUgaXMgaW52YWxpZGApO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBa2l0YVVwZGF0ZUlkS2V5RXJyb3IgZXh0ZW5kcyBBa2l0YUVycm9yIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoYFVwZGF0aW5nIGVudGl0eSBpZCBpcyBub3QgcGVybWl0dGVkIHdoZW4gdXBkYXRpbmcgbWFueSBlbnRpdGllc2ApO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRFbnRpdHlFeGlzdHMoaWQ6IElELCBlbnRpdGllcykge1xuICBpZiAoIWVudGl0eUV4aXN0cyhpZCwgZW50aXRpZXMpKSB7XG4gICAgdGhyb3cgbmV3IEFraXRhRW50aXR5Tm90RXhpc3RzRXJyb3IoaWQpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRBY3RpdmUoc3RvcmUpIHtcbiAgaWYgKCF0b0Jvb2xlYW4oc3RvcmUuYWN0aXZlKSkge1xuICAgIHRocm93IG5ldyBBa2l0YU5vQWN0aXZlRXJyb3IoKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RW50aXR5U3RhdGUoc3RhdGU6IEVudGl0eVN0YXRlPGFueT4pIHtcbiAgY29uc3QgYXNzZXJ0RW50aXRpZXMgPSBpc09iamVjdChzdGF0ZSk7XG5cbiAgaWYgKCFhc3NlcnRFbnRpdGllcykge1xuICAgIHRocm93IG5ldyBBa2l0YUludmFsaWRFbnRpdHlTdGF0ZSgpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnREZWNvcmF0b3IobmFtZTogc3RyaW5nLCBjbGFzc05hbWU6IHN0cmluZykge1xuICBpZiAoIW5hbWUpIHtcbiAgICBjb25zb2xlLmVycm9yKGBAU3RvcmVDb25maWcoeyBuYW1lIH0pIGlzIG1pc3NpbmcgaW4gJHtjbGFzc05hbWV9YCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IEVudGl0aWVzLCBFbnRpdHlTdGF0ZSwgSGFzaE1hcCwgSUQsIE5ld2FibGUsIEFkZE9wdGlvbnMgfSBmcm9tICcuLi9hcGkvdHlwZXMnO1xuaW1wb3J0IHsgQWtpdGFVcGRhdGVJZEtleUVycm9yLCBhc3NlcnRFbnRpdHlFeGlzdHMsIGFzc2VydEVudGl0eVN0YXRlIH0gZnJvbSAnLi9lcnJvcic7XG5pbXBvcnQgeyBlbnRpdHlFeGlzdHMsIGlzRnVuY3Rpb24sIGlzUGxhaW5PYmplY3QsIHJlc2V0QWN0aXZlIH0gZnJvbSAnLi91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBDUlVEIHtcbiAgX3NldDxTLCBFPihzdGF0ZTogUywgZW50aXRpZXM6IEVbXSB8IEhhc2hNYXA8RT4gfCBFbnRpdGllczxFPiwgZW50aXR5Q2xhc3M6IE5ld2FibGU8RT4gfCB1bmRlZmluZWQsIGlkS2V5KTogUyB7XG4gICAgbGV0IGlkcywgbm9ybWFsaXplZDtcblxuICAgIGlmICgoZW50aXRpZXMgYXMgRW50aXRpZXM8RT4pLmlkcyAmJiAoZW50aXRpZXMgYXMgRW50aXRpZXM8RT4pLmVudGl0aWVzKSB7XG4gICAgICBpZHMgPSAoZW50aXRpZXMgYXMgRW50aXRpZXM8RT4pLmlkcztcbiAgICAgIG5vcm1hbGl6ZWQgPSAoZW50aXRpZXMgYXMgRW50aXRpZXM8RT4pLmVudGl0aWVzO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBpc0FycmF5ID0gQXJyYXkuaXNBcnJheShlbnRpdGllcyk7XG4gICAgICBub3JtYWxpemVkID0gZW50aXRpZXM7XG5cbiAgICAgIGlmIChpc0FycmF5KSB7XG4gICAgICAgIG5vcm1hbGl6ZWQgPSB0aGlzLmtleUJ5KGVudGl0aWVzIGFzIEVbXSwgZW50aXR5Q2xhc3MsIGlkS2V5KSBhcyBFW107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhc3NlcnRFbnRpdHlTdGF0ZShlbnRpdGllcyk7XG4gICAgICB9XG5cbiAgICAgIGlkcyA9IGlzQXJyYXkgPyAoZW50aXRpZXMgYXMgRVtdKS5tYXAoZW50aXR5ID0+IGVudGl0eVtpZEtleV0pIDogT2JqZWN0LmtleXMobm9ybWFsaXplZCBhcyBIYXNoTWFwPEU+KS5tYXAoaWQgPT4gZW50aXRpZXNbaWRdW2lkS2V5XSk7XG4gICAgfVxuXG4gICAgY29uc3QgbmV3U3RhdGUgPSB7XG4gICAgICAuLi4oc3RhdGUgYXMgYW55KSxcbiAgICAgIGVudGl0aWVzOiBub3JtYWxpemVkLFxuICAgICAgaWRzLFxuICAgICAgbG9hZGluZzogZmFsc2VcbiAgICB9O1xuXG4gICAgaWYgKHJlc2V0QWN0aXZlKG5ld1N0YXRlKSkge1xuICAgICAgbmV3U3RhdGUuYWN0aXZlID0gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3U3RhdGU7XG4gIH1cblxuICBfcmVwbGFjZUVudGl0eTxUIGV4dGVuZHMgRW50aXR5U3RhdGU+KHN0YXRlOiBULCBpZDogSUQsIGVudGl0eSk6IFQge1xuICAgIHJldHVybiB7XG4gICAgICAuLi4oc3RhdGUgYXMgYW55KSxcbiAgICAgIGVudGl0aWVzOiB7XG4gICAgICAgIC4uLnN0YXRlLmVudGl0aWVzLFxuICAgICAgICBbaWRdOiBlbnRpdHlcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgX2FkZDxTIGV4dGVuZHMgRW50aXR5U3RhdGUsIEU+KHN0YXRlOiBTLCBlbnRpdGllczogRVtdLCBpZEtleSwgb3B0aW9uczogQWRkT3B0aW9ucyA9IHt9KTogUyB7XG4gICAgbGV0IGFkZGVkRW50aXRpZXMgPSB7fTtcbiAgICBsZXQgYWRkZWRJZHMgPSBbXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZW50aXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGVudGl0eSA9IGVudGl0aWVzW2ldO1xuICAgICAgY29uc3QgZW50aXR5SWQgPSBlbnRpdHlbaWRLZXldO1xuXG4gICAgICBpZiAoIWVudGl0eUV4aXN0cyhlbnRpdHlJZCwgc3RhdGUuZW50aXRpZXMpKSB7XG4gICAgICAgIGFkZGVkRW50aXRpZXNbZW50aXR5SWRdID0gZW50aXR5O1xuICAgICAgICBpZiAob3B0aW9ucy5wcmVwZW5kKSBhZGRlZElkcy51bnNoaWZ0KGVudGl0eUlkKTtcbiAgICAgICAgZWxzZSBhZGRlZElkcy5wdXNoKGVudGl0eUlkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4uKHN0YXRlIGFzIGFueSksXG4gICAgICBlbnRpdGllczoge1xuICAgICAgICAuLi5zdGF0ZS5lbnRpdGllcyxcbiAgICAgICAgLi4uYWRkZWRFbnRpdGllc1xuICAgICAgfSxcbiAgICAgIGlkczogb3B0aW9ucy5wcmVwZW5kID8gWy4uLmFkZGVkSWRzLCAuLi5zdGF0ZS5pZHNdIDogWy4uLnN0YXRlLmlkcywgLi4uYWRkZWRJZHNdXG4gICAgfTtcbiAgfVxuXG4gIF91cGRhdGU8VCBleHRlbmRzIEVudGl0eVN0YXRlPihzdGF0ZTogVCwgaWRzOiBJRFtdLCBuZXdTdGF0ZU9yRm46IG9iamVjdCB8ICgoZTogUmVhZG9ubHk8YW55PikgPT4gb2JqZWN0KSwgaWRLZXk6IHN0cmluZyk6IFQge1xuICAgIGNvbnN0IHVwZGF0ZWRFbnRpdGllcyA9IHt9O1xuXG4gICAgbGV0IGlzVXBkYXRpbmdJZEtleSA9IGZhbHNlO1xuICAgIGxldCBpZFRvVXBkYXRlOiBJRDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBpZCA9IGlkc1tpXTtcbiAgICAgIGlkVG9VcGRhdGUgPSBpZDtcbiAgICAgIGFzc2VydEVudGl0eUV4aXN0cyhpZCwgc3RhdGUuZW50aXRpZXMpO1xuXG4gICAgICBjb25zdCBvbGRFbnRpdHkgPSBzdGF0ZS5lbnRpdGllc1tpZF07XG4gICAgICBjb25zdCBuZXdTdGF0ZSA9IGlzRnVuY3Rpb24obmV3U3RhdGVPckZuKSA/IG5ld1N0YXRlT3JGbihvbGRFbnRpdHkpIDogbmV3U3RhdGVPckZuO1xuXG4gICAgICBpZiAobmV3U3RhdGUuaGFzT3duUHJvcGVydHkoaWRLZXkpICYmIG5ld1N0YXRlW2lkS2V5XSAhPT0gb2xkRW50aXR5W2lkS2V5XSkge1xuICAgICAgICBpZiAoaWRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQWtpdGFVcGRhdGVJZEtleUVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgaXNVcGRhdGluZ0lkS2V5ID0gdHJ1ZTtcbiAgICAgICAgaWRUb1VwZGF0ZSA9IG5ld1N0YXRlW2lkS2V5XTtcbiAgICAgIH1cblxuICAgICAgbGV0IG5ld0VudGl0eTtcblxuICAgICAgY29uc3QgbWVyZ2VkID0ge1xuICAgICAgICAuLi5vbGRFbnRpdHksXG4gICAgICAgIC4uLm5ld1N0YXRlXG4gICAgICB9O1xuXG4gICAgICBpZiAoaXNQbGFpbk9iamVjdChvbGRFbnRpdHkpKSB7XG4gICAgICAgIG5ld0VudGl0eSA9IG1lcmdlZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbiBjYXNlIHRoYXQgbmV3IHN0YXRlIGlzIGNsYXNzIG9mIGl0J3Mgb3duLCB0aGVyZSdzXG4gICAgICAgICAqIGEgcG9zc2liaWxpdHkgdGhhdCBpdCB3aWxsIGJlIGRpZmZlcmVudCB0aGFuIHRoZSBvbGRcbiAgICAgICAgICogY2xhc3MuXG4gICAgICAgICAqIEZvciBleGFtcGxlLCBPbGQgc3RhdGUgaXMgYW4gaW5zdGFuY2Ugb2YgYW5pbWFsIGNsYXNzXG4gICAgICAgICAqIGFuZCBuZXcgc3RhdGUgaXMgaW5zdGFuY2Ugb2YgcGVyc29uIGNsYXNzLlxuICAgICAgICAgKiBUbyBhdm9pZCBydW4gb3ZlciBuZXcgcGVyc29uIGNsYXNzIHdpdGggdGhlIG9sZCBhbmltYWxcbiAgICAgICAgICogY2xhc3Mgd2UgY2hlY2sgaWYgdGhlIG5ldyBzdGF0ZSBpcyBhIGNsYXNzIG9mIGl0J3Mgb3duLlxuICAgICAgICAgKiBJZiBzbywgdXNlIGl0LiBPdGhlcndpc2UsIHVzZSB0aGUgb2xkIHN0YXRlIGNsYXNzXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoaXNQbGFpbk9iamVjdChuZXdTdGF0ZSkpIHtcbiAgICAgICAgICBuZXdFbnRpdHkgPSBuZXcgb2xkRW50aXR5LmNvbnN0cnVjdG9yKG1lcmdlZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3RW50aXR5ID0gbmV3IChuZXdTdGF0ZSBhcyBhbnkpLmNvbnN0cnVjdG9yKG1lcmdlZCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdXBkYXRlZEVudGl0aWVzW2lkVG9VcGRhdGVdID0gbmV3RW50aXR5O1xuICAgIH1cblxuICAgIGxldCB1cGRhdGVkSWRzID0gc3RhdGUuaWRzO1xuICAgIGxldCBzdGF0ZUVudGl0aWVzID0gc3RhdGUuZW50aXRpZXM7XG4gICAgaWYgKGlzVXBkYXRpbmdJZEtleSkge1xuICAgICAgY29uc3QgW2lkXSA9IGlkcztcbiAgICAgIGNvbnN0IHsgW2lkXTogZGVsZXRlZEVudGl0eSwgLi4ucmVzdCB9ID0gc3RhdGUuZW50aXRpZXM7XG4gICAgICBzdGF0ZUVudGl0aWVzID0gcmVzdDtcbiAgICAgIHVwZGF0ZWRJZHMgPSBzdGF0ZS5pZHMubWFwKGN1cnJlbnQgPT4gKGN1cnJlbnQgPT09IGlkID8gaWRUb1VwZGF0ZSA6IGN1cnJlbnQpKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4uKHN0YXRlIGFzIGFueSksXG4gICAgICBlbnRpdGllczoge1xuICAgICAgICAuLi5zdGF0ZUVudGl0aWVzLFxuICAgICAgICAuLi51cGRhdGVkRW50aXRpZXNcbiAgICAgIH0sXG4gICAgICBpZHM6IHVwZGF0ZWRJZHNcbiAgICB9O1xuICB9XG5cbiAgX3JlbW92ZTxUIGV4dGVuZHMgRW50aXR5U3RhdGU+KHN0YXRlOiBULCBpZHM6IElEW10gfCBudWxsKTogVCB7XG4gICAgaWYgKCFpZHMpIHJldHVybiB0aGlzLl9yZW1vdmVBbGwoc3RhdGUpO1xuXG4gICAgY29uc3QgcmVtb3ZlZCA9IGlkcy5yZWR1Y2UoKGFjYywgaWQpID0+IHtcbiAgICAgIGNvbnN0IHsgW2lkXTogZW50aXR5LCAuLi5yZXN0IH0gPSBhY2M7XG4gICAgICByZXR1cm4gcmVzdDtcbiAgICB9LCBzdGF0ZS5lbnRpdGllcyk7XG4gICAgY29uc3QgbmV3U3RhdGUgPSB7XG4gICAgICAuLi4oc3RhdGUgYXMgYW55KSxcbiAgICAgIGVudGl0aWVzOiByZW1vdmVkLFxuICAgICAgaWRzOiBzdGF0ZS5pZHMuZmlsdGVyKGN1cnJlbnQgPT4gaWRzLmluZGV4T2YoY3VycmVudCkgPT09IC0xKVxuICAgIH07XG5cbiAgICBpZiAocmVzZXRBY3RpdmUobmV3U3RhdGUpKSB7XG4gICAgICBuZXdTdGF0ZS5hY3RpdmUgPSBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBuZXdTdGF0ZTtcbiAgfVxuXG4gIHByaXZhdGUgX3JlbW92ZUFsbDxUIGV4dGVuZHMgRW50aXR5U3RhdGU+KHN0YXRlOiBUKTogVCB7XG4gICAgY29uc3QgbmV3U3RhdGUgPSB7XG4gICAgICAuLi4oc3RhdGUgYXMgYW55KSxcbiAgICAgIGVudGl0aWVzOiB7fSxcbiAgICAgIGlkczogW10sXG4gICAgICBhY3RpdmU6IG51bGxcbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ld1N0YXRlO1xuICB9XG5cbiAgcHJpdmF0ZSBrZXlCeShlbnRpdGllczogYW55W10sIGVudGl0eUNsYXNzPzogTmV3YWJsZTxhbnk+LCBpZCA9ICdpZCcpIHtcbiAgICBjb25zdCBhY2MgPSB7fTtcblxuICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBlbnRpdGllcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgY29uc3QgZW50aXR5ID0gZW50aXRpZXNbaV07XG4gICAgICBhY2NbZW50aXR5W2lkXV0gPSBlbnRpdHlDbGFzcyA/IG5ldyBlbnRpdHlDbGFzcyhlbnRpdHkpIDogZW50aXR5O1xuICAgIH1cblxuICAgIHJldHVybiBhY2M7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IF9jcnVkID0gbmV3IENSVUQoKTtcbiIsImltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcblxuZXhwb3J0IHR5cGUgQWN0aW9uID0ge1xuICB0eXBlOiBzdHJpbmc7XG4gIGVudGl0eUlkPzogYW55W10gfCBhbnk7XG4gIHBheWxvYWQ/OiBhbnk7XG59O1xuXG5leHBvcnQgY2xhc3MgQWtpdGFHbG9iYWxzIHtcbiAgcHJpdmF0ZSBjdXN0b21BY3Rpb247XG4gIGN1cnJlbnRBY3Rpb246IEFjdGlvbjtcbiAgc2tpcEFjdGlvbiA9IGZhbHNlO1xuICBza2lwVHJhbnNhY3Rpb25Nc2cgPSBmYWxzZTtcbiAgY3VycmVudFQgPSBbXTtcbiAgYWN0aXZlVHJhbnNhY3Rpb25zID0gMDtcbiAgYmF0Y2hUcmFuc2FjdGlvbjogU3ViamVjdDxib29sZWFuPjtcblxuICBzZXRBY3Rpb24oX2FjdGlvbjogQWN0aW9uKSB7XG4gICAgaWYgKHRoaXMuY3VzdG9tQWN0aW9uKSB7XG4gICAgICB0aGlzLmN1cnJlbnRBY3Rpb24gPSB0aGlzLmN1c3RvbUFjdGlvbjtcbiAgICAgIHRoaXMuY3VzdG9tQWN0aW9uID0gbnVsbDtcbiAgICAgIHRoaXMuc2tpcFRyYW5zYWN0aW9uTXNnID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0aGlzLmFjdGl2ZVRyYW5zYWN0aW9ucyA9PT0gMCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRBY3Rpb24gPSBfYWN0aW9uO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmFjdGl2ZVRyYW5zYWN0aW9ucyA+IDApIHtcbiAgICAgIHRoaXMuY3VycmVudFQucHVzaChfYWN0aW9uKTtcbiAgICB9XG4gIH1cblxuICBzZXRDdXN0b21BY3Rpb24oYWN0aW9uOiBBY3Rpb24sIHNraXBUcmFuc2FjdGlvbk1zZyA9IGZhbHNlKSB7XG4gICAgdGhpcy5jdXJyZW50QWN0aW9uID0gdGhpcy5jdXN0b21BY3Rpb24gPSBhY3Rpb247XG4gICAgdGhpcy5za2lwVHJhbnNhY3Rpb25Nc2cgPSBza2lwVHJhbnNhY3Rpb25Nc2c7XG4gIH1cblxuICBzZXRTa2lwQWN0aW9uKHNraXAgPSB0cnVlKSB7XG4gICAgdGhpcy5za2lwQWN0aW9uID0gc2tpcDtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgX19nbG9iYWxTdGF0ZSA9IG5ldyBBa2l0YUdsb2JhbHMoKTtcbiIsImltcG9ydCB7IF9fZ2xvYmFsU3RhdGUgfSBmcm9tICcuL2dsb2JhbC1zdGF0ZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0LCBvZiB9IGZyb20gJ3J4anMnO1xuXG4vKipcbiAqIFN0YXJ0IGEgbmV3IHRyYW5zYWN0aW9uIGJhdGNoXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdGFydEJhdGNoKCkge1xuICBpZiAoIWlzVHJhbnNhY3Rpb25JblByb2Nlc3MoKSkge1xuICAgIF9fZ2xvYmFsU3RhdGUuYmF0Y2hUcmFuc2FjdGlvbiA9IG5ldyBTdWJqZWN0KCk7XG4gIH1cbiAgX19nbG9iYWxTdGF0ZS5hY3RpdmVUcmFuc2FjdGlvbnMrKztcbn1cblxuLyoqXG4gKiBFbmQgdGhlIHRyYW5zYWN0aW9uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbmRCYXRjaCgpIHtcbiAgaWYgKC0tX19nbG9iYWxTdGF0ZS5hY3RpdmVUcmFuc2FjdGlvbnMgPT09IDApIHtcbiAgICBfX2dsb2JhbFN0YXRlLmJhdGNoVHJhbnNhY3Rpb24ubmV4dCh0cnVlKTtcbiAgICBfX2dsb2JhbFN0YXRlLmJhdGNoVHJhbnNhY3Rpb24uY29tcGxldGUoKTtcbiAgfVxufVxuXG4vKipcbiAqIFdoZXRoZXIgd2UncmUgaW5zaWRlIGJhdGNoXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1RyYW5zYWN0aW9uSW5Qcm9jZXNzKCkge1xuICByZXR1cm4gX19nbG9iYWxTdGF0ZS5hY3RpdmVUcmFuc2FjdGlvbnMgPiAwO1xufVxuXG4vKipcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbW1pdCgpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIF9fZ2xvYmFsU3RhdGUuYmF0Y2hUcmFuc2FjdGlvbiA/IF9fZ2xvYmFsU3RhdGUuYmF0Y2hUcmFuc2FjdGlvbi5hc09ic2VydmFibGUoKSA6IG9mKHRydWUpO1xufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIGRlZXBGcmVlemUobykge1xuICBPYmplY3QuZnJlZXplKG8pO1xuXG4gIHZhciBvSXNGdW5jdGlvbiA9IHR5cGVvZiBvID09PSAnZnVuY3Rpb24nO1xuICB2YXIgaGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbiAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMobykuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgaWYgKFxuICAgICAgaGFzT3duUHJvcC5jYWxsKG8sIHByb3ApICYmXG4gICAgICAob0lzRnVuY3Rpb24gPyBwcm9wICE9PSAnY2FsbGVyJyAmJiBwcm9wICE9PSAnY2FsbGVlJyAmJiBwcm9wICE9PSAnYXJndW1lbnRzJyA6IHRydWUpICYmXG4gICAgICBvW3Byb3BdICE9PSBudWxsICYmXG4gICAgICAodHlwZW9mIG9bcHJvcF0gPT09ICdvYmplY3QnIHx8IHR5cGVvZiBvW3Byb3BdID09PSAnZnVuY3Rpb24nKSAmJlxuICAgICAgIU9iamVjdC5pc0Zyb3plbihvW3Byb3BdKVxuICAgICkge1xuICAgICAgZGVlcEZyZWV6ZShvW3Byb3BdKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBvO1xufVxuIiwiZXhwb3J0IHR5cGUgU3RvcmVDb25maWdPcHRpb25zID0ge1xuICBuYW1lOiBzdHJpbmc7XG4gIHJlc2V0dGFibGU/OiBib29sZWFuO1xuICBpZEtleT86IHN0cmluZztcbn07XG5cbmV4cG9ydCBjb25zdCBjb25maWdLZXkgPSAnYWtpdGFDb25maWcnO1xuXG5leHBvcnQgZnVuY3Rpb24gU3RvcmVDb25maWcobWV0YWRhdGE6IFN0b3JlQ29uZmlnT3B0aW9ucykge1xuICByZXR1cm4gZnVuY3Rpb24oY29uc3RydWN0b3I6IEZ1bmN0aW9uKSB7XG4gICAgY29uc3RydWN0b3JbY29uZmlnS2V5XSA9IHsgaWRLZXk6ICdpZCcgfTtcblxuICAgIGZvciAobGV0IGkgPSAwLCBrZXlzID0gT2JqZWN0LmtleXMobWV0YWRhdGEpOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qga2V5ID0ga2V5c1tpXTtcbiAgICAgIC8qIG5hbWUgaXMgcHJlc2VydmVkIHJlYWQgb25seSBrZXkgKi9cbiAgICAgIGlmIChrZXkgPT09ICduYW1lJykge1xuICAgICAgICBjb25zdHJ1Y3Rvcltjb25maWdLZXldWydzdG9yZU5hbWUnXSA9IG1ldGFkYXRhW2tleV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdHJ1Y3Rvcltjb25maWdLZXldW2tleV0gPSBtZXRhZGF0YVtrZXldO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbiIsImV4cG9ydCBpbnRlcmZhY2UgQWtpdGFDb25maWcge1xuICAvKipcbiAgICogV2hldGhlciB0byBhbGxvd2VkIHRoZSByZXNldCgpIHN0b3JlcyBmdW5jdGlvbmFsaXR5XG4gICAqL1xuICByZXNldHRhYmxlPzogYm9vbGVhbjtcbn1cblxubGV0IENPTkZJRzogQWtpdGFDb25maWcgPSB7XG4gIHJlc2V0dGFibGU6IGZhbHNlXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gYWtpdGFDb25maWcoY29uZmlnOiBBa2l0YUNvbmZpZykge1xuICBDT05GSUcgPSB7IC4uLkNPTkZJRywgLi4uY29uZmlnIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBa2l0YUNvbmZpZygpIHtcbiAgcmV0dXJuIENPTkZJRztcbn1cbiIsImltcG9ydCB7IEhhc2hNYXAsIElEIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUsIFJlcGxheVN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGRpc3RpbmN0VW50aWxDaGFuZ2VkLCBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBBa2l0YUVycm9yLCBBa2l0YUltbXV0YWJpbGl0eUVycm9yLCBhc3NlcnREZWNvcmF0b3IgfSBmcm9tICcuLi9pbnRlcm5hbC9lcnJvcic7XG5pbXBvcnQgeyBjb21taXQsIGlzVHJhbnNhY3Rpb25JblByb2Nlc3MgfSBmcm9tICcuLi9pbnRlcm5hbC90cmFuc2FjdGlvbi5pbnRlcm5hbCc7XG5pbXBvcnQgeyBpc0Z1bmN0aW9uLCBpc1BsYWluT2JqZWN0IH0gZnJvbSAnLi4vaW50ZXJuYWwvdXRpbHMnO1xuaW1wb3J0IHsgZGVlcEZyZWV6ZSB9IGZyb20gJy4uL2ludGVybmFsL2RlZXAtZnJlZXplJztcbmltcG9ydCB7IGNvbmZpZ0tleSwgU3RvcmVDb25maWdPcHRpb25zIH0gZnJvbSAnLi9zdG9yZS1jb25maWcnO1xuaW1wb3J0IHsgX19nbG9iYWxTdGF0ZSB9IGZyb20gJy4uL2ludGVybmFsL2dsb2JhbC1zdGF0ZSc7XG5pbXBvcnQgeyBnZXRBa2l0YUNvbmZpZyB9IGZyb20gJy4vY29uZmlnJztcblxubGV0IF9fREVWX18gPSB0cnVlO1xuY29uc3QgaXNOb3RCcm93c2VyID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCc7XG5cbmV4cG9ydCBjb25zdCBfX3N0b3Jlc19fOiB7IFtzdG9yZU5hbWU6IHN0cmluZ106IFN0b3JlPGFueT4gfSA9IHt9O1xuXG5leHBvcnQgY29uc3QgZW51bSBBY3Rpb25zIHtcbiAgTkVXX1NUT1JFLFxuICBERUxFVEVfU1RPUkUsXG4gIE5FV19TVEFURVxufVxuXG5leHBvcnQgdHlwZSBBY3Rpb24gPSB7XG4gIHR5cGU6IEFjdGlvbnM7XG4gIHBheWxvYWQ6IEhhc2hNYXA8YW55Pjtcbn07XG5cbmV4cG9ydCBjb25zdCByb290RGlzcGF0Y2hlciA9IG5ldyBSZXBsYXlTdWJqZWN0PEFjdGlvbj4oKTtcblxuZnVuY3Rpb24gbmV4dFN0YXRlKHN0b3JlTmFtZSwgaW5pdGlhbFN0YXRlID0gZmFsc2UpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBBY3Rpb25zLk5FV19TVEFURSxcbiAgICBwYXlsb2FkOiB7XG4gICAgICBuYW1lOiBzdG9yZU5hbWUsXG4gICAgICBpbml0aWFsU3RhdGVcbiAgICB9XG4gIH07XG59XG5cbi8qKlxuICogRW5hYmxlIHByb2R1Y3Rpb24gbW9kZSB0byBkaXNhYmxlIG9iamVjdEZyZWV6ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZW5hYmxlQWtpdGFQcm9kTW9kZSgpIHtcbiAgX19ERVZfXyA9IGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNEZXYoKSB7XG4gIHJldHVybiBfX0RFVl9fO1xufVxuXG4vKipcbiAqIFRoZSBSb290IFN0b3JlIHRoYXQgZXZlcnkgc3ViIHN0b3JlIG5lZWRzIHRvIGluaGVyaXQgYW5kXG4gKiBpbnZva2UgYHN1cGVyYCB3aXRoIHRoZSBpbml0aWFsIHN0YXRlLlxuICovXG5leHBvcnQgY2xhc3MgU3RvcmU8Uz4ge1xuICAvKiogTWFuYWdlIHRoZSBzdG9yZSB3aXRoIEJlaGF2aW9yU3ViamVjdCAqL1xuICBwcml2YXRlIHN0b3JlOiBCZWhhdmlvclN1YmplY3Q8UmVhZG9ubHk8Uz4+O1xuXG4gIC8qKiBUaGUgY3VycmVudCBzdGF0ZSB2YWx1ZSAqL1xuICBwcml2YXRlIHN0b3JlVmFsdWU6IFM7XG5cbiAgLyoqIFdoZXRoZXIgd2UgYXJlIGluc2lkZSB0cmFuc2FjdGlvbiAqKi9cbiAgcHJpdmF0ZSBpblRyYW5zYWN0aW9uID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBfaXNQcmlzdGluZSA9IHRydWU7XG5cbiAgcHJpdmF0ZSByZWFkb25seSBfaW5pdGlhbFN0YXRlOiBTO1xuXG4gIC8qKlxuICAgKlxuICAgKiBJbml0aWFsIHRoZSBzdG9yZSB3aXRoIHRoZSBzdGF0ZVxuICAgKi9cbiAgY29uc3RydWN0b3IoaW5pdGlhbFN0YXRlLCBwcml2YXRlIG9wdGlvbnM6IHsgaWRLZXk/OiBzdHJpbmc7IHN0b3JlTmFtZT86IHN0cmluZyB9ID0ge30pIHtcbiAgICBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdAQElOSVQnIH0pO1xuICAgIF9fc3RvcmVzX19bdGhpcy5zdG9yZU5hbWVdID0gdGhpcztcbiAgICB0aGlzLnNldFN0YXRlKCgpID0+IGluaXRpYWxTdGF0ZSk7XG4gICAgcm9vdERpc3BhdGNoZXIubmV4dCh7XG4gICAgICB0eXBlOiBBY3Rpb25zLk5FV19TVE9SRSxcbiAgICAgIHBheWxvYWQ6IHsgc3RvcmU6IHRoaXMgfVxuICAgIH0pO1xuICAgIGlzRGV2KCkgJiYgYXNzZXJ0RGVjb3JhdG9yKHRoaXMuc3RvcmVOYW1lLCB0aGlzLmNvbnN0cnVjdG9yLm5hbWUpO1xuICAgIGlmICh0aGlzLmlzUmVzc2V0YWJsZSgpKSB7XG4gICAgICB0aGlzLl9pbml0aWFsU3RhdGUgPSBpbml0aWFsU3RhdGU7XG4gICAgfVxuICB9XG5cbiAgc2V0TG9hZGluZyhsb2FkaW5nID0gZmFsc2UpIHtcbiAgICBpZiAobG9hZGluZyAhPT0gKHRoaXMuX3ZhbHVlKCkgYXMgUyAmIHsgbG9hZGluZzogYm9vbGVhbiB9KS5sb2FkaW5nKSB7XG4gICAgICBpc0RldigpICYmIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKHsgdHlwZTogJ1NldCBMb2FkaW5nJyB9KTtcbiAgICAgIHRoaXMuc2V0U3RhdGUocyA9PiAoeyAuLi4ocyBhcyBvYmplY3QpLCBsb2FkaW5nIH0gYXMgYW55KSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgc3RvcmUncyBlcnJvciBzdGF0ZS5cbiAgICovXG4gIHNldEVycm9yPFQ+KGVycm9yOiBUKSB7XG4gICAgaWYgKGVycm9yICE9PSAodGhpcy5fdmFsdWUoKSBhcyBTICYgeyBlcnJvcjogYW55IH0pLmVycm9yKSB7XG4gICAgICBpc0RldigpICYmIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKHsgdHlwZTogJ1NldCBFcnJvcicgfSk7XG4gICAgICB0aGlzLnNldFN0YXRlKHMgPT4gKHsgLi4uKHMgYXMgb2JqZWN0KSwgZXJyb3IgfSBhcyBhbnkpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IGEgc2xpY2UgZnJvbSB0aGUgc3RvcmVcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5zdG9yZS5zZWxlY3Qoc3RhdGUgPT4gc3RhdGUuZW50aXRpZXMpXG4gICAqXG4gICAqL1xuICBfc2VsZWN0PFI+KHByb2plY3Q6IChzdG9yZTogUykgPT4gUik6IE9ic2VydmFibGU8Uj4ge1xuICAgIHJldHVybiB0aGlzLnN0b3JlJC5waXBlKFxuICAgICAgbWFwKHByb2plY3QpLFxuICAgICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKVxuICAgICk7XG4gIH1cblxuICBfdmFsdWUoKTogUyB7XG4gICAgcmV0dXJuIHRoaXMuc3RvcmVWYWx1ZTtcbiAgfVxuXG4gIGdldCBjb25maWcoKTogU3RvcmVDb25maWdPcHRpb25zIHtcbiAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvcltjb25maWdLZXldO1xuICB9XG5cbiAgZ2V0IHN0b3JlTmFtZSgpIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLnN0b3JlTmFtZSB8fCAodGhpcy5jb25maWcgJiYgdGhpcy5jb25maWdbJ3N0b3JlTmFtZSddKTtcbiAgfVxuXG4gIGdldCBpZEtleSgpIHtcbiAgICAvKiogYmFja3dhcmQgY29tcGF0aWJpbGl0eSAqL1xuICAgIGNvbnN0IG5ld0lkS2V5ID0gdGhpcy5jb25maWcgJiYgdGhpcy5jb25maWcuaWRLZXk7XG4gICAgaWYgKCFuZXdJZEtleSkge1xuICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5pZEtleSB8fCAnaWQnO1xuICAgIH1cbiAgICByZXR1cm4gbmV3SWRLZXk7XG4gIH1cblxuICBnZXQgaXNQcmlzdGluZSgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNQcmlzdGluZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBgc2V0U3RhdGUoKWAgaXMgdGhlIG9ubHkgd2F5IHRvIHVwZGF0ZSBhIHN0b3JlOyBJdCByZWNlaXZlcyBhIGNhbGxiYWNrIGZ1bmN0aW9uLFxuICAgKiB3aGljaCBnZXRzIHRoZSBjdXJyZW50IHN0YXRlLCBhbmQgcmV0dXJucyBhIG5ldyBpbW11dGFibGUgc3RhdGUsXG4gICAqIHdoaWNoIHdpbGwgYmUgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgc3RvcmUuXG4gICAqL1xuICBzZXRTdGF0ZShuZXdTdGF0ZUZuOiAoc3RhdGU6IFJlYWRvbmx5PFM+KSA9PiBTLCBfcm9vdERpc3BhdGNoZXIgPSB0cnVlKSB7XG4gICAgY29uc3QgcHJldlN0YXRlID0gdGhpcy5fdmFsdWUoKTtcbiAgICB0aGlzLnN0b3JlVmFsdWUgPSBfX0RFVl9fID8gZGVlcEZyZWV6ZShuZXdTdGF0ZUZuKHRoaXMuX3ZhbHVlKCkpKSA6IG5ld1N0YXRlRm4odGhpcy5fdmFsdWUoKSk7XG5cbiAgICBpZiAocHJldlN0YXRlID09PSB0aGlzLnN0b3JlVmFsdWUpIHtcbiAgICAgIHRocm93IG5ldyBBa2l0YUltbXV0YWJpbGl0eUVycm9yKHRoaXMuc3RvcmVOYW1lKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuc3RvcmUpIHtcbiAgICAgIHRoaXMuc3RvcmUgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KHRoaXMuc3RvcmVWYWx1ZSk7XG4gICAgICByb290RGlzcGF0Y2hlci5uZXh0KG5leHRTdGF0ZSh0aGlzLnN0b3JlTmFtZSwgdHJ1ZSkpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChpc1RyYW5zYWN0aW9uSW5Qcm9jZXNzKCkpIHtcbiAgICAgIHRoaXMuaGFuZGxlVHJhbnNhY3Rpb24oKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmRpc3BhdGNoKHRoaXMuc3RvcmVWYWx1ZSwgX3Jvb3REaXNwYXRjaGVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNldHMgdGhlIHN0b3JlIHRvIGl0J3MgaW5pdGlhbCBzdGF0ZSBhbmQgc2V0IHRoZSBzdG9yZSB0byBhIHByaXN0aW5lIHN0YXRlLlxuICAgKi9cbiAgcmVzZXQoKSB7XG4gICAgaWYgKHRoaXMuaXNSZXNzZXRhYmxlKCkpIHtcbiAgICAgIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKHsgdHlwZTogJ1Jlc2V0IFN0b3JlJyB9KTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoKCkgPT4gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5faW5pdGlhbFN0YXRlKSk7XG4gICAgICB0aGlzLnNldFByaXN0aW5lKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBBa2l0YUVycm9yKGBZb3UgbmVlZCB0byBlbmFibGUgdGhlIHJlc2V0IGZ1bmN0aW9uYWxpdHlgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBtZXRob2QgaXMgYSBzaG9ydGN1dCBmb3IgYHNldFN0YXRlKClgLlxuICAgKiBJdCBjYW4gYmUgdXNlZnVsIHdoZW4geW91IHdhbnQgdG8gcGFzcyB0aGUgd2hvbGUgc3RhdGUgb2JqZWN0IGluc3RlYWQgb2YgbWVyZ2luZyBhIHBhcnRpYWwgc3RhdGUuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMuc3RvcmUudXBkYXRlKG5ld1N0YXRlKVxuICAgKi9cbiAgdXBkYXRlKG5ld1N0YXRlOiAoc3RhdGU6IFJlYWRvbmx5PFM+KSA9PiBQYXJ0aWFsPFM+KTtcbiAgdXBkYXRlKG5ld1N0YXRlOiBQYXJ0aWFsPFM+KTtcbiAgdXBkYXRlKGlkOiBJRCB8IElEW10gfCBudWxsLCBuZXdTdGF0ZTogUGFydGlhbDxTPik7XG4gIHVwZGF0ZShuZXdTdGF0ZU9ySWQ6IFBhcnRpYWw8Uz4gfCBJRCB8IElEW10gfCBudWxsIHwgKChzdGF0ZTogUmVhZG9ubHk8Uz4pID0+IFBhcnRpYWw8Uz4pLCBuZXdTdGF0ZT86IFBhcnRpYWw8Uz4pIHtcbiAgICBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdVcGRhdGUgU3RvcmUnIH0pO1xuICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUgPT4ge1xuICAgICAgbGV0IHZhbHVlID0gaXNGdW5jdGlvbihuZXdTdGF0ZU9ySWQpID8gbmV3U3RhdGVPcklkKHN0YXRlKSA6IG5ld1N0YXRlT3JJZDtcbiAgICAgIGxldCBtZXJnZWQgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZSwgdmFsdWUpO1xuICAgICAgcmV0dXJuIGlzUGxhaW5PYmplY3Qoc3RhdGUpID8gbWVyZ2VkIDogbmV3IChzdGF0ZSBhcyBhbnkpLmNvbnN0cnVjdG9yKG1lcmdlZCk7XG4gICAgfSk7XG4gICAgdGhpcy5zZXREaXJ0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHN0b3JlIHRvIGEgcHJpc3RpbmUgc3RhdGUuXG4gICAqL1xuICBzZXRQcmlzdGluZSgpIHtcbiAgICB0aGlzLl9pc1ByaXN0aW5lID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBzdG9yZSB0byBhIGRpcnR5IHN0YXRlLCBpbmRpY2F0aW5nIHRoYXQgaXQgaXMgbm90IHByaXN0aW5lLlxuICAgKi9cbiAgc2V0RGlydHkoKSB7XG4gICAgdGhpcy5faXNQcmlzdGluZSA9IGZhbHNlO1xuICB9XG5cbiAgZGVzdHJveSA9IHRoaXMubmdPbkRlc3Ryb3k7XG5cbiAgcHJpdmF0ZSBkaXNwYXRjaChzdGF0ZTogUywgX3Jvb3REaXNwYXRjaGVyID0gdHJ1ZSkge1xuICAgIHRoaXMuc3RvcmUubmV4dChzdGF0ZSk7XG4gICAgaWYgKF9yb290RGlzcGF0Y2hlcikge1xuICAgICAgcm9vdERpc3BhdGNoZXIubmV4dChuZXh0U3RhdGUodGhpcy5zdG9yZU5hbWUpKTtcbiAgICAgIGlzRGV2KCkgJiYgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnU2V0IFN0YXRlJyB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldCBzdG9yZSQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RvcmUuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICAvKipcbiAgICogV2hlbiB0aGUgdHJhbnNhY3Rpb24gZW5kcyBkaXNwYXRjaCB0aGUgZmluYWwgdmFsdWUgb25jZVxuICAgKi9cbiAgcHJpdmF0ZSB3YXRjaFRyYW5zYWN0aW9uKCkge1xuICAgIGNvbW1pdCgpLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICB0aGlzLmluVHJhbnNhY3Rpb24gPSBmYWxzZTtcbiAgICAgIGlmIChpc0RldigpICYmICFfX2dsb2JhbFN0YXRlLnNraXBUcmFuc2FjdGlvbk1zZykge1xuICAgICAgICBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdAVHJhbnNhY3Rpb24nIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy5kaXNwYXRjaCh0aGlzLl92YWx1ZSgpKTtcbiAgICAgIF9fZ2xvYmFsU3RhdGUuY3VycmVudFQgPSBbXTtcbiAgICAgIF9fZ2xvYmFsU3RhdGUuc2tpcFRyYW5zYWN0aW9uTXNnID0gZmFsc2U7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGlzUmVzc2V0YWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWcucmVzZXR0YWJsZSB8fCBnZXRBa2l0YUNvbmZpZygpLnJlc2V0dGFibGU7XG4gIH1cblxuICAvKipcbiAgICogTGlzdGVuIHRvIHRoZSB0cmFuc2FjdGlvbiBzdHJlYW1cbiAgICovXG4gIHByaXZhdGUgaGFuZGxlVHJhbnNhY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLmluVHJhbnNhY3Rpb24pIHtcbiAgICAgIHRoaXMud2F0Y2hUcmFuc2FjdGlvbigpO1xuICAgICAgdGhpcy5pblRyYW5zYWN0aW9uID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICBpZiAoaXNOb3RCcm93c2VyKSByZXR1cm47XG4gICAgaWYgKCEod2luZG93IGFzIGFueSkuaG1yRW5hYmxlZCAmJiB0aGlzID09PSBfX3N0b3Jlc19fW3RoaXMuc3RvcmVOYW1lXSkge1xuICAgICAgZGVsZXRlIF9fc3RvcmVzX19bdGhpcy5zdG9yZU5hbWVdO1xuICAgICAgcm9vdERpc3BhdGNoZXIubmV4dCh7XG4gICAgICAgIHR5cGU6IEFjdGlvbnMuREVMRVRFX1NUT1JFLFxuICAgICAgICBwYXlsb2FkOiB7IHN0b3JlTmFtZTogdGhpcy5zdG9yZU5hbWUgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBfY3J1ZCB9IGZyb20gJy4uL2ludGVybmFsL2NydWQnO1xuaW1wb3J0IHsgQWtpdGFJbW11dGFiaWxpdHlFcnJvciwgYXNzZXJ0QWN0aXZlIH0gZnJvbSAnLi4vaW50ZXJuYWwvZXJyb3InO1xuaW1wb3J0IHsgQWN0aW9uLCBfX2dsb2JhbFN0YXRlIH0gZnJvbSAnLi4vaW50ZXJuYWwvZ2xvYmFsLXN0YXRlJztcbmltcG9ydCB7IGNvZXJjZUFycmF5LCBlbnRpdHlFeGlzdHMsIGlzRnVuY3Rpb24sIGlzTmlsLCBpc09iamVjdCwgaXNVbmRlZmluZWQsIHRvQm9vbGVhbiB9IGZyb20gJy4uL2ludGVybmFsL3V0aWxzJztcbmltcG9ydCB7IGlzRGV2LCBTdG9yZSB9IGZyb20gJy4vc3RvcmUnO1xuaW1wb3J0IHsgQWN0aXZlU3RhdGUsIEVudGl0aWVzLCBFbnRpdHlTdGF0ZSwgSGFzaE1hcCwgSUQsIE5ld2FibGUsIEFkZE9wdGlvbnMsIFNldEFjdGl2ZU9wdGlvbnMgfSBmcm9tICcuL3R5cGVzJztcblxuLyoqXG4gKiBUaGUgUm9vdCBTdG9yZSB0aGF0IGV2ZXJ5IHN1YiBzdG9yZSBuZWVkcyB0byBpbmhlcml0IGFuZFxuICogaW52b2tlIGBzdXBlcmAgd2l0aCB0aGUgaW5pdGlhbCBzdGF0ZS5cbiAqL1xuZXhwb3J0IGNsYXNzIEVudGl0eVN0b3JlPFMgZXh0ZW5kcyBFbnRpdHlTdGF0ZTxFPiwgRSwgQWN0aXZlRW50aXR5ID0gSUQ+IGV4dGVuZHMgU3RvcmU8Uz4ge1xuICAvKipcbiAgICpcbiAgICogSW5pdGlhdGUgdGhlIHN0b3JlIHdpdGggdGhlIHN0YXRlXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihpbml0aWFsU3RhdGUgPSB7fSwgb3B0aW9uczogeyBpZEtleT86IHN0cmluZzsgc3RvcmVOYW1lPzogc3RyaW5nIH0gPSB7fSkge1xuICAgIHN1cGVyKHsgLi4uZ2V0SW5pdGlhbEVudGl0aWVzU3RhdGUoKSwgLi4uaW5pdGlhbFN0YXRlIH0sIG9wdGlvbnMpO1xuICB9XG5cbiAgZ2V0IGVudGl0aWVzKCkge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZSgpLmVudGl0aWVzO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIFJlcGxhY2UgY3VycmVudCBjb2xsZWN0aW9uIHdpdGggcHJvdmlkZWQgY29sbGVjdGlvblxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB0aGlzLnN0b3JlLnNldChbRW50aXR5LCBFbnRpdHldKTtcbiAgICogdGhpcy5zdG9yZS5zZXQoezE6IEVudGl0eSwgMjogRW50aXR5fSk7XG4gICAqIHRoaXMuc3RvcmUuc2V0KFt7aWQ6IDF9LCB7aWQ6IDJ9XSwgeyBlbnRpdHlDbGFzczogUHJvZHVjdCB9KTtcbiAgICpcbiAgICovXG4gIHNldChlbnRpdGllczogRVtdIHwgSGFzaE1hcDxFPiB8IEVudGl0aWVzPEU+LCBvcHRpb25zOiB7IGVudGl0eUNsYXNzPzogTmV3YWJsZTxFPiB8IHVuZGVmaW5lZCB9ID0ge30pIHtcbiAgICBpc0RldigpICYmIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKHsgdHlwZTogJ1NldCBFbnRpdGllcycgfSk7XG4gICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSA9PiBfY3J1ZC5fc2V0KHN0YXRlLCBpc05pbChlbnRpdGllcykgPyBbXSA6IGVudGl0aWVzLCBvcHRpb25zLmVudGl0eUNsYXNzLCB0aGlzLmlkS2V5KSk7XG4gICAgdGhpcy5zZXREaXJ0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBvciByZXBsYWNlIGFuIGVudGl0eSBpbiB0aGUgc3RvcmUuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMuc3RvcmUuY3JlYXRlT3JSZXBsYWNlKDMsIEVudGl0eSk7XG4gICAqXG4gICAqL1xuICBjcmVhdGVPclJlcGxhY2UoaWQ6IElELCBlbnRpdHk6IEUpIHtcbiAgICBpZiAoIWVudGl0eUV4aXN0cyhpZCwgdGhpcy5fdmFsdWUoKS5lbnRpdGllcykpIHtcbiAgICAgIHRoaXMuYWRkV2hlbk5vdEV4aXN0cyhpZCwgZW50aXR5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgaXNEZXYoKSAmJiBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdDcmVhdGUgb3IgUmVwbGFjZSBFbnRpdHknLCBlbnRpdHlJZDogW2lkXSB9KTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUgPT4gX2NydWQuX3JlcGxhY2VFbnRpdHkoc3RhdGUsIGlkLCBlbnRpdHkpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICpcbiAgICogSW5zZXJ0IG9yIFVwZGF0ZVxuICAgKi9cbiAgdXBzZXJ0KGlkOiBJRCwgZW50aXR5T3JGbjogUGFydGlhbDxFPiB8ICgoZW50aXR5OiBSZWFkb25seTxFPikgPT4gUGFydGlhbDxFPikpIHtcbiAgICBpZiAoIWVudGl0eUV4aXN0cyhpZCwgdGhpcy5fdmFsdWUoKS5lbnRpdGllcykpIHtcbiAgICAgIGNvbnN0IHJlc29sdmUgPSBpc0Z1bmN0aW9uKGVudGl0eU9yRm4pID8gKGVudGl0eU9yRm4gYXMgRnVuY3Rpb24pKHt9KSA6IGVudGl0eU9yRm47XG4gICAgICB0aGlzLmFkZFdoZW5Ob3RFeGlzdHMoaWQsIHJlc29sdmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVwZGF0ZShpZCwgZW50aXR5T3JGbiBhcyBhbnkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYW4gZW50aXR5IG9yIGVudGl0aWVzIHRvIHRoZSBzdG9yZS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5zdG9yZS5hZGQoW0VudGl0eSwgRW50aXR5XSk7XG4gICAqIHRoaXMuc3RvcmUuYWRkKEVudGl0eSk7XG4gICAqIHRoaXMuc3RvcmUuYWRkKEVudGl0eSwgeyBwcmVwZW5kOiB0cnVlIH0pO1xuICAgKi9cbiAgYWRkKGVudGl0aWVzOiBFW10gfCBFLCBvcHRpb25zPzogQWRkT3B0aW9ucykge1xuICAgIGNvbnN0IHRvQXJyYXkgPSBjb2VyY2VBcnJheShlbnRpdGllcyk7XG5cbiAgICBpZiAodG9BcnJheS5sZW5ndGggPT09IDApIHJldHVybjtcbiAgICAvKiogIElmIHdlIHBhc3MgZW50aXRpZXMgdGhhdCBhbHJlYWR5IGV4aXN0LCB3ZSBzaG91bGQgaWdub3JlIHRoZW0gKi9cbiAgICBjb25zdCBhbGxFeGlzdHMgPSB0b0FycmF5LmV2ZXJ5KGVudGl0eSA9PiB0aGlzLl92YWx1ZSgpLmlkcy5pbmRleE9mKGVudGl0eVt0aGlzLmlkS2V5XSkgPiAtMSk7XG4gICAgaWYgKGFsbEV4aXN0cykgcmV0dXJuO1xuXG4gICAgaXNEZXYoKSAmJiBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdBZGQgRW50aXR5JyB9KTtcbiAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IF9jcnVkLl9hZGQ8UywgRT4oc3RhdGUsIHRvQXJyYXksIHRoaXMuaWRLZXksIG9wdGlvbnMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBVcGRhdGUgYW4gZW50aXR5IG9yIGVudGl0aWVzIGluIHRoZSBzdG9yZS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5zdG9yZS51cGRhdGUoMywge1xuICAgKiAgIG5hbWU6ICdOZXcgTmFtZSdcbiAgICogfSk7XG4gICAqXG4gICAqICB0aGlzLnN0b3JlLnVwZGF0ZSgzLCBlbnRpdHkgPT4ge1xuICAgKiAgICByZXR1cm4ge1xuICAgKiAgICAgIGNvbmZpZzoge1xuICAgKiAgICAgICAgLi4uZW50aXR5LmZpbHRlcixcbiAgICogICAgICAgIGRhdGVcbiAgICogICAgICB9XG4gICAqICAgIH1cbiAgICogIH0pO1xuICAgKlxuICAgKiB0aGlzLnN0b3JlLnVwZGF0ZShbMSwyLDNdLCB7XG4gICAqICAgbmFtZTogJ05ldyBOYW1lJ1xuICAgKiB9KTtcbiAgICpcbiAgICogdGhpcy5zdG9yZS51cGRhdGUoZSA9PiBlLm5hbWUgPT09ICd2YWx1ZScsIHtcbiAgICogICBuYW1lOiAnTmV3IE5hbWUnXG4gICAqIH0pO1xuICAgKlxuICAgKiB0aGlzLnN0b3JlLnVwZGF0ZShudWxsLCB7XG4gICAqICAgbmFtZTogJ05ldyBOYW1lJ1xuICAgKiB9KTtcbiAgICpcbiAgICovXG4gIHVwZGF0ZShpZDogSUQgfCBJRFtdIHwgbnVsbCwgbmV3U3RhdGVGbjogKChlbnRpdHk6IFJlYWRvbmx5PEU+KSA9PiBQYXJ0aWFsPEU+KSk7XG4gIHVwZGF0ZShpZDogSUQgfCBJRFtdIHwgbnVsbCwgbmV3U3RhdGU6IFBhcnRpYWw8RT4pO1xuICB1cGRhdGUoaWQ6IElEIHwgSURbXSB8IG51bGwsIG5ld1N0YXRlOiBQYXJ0aWFsPFM+KTtcbiAgdXBkYXRlKG5ld1N0YXRlOiAoc3RhdGU6IFJlYWRvbmx5PFM+KSA9PiBQYXJ0aWFsPFM+KTtcbiAgdXBkYXRlKHByZWRpY2F0ZTogKChlbnRpdHk6IFJlYWRvbmx5PEU+KSA9PiBib29sZWFuKSwgbmV3U3RhdGVGbjogKChlbnRpdHk6IFJlYWRvbmx5PEU+KSA9PiBQYXJ0aWFsPEU+KSk7XG4gIHVwZGF0ZShwcmVkaWNhdGU6ICgoZW50aXR5OiBSZWFkb25seTxFPikgPT4gYm9vbGVhbiksIG5ld1N0YXRlOiBQYXJ0aWFsPEU+KTtcbiAgdXBkYXRlKHByZWRpY2F0ZTogKChlbnRpdHk6IFJlYWRvbmx5PEU+KSA9PiBib29sZWFuKSwgbmV3U3RhdGU6IFBhcnRpYWw8Uz4pO1xuICB1cGRhdGUobmV3U3RhdGU6IFBhcnRpYWw8Uz4pO1xuICB1cGRhdGUoXG4gICAgaWRzT3JGbjogSUQgfCBJRFtdIHwgbnVsbCB8IFBhcnRpYWw8Uz4gfCAoKHN0YXRlOiBSZWFkb25seTxTPikgPT4gUGFydGlhbDxTPikgfCAoKGVudGl0eTogUmVhZG9ubHk8RT4pID0+IGJvb2xlYW4pLFxuICAgIG5ld1N0YXRlT3JGbj86ICgoZW50aXR5OiBSZWFkb25seTxFPikgPT4gUGFydGlhbDxFPikgfCBQYXJ0aWFsPEU+IHwgUGFydGlhbDxTPlxuICApIHtcbiAgICBsZXQgaWRzOiBJRFtdID0gW107XG4gICAgY29uc3Qgc3RvcmVJZHMgPSB0aGlzLl92YWx1ZSgpLmlkcztcblxuICAgIGlmIChpc0Z1bmN0aW9uKGlkc09yRm4pKSB7XG4gICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gc3RvcmVJZHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY29uc3QgaWQgPSBzdG9yZUlkc1tpXTtcbiAgICAgICAgY29uc3QgZW50aXR5ID0gdGhpcy5fdmFsdWUoKS5lbnRpdGllc1tpZF07XG4gICAgICAgIGlmIChlbnRpdHkgJiYgKGlkc09yRm4gYXMgRnVuY3Rpb24pKGVudGl0eSkpIHtcbiAgICAgICAgICBpZHMucHVzaChpZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWRzID0gdG9Cb29sZWFuKGlkc09yRm4pID8gY29lcmNlQXJyYXkoaWRzT3JGbikgOiBzdG9yZUlkcztcbiAgICB9XG5cbiAgICBpZiAoaWRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICAgIGlzRGV2KCkgJiYgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnVXBkYXRlIEVudGl0eScsIGVudGl0eUlkOiBpZHMgfSk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHtcbiAgICAgIHJldHVybiBfY3J1ZC5fdXBkYXRlKHN0YXRlLCBpZHMsIG5ld1N0YXRlT3JGbiwgdGhpcy5pZEtleSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQW4gYWxpYXMgdG8gdXBkYXRlIGFsbC5cbiAgICovXG4gIHVwZGF0ZUFsbChzdGF0ZTogUGFydGlhbDxFPikge1xuICAgIGlmICh0aGlzLl92YWx1ZSgpLmlkcy5sZW5ndGggPT09IDApIHJldHVybjtcbiAgICB0aGlzLnVwZGF0ZShudWxsLCBzdGF0ZSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSByb290IHN0YXRlIChkYXRhIHdoaWNoIGlzIGV4dGVybmFsIHRvIHRoZSBlbnRpdGllcykuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMuc3RvcmUudXBkYXRlUm9vdCh7XG4gICAqICAgbWV0YWRhdGE6ICduZXcgbWV0YWRhdGFcbiAgICogfSk7XG4gICAqXG4gICAqICB0aGlzLnN0b3JlLnVwZGF0ZVJvb3Qoc3RhdGUgPT4ge1xuICAgKiAgICByZXR1cm4ge1xuICAgKiAgICAgIG1ldGFkYXRhOiB7XG4gICAqICAgICAgICAuLi5zdGF0ZS5tZXRhZGF0YSxcbiAgICogICAgICAgIGtleTogJ25ldyB2YWx1ZSdcbiAgICogICAgICB9XG4gICAqICAgIH1cbiAgICogIH0pO1xuICAgKi9cbiAgdXBkYXRlUm9vdChuZXdTdGF0ZUZuOiAoKHN0YXRlOiBSZWFkb25seTxTPikgPT4gUGFydGlhbDxTPikgfCBQYXJ0aWFsPFM+LCBhY3Rpb24/OiBBY3Rpb24pIHtcbiAgICBjb25zdCBuZXdTdGF0ZSA9IGlzRnVuY3Rpb24obmV3U3RhdGVGbikgPyBuZXdTdGF0ZUZuKHRoaXMuX3ZhbHVlKCkpIDogbmV3U3RhdGVGbjtcblxuICAgIGlmIChuZXdTdGF0ZSA9PT0gdGhpcy5fdmFsdWUoKSkge1xuICAgICAgdGhyb3cgbmV3IEFraXRhSW1tdXRhYmlsaXR5RXJyb3IodGhpcy5zdG9yZU5hbWUpO1xuICAgIH1cblxuICAgIGlzRGV2KCkgJiYgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oYWN0aW9uIHx8IHsgdHlwZTogJ1VwZGF0ZSBSb290JyB9KTtcblxuICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uKHN0YXRlIGFzIGFueSksXG4gICAgICAgIC4uLihuZXdTdGF0ZSBhcyBhbnkpXG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIFJlbW92ZSBvbmUgb3IgbW9yZSBlbnRpdGllcyBmcm9tIHRoZSBzdG9yZTpcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5zdG9yZS5yZW1vdmUoNSk7XG4gICAqIHRoaXMuc3RvcmUucmVtb3ZlKFsxLDIsM10pO1xuICAgKiB0aGlzLnN0b3JlLnJlbW92ZShlbnRpdHkgPT4gZW50aXR5LmlkID09PSAxKTtcbiAgICogdGhpcy5zdG9yZS5yZW1vdmUoKTtcbiAgICovXG4gIHJlbW92ZShpZD86IElEIHwgSURbXSk7XG4gIHJlbW92ZShwcmVkaWNhdGU6IChlbnRpdHk6IFJlYWRvbmx5PEU+KSA9PiBib29sZWFuKTtcbiAgcmVtb3ZlKGlkc09yRm4/OiBJRCB8IElEW10gfCAoKGVudGl0eTogUmVhZG9ubHk8RT4pID0+IGJvb2xlYW4pKSB7XG4gICAgY29uc3Qgc3RvcmVJZHMgPSB0aGlzLl92YWx1ZSgpLmlkcztcblxuICAgIGlmIChzdG9yZUlkcy5sZW5ndGggPT09IDApIHJldHVybjtcbiAgICBjb25zdCBpZFBhc3NlZCA9IHRvQm9vbGVhbihpZHNPckZuKTtcbiAgICBpZiAoIWlkUGFzc2VkKSB0aGlzLnNldFByaXN0aW5lKCk7XG5cbiAgICBsZXQgaWRzOiBJRFtdID0gW107XG4gICAgaWYgKGlzRnVuY3Rpb24oaWRzT3JGbikpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBzdG9yZUlkcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjb25zdCBpZCA9IHN0b3JlSWRzW2ldO1xuICAgICAgICBjb25zdCBlbnRpdHkgPSB0aGlzLl92YWx1ZSgpLmVudGl0aWVzW2lkXTtcbiAgICAgICAgaWYgKGVudGl0eSAmJiBpZHNPckZuKGVudGl0eSkpIHtcbiAgICAgICAgICBpZHMucHVzaChpZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWRzID0gaWRQYXNzZWQgPyBjb2VyY2VBcnJheShpZHNPckZuKSA6IG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGlkcyAmJiBpZHMubGVuZ3RoID09PSAwKSByZXR1cm47XG4gICAgaXNEZXYoKSAmJiBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdSZW1vdmUgRW50aXR5JywgZW50aXR5SWQ6IGlkcyB9KTtcblxuICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUgPT4ge1xuICAgICAgcmV0dXJuIF9jcnVkLl9yZW1vdmUoc3RhdGUsIGlkcyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICpcbiAgICogVXBkYXRlIHRoZSBhY3RpdmUgZW50aXR5LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB0aGlzLnN0b3JlLnVwZGF0ZUFjdGl2ZShhY3RpdmUgPT4ge1xuICAgKiAgIHJldHVybiB7XG4gICAqICAgICBjb25maWc6IHtcbiAgICogICAgICAuLmFjdGl2ZS5jb25maWcsXG4gICAqICAgICAgZGF0ZVxuICAgKiAgICAgfVxuICAgKiAgIH1cbiAgICogfSlcbiAgICovXG4gIHVwZGF0ZUFjdGl2ZShuZXdTdGF0ZUZuOiAoKGVudGl0eTogUmVhZG9ubHk8RT4pID0+IFBhcnRpYWw8RT4pIHwgUGFydGlhbDxFPikge1xuICAgIGFzc2VydEFjdGl2ZSh0aGlzLl92YWx1ZSgpKTtcbiAgICBpc0RldigpICYmIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKHsgdHlwZTogJ1VwZGF0ZSBBY3RpdmUgRW50aXR5JywgZW50aXR5SWQ6IHRoaXMuX3ZhbHVlKCkuYWN0aXZlIH0pO1xuICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUgPT4ge1xuICAgICAgY29uc3QgYWN0aXZlSWQgPSBzdGF0ZS5hY3RpdmUgYXMgSUQ7XG4gICAgICBjb25zdCBuZXdTdGF0ZSA9IGlzRnVuY3Rpb24obmV3U3RhdGVGbikgPyBuZXdTdGF0ZUZuKHN0YXRlLmVudGl0aWVzW2FjdGl2ZUlkXSkgOiBuZXdTdGF0ZUZuO1xuICAgICAgaWYgKG5ld1N0YXRlID09PSBzdGF0ZSkge1xuICAgICAgICB0aHJvdyBuZXcgQWtpdGFJbW11dGFiaWxpdHlFcnJvcih0aGlzLnN0b3JlTmFtZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gX2NydWQuX3VwZGF0ZShzdGF0ZSwgW2FjdGl2ZUlkXSwgbmV3U3RhdGUsIHRoaXMuaWRLZXkpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgZ2l2ZW4gZW50aXR5IGFzIGFjdGl2ZS5cbiAgICovXG4gIHNldEFjdGl2ZShpZE9yT3B0aW9uczogQWN0aXZlRW50aXR5IHwgU2V0QWN0aXZlT3B0aW9ucyB8IG51bGwpIHtcbiAgICBsZXQgYWN0aXZlSWQ6IEFjdGl2ZUVudGl0eTtcblxuICAgIGlmIChpc09iamVjdChpZE9yT3B0aW9ucykpIHtcbiAgICAgIGlmIChpc05pbCh0aGlzLl92YWx1ZSgpLmFjdGl2ZSkpIHJldHVybjtcbiAgICAgIChpZE9yT3B0aW9ucyBhcyBTZXRBY3RpdmVPcHRpb25zKSA9IE9iamVjdC5hc3NpZ24oeyB3cmFwOiB0cnVlIH0sIGlkT3JPcHRpb25zKTtcbiAgICAgIGNvbnN0IGlkcyA9IHRoaXMuX3ZhbHVlKCkuaWRzO1xuICAgICAgY29uc3QgY3VycmVudElkSW5kZXggPSBpZHMuaW5kZXhPZih0aGlzLl92YWx1ZSgpLmFjdGl2ZSk7XG4gICAgICBpZiAoKGlkT3JPcHRpb25zIGFzIFNldEFjdGl2ZU9wdGlvbnMpLnByZXYpIHtcbiAgICAgICAgY29uc3QgaXNGaXJzdCA9IGN1cnJlbnRJZEluZGV4ID09PSAwO1xuICAgICAgICBpZiAoaXNGaXJzdCAmJiAhKGlkT3JPcHRpb25zIGFzIFNldEFjdGl2ZU9wdGlvbnMpLndyYXApIHJldHVybjtcbiAgICAgICAgYWN0aXZlSWQgPSBpc0ZpcnN0ID8gaWRzW2lkcy5sZW5ndGggLSAxXSA6IChpZHNbY3VycmVudElkSW5kZXggLSAxXSBhcyBhbnkpO1xuICAgICAgfSBlbHNlIGlmICgoaWRPck9wdGlvbnMgYXMgU2V0QWN0aXZlT3B0aW9ucykubmV4dCkge1xuICAgICAgICBjb25zdCBpc0xhc3QgPSBpZHMubGVuZ3RoID09PSBjdXJyZW50SWRJbmRleCArIDE7XG4gICAgICAgIGlmIChpc0xhc3QgJiYgIShpZE9yT3B0aW9ucyBhcyBTZXRBY3RpdmVPcHRpb25zKS53cmFwKSByZXR1cm47XG4gICAgICAgIGFjdGl2ZUlkID0gaXNMYXN0ID8gaWRzWzBdIDogKGlkc1tjdXJyZW50SWRJbmRleCArIDFdIGFzIGFueSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChpZE9yT3B0aW9ucyA9PT0gdGhpcy5fdmFsdWUoKS5hY3RpdmUpIHJldHVybjtcbiAgICAgIGFjdGl2ZUlkID0gaWRPck9wdGlvbnMgYXMgQWN0aXZlRW50aXR5O1xuICAgIH1cblxuICAgIGlzRGV2KCkgJiYgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnU2V0IEFjdGl2ZSBFbnRpdHknLCBlbnRpdHlJZDogYWN0aXZlSWQgfSk7XG4gICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi4oc3RhdGUgYXMgYW55KSxcbiAgICAgICAgYWN0aXZlOiBhY3RpdmVJZFxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgYWRkV2hlbk5vdEV4aXN0cyhpZDogSUQsIGVudGl0eTogRSkge1xuICAgIGlmICghZW50aXR5W3RoaXMuaWRLZXldKSB7XG4gICAgICBlbnRpdHlbdGhpcy5pZEtleV0gPSBpZDtcbiAgICB9XG4gICAgdGhpcy5hZGQoZW50aXR5KTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgZ2V0SW5pdGlhbEVudGl0aWVzU3RhdGUgPSAoKSA9PlxuICAoe1xuICAgIGVudGl0aWVzOiB7fSxcbiAgICBpZHM6IFtdLFxuICAgIGxvYWRpbmc6IHRydWUsXG4gICAgZXJyb3I6IG51bGxcbiAgfSBhcyBFbnRpdHlTdGF0ZSk7XG5cbmV4cG9ydCBjb25zdCBnZXRJbml0aWFsQWN0aXZlU3RhdGUgPSAoKSA9PlxuICAoe1xuICAgIGFjdGl2ZTogbnVsbFxuICB9IGFzIEFjdGl2ZVN0YXRlKTtcbiIsImV4cG9ydCBlbnVtIE9yZGVyIHtcbiAgQVNDID0gJ2FzYycsXG4gIERFU0MgPSAnZGVzYydcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVWYWx1ZXMoa2V5LCBvcmRlcjogT3JkZXIgPSBPcmRlci5BU0MpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGEsIGIpIHtcbiAgICBpZiAoIWEuaGFzT3duUHJvcGVydHkoa2V5KSB8fCAhYi5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBjb25zdCB2YXJBID0gdHlwZW9mIGFba2V5XSA9PT0gJ3N0cmluZycgPyBhW2tleV0udG9VcHBlckNhc2UoKSA6IGFba2V5XTtcbiAgICBjb25zdCB2YXJCID0gdHlwZW9mIGJba2V5XSA9PT0gJ3N0cmluZycgPyBiW2tleV0udG9VcHBlckNhc2UoKSA6IGJba2V5XTtcblxuICAgIGxldCBjb21wYXJpc29uID0gMDtcbiAgICBpZiAodmFyQSA+IHZhckIpIHtcbiAgICAgIGNvbXBhcmlzb24gPSAxO1xuICAgIH0gZWxzZSBpZiAodmFyQSA8IHZhckIpIHtcbiAgICAgIGNvbXBhcmlzb24gPSAtMTtcbiAgICB9XG4gICAgcmV0dXJuIG9yZGVyID09IE9yZGVyLkRFU0MgPyBjb21wYXJpc29uICogLTEgOiBjb21wYXJpc29uO1xuICB9O1xufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIG1lbW9pemVPbmUoZm46IEZ1bmN0aW9uKSB7XG4gIGxldCBsYXN0QXJncztcbiAgbGV0IGNoYW5nZWQgPSBmYWxzZTtcbiAgbGV0IGZpcnN0SW5pdCA9IHRydWU7XG4gIGxldCBsYXN0UmVzdWx0O1xuXG4gIHJldHVybiBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgaWYgKGxhc3RBcmdzKSB7XG4gICAgICAvKiogSWYgZW50aXRpZXMgbm9yIGlkcyBkb2Vzbid0IGNoYW5nZSByZXR1cm4gdGhlIGxhc3QgdmFsdWUgKi9cbiAgICAgIGNoYW5nZWQgPSBsYXN0QXJnc1sxXSAhPT0gYXJnc1sxXSB8fCBsYXN0QXJnc1swXSAhPT0gYXJnc1swXTtcbiAgICB9XG5cbiAgICBpZiAoZmlyc3RJbml0IHx8IChjaGFuZ2VkICYmICFmaXJzdEluaXQpKSB7XG4gICAgICBsYXN0UmVzdWx0ID0gZm4uYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxuXG4gICAgZmlyc3RJbml0ID0gZmFsc2U7XG4gICAgbGFzdEFyZ3MgPSBhcmdzO1xuICAgIHJldHVybiBsYXN0UmVzdWx0O1xuICB9O1xufVxuIiwiaW1wb3J0IHsgT3JkZXIgfSBmcm9tICcuLi9pbnRlcm5hbC9zb3J0JztcblxuZXhwb3J0IHR5cGUgU29ydEJ5PEUsIFMgPSBhbnk+ID0gKChhOiBFLCBiOiBFLCBzdGF0ZT86IFMpID0+IG51bWJlcikgfCBrZXlvZiBFO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNvcnRCeU9wdGlvbnM8RT4ge1xuICBzb3J0Qnk/OiBTb3J0Qnk8RT47XG4gIHNvcnRCeU9yZGVyPzogT3JkZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUXVlcnlDb25maWdPcHRpb25zPEUgPSBhbnk+IGV4dGVuZHMgU29ydEJ5T3B0aW9uczxFPiB7fVxuXG5leHBvcnQgY29uc3QgcXVlcnlDb25maWdLZXkgPSAnYWtpdGFRdWVyeUNvbmZpZyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBRdWVyeUNvbmZpZzxFPihtZXRhZGF0YTogUXVlcnlDb25maWdPcHRpb25zPEU+KSB7XG4gIHJldHVybiBmdW5jdGlvbihjb25zdHJ1Y3RvcjogRnVuY3Rpb24pIHtcbiAgICBjb25zdHJ1Y3RvcltxdWVyeUNvbmZpZ0tleV0gPSB7fTtcbiAgICBmb3IgKGxldCBpID0gMCwga2V5cyA9IE9iamVjdC5rZXlzKG1ldGFkYXRhKTsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGtleSA9IGtleXNbaV07XG4gICAgICBjb25zdHJ1Y3RvcltxdWVyeUNvbmZpZ0tleV1ba2V5XSA9IG1ldGFkYXRhW2tleV07XG4gICAgfVxuICB9O1xufVxuIiwiaW1wb3J0IHsgU3RvcmUgfSBmcm9tICcuL3N0b3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHRha2UgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBxdWVyeUNvbmZpZ0tleSwgUXVlcnlDb25maWdPcHRpb25zIH0gZnJvbSAnLi9xdWVyeS1jb25maWcnO1xuXG5leHBvcnQgY2xhc3MgUXVlcnk8Uz4ge1xuICAvKiogVXNlIG9ubHkgZm9yIGludGVybmFsIHBsdWdpbnMgbGlrZSBQYWdpbmF0aW9uIC0gZG9uJ3QgdXNlIHRoaXMgcHJvcGVydHkgKiovXG4gIF9fc3RvcmVfXzogU3RvcmU8Uz47XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIHN0b3JlOiBTdG9yZTxTPikge1xuICAgIHRoaXMuX19zdG9yZV9fID0gc3RvcmU7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IGEgc2xpY2UgZnJvbSB0aGUgc3RvcmUuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMucXVlcnkuc2VsZWN0KClcbiAgICogdGhpcy5xdWVyeS5zZWxlY3Qoc3RhdGUgPT4gc3RhdGUuZW50aXRpZXMpXG4gICAqL1xuICBzZWxlY3Q8Uj4ocHJvamVjdD86IChzdG9yZTogUykgPT4gUik6IE9ic2VydmFibGU8Uj47XG4gIHNlbGVjdCgpOiBPYnNlcnZhYmxlPFM+O1xuICBzZWxlY3Q8Uj4ocHJvamVjdD86IChzdG9yZTogUykgPT4gUik6IE9ic2VydmFibGU8UiB8IFM+IHtcbiAgICBsZXQgc3RhdGUgPSBwcm9qZWN0ID8gcHJvamVjdCA6IHN0YXRlID0+IHN0YXRlO1xuICAgIHJldHVybiB0aGlzLnN0b3JlLl9zZWxlY3Qoc3RhdGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdCBvbmNlIGFuZCBjb21wbGV0ZS5cbiAgICovXG4gIHNlbGVjdE9uY2U8Uj4ocHJvamVjdDogKHN0b3JlOiBTKSA9PiBSKTogT2JzZXJ2YWJsZTxSPiB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0KHByb2plY3QpLnBpcGUodGFrZSgxKSk7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IHRoZSBzdG9yZSdzIGxvYWRpbmcgc3RhdGUuXG4gICAqL1xuICBzZWxlY3RMb2FkaW5nKCkge1xuICAgIHJldHVybiB0aGlzLnNlbGVjdChzdGF0ZSA9PiAoc3RhdGUgYXMgUyAmIHsgbG9hZGluZzogYm9vbGVhbiB9KS5sb2FkaW5nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY3QgdGhlIHN0b3JlJ3MgZXJyb3Igc3RhdGUuXG4gICAqL1xuICBzZWxlY3RFcnJvcigpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3Qoc3RhdGUgPT4gKHN0YXRlIGFzIFMgJiB7IGVycm9yOiBhbnkgfSkuZXJyb3IpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgcmF3IHZhbHVlIG9mIHRoZSBzdG9yZS5cbiAgICovXG4gIGdldFNuYXBzaG90KCk6IFMge1xuICAgIHJldHVybiB0aGlzLnN0b3JlLl92YWx1ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqICBSZXR1cm5zIHdoZXRoZXIgdGhlIHN0YXRlIG9mIHRoZSBzdG9yZSBpcyBwcmlzdGluZSAodGhlIHNldCgpIG1ldGhvZCBoYXNuJ3QgYmVlbiBleHBsaWNpdGx5IGNhbGxlZFxuICAgKiAgc2luY2UgdGhlIHN0b3JlIGNyZWF0aW9uLCBvciB0aGUgbGFzdCB0aW1lIHNldFByaXN0aW5lKCl3YXMgY2FsbGVkKS5cbiAgICovXG4gIGdldCBpc1ByaXN0aW5lKCkge1xuICAgIHJldHVybiB0aGlzLnN0b3JlLmlzUHJpc3RpbmU7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBzdGF0ZSBvZiB0aGUgc3RvcmUgaXMgZGlydHkgKHRoZSBzZXQoKSBtZXRob2RcbiAgICogb3IgdGhlIHNldERpcnR5KCkgbWV0aG9kIGhhcyBiZWVuIGV4cGxpY2l0bHkgY2FsbGVkIHNpbmNlIHRoZSBzdG9yZSBjcmVhdGlvbixcbiAgICogb3IgdGhlIGxhc3QgdGltZSBzZXRQcmlzdGluZSgpIHdhcyBjYWxsZWQpLlxuICAgKi9cbiAgZ2V0IGlzRGlydHkoKSB7XG4gICAgcmV0dXJuICF0aGlzLnN0b3JlLmlzUHJpc3RpbmU7XG4gIH1cblxuICBnZXQgY29uZmlnKCk6IFF1ZXJ5Q29uZmlnT3B0aW9ucyB7XG4gICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3JbcXVlcnlDb25maWdLZXldO1xuICB9XG59XG4iLCJpbXBvcnQgeyBjb21iaW5lTGF0ZXN0LCBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBhdWRpdFRpbWUsIG1hcCwgc3dpdGNoTWFwLCB3aXRoTGF0ZXN0RnJvbSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgY29tcGFyZVZhbHVlcywgT3JkZXIgfSBmcm9tICcuLi9pbnRlcm5hbC9zb3J0JztcbmltcG9ydCB7IGVudGl0eUV4aXN0cywgaXNGdW5jdGlvbiwgaXNVbmRlZmluZWQsIHRvQm9vbGVhbiB9IGZyb20gJy4uL2ludGVybmFsL3V0aWxzJztcbmltcG9ydCB7IEVudGl0eVN0b3JlIH0gZnJvbSAnLi9lbnRpdHktc3RvcmUnO1xuaW1wb3J0IHsgbWVtb2l6ZU9uZSB9IGZyb20gJy4vbWVtb2l6ZSc7XG5pbXBvcnQgeyBRdWVyeSB9IGZyb20gJy4vcXVlcnknO1xuaW1wb3J0IHsgU29ydEJ5LCBTb3J0QnlPcHRpb25zIH0gZnJvbSAnLi9xdWVyeS1jb25maWcnO1xuaW1wb3J0IHsgQWN0aXZlU3RhdGUsIEVudGl0eVN0YXRlLCBIYXNoTWFwLCBJRCB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdE9wdGlvbnM8RT4gZXh0ZW5kcyBTb3J0QnlPcHRpb25zPEU+IHtcbiAgYXNPYmplY3Q/OiBib29sZWFuO1xuICBmaWx0ZXJCeT86ICgoZW50aXR5OiBFLCBpbmRleD86IG51bWJlcikgPT4gYm9vbGVhbikgfCAoKGVudGl0eTogRSwgaW5kZXg/OiBudW1iZXIpID0+IGJvb2xlYW4pW10gfCB1bmRlZmluZWQ7XG4gIGxpbWl0VG8/OiBudW1iZXI7XG59XG5cbi8qKlxuICogIEFuIGFic3RyYWN0aW9uIGZvciBxdWVyeWluZyB0aGUgZW50aXRpZXMgZnJvbSB0aGUgc3RvcmVcbiAqL1xuZXhwb3J0IGNsYXNzIFF1ZXJ5RW50aXR5PFMgZXh0ZW5kcyBFbnRpdHlTdGF0ZSwgRSwgQWN0aXZlRW50aXR5ID0gSUQ+IGV4dGVuZHMgUXVlcnk8Uz4ge1xuICBwcm90ZWN0ZWQgc3RvcmU6IEVudGl0eVN0b3JlPFMsIEUsIEFjdGl2ZUVudGl0eT47XG4gIHByaXZhdGUgbWVtb2l6ZWQ7XG5cbiAgLyoqIFVzZSBvbmx5IGZvciBpbnRlcm5hbCBwbHVnaW5zIGxpa2UgUGFnaW5hdGlvbiAtIGRvbid0IHVzZSB0aGlzIHByb3BlcnR5ICoqL1xuICBfX3N0b3JlX187XG5cbiAgY29uc3RydWN0b3Ioc3RvcmU6IEVudGl0eVN0b3JlPFMsIEUsIEFjdGl2ZUVudGl0eT4pIHtcbiAgICBzdXBlcihzdG9yZSk7XG4gICAgdGhpcy5fX3N0b3JlX18gPSBzdG9yZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY3QgdGhlIGVudGlyZSBzdG9yZSdzIGVudGl0eSBjb2xsZWN0aW9uLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB0aGlzLnN0b3JlLnNlbGVjdEFsbCgpO1xuICAgKi9cbiAgc2VsZWN0QWxsKG9wdGlvbnM6IHsgYXNPYmplY3Q6IHRydWU7IGZpbHRlckJ5PzogU2VsZWN0T3B0aW9uczxFPlsnZmlsdGVyQnknXTsgbGltaXRUbz86IG51bWJlcjsgc29ydEJ5PzogdW5kZWZpbmVkOyBzb3J0QnlPcmRlcj86IHVuZGVmaW5lZCB9KTogT2JzZXJ2YWJsZTxIYXNoTWFwPEU+PjtcbiAgc2VsZWN0QWxsKG9wdGlvbnM6IHsgZmlsdGVyQnk6IFNlbGVjdE9wdGlvbnM8RT5bJ2ZpbHRlckJ5J107IGxpbWl0VG8/OiBudW1iZXI7IHNvcnRCeT86IFNvcnRCeTxFPjsgc29ydEJ5T3JkZXI/OiBPcmRlciB9KTogT2JzZXJ2YWJsZTxFW10+O1xuICBzZWxlY3RBbGwob3B0aW9uczogeyBhc09iamVjdDogdHJ1ZTsgbGltaXRUbz86IG51bWJlcjsgc29ydEJ5PzogdW5kZWZpbmVkOyBzb3J0QnlPcmRlcj86IHVuZGVmaW5lZCB9KTogT2JzZXJ2YWJsZTxIYXNoTWFwPEU+PjtcbiAgc2VsZWN0QWxsKG9wdGlvbnM6IHsgbGltaXRUbz86IG51bWJlcjsgc29ydEJ5PzogU29ydEJ5PEU+OyBzb3J0QnlPcmRlcj86IE9yZGVyIH0pOiBPYnNlcnZhYmxlPEVbXT47XG4gIHNlbGVjdEFsbChvcHRpb25zOiB7IGFzT2JqZWN0OiBmYWxzZTsgZmlsdGVyQnk/OiBTZWxlY3RPcHRpb25zPEU+WydmaWx0ZXJCeSddOyBsaW1pdFRvPzogbnVtYmVyOyBzb3J0Qnk/OiBTb3J0Qnk8RT47IHNvcnRCeU9yZGVyPzogT3JkZXIgfSk6IE9ic2VydmFibGU8RVtdPjtcbiAgc2VsZWN0QWxsKCk6IE9ic2VydmFibGU8RVtdPjtcbiAgc2VsZWN0QWxsKFxuICAgIG9wdGlvbnM6IFNlbGVjdE9wdGlvbnM8RT4gPSB7XG4gICAgICBhc09iamVjdDogZmFsc2VcbiAgICB9XG4gICk6IE9ic2VydmFibGU8RVtdIHwgSGFzaE1hcDxFPj4ge1xuICAgIGNvbnN0IHNlbGVjdFN0YXRlJCA9IHRoaXMuc2VsZWN0KHN0YXRlID0+IHN0YXRlKTtcbiAgICBjb25zdCBzZWxlY3RFbnRpdGllcyQgPSB0aGlzLnNlbGVjdChzdGF0ZSA9PiBzdGF0ZS5lbnRpdGllcyk7XG5cbiAgICB0aGlzLnNvcnRCeU9wdGlvbnMob3B0aW9ucyk7XG5cbiAgICByZXR1cm4gc2VsZWN0RW50aXRpZXMkLnBpcGUoXG4gICAgICB3aXRoTGF0ZXN0RnJvbShzZWxlY3RTdGF0ZSQsIChlbnRpdGllczogSGFzaE1hcDxFPiwgc3RhdGU6IFMpID0+IHtcbiAgICAgICAgY29uc3QgeyBpZHMgfSA9IHN0YXRlO1xuICAgICAgICBpZiAob3B0aW9ucy5hc09iamVjdCkge1xuICAgICAgICAgIHJldHVybiB0b01hcChpZHMsIGVudGl0aWVzLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoIW9wdGlvbnMuZmlsdGVyQnkgJiYgIW9wdGlvbnMuc29ydEJ5KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMubWVtb2l6ZWQpIHtcbiAgICAgICAgICAgICAgdGhpcy5tZW1vaXplZCA9IG1lbW9pemVPbmUodG9BcnJheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZW1vaXplZChzdGF0ZSwgb3B0aW9ucyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHRvQXJyYXkoc3RhdGUsIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBlbnRpcmUgc3RvcmUncyBlbnRpdHkgY29sbGVjdGlvbi5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5zdG9yZS5nZXRBbGwoKTtcbiAgICovXG4gIGdldEFsbChvcHRpb25zOiB7IGFzT2JqZWN0OiB0cnVlOyBmaWx0ZXJCeT86IFNlbGVjdE9wdGlvbnM8RT5bJ2ZpbHRlckJ5J107IGxpbWl0VG8/OiBudW1iZXI7IHNvcnRCeT86IHVuZGVmaW5lZDsgc29ydEJ5T3JkZXI/OiB1bmRlZmluZWQgfSk6IEhhc2hNYXA8RT47XG4gIGdldEFsbChvcHRpb25zOiB7IGZpbHRlckJ5OiBTZWxlY3RPcHRpb25zPEU+WydmaWx0ZXJCeSddOyBsaW1pdFRvPzogbnVtYmVyOyBzb3J0Qnk/OiBTb3J0Qnk8RT47IHNvcnRCeU9yZGVyPzogT3JkZXIgfSk6IEVbXTtcbiAgZ2V0QWxsKG9wdGlvbnM6IHsgYXNPYmplY3Q6IHRydWU7IGxpbWl0VG8/OiBudW1iZXI7IHNvcnRCeT86IHVuZGVmaW5lZDsgc29ydEJ5T3JkZXI/OiB1bmRlZmluZWQgfSk6IEhhc2hNYXA8RT47XG4gIGdldEFsbChvcHRpb25zOiB7IGxpbWl0VG8/OiBudW1iZXI7IHNvcnRCeT86IFNvcnRCeTxFPjsgc29ydEJ5T3JkZXI/OiBPcmRlciB9KTogRVtdO1xuICBnZXRBbGwob3B0aW9uczogeyBhc09iamVjdDogZmFsc2U7IGZpbHRlckJ5PzogU2VsZWN0T3B0aW9uczxFPlsnZmlsdGVyQnknXTsgbGltaXRUbz86IG51bWJlcjsgc29ydEJ5PzogU29ydEJ5PEU+OyBzb3J0QnlPcmRlcj86IE9yZGVyIH0pOiBFW107XG4gIGdldEFsbCgpOiBFW107XG4gIGdldEFsbChvcHRpb25zOiBTZWxlY3RPcHRpb25zPEU+ID0geyBhc09iamVjdDogZmFsc2UsIGZpbHRlckJ5OiB1bmRlZmluZWQsIGxpbWl0VG86IHVuZGVmaW5lZCB9KTogRVtdIHwgSGFzaE1hcDxFPiB7XG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLmdldFNuYXBzaG90KCk7XG5cbiAgICBpZiAob3B0aW9ucy5hc09iamVjdCkge1xuICAgICAgcmV0dXJuIHRvTWFwKHN0YXRlLmlkcywgc3RhdGUuZW50aXRpZXMsIG9wdGlvbnMsIHRydWUpO1xuICAgIH1cblxuICAgIHRoaXMuc29ydEJ5T3B0aW9ucyhvcHRpb25zKTtcblxuICAgIHJldHVybiB0b0FycmF5KHN0YXRlLCBvcHRpb25zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY3QgbXVsdGlwbGUgZW50aXRpZXMgZnJvbSB0aGUgc3RvcmUuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMuc3RvcmUuc2VsZWN0TWFueShbMSwyXSk7XG4gICAqL1xuICBzZWxlY3RNYW55KGlkczogQWN0aXZlRW50aXR5W10sIG9wdGlvbnM6IHsgZmlsdGVyVW5kZWZpbmVkPzogYm9vbGVhbiB9ID0ge30pOiBPYnNlcnZhYmxlPEVbXT4ge1xuICAgIGNvbnN0IGZpbHRlclVuZGVmaW5lZCA9IGlzVW5kZWZpbmVkKG9wdGlvbnMuZmlsdGVyVW5kZWZpbmVkKSA/IHRydWUgOiBvcHRpb25zLmZpbHRlclVuZGVmaW5lZDtcbiAgICBjb25zdCBlbnRpdGllcyA9IGlkcy5tYXAoaWQgPT4gdGhpcy5zZWxlY3RFbnRpdHkoaWQpKTtcblxuICAgIHJldHVybiBjb21iaW5lTGF0ZXN0KGVudGl0aWVzKS5waXBlKFxuICAgICAgbWFwKGVudGl0aWVzID0+IHtcbiAgICAgICAgcmV0dXJuIGZpbHRlclVuZGVmaW5lZCA/IGVudGl0aWVzLmZpbHRlcih2YWwgPT4gIWlzVW5kZWZpbmVkKHZhbCkpIDogZW50aXRpZXM7XG4gICAgICB9KSxcbiAgICAgIGF1ZGl0VGltZSgwKVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IGFuIGVudGl0eSBvciBhIHNsaWNlIG9mIGFuIGVudGl0eS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5wYWdlc1N0b3JlLnNlbGVjdEVudGl0eSgxKVxuICAgKiB0aGlzLnBhZ2VzU3RvcmUuc2VsZWN0RW50aXR5KDEsIGVudGl0eSA9PiBlbnRpdHkuY29uZmlnLmRhdGUpXG4gICAqXG4gICAqL1xuICBzZWxlY3RFbnRpdHk8Uj4oaWQ6IEFjdGl2ZUVudGl0eSk6IE9ic2VydmFibGU8RT47XG4gIHNlbGVjdEVudGl0eTxSPihpZDogQWN0aXZlRW50aXR5LCBwcm9qZWN0OiAoZW50aXR5OiBFKSA9PiBSKTogT2JzZXJ2YWJsZTxSPjtcbiAgc2VsZWN0RW50aXR5PFI+KGlkOiBBY3RpdmVFbnRpdHksIHByb2plY3Q/OiAoZW50aXR5OiBFKSA9PiBSKTogT2JzZXJ2YWJsZTxSIHwgRT4ge1xuICAgIGlmICghcHJvamVjdCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2J5SWQoaWQpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnNlbGVjdChzdGF0ZSA9PiB7XG4gICAgICBpZiAodGhpcy5oYXNFbnRpdHkoaWQpKSB7XG4gICAgICAgIHJldHVybiBwcm9qZWN0KHRoaXMuZ2V0RW50aXR5KGlkKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFuIGVudGl0eSBieSBpZFxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB0aGlzLnN0b3JlLmdldEVudGl0eSgxKTtcbiAgICovXG4gIGdldEVudGl0eShpZDogQWN0aXZlRW50aXR5KTogRSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U25hcHNob3QoKS5lbnRpdGllc1tpZCBhcyBhbnldO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdCB0aGUgYWN0aXZlIGVudGl0eSdzIGlkLlxuICAgKi9cbiAgc2VsZWN0QWN0aXZlSWQoKTogT2JzZXJ2YWJsZTxBY3RpdmVFbnRpdHk+IHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3Qoc3RhdGUgPT4gKHN0YXRlIGFzIFMgJiBBY3RpdmVTdGF0ZTxBY3RpdmVFbnRpdHk+KS5hY3RpdmUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgYWN0aXZlIGlkXG4gICAqL1xuICBnZXRBY3RpdmVJZCgpOiBBY3RpdmVFbnRpdHkge1xuICAgIHJldHVybiAodGhpcy5nZXRTbmFwc2hvdCgpIGFzIFMgJiBBY3RpdmVTdGF0ZTxBY3RpdmVFbnRpdHk+KS5hY3RpdmU7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IHRoZSBhY3RpdmUgZW50aXR5LlxuICAgKi9cbiAgc2VsZWN0QWN0aXZlPFI+KCk6IE9ic2VydmFibGU8RT47XG4gIHNlbGVjdEFjdGl2ZTxSPihwcm9qZWN0OiAoZW50aXR5OiBFKSA9PiBSKTogT2JzZXJ2YWJsZTxSPjtcbiAgc2VsZWN0QWN0aXZlPFI+KHByb2plY3Q/OiAoZW50aXR5OiBFKSA9PiBSKTogT2JzZXJ2YWJsZTxSIHwgRT4ge1xuICAgIHJldHVybiB0aGlzLnNlbGVjdEFjdGl2ZUlkKCkucGlwZShzd2l0Y2hNYXAoYWN0aXZlSWQgPT4gdGhpcy5zZWxlY3RFbnRpdHkoYWN0aXZlSWQsIHByb2plY3QpKSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBhY3RpdmUgZW50aXR5LlxuICAgKi9cbiAgZ2V0QWN0aXZlKCk6IEUge1xuICAgIGNvbnN0IGFjdGl2ZUlkOiBBY3RpdmVFbnRpdHkgPSB0aGlzLmdldEFjdGl2ZUlkKCk7XG4gICAgcmV0dXJuIHRvQm9vbGVhbihhY3RpdmVJZCkgPyB0aGlzLmdldEVudGl0eShhY3RpdmVJZCkgOiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IHRoZSBzdG9yZSdzIGVudGl0eSBjb2xsZWN0aW9uIGxlbmd0aC5cbiAgICovXG4gIHNlbGVjdENvdW50KHByZWRpY2F0ZT86IChlbnRpdHk6IEUsIGluZGV4OiBudW1iZXIpID0+IGJvb2xlYW4pOiBPYnNlcnZhYmxlPG51bWJlcj4ge1xuICAgIGlmIChpc0Z1bmN0aW9uKHByZWRpY2F0ZSkpIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbGVjdEFsbCh7XG4gICAgICAgIGZpbHRlckJ5OiBwcmVkaWNhdGVcbiAgICAgIH0pLnBpcGUobWFwKGVudGl0aWVzID0+IGVudGl0aWVzLmxlbmd0aCkpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnNlbGVjdChzdG9yZSA9PiBzdG9yZS5pZHMubGVuZ3RoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIHN0b3JlJ3MgZW50aXR5IGNvbGxlY3Rpb24gbGVuZ3RoLlxuICAgKi9cbiAgZ2V0Q291bnQocHJlZGljYXRlPzogKGVudGl0eTogRSwgaW5kZXg6IG51bWJlcikgPT4gYm9vbGVhbik6IG51bWJlciB7XG4gICAgaWYgKGlzRnVuY3Rpb24ocHJlZGljYXRlKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsKCkuZmlsdGVyKHByZWRpY2F0ZSkubGVuZ3RoO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5nZXRTbmFwc2hvdCgpLmlkcy5sZW5ndGg7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIGVudGl0eSBleGlzdHMuXG4gICAqL1xuICBoYXNFbnRpdHkoaWQ6IEFjdGl2ZUVudGl0eSk6IGJvb2xlYW47XG4gIGhhc0VudGl0eShpZDogQWN0aXZlRW50aXR5W10pOiBib29sZWFuO1xuICBoYXNFbnRpdHkocHJvamVjdDogKGVudGl0eTogRSkgPT4gYm9vbGVhbik6IGJvb2xlYW47XG4gIGhhc0VudGl0eShwcm9qZWN0T3JJZHM6IEFjdGl2ZUVudGl0eSB8IEFjdGl2ZUVudGl0eVtdIHwgKChlbnRpdHk6IEUpID0+IGJvb2xlYW4pKTogYm9vbGVhbiB7XG4gICAgaWYgKGlzRnVuY3Rpb24ocHJvamVjdE9ySWRzKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsKCkuc29tZShwcm9qZWN0T3JJZHMpO1xuICAgIH1cblxuICAgIGlmIChBcnJheS5pc0FycmF5KHByb2plY3RPcklkcykpIHtcbiAgICAgIHJldHVybiBwcm9qZWN0T3JJZHMuZXZlcnkoaWQgPT4gKGlkIGFzIGFueSkgaW4gdGhpcy5zdG9yZS5lbnRpdGllcyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIChwcm9qZWN0T3JJZHMgYXMgYW55KSBpbiB0aGlzLnN0b3JlLmVudGl0aWVzO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgd2hldGhlciBlbnRpdHkgc3RvcmUgaGFzIGFuIGFjdGl2ZSBlbnRpdHkuXG4gICAqL1xuICBoYXNBY3RpdmUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U25hcHNob3QoKS5hY3RpdmUgIT0gbnVsbDtcbiAgfVxuXG4gIGlzRW1wdHkoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U25hcHNob3QoKS5pZHMubGVuZ3RoID09PSAwO1xuICB9XG5cbiAgcHJpdmF0ZSBfYnlJZChpZDogQWN0aXZlRW50aXR5KTogT2JzZXJ2YWJsZTxFPiB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0KHN0YXRlID0+IHRoaXMuZ2V0RW50aXR5KGlkKSk7XG4gIH1cblxuICBwcml2YXRlIHNvcnRCeU9wdGlvbnMob3B0aW9ucykge1xuICAgIG9wdGlvbnMuc29ydEJ5ID0gb3B0aW9ucy5zb3J0QnkgfHwgKHRoaXMuY29uZmlnICYmICh0aGlzLmNvbmZpZy5zb3J0QnkgYXMgU29ydEJ5PEU+KSk7XG4gICAgb3B0aW9ucy5zb3J0QnlPcmRlciA9IG9wdGlvbnMuc29ydEJ5T3JkZXIgfHwgKHRoaXMuY29uZmlnICYmIHRoaXMuY29uZmlnLnNvcnRCeU9yZGVyKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMubWVtb2l6ZWQgPSBudWxsO1xuICB9XG59XG5cbmZ1bmN0aW9uIHRvQXJyYXk8RSwgUyBleHRlbmRzIEVudGl0eVN0YXRlPihzdGF0ZTogUywgb3B0aW9uczogU2VsZWN0T3B0aW9uczxFPik6IEVbXSB7XG4gIGxldCBhcnIgPSBbXTtcbiAgY29uc3QgeyBpZHMsIGVudGl0aWVzIH0gPSBzdGF0ZTtcbiAgY29uc3QgeyBmaWx0ZXJCeSwgbGltaXRUbywgc29ydEJ5LCBzb3J0QnlPcmRlciB9ID0gb3B0aW9ucztcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGlkcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGlkID0gaWRzW2ldO1xuXG4gICAgaWYgKCFlbnRpdHlFeGlzdHMoaWQsIGVudGl0aWVzKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKCFmaWx0ZXJCeSkge1xuICAgICAgYXJyLnB1c2goZW50aXRpZXNbaWRdKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChBcnJheS5pc0FycmF5KGZpbHRlckJ5KSkge1xuICAgICAgY29uc3QgYWxsUGFzcyA9IGZpbHRlckJ5LmV2ZXJ5KGZuID0+IGZuKGVudGl0aWVzW2lkXSwgaSkpO1xuICAgICAgaWYgKGFsbFBhc3MpIHtcbiAgICAgICAgYXJyLnB1c2goZW50aXRpZXNbaWRdKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGZpbHRlckJ5KGVudGl0aWVzW2lkXSwgaSkpIHtcbiAgICAgICAgYXJyLnB1c2goZW50aXRpZXNbaWRdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoc29ydEJ5KSB7XG4gICAgbGV0IF9zb3J0Qnk6IGFueSA9IGlzRnVuY3Rpb24oc29ydEJ5KSA/IHNvcnRCeSA6IGNvbXBhcmVWYWx1ZXMoc29ydEJ5LCBzb3J0QnlPcmRlcik7XG4gICAgYXJyID0gYXJyLnNvcnQoKGEsIGIpID0+IF9zb3J0QnkoYSwgYiwgc3RhdGUpKTtcbiAgfVxuICBjb25zdCBsZW5ndGggPSBNYXRoLm1pbihsaW1pdFRvIHx8IGFyci5sZW5ndGgsIGFyci5sZW5ndGgpO1xuXG4gIHJldHVybiBsZW5ndGggPT09IGFyci5sZW5ndGggPyBhcnIgOiBhcnIuc2xpY2UoMCwgbGVuZ3RoKTtcbn1cblxuZnVuY3Rpb24gdG9NYXA8RT4oaWRzOiBhbnlbXSwgZW50aXRpZXM6IEhhc2hNYXA8RT4sIG9wdGlvbnM6IFNlbGVjdE9wdGlvbnM8RT4sIGdldCA9IGZhbHNlKTogSGFzaE1hcDxFPiB7XG4gIGNvbnN0IG1hcCA9IHt9O1xuICBjb25zdCB7IGZpbHRlckJ5LCBsaW1pdFRvIH0gPSBvcHRpb25zO1xuXG4gIGlmIChnZXQgJiYgIWZpbHRlckJ5ICYmICFsaW1pdFRvKSB7XG4gICAgcmV0dXJuIGVudGl0aWVzO1xuICB9XG5cbiAgY29uc3QgbGVuZ3RoID0gTWF0aC5taW4obGltaXRUbyB8fCBpZHMubGVuZ3RoLCBpZHMubGVuZ3RoKTtcblxuICBpZiAoZmlsdGVyQnkgJiYgaXNVbmRlZmluZWQobGltaXRUbykgPT09IGZhbHNlKSB7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gaWRzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoY291bnQgPT09IGxpbWl0VG8pIGJyZWFrO1xuICAgICAgY29uc3QgaWQgPSBpZHNbaV07XG4gICAgICBpZiAoIWVudGl0eUV4aXN0cyhpZCwgZW50aXRpZXMpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZmlsdGVyQnkpKSB7XG4gICAgICAgIGNvbnN0IGFsbFBhc3MgPSBmaWx0ZXJCeS5ldmVyeShmbiA9PiBmbihlbnRpdGllc1tpZF0sIGkpKTtcbiAgICAgICAgaWYgKGFsbFBhc3MpIHtcbiAgICAgICAgICBtYXBbaWRdID0gZW50aXRpZXNbaWRdO1xuICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChmaWx0ZXJCeShlbnRpdGllc1tpZF0sIGkpKSB7XG4gICAgICAgICAgbWFwW2lkXSA9IGVudGl0aWVzW2lkXTtcbiAgICAgICAgICBjb3VudCsrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGlkID0gaWRzW2ldO1xuXG4gICAgICBpZiAoIWVudGl0eUV4aXN0cyhpZCwgZW50aXRpZXMpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWZpbHRlckJ5KSB7XG4gICAgICAgIG1hcFtpZF0gPSBlbnRpdGllc1tpZF07XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXJCeSkpIHtcbiAgICAgICAgY29uc3QgYWxsUGFzcyA9IGZpbHRlckJ5LmV2ZXJ5KGZuID0+IGZuKGVudGl0aWVzW2lkXSwgaSkpO1xuICAgICAgICBpZiAoYWxsUGFzcykge1xuICAgICAgICAgIG1hcFtpZF0gPSBlbnRpdGllc1tpZF07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChmaWx0ZXJCeShlbnRpdGllc1tpZF0sIGkpKSB7XG4gICAgICAgICAgbWFwW2lkXSA9IGVudGl0aWVzW2lkXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBtYXA7XG59XG4iLCJpbXBvcnQgeyBlbmRCYXRjaCwgc3RhcnRCYXRjaCB9IGZyb20gJy4uL2ludGVybmFsL3RyYW5zYWN0aW9uLmludGVybmFsJztcblxuLyoqXG4gKiAgQSBsb2dpY2FsIHRyYW5zYWN0aW9uLlxuICogIFVzZSB0aGlzIHRyYW5zYWN0aW9uIHRvIG9wdGltaXplIHRoZSBkaXNwYXRjaCBvZiBhbGwgdGhlIHN0b3Jlcy5cbiAqICBUaGUgZm9sbG93aW5nIGNvZGUgd2lsbCB1cGRhdGUgdGhlIHN0b3JlLCBCVVQgIGVtaXRzIG9ubHkgb25jZVxuICpcbiAqICBAZXhhbXBsZVxuICogIGFwcGx5VHJhbnNhY3Rpb24oKCkgPT4ge1xuICogICAgdGhpcy50b2Rvc1N0b3JlLmFkZChuZXcgVG9kbygxLCB0aXRsZSkpO1xuICogICAgdGhpcy50b2Rvc1N0b3JlLmFkZChuZXcgVG9kbygyLCB0aXRsZSkpO1xuICogIH0pO1xuICpcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5VHJhbnNhY3Rpb248VD4oYWN0aW9uOiAoKSA9PiBULCB0aGlzQXJnID0gdW5kZWZpbmVkKTogVCB7XG4gIHN0YXJ0QmF0Y2goKTtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYWN0aW9uLmFwcGx5KHRoaXNBcmcpO1xuICB9IGZpbmFsbHkge1xuICAgIGVuZEJhdGNoKCk7XG4gIH1cbn1cblxuLyoqXG4gKiAgQSBsb2dpY2FsIHRyYW5zYWN0aW9uLlxuICogIFVzZSB0aGlzIHRyYW5zYWN0aW9uIHRvIG9wdGltaXplIHRoZSBkaXNwYXRjaCBvZiBhbGwgdGhlIHN0b3Jlcy5cbiAqXG4gKiAgVGhlIGZvbGxvd2luZyBjb2RlIHdpbGwgdXBkYXRlIHRoZSBzdG9yZSwgQlVUICBlbWl0cyBvbmx5IG9uY2UuXG4gKlxuICogIEBleGFtcGxlXG4gKiAgQHRyYW5zYWN0aW9uXG4gKiAgYWRkVG9kb3MoKSB7XG4gKiAgICB0aGlzLnRvZG9zU3RvcmUuYWRkKG5ldyBUb2RvKDEsIHRpdGxlKSk7XG4gKiAgICB0aGlzLnRvZG9zU3RvcmUuYWRkKG5ldyBUb2RvKDIsIHRpdGxlKSk7XG4gKiAgfVxuICpcbiAqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2FjdGlvbigpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHRhcmdldDogYW55LCBwcm9wZXJ0eUtleTogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IpIHtcbiAgICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG5cbiAgICBkZXNjcmlwdG9yLnZhbHVlID0gZnVuY3Rpb24oLi4uYXJncykge1xuICAgICAgcmV0dXJuIGFwcGx5VHJhbnNhY3Rpb24oKCkgPT4ge1xuICAgICAgICByZXR1cm4gb3JpZ2luYWxNZXRob2QuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gIH07XG59XG4iLCJpbXBvcnQgeyBpc09iamVjdCB9IGZyb20gJy4uL2ludGVybmFsL3V0aWxzJztcblxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2dlb3JhcGJveC9pbW11dGFibGUtYXJyYXlzXG5cbi8qKlxuICogQWRkcyBvbmUgb3IgbW9yZSBlbGVtZW50cyB0byB0aGUgZW5kIG9mIGFuIGFycmF5IGJ5IHJldHVybmluZ1xuICogYSBuZXcgYXJyYXkgaW5zdGVhZCBvZiBtdXRhdGluZyB0aGUgb3JpZ2luYWwgb25lLlxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gcHVzaChvcmlnaW5hbEFycmF5LCAnZicsICdnJyk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJywgJ2YnLCAnZyddXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwdXNoPFQ+KGFycmF5OiBUW10sIC4uLmVsZW1lbnROOiBUW10pOiBUW10ge1xuICByZXR1cm4gWy4uLmFycmF5LCAuLi5lbGVtZW50Tl07XG59XG5cbi8qKlxuICogRGVsZXRlcyBhbiBlbGVtZW50IGZyb20gYW4gYXJyYXkgYnkgaXRzIGluZGV4IGluIHRoZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHJlbW92ZShvcmlnaW5hbEFycmF5LCAyKTtcbiAqIC8vIC0+IG9yaWdpbmFsQXJyYXkgWydhJywgJ2InLCAnYycsICdkJywgJ2UnXVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWydhJywgJ2InLCAnZCcsICdlJ11cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZTxUPihhcnJheTogVFtdLCBpbmRleDogbnVtYmVyKTogVFtdIHtcbiAgcmV0dXJuIGluZGV4ID49IDAgPyBbLi4uYXJyYXkuc2xpY2UoMCwgaW5kZXgpLCAuLi5hcnJheS5zbGljZShpbmRleCArIDEpXSA6IFsuLi5hcnJheV07XG59XG5cbi8qKlxuICogUmVtb3ZlcyB0aGUgbGFzdCBlbGVtZW50IGZyb20gYW4gYXJyYXkgYnkgcmV0dXJuaW5nXG4gKiBhIG5ldyBhcnJheSBpbnN0ZWFkIG9mIG11dGF0aW5nIHRoZSBvcmlnaW5hbCBvbmUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGNvbnN0IG9yaWdpbmFsQXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSBwb3Aob3JpZ2luYWxBcnJheSk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCddXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwb3A8VD4oYXJyYXk6IFRbXSk6IFRbXSB7XG4gIHJldHVybiBhcnJheS5zbGljZSgwLCAtMSk7XG59XG5cbi8qKlxuICogQWRkcyBvbmUgb3IgbW9yZSBlbGVtZW50cyB0byB0aGUgYmVnaW5uaW5nIG9mIGFuIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gdW5zaGlmdChvcmlnaW5hbEFycmF5LCAnZicsICdnJyk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnZicsICdnJywgJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bnNoaWZ0PFQ+KGFycmF5OiBUW10sIC4uLmVsZW1lbnROOiBUW10pOiBUW10ge1xuICByZXR1cm4gWy4uLmVsZW1lbnROLCAuLi5hcnJheV07XG59XG5cbi8qKlxuICogU29ydHMgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IChub3QgaW4gcGxhY2UpIGFuZCByZXR1cm5zIGEgc29ydGVkIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBudW1iZXJBcnJheSA9IFsyMCwgMywgNCwgMTAsIC0zLCAxLCAwLCA1XTtcbiAqIGNvbnN0IHN0cmluZ0FycmF5ID0gWydCbHVlJywgJ0h1bXBiYWNrJywgJ0JlbHVnYSddO1xuICpcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gc29ydChudW1iZXJBcnJheSwgKGEsIGIpID0+IGEgLSBiKTtcbiAqIC8vIC0+IG51bWJlckFycmF5IFsyMCwgMywgNCwgMTAsIC0zLCAxLCAwLCA1XVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWy0zLCAwLCAxLCAzLCA0LCA1LCAxMCwgMjBdXG4gKlxuICogY29uc3QgcmVzdWx0QXJyYXkgPSBzb3J0KG51bWJlckFycmF5LCAoYSwgYikgPT4gYiAtIGEpO1xuICogLy8gLT4gbnVtYmVyQXJyYXkgWzIwLCAzLCA0LCAxMCwgLTMsIDEsIDAsIDVdXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbMjAsIDEwLCA1LCA0LCAzLCAxLCAwLCAtM11cbiAqXG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNvcnQoc3RyaW5nQXJyYXkpO1xuICogLy8gLT4gc3RyaW5nQXJyYXkgWydCbHVlJywgJ0h1bXBiYWNrJywgJ0JlbHVnYSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ0JlbHVnYScsICdCbHVlJywgJ0h1bXBiYWNrJ11cbiAqXG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNvcnQoc3RyaW5nQXJyYXksIChhLCBiKSA9PiBhLnRvTG93ZXJDYXNlKCkgPCBiLnRvTG93ZXJDYXNlKCkpO1xuICogLy8gLT4gc3RyaW5nQXJyYXkgWydCbHVlJywgJ0h1bXBiYWNrJywgJ0JlbHVnYSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ0h1bXBiYWNrJywgJ0JsdWUnLCAnQmVsdWdhJ11cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNvcnQ8VD4oYXJyYXk6IFRbXSwgY29tcGFyZUZ1bmN0aW9uPzogKGE6IFQsIGI6IFQpID0+IG51bWJlcik6IFRbXSB7XG4gIHJldHVybiBbLi4uYXJyYXldLnNvcnQoY29tcGFyZUZ1bmN0aW9uKTtcbn1cblxuLyoqXG4gKiBSZXZlcnNlcyBhbiBhcnJheSAobm90IGluIHBsYWNlKS5cbiAqIFRoZSBmaXJzdCBhcnJheSBlbGVtZW50IGJlY29tZXMgdGhlIGxhc3QsIGFuZCB0aGUgbGFzdCBhcnJheSBlbGVtZW50IGJlY29tZXMgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gcmV2ZXJzZShvcmlnaW5hbEFycmF5KTtcbiAqIC8vIC0+IG9yaWdpbmFsQXJyYXkgWydhJywgJ2InLCAnYycsICdkJywgJ2UnXVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWydlJywgJ2QnLCAnYycsICdiJywgJ2EnXVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmV2ZXJzZTxUPihhcnJheTogVFtdKTogVFtdIHtcbiAgcmV0dXJuIFsuLi5hcnJheV0ucmV2ZXJzZSgpO1xufVxuXG4vKipcbiAqIFN3YXAgaXRlbXMgaW4gdGhlIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGNvbnN0IG9yaWdpbmFsQXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSBzd2FwKG9yaWdpbmFsQXJyYXksIDEsIDQpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2EnLCAnZScsICdjJywgJ2QnLCAnYiddXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzd2FwPFQ+KGFycmF5OiBUW10sIGZpcnN0SW5kZXg6IG51bWJlciwgc2Vjb25kSW5kZXg6IG51bWJlcik6IFRbXSB7XG4gIGNvbnN0IHJlc3VsdHMgPSBhcnJheS5zbGljZSgpO1xuICBjb25zdCBmaXJzdEl0ZW0gPSBhcnJheVtmaXJzdEluZGV4XTtcbiAgcmVzdWx0c1tmaXJzdEluZGV4XSA9IGFycmF5W3NlY29uZEluZGV4XTtcbiAgcmVzdWx0c1tzZWNvbmRJbmRleF0gPSBmaXJzdEl0ZW07XG5cbiAgcmV0dXJuIHJlc3VsdHM7XG59XG5cbi8qKlxuICogVXBkYXRlIGl0ZW0gaW4gdGhlIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGNvbnN0IG9yaWdpbmFsQXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSB1cGRhdGUob3JpZ2luYWxBcnJheSwgMSwgJ25ld0l0ZW0nKTtcbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnYScsICduZXdJdGVtJywgJ2MnLCAnZCcsICdiJ11cbiAqXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gW3t0aXRsZTogMX0sIHt0aXRsZTogMn1dO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSB1cGRhdGUob3JpZ2luYWxBcnJheSwgb3JpZ2luYWxBcnJheVswXSwge3RpdGxlOiAzfSk7XG4gKiAvLyAtPiByZXN1bHRBcnJheSAgW3t0aXRsZTogM30sIHt0aXRsZTogMn1dO1xuICovXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlPFQ+KGFycmF5OiBUW10sIGluZGV4T3JJdGVtOiBudW1iZXIgfCBvYmplY3QsIHVwZGF0ZWQ6IFQpOiBUW10ge1xuICByZXR1cm4gYXJyYXkubWFwKChjdXJyZW50LCBpZHgpID0+IHtcbiAgICBpZiAodHlwZW9mIGluZGV4T3JJdGVtID09PSAnbnVtYmVyJyAmJiBpZHggPT09IGluZGV4T3JJdGVtKSB7XG4gICAgICByZXR1cm4gdXBkYXRlZDtcbiAgICB9XG5cbiAgICBpZiAoaXNPYmplY3QoaW5kZXhPckl0ZW0pICYmIChpbmRleE9ySXRlbSBhcyBhbnkpID09PSBjdXJyZW50KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi4oaW5kZXhPckl0ZW0gYXMgb2JqZWN0KSxcbiAgICAgICAgLi4uKHVwZGF0ZWQgYXMgYW55KVxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gY3VycmVudDtcbiAgfSk7XG59XG5cbi8qKlxuICogUmVtb3ZlcyBleGlzdGluZyBlbGVtZW50cyBhbmQvb3IgYWRkcyBuZXcgZWxlbWVudHMgdG8gYW4gYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGNvbnN0IG9yaWdpbmFsQXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSBzcGxpY2Uob3JpZ2luYWxBcnJheSwgMCk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFtdXG4gKlxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNwbGljZShvcmlnaW5hbEFycmF5LCAwLCAxKTtcbiAqIC8vIC0+IG9yaWdpbmFsQXJyYXkgWydhJywgJ2InLCAnYycsICdkJywgJ2UnXVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWydiJywgJ2MnLCAnZCcsICdlJ11cbiAqXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gc3BsaWNlKG9yaWdpbmFsQXJyYXksIDAsIDMpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2QnLCAnZSddXG4gKlxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNwbGljZShvcmlnaW5hbEFycmF5LCAwLCBvcmlnaW5hbEFycmF5Lmxlbmd0aCk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFtdXG4gKlxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNwbGljZShvcmlnaW5hbEFycmF5LCAwLCAtMyk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gc3BsaWNlKG9yaWdpbmFsQXJyYXksIDAsIDAsICdsb3JlbScsICdpcHN1bScpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2xvcmVtJywgJ2lwc3VtJywgJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKlxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNwbGljZShvcmlnaW5hbEFycmF5LCBvcmlnaW5hbEFycmF5Lmxlbmd0aCwgMCwgJ2xvcmVtJywgJ2lwc3VtJyk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJywgJ2xvcmVtJywgJ2lwc3VtJ11cbiAqXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gc3BsaWNlKG9yaWdpbmFsQXJyYXksIDAsIDIsICdsb3JlbScsICdpcHN1bScpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2xvcmVtJywgJ2lwc3VtJywgJ2MnLCAnZCcsICdlJ11cbiAqXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gc3BsaWNlKG9yaWdpbmFsQXJyYXksIG9yaWdpbmFsQXJyYXkubGVuZ3RoIC0gMiwgMiwgJ2xvcmVtJywgJ2lwc3VtJyk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnYScsICdiJywgJ2MnLCAnbG9yZW0nLCAnaXBzdW0nXVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3BsaWNlPFQ+KGFycmF5OiBUW10sIHN0YXJ0ID0gYXJyYXkubGVuZ3RoLCBkZWxldGVDb3VudCA9IGFycmF5Lmxlbmd0aCAtIHN0YXJ0LCAuLi5lbGVtZW50TjogVFtdKTogVFtdIHtcbiAgcmV0dXJuIFsuLi5hcnJheS5zbGljZSgwLCBzdGFydCksIC4uLmVsZW1lbnROLCAuLi5hcnJheS5zbGljZShzdGFydCArIChkZWxldGVDb3VudCA8IDAgPyAwIDogZGVsZXRlQ291bnQpKV07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGU8VD4oYXJyOiBUW10sIGl0ZW06IFQpIHtcbiAgcmV0dXJuIGFyci5pbmRleE9mKGl0ZW0pID4gLTEgPyBhcnIuZmlsdGVyKGN1cnJlbnQgPT4gaXRlbSAhPT0gY3VycmVudCkgOiBwdXNoKGFyciwgaXRlbSk7XG59XG4iLCIvKiogQ2hlY2tzIGlmIHZhbHVlIGlzIG51bGwgb3IgdW5kZWZpbmVkICovXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBmaWx0ZXIgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmV4cG9ydCBjb25zdCBmaWx0ZXJOaWwgPSA8VD4oc291cmNlOiBPYnNlcnZhYmxlPFQ+KSA9PiBzb3VyY2UucGlwZShmaWx0ZXIodmFsdWUgPT4gdmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJykpO1xuIiwiaW1wb3J0IHsgQWN0aW9uLCBfX2dsb2JhbFN0YXRlIH0gZnJvbSAnLi9nbG9iYWwtc3RhdGUnO1xuXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlBY3Rpb248VD4oZnVuYzogKCkgPT4gVCwgYWN0aW9uOiBBY3Rpb24sIHRoaXNBcmcgPSB1bmRlZmluZWQpOiBUIHtcbiAgX19nbG9iYWxTdGF0ZS5zZXRDdXN0b21BY3Rpb24oYWN0aW9uLCB0cnVlKTtcbiAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpc0FyZyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhY3Rpb24oYWN0aW9uOiBBY3Rpb24sIHNraXBUcmFuc2FjdGlvbk1zZyA9IHRydWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHRhcmdldDogYW55LCBwcm9wZXJ0eUtleTogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IpIHtcbiAgICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICAgIF9fZ2xvYmFsU3RhdGUuc2V0Q3VzdG9tQWN0aW9uKGFjdGlvbiwgc2tpcFRyYW5zYWN0aW9uTXNnKTtcbiAgICAgIHJldHVybiBvcmlnaW5hbE1ldGhvZC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gIH07XG59XG4iLCJpbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5cbmZ1bmN0aW9uIHNlcmlhbGl6ZShvYmplY3QpIHtcbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iamVjdCwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiB2YWx1ZS50b1N0cmluZygpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVXb3JrZXIoKSB7XG4gIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihcbiAgICBbXG4gICAgICBgc2VsZi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKSB7XG5cbiAgICAgIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHN0cikge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShzdHIgfHwgJycsIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICBpZiAodmFsdWUgJiZcbiAgICAgICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJlxuICAgICAgICAgICAgdmFsdWUuc3Vic3RyKDAsIDgpID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdmFyIHN0YXJ0Qm9keSA9IHZhbHVlLmluZGV4T2YoJ3snKSArIDE7XG4gICAgICAgICAgICB2YXIgZW5kQm9keSA9IHZhbHVlLmxhc3RJbmRleE9mKCd9Jyk7XG4gICAgICAgICAgICB2YXIgc3RhcnRBcmdzID0gdmFsdWUuaW5kZXhPZignKCcpICsgMTtcbiAgICAgICAgICAgIHZhciBlbmRBcmdzID0gdmFsdWUuaW5kZXhPZignKScpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbih2YWx1ZS5zdWJzdHJpbmcoc3RhcnRBcmdzLCBlbmRBcmdzKSwgdmFsdWUuc3Vic3RyaW5nKHN0YXJ0Qm9keSwgZW5kQm9keSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGVzZXJpYWxpemVkID0gZGVzZXJpYWxpemUoZS5kYXRhKTtcbiAgICAgIHZhciBtYXBwZWQgPSBkZXNlcmlhbGl6ZWQuZGF0YS5tYXAoZnVuY3Rpb24oZCkge1xuICAgICAgICByZXR1cm4gZGVzZXJpYWxpemVkLmZhY3RvcnkoZCk7XG4gICAgICB9KTtcblxuICAgICAgc2VsZi5wb3N0TWVzc2FnZShtYXBwZWQpO1xuICAgIH1gXG4gICAgXSxcbiAgICB7XG4gICAgICB0eXBlOiAndGV4dC9qYXZhc2NyaXB0J1xuICAgIH1cbiAgKTtcblxuICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuICByZXR1cm4gbmV3IFdvcmtlcih1cmwpO1xufVxuXG4vKipcbiAqICBAZXhhbXBsZVxuICogICBjb25zdCBtb2NrVG9kb3MgPSBBcnJheS5mcm9tKHtsZW5ndGg6IDEwMDAwfSwgKF8sIHgpID0+ICh7aWQ6IHh9KSk7XG4gKlxuICogICBvZihtb2NrVG9kb3MpLnBpcGUobWFwSW5Xb3JrZXI8VG9kbz4oY3JlYXRlVG9kbykpXG4gKiAgIC5zdWJzY3JpYmUocmVzID0+IGNvbnNvbGUubG9nKHJlcykpO1xuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwSW5Xb3JrZXI8VD4oZmFjdG9yeUZuOiBGdW5jdGlvbikge1xuICByZXR1cm4gZnVuY3Rpb24oc291cmNlKTogT2JzZXJ2YWJsZTxUW10+IHtcbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGUob2JzZXJ2ZXIgPT4ge1xuICAgICAgY29uc3Qgd29ya2VyID0gY3JlYXRlV29ya2VyKCk7XG5cbiAgICAgIHdvcmtlci5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIG9ic2VydmVyLm5leHQoZS5kYXRhKTtcbiAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgd29ya2VyLnRlcm1pbmF0ZSgpO1xuICAgICAgfTtcblxuICAgICAgd29ya2VyLm9uZXJyb3IgPSBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgd29ya2VyLnRlcm1pbmF0ZSgpO1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUodmFsdWUgPT4ge1xuICAgICAgICBjb25zdCBpbnB1dCA9IHtcbiAgICAgICAgICBmYWN0b3J5OiBmYWN0b3J5Rm4sXG4gICAgICAgICAgZGF0YTogdmFsdWVcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc2VyaWFsaXplZCA9IHNlcmlhbGl6ZShpbnB1dCk7XG5cbiAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHNlcmlhbGl6ZWQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG59XG4iLCJpbXBvcnQgeyBfX3N0b3Jlc19fIH0gZnJvbSAnLi9zdG9yZSc7XG5pbXBvcnQgeyBpc1N0cmluZyB9IGZyb20gJy4uL2ludGVybmFsL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFNuYXBzaG90TWFuYWdlciB7XG4gIC8qKlxuICAgKiBHZXQgYSBzbmFwc2hvdCBvZiB0aGUgd2hvbGUgc3RhdGUgb3IgYSBzcGVjaWZpYyBzdG9yZXNcbiAgICogVXNlIGl0IE9OTFkgZm9yIHRoaW5ncyBsaWtlIHNhdmluZyB0aGUgc3RhdGUgaW4gdGhlIHNlcnZlclxuICAgKi9cbiAgZ2V0U3RvcmVzU25hcHNob3Qoc3RvcmVzOiBzdHJpbmdbXSA9IFtdKSB7XG4gICAgbGV0IGFjYyA9IHt9O1xuICAgIGNvbnN0IGhhc0luY2x1ZGUgPSBzdG9yZXMubGVuZ3RoID4gMDtcbiAgICBjb25zdCBrZXlzID0gaGFzSW5jbHVkZSA/IHN0b3JlcyA6IE9iamVjdC5rZXlzKF9fc3RvcmVzX18pO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHN0b3JlTmFtZSA9IGtleXNbaV07XG4gICAgICBhY2Nbc3RvcmVOYW1lXSA9IF9fc3RvcmVzX19bc3RvcmVOYW1lXS5fdmFsdWUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWNjO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCBzbmFwc2hvdCB3ZSBnZXQgZnJvbSB0aGUgc2VydmVyXG4gICAqL1xuICBzZXRTdG9yZXNTbmFwc2hvdChzdG9yZXM6IHsgW3N0b3JlTmFtZTogc3RyaW5nXTogYW55IH0gfCBzdHJpbmcpIHtcbiAgICBsZXQgbm9ybWFsaXplZFN0b3JlcyA9IHN0b3JlcztcbiAgICBpZiAoaXNTdHJpbmcoc3RvcmVzKSkge1xuICAgICAgbm9ybWFsaXplZFN0b3JlcyA9IEpTT04ucGFyc2Uobm9ybWFsaXplZFN0b3JlcyBhcyBzdHJpbmcpO1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwLCBrZXlzID0gT2JqZWN0LmtleXMobm9ybWFsaXplZFN0b3Jlcyk7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBzdG9yZU5hbWUgPSBrZXlzW2ldO1xuICAgICAgaWYgKF9fc3RvcmVzX19bc3RvcmVOYW1lXSkge1xuICAgICAgICBfX3N0b3Jlc19fW3N0b3JlTmFtZV0uc2V0U3RhdGUoKCkgPT4gbm9ybWFsaXplZFN0b3Jlc1tzdG9yZU5hbWVdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHNuYXBzaG90TWFuYWdlciA9IG5ldyBTbmFwc2hvdE1hbmFnZXIoKTtcbiIsImltcG9ydCB7IFF1ZXJ5RW50aXR5IH0gZnJvbSAnLi4vYXBpL3F1ZXJ5LWVudGl0eSc7XG5pbXBvcnQgeyBRdWVyeSB9IGZyb20gJy4uL2FwaS9xdWVyeSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBmaWx0ZXJOaWwgfSBmcm9tICcuLi9hcGkvb3BlcmF0b3JzJztcbmltcG9ydCB7IHRvQm9vbGVhbiB9IGZyb20gJy4uL2ludGVybmFsL3V0aWxzJztcbmltcG9ydCB7IElEIH0gZnJvbSAnLi4vYXBpL3R5cGVzJztcbmltcG9ydCB7IGdldEFraXRhQ29uZmlnIH0gZnJvbSAnLi4vYXBpL2NvbmZpZyc7XG5cbmV4cG9ydCB0eXBlIFF1ZXJpZXM8RSwgUz4gPSBRdWVyeTxTPiB8IFF1ZXJ5RW50aXR5PFMsIEU+O1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWtpdGFQbHVnaW48RSA9IGFueSwgUyA9IGFueT4ge1xuICBwcm90ZWN0ZWQgY29uc3RydWN0b3IocHJvdGVjdGVkIHF1ZXJ5OiBRdWVyaWVzPEUsIFM+LCBjb25maWc/OiB7IHJlc2V0Rm4/OiBGdW5jdGlvbiB9KSB7XG4gICAgaWYgKGNvbmZpZyAmJiBjb25maWcucmVzZXRGbikge1xuICAgICAgaWYgKGdldEFraXRhQ29uZmlnKCkucmVzZXR0YWJsZSkge1xuICAgICAgICB0aGlzLm9uUmVzZXQoY29uZmlnLnJlc2V0Rm4pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKiBUaGlzIG1ldGhvZCBpcyByZXNwb25zaWJsZSBmb3IgZ2V0dGluZyBhY2Nlc3MgdG8gdGhlIHF1ZXJ5LiAqL1xuICBwcm90ZWN0ZWQgZ2V0UXVlcnkoKTogUXVlcmllczxFLCBTPiB7XG4gICAgcmV0dXJuIHRoaXMucXVlcnk7XG4gIH1cblxuICAvKiogVGhpcyBtZXRob2QgaXMgcmVzcG9uc2libGUgZm9yIGdldHRpbmcgYWNjZXNzIHRvIHRoZSBzdG9yZS4gKi9cbiAgcHJvdGVjdGVkIGdldFN0b3JlKCkge1xuICAgIHJldHVybiB0aGlzLmdldFF1ZXJ5KCkuX19zdG9yZV9fO1xuICB9XG5cbiAgLyoqIFRoaXMgbWV0aG9kIGlzIHJlc3BvbnNpYmxlIGZvciBjbGVhbmluZy4gKi9cbiAgcHVibGljIGFic3RyYWN0IGRlc3Ryb3koKTtcblxuICAvKiogVGhpcyBtZXRob2QgaXMgcmVzcG9uc2libGUgdGVsbHMgd2hldGhlciB0aGUgcGx1Z2luIGlzIGVudGl0eUJhc2VkIG9yIG5vdC4gICovXG4gIHByb3RlY3RlZCBpc0VudGl0eUJhc2VkKGVudGl0eUlkOiBJRCkge1xuICAgIHJldHVybiB0b0Jvb2xlYW4oZW50aXR5SWQpO1xuICB9XG5cbiAgLyoqIFRoaXMgbWV0aG9kIGlzIHJlc3BvbnNpYmxlIGZvciBzZWxlY3RpbmcgdGhlIHNvdXJjZTsgaXQgY2FuIGJlIHRoZSB3aG9sZSBzdG9yZSBvciBvbmUgZW50aXR5LiAqL1xuICBwcm90ZWN0ZWQgc2VsZWN0U291cmNlKGVudGl0eUlkOiBJRCk6IE9ic2VydmFibGU8UyB8IEU+IHtcbiAgICBpZiAodGhpcy5pc0VudGl0eUJhc2VkKGVudGl0eUlkKSkge1xuICAgICAgcmV0dXJuICh0aGlzLmdldFF1ZXJ5KCkgYXMgUXVlcnlFbnRpdHk8UywgRT4pLnNlbGVjdEVudGl0eShlbnRpdHlJZCkucGlwZShmaWx0ZXJOaWwpO1xuICAgIH1cblxuICAgIHJldHVybiAodGhpcy5nZXRRdWVyeSgpIGFzIFF1ZXJ5PFM+KS5zZWxlY3Qoc3RhdGUgPT4gc3RhdGUpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldFNvdXJjZShlbnRpdHlJZDogSUQpOiBTIHwgRSB7XG4gICAgaWYgKHRoaXMuaXNFbnRpdHlCYXNlZChlbnRpdHlJZCkpIHtcbiAgICAgIHJldHVybiAodGhpcy5nZXRRdWVyeSgpIGFzIFF1ZXJ5RW50aXR5PFMsIEU+KS5nZXRFbnRpdHkoZW50aXR5SWQpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmdldFF1ZXJ5KCkuZ2V0U25hcHNob3QoKTtcbiAgfVxuXG4gIC8qKiBUaGlzIG1ldGhvZCBpcyByZXNwb25zaWJsZSBmb3IgdXBkYXRpbmcgdGhlIHN0b3JlIG9yIG9uZSBlbnRpdHk7IGl0IGNhbiBiZSB0aGUgd2hvbGUgc3RvcmUgb3Igb25lIGVudGl0eS4gKi9cbiAgcHJvdGVjdGVkIHVwZGF0ZVN0b3JlKG5ld1N0YXRlLCBlbnRpdHlJZD8pIHtcbiAgICBpZiAodGhpcy5pc0VudGl0eUJhc2VkKGVudGl0eUlkKSkge1xuICAgICAgdGhpcy5nZXRTdG9yZSgpLnVwZGF0ZShlbnRpdHlJZCwgbmV3U3RhdGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmdldFN0b3JlKCkuc2V0U3RhdGUoc3RhdGUgPT4gKHsgLi4uc3RhdGUsIC4uLm5ld1N0YXRlIH0pKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRnVuY3Rpb24gdG8gaW52b2tlIHVwb24gcmVzZXRcbiAgICovXG4gIHByaXZhdGUgb25SZXNldChmbjogRnVuY3Rpb24pIHtcbiAgICBjb25zdCBvcmlnaW5hbCA9IHRoaXMuZ2V0U3RvcmUoKS5yZXNldDtcbiAgICB0aGlzLmdldFN0b3JlKCkucmVzZXQgPSAoLi4ucGFyYW1zKSA9PiB7XG4gICAgICAvKiogSXQgc2hvdWxkIHJ1biBhZnRlciB0aGUgcGx1Z2luIGRlc3Ryb3kgbWV0aG9kICovXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgb3JpZ2luYWwuYXBwbHkodGhpcy5nZXRTdG9yZSgpLCBwYXJhbXMpO1xuICAgICAgICBmbigpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUXVlcnlFbnRpdHkgfSBmcm9tICcuLi8uLi9hcGkvcXVlcnktZW50aXR5JztcbmltcG9ydCB7IGRlbGF5LCBtYXAsIHN3aXRjaE1hcCwgdGFrZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgZnJvbSwgT2JzZXJ2YWJsZSwgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBpc09ic2VydmFibGUsIGlzVW5kZWZpbmVkIH0gZnJvbSAnLi4vLi4vaW50ZXJuYWwvdXRpbHMnO1xuaW1wb3J0IHsgSUQgfSBmcm9tICcuLi8uLi9hcGkvdHlwZXMnO1xuaW1wb3J0IHsgQWtpdGFQbHVnaW4gfSBmcm9tICcuLi9wbHVnaW4nO1xuaW1wb3J0IHsgYXBwbHlUcmFuc2FjdGlvbiB9IGZyb20gJy4uLy4uL2FwaS90cmFuc2FjdGlvbic7XG5pbXBvcnQgeyBhY3Rpb24sIGFwcGx5QWN0aW9uIH0gZnJvbSAnLi4vLi4vaW50ZXJuYWwvYWN0aW9uJztcblxuZXhwb3J0IGludGVyZmFjZSBQYWdpbmF0aW9uUmVzcG9uc2U8RT4ge1xuICBjdXJyZW50UGFnZTogbnVtYmVyO1xuICBwZXJQYWdlOiBudW1iZXI7XG4gIGxhc3RQYWdlOiBudW1iZXI7XG4gIGRhdGE6IEVbXTtcbiAgdG90YWw/OiBudW1iZXI7XG4gIGZyb20/OiBudW1iZXI7XG4gIHRvPzogbnVtYmVyO1xuICBwYWdlQ29udHJvbHM/OiBudW1iZXJbXTtcbn1cblxuZXhwb3J0IHR5cGUgUGFnaW5hdG9yQ29uZmlnID0ge1xuICBwYWdlc0NvbnRyb2xzPzogYm9vbGVhbjtcbiAgcmFuZ2U/OiBib29sZWFuO1xuICBzdGFydFdpdGg/OiBudW1iZXI7XG4gIGNhY2hlVGltZW91dD86IE9ic2VydmFibGU8bnVtYmVyPjtcbn07XG5cbmNvbnN0IHBhZ2luYXRvckRlZmF1bHRzOiBQYWdpbmF0b3JDb25maWcgPSB7XG4gIHBhZ2VzQ29udHJvbHM6IGZhbHNlLFxuICByYW5nZTogZmFsc2UsXG4gIHN0YXJ0V2l0aDogMSxcbiAgY2FjaGVUaW1lb3V0OiB1bmRlZmluZWRcbn07XG5cbmV4cG9ydCBjbGFzcyBQYWdpbmF0b3JQbHVnaW48RT4gZXh0ZW5kcyBBa2l0YVBsdWdpbjxFPiB7XG4gIC8qKiBTYXZlIGN1cnJlbnQgZmlsdGVycywgc29ydGluZywgZXRjLiBpbiBjYWNoZSAqL1xuICBtZXRhZGF0YSA9IG5ldyBNYXAoKTtcblxuICBwcml2YXRlIHBhZ2U6IEJlaGF2aW9yU3ViamVjdDxudW1iZXI+O1xuICBwcml2YXRlIHBhZ2VzID0gbmV3IE1hcDxudW1iZXIsIHsgaWRzOiBJRFtdIH0+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgY2xlYXJDYWNoZVN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIHByaXZhdGUgcGFnaW5hdGlvbjogUGFnaW5hdGlvblJlc3BvbnNlPEU+ID0ge1xuICAgIGN1cnJlbnRQYWdlOiAxLFxuICAgIHBlclBhZ2U6IDAsXG4gICAgdG90YWw6IDAsXG4gICAgbGFzdFBhZ2U6IDAsXG4gICAgZGF0YTogW11cbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgdXNlciBuYXZpZ2F0ZXMgdG8gYSBkaWZmZXJlbnQgcGFnZSBhbmQgcmV0dXJuXG4gICAqIHdlIGRvbid0IHdhbnQgdG8gY2FsbCBgY2xlYXJDYWNoZWAgb24gZmlyc3QgdGltZS5cbiAgICovXG4gIHByaXZhdGUgaW5pdGlhbCA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBxdWVyeTogUXVlcnlFbnRpdHk8YW55LCBFPiwgcHVibGljIGNvbmZpZzogUGFnaW5hdG9yQ29uZmlnID0ge30pIHtcbiAgICBzdXBlcihxdWVyeSwge1xuICAgICAgcmVzZXRGbjogKCkgPT4ge1xuICAgICAgICB0aGlzLmluaXRpYWwgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5kZXN0cm95KHsgY2xlYXJDYWNoZTogdHJ1ZSwgY3VycmVudFBhZ2U6IDEgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5jb25maWcgPSBPYmplY3QuYXNzaWduKHBhZ2luYXRvckRlZmF1bHRzLCBjb25maWcpO1xuICAgIGNvbnN0IHsgc3RhcnRXaXRoLCBjYWNoZVRpbWVvdXQgfSA9IHRoaXMuY29uZmlnO1xuICAgIHRoaXMucGFnZSA9IG5ldyBCZWhhdmlvclN1YmplY3Qoc3RhcnRXaXRoKTtcbiAgICBpZiAoaXNPYnNlcnZhYmxlKGNhY2hlVGltZW91dCkpIHtcbiAgICAgIHRoaXMuY2xlYXJDYWNoZVN1YnNjcmlwdGlvbiA9IGNhY2hlVGltZW91dC5zdWJzY3JpYmUoXyA9PiB0aGlzLmNsZWFyQ2FjaGUoKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFByb3h5IHRvIHRoZSBxdWVyeSBsb2FkaW5nXG4gICAqL1xuICBpc0xvYWRpbmckID0gdGhpcy5xdWVyeS5zZWxlY3RMb2FkaW5nKCkucGlwZShkZWxheSgwKSk7XG5cbiAgLyoqXG4gICAqIExpc3RlbiB0byBwYWdlIGNoYW5nZXNcbiAgICovXG4gIGdldCBwYWdlQ2hhbmdlcygpIHtcbiAgICByZXR1cm4gdGhpcy5wYWdlLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY3VycmVudCBwYWdlIG51bWJlclxuICAgKi9cbiAgZ2V0IGN1cnJlbnRQYWdlKCkge1xuICAgIHJldHVybiB0aGlzLnBhZ2luYXRpb24uY3VycmVudFBhZ2U7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgY3VycmVudCBwYWdlIGlzIHRoZSBmaXJzdCBvbmVcbiAgICovXG4gIGdldCBpc0ZpcnN0KCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRQYWdlID09PSAxO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGN1cnJlbnQgcGFnZSBpcyB0aGUgbGFzdCBvbmVcbiAgICovXG4gIGdldCBpc0xhc3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFBhZ2UgPT09IHRoaXMucGFnaW5hdGlvbi5sYXN0UGFnZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRvIGdlbmVyYXRlIGFuIGFycmF5IG9mIHBhZ2VzIGZvciAqbmdGb3JcbiAgICogWzEsIDIsIDMsIDRdXG4gICAqL1xuICB3aXRoQ29udHJvbHMoKSB7XG4gICAgdGhpcy5jb25maWcucGFnZXNDb250cm9scyA9IHRydWU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0byBnZW5lcmF0ZSB0aGUgYGZyb21gIGFuZCBgdG9gIGtleXNcbiAgICogWzEsIDIsIDMsIDRdXG4gICAqL1xuICB3aXRoUmFuZ2UoKSB7XG4gICAgdGhpcy5jb25maWcucmFuZ2UgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgbG9hZGluZyBzdGF0ZVxuICAgKi9cbiAgc2V0TG9hZGluZyh2YWx1ZSA9IHRydWUpIHtcbiAgICB0aGlzLmdldFN0b3JlKCkuc2V0TG9hZGluZyh2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBwYWdpbmF0aW9uIG9iamVjdCBhbmQgYWRkIHRoZSBwYWdlXG4gICAqL1xuICBAYWN0aW9uKHsgdHlwZTogJ0BQYWdpbmF0aW9uIC0gTmV3IFBhZ2UnIH0sIHRydWUpXG4gIHVwZGF0ZShyZXNwb25zZTogUGFnaW5hdGlvblJlc3BvbnNlPEU+KSB7XG4gICAgdGhpcy5wYWdpbmF0aW9uID0gcmVzcG9uc2U7XG4gICAgdGhpcy5hZGRQYWdlKHJlc3BvbnNlLmRhdGEpO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIFNldCB0aGUgaWRzIGFuZCBhZGQgdGhlIHBhZ2UgdG8gc3RvcmVcbiAgICovXG4gIGFkZFBhZ2UoZGF0YTogRVtdKSB7XG4gICAgdGhpcy5wYWdlcy5zZXQodGhpcy5jdXJyZW50UGFnZSwgeyBpZHM6IGRhdGEubWFwKGVudGl0eSA9PiBlbnRpdHlbdGhpcy5nZXRTdG9yZSgpLmlkS2V5XSkgfSk7XG4gICAgdGhpcy5nZXRTdG9yZSgpLmFkZChkYXRhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhciB0aGUgY2FjaGUuXG4gICAqL1xuICBjbGVhckNhY2hlKCkge1xuICAgIGlmICghdGhpcy5pbml0aWFsKSB7XG4gICAgICBhcHBseUFjdGlvbihcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZ2V0U3RvcmUoKS5yZW1vdmUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgeyB0eXBlOiAnQFBhZ2luYXRpb24gLSBDbGVhciBDYWNoZScgfVxuICAgICAgKTtcbiAgICAgIHRoaXMucGFnZXMgPSBuZXcgTWFwKCk7XG4gICAgICB0aGlzLm1ldGFkYXRhID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICB0aGlzLmluaXRpYWwgPSBmYWxzZTtcbiAgfVxuXG4gIGNsZWFyUGFnZShwYWdlOiBudW1iZXIpIHtcbiAgICB0aGlzLnBhZ2VzLmRlbGV0ZShwYWdlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhciB0aGUgY2FjaGUgdGltZW91dCBhbmQgb3B0aW9uYWxseSB0aGUgcGFnZXNcbiAgICovXG4gIGRlc3Ryb3koeyBjbGVhckNhY2hlLCBjdXJyZW50UGFnZSB9OiB7IGNsZWFyQ2FjaGU/OiBib29sZWFuOyBjdXJyZW50UGFnZT86IG51bWJlciB9ID0ge30pIHtcbiAgICBpZiAodGhpcy5jbGVhckNhY2hlU3Vic2NyaXB0aW9uKSB7XG4gICAgICB0aGlzLmNsZWFyQ2FjaGVTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gICAgaWYgKGNsZWFyQ2FjaGUpIHtcbiAgICAgIHRoaXMuY2xlYXJDYWNoZSgpO1xuICAgIH1cbiAgICBpZiAoIWlzVW5kZWZpbmVkKGN1cnJlbnRQYWdlKSkge1xuICAgICAgdGhpcy5zZXRQYWdlKGN1cnJlbnRQYWdlKTtcbiAgICB9XG4gICAgdGhpcy5pbml0aWFsID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBwcm92aWRlZCBwYWdlIGlzIGFjdGl2ZVxuICAgKi9cbiAgaXNQYWdlQWN0aXZlKHBhZ2U6IG51bWJlcikge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRQYWdlID09PSBwYWdlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgY3VycmVudCBwYWdlXG4gICAqL1xuICBzZXRQYWdlKHBhZ2U6IG51bWJlcikge1xuICAgIGlmIChwYWdlICE9PSB0aGlzLmN1cnJlbnRQYWdlIHx8ICF0aGlzLmhhc1BhZ2UocGFnZSkpIHtcbiAgICAgIHRoaXMucGFnZS5uZXh0KCh0aGlzLnBhZ2luYXRpb24uY3VycmVudFBhZ2UgPSBwYWdlKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEluY3JlbWVudCBjdXJyZW50IHBhZ2VcbiAgICovXG4gIG5leHRQYWdlKCkge1xuICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlICE9PSB0aGlzLnBhZ2luYXRpb24ubGFzdFBhZ2UpIHtcbiAgICAgIHRoaXMuc2V0UGFnZSh0aGlzLnBhZ2luYXRpb24uY3VycmVudFBhZ2UgKyAxKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGVjcmVtZW50IGN1cnJlbnQgcGFnZVxuICAgKi9cbiAgcHJldlBhZ2UoKSB7XG4gICAgaWYgKHRoaXMucGFnaW5hdGlvbi5jdXJyZW50UGFnZSA+IDEpIHtcbiAgICAgIHRoaXMuc2V0UGFnZSh0aGlzLnBhZ2luYXRpb24uY3VycmVudFBhZ2UgLSAxKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0IGN1cnJlbnQgcGFnZSB0byBsYXN0XG4gICAqL1xuICBzZXRMYXN0UGFnZSgpIHtcbiAgICB0aGlzLnNldFBhZ2UodGhpcy5wYWdpbmF0aW9uLmxhc3RQYWdlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgY3VycmVudCBwYWdlIHRvIGZpcnN0XG4gICAqL1xuICBzZXRGaXJzdFBhZ2UoKSB7XG4gICAgdGhpcy5zZXRQYWdlKDEpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHBhZ2UgZXhpc3RzIGluIGNhY2hlXG4gICAqL1xuICBoYXNQYWdlKHBhZ2U6IG51bWJlcikge1xuICAgIHJldHVybiB0aGlzLnBhZ2VzLmhhcyhwYWdlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgcGFnZSBpZiBpdCdzIGluIGNhY2hlLCBvdGhlcndpc2UgaW52b2tlIHRoZSByZXF1ZXN0XG4gICAqL1xuICBnZXRQYWdlKHJlcTogKCkgPT4gT2JzZXJ2YWJsZTxQYWdpbmF0aW9uUmVzcG9uc2U8RT4+KSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnaW5hdGlvbi5jdXJyZW50UGFnZTtcbiAgICBpZiAodGhpcy5oYXNQYWdlKHBhZ2UpKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZWxlY3RQYWdlKHBhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldExvYWRpbmcodHJ1ZSk7XG4gICAgICByZXR1cm4gZnJvbShyZXEoKSkucGlwZShcbiAgICAgICAgc3dpdGNoTWFwKChjb25maWc6IFBhZ2luYXRpb25SZXNwb25zZTxFPikgPT4ge1xuICAgICAgICAgIGFwcGx5VHJhbnNhY3Rpb24oKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKGNvbmZpZyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0UGFnZShwYWdlKTtcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgZ2V0UXVlcnkoKTogUXVlcnlFbnRpdHk8YW55LCBFPiB7XG4gICAgcmV0dXJuIHRoaXMucXVlcnk7XG4gIH1cblxuICBwcml2YXRlIGdldEZyb20oKSB7XG4gICAgaWYgKHRoaXMuaXNGaXJzdCkge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIHJldHVybiAodGhpcy5jdXJyZW50UGFnZSAtIDEpICogdGhpcy5wYWdpbmF0aW9uLnBlclBhZ2UgKyAxO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRUbygpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50UGFnZSAqIHRoaXMucGFnaW5hdGlvbi5wZXJQYWdlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdCB0aGUgcGFnZVxuICAgKi9cbiAgcHJpdmF0ZSBzZWxlY3RQYWdlKHBhZ2U6IG51bWJlcik6IE9ic2VydmFibGU8UGFnaW5hdGlvblJlc3BvbnNlPEU+PiB7XG4gICAgcmV0dXJuIHRoaXMucXVlcnkuc2VsZWN0QWxsKHsgYXNPYmplY3Q6IHRydWUgfSkucGlwZShcbiAgICAgIHRha2UoMSksXG4gICAgICBtYXAoZW50aXRpZXMgPT4ge1xuICAgICAgICBsZXQgcmVzcG9uc2U6IFBhZ2luYXRpb25SZXNwb25zZTxFPiA9IHtcbiAgICAgICAgICAuLi50aGlzLnBhZ2luYXRpb24sXG4gICAgICAgICAgZGF0YTogdGhpcy5wYWdlcy5nZXQocGFnZSkuaWRzLm1hcChpZCA9PiBlbnRpdGllc1tpZF0pXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgeyByYW5nZSwgcGFnZXNDb250cm9scyB9ID0gdGhpcy5jb25maWc7XG5cbiAgICAgICAgLyoqIElmIG5vIHRvdGFsIC0gY2FsYyBpdCAqL1xuICAgICAgICBpZiAoaXNOYU4odGhpcy5wYWdpbmF0aW9uLnRvdGFsKSkge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5sYXN0UGFnZSA9PT0gMSkge1xuICAgICAgICAgICAgcmVzcG9uc2UudG90YWwgPSByZXNwb25zZS5kYXRhID8gcmVzcG9uc2UuZGF0YS5sZW5ndGggOiAwO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNwb25zZS50b3RhbCA9IHJlc3BvbnNlLnBlclBhZ2UgKiByZXNwb25zZS5sYXN0UGFnZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5wYWdpbmF0aW9uLnRvdGFsID0gcmVzcG9uc2UudG90YWw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmFuZ2UpIHtcbiAgICAgICAgICByZXNwb25zZS5mcm9tID0gdGhpcy5nZXRGcm9tKCk7XG4gICAgICAgICAgcmVzcG9uc2UudG8gPSB0aGlzLmdldFRvKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFnZXNDb250cm9scykge1xuICAgICAgICAgIHJlc3BvbnNlLnBhZ2VDb250cm9scyA9IGdlbmVyYXRlUGFnZXModGhpcy5wYWdpbmF0aW9uLnRvdGFsLCB0aGlzLnBhZ2luYXRpb24ucGVyUGFnZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgICB9KVxuICAgICk7XG4gIH1cbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSBhbiBhcnJheSBzbyB3ZSBjYW4gbmdGb3IgdGhlbSB0byBuYXZpZ2F0ZSBiZXR3ZWVuIHBhZ2VzXG4gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlUGFnZXModG90YWw6IG51bWJlciwgcGVyUGFnZTogbnVtYmVyKSB7XG4gIGNvbnN0IGxlbiA9IE1hdGguY2VpbCh0b3RhbCAvIHBlclBhZ2UpO1xuICBsZXQgYXJyID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICBhcnIucHVzaChpICsgMSk7XG4gIH1cbiAgcmV0dXJuIGFycjtcbn1cblxuLyoqIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgKi9cbmV4cG9ydCBjb25zdCBQYWdpbmF0b3IgPSBQYWdpbmF0b3JQbHVnaW47XG4iLCJpbXBvcnQgeyBBa2l0YVBsdWdpbiB9IGZyb20gJy4uL3BsdWdpbic7XG5pbXBvcnQgeyBRdWVyeSB9IGZyb20gJy4uLy4uL2FwaS9xdWVyeSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGRlYm91bmNlVGltZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IF9fZ2xvYmFsU3RhdGUgfSBmcm9tICcuLi8uLi9pbnRlcm5hbC9nbG9iYWwtc3RhdGUnO1xuaW1wb3J0IHsgZ2V0VmFsdWUsIGlzU3RyaW5nLCBzZXRWYWx1ZSwgdG9Cb29sZWFuIH0gZnJvbSAnLi4vLi4vaW50ZXJuYWwvdXRpbHMnO1xuXG5leHBvcnQgdHlwZSBGb3JtR3JvdXBMaWtlID0ge1xuICBwYXRjaFZhbHVlOiBGdW5jdGlvbjtcbiAgc2V0VmFsdWU6IEZ1bmN0aW9uO1xuICB2YWx1ZTogYW55O1xuICBnZXQ6IEZ1bmN0aW9uO1xuICB2YWx1ZUNoYW5nZXM6IE9ic2VydmFibGU8YW55PjtcbiAgY29udHJvbHM6IGFueTtcbn07XG5cbmV4cG9ydCB0eXBlIEFraXRhRm9ybVByb3A8VD4gPSB7XG4gIFtrZXk6IHN0cmluZ106IFQ7XG59O1xuXG5leHBvcnQgdHlwZSBQZXJzaXN0Rm9ybVBhcmFtcyA9IHtcbiAgZGVib3VuY2VUaW1lPzogbnVtYmVyO1xuICBmb3JtS2V5Pzogc3RyaW5nO1xuICBlbWl0RXZlbnQ/OiBib29sZWFuO1xuICBhcnJDb250cm9sRmFjdG9yeT86IEFycmF5Q29udHJvbEZhY3Rvcnk7XG59O1xuXG5leHBvcnQgdHlwZSBBcnJheUNvbnRyb2xGYWN0b3J5ID0gKHZhbHVlOiBhbnkpID0+IGFueTsgLy8gVG9kbzogUmV0dXJuICBBYnN0cmFjdENvbnRyb2wgaW50ZXJmYWNlXG5cbmV4cG9ydCBjbGFzcyBQZXJzaXN0TmdGb3JtUGx1Z2luPFQgPSBhbnk+IGV4dGVuZHMgQWtpdGFQbHVnaW4ge1xuICBmb3JtQ2hhbmdlczogU3Vic2NyaXB0aW9uO1xuICBwcml2YXRlIGlzUm9vdEtleXM6IGJvb2xlYW47XG4gIHByaXZhdGUgZm9ybTogRm9ybUdyb3VwTGlrZTtcbiAgcHJpdmF0ZSBpc0tleUJhc2VkOiBib29sZWFuO1xuICBwcml2YXRlIGluaXRpYWxWYWx1ZTtcbiAgcHJpdmF0ZSBidWlsZGVyO1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBxdWVyeTogUXVlcnk8YW55PiwgcHJpdmF0ZSBmYWN0b3J5Rm5PclBhdGg/OiBGdW5jdGlvbiB8IHN0cmluZywgcHJpdmF0ZSBwYXJhbXM6IFBlcnNpc3RGb3JtUGFyYW1zID0ge30pIHtcbiAgICBzdXBlcihxdWVyeSk7XG4gICAgdGhpcy5wYXJhbXMgPSB7IC4uLnsgZGVib3VuY2VUaW1lOiAzMDAsIGZvcm1LZXk6ICdha2l0YUZvcm0nLCBlbWl0RXZlbnQ6IGZhbHNlLCBhcnJDb250cm9sRmFjdG9yeTogdiA9PiB0aGlzLmJ1aWxkZXIuY29udHJvbCh2KSB9LCAuLi5wYXJhbXMgfTtcbiAgICB0aGlzLmlzUm9vdEtleXMgPSB0b0Jvb2xlYW4oZmFjdG9yeUZuT3JQYXRoKSA9PT0gZmFsc2U7XG4gICAgdGhpcy5pc0tleUJhc2VkID0gaXNTdHJpbmcoZmFjdG9yeUZuT3JQYXRoKSB8fCB0aGlzLmlzUm9vdEtleXM7XG4gIH1cblxuICBzZXRGb3JtKGZvcm06IEZvcm1Hcm91cExpa2UsIGJ1aWxkZXI/KSB7XG4gICAgdGhpcy5mb3JtID0gZm9ybTtcbiAgICB0aGlzLmJ1aWxkZXIgPSBidWlsZGVyO1xuICAgIHRoaXMuYWN0aXZhdGUoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHJlc2V0KGluaXRpYWxTdGF0ZT86IFQpIHtcbiAgICBsZXQgdmFsdWU7XG4gICAgaWYgKGluaXRpYWxTdGF0ZSkge1xuICAgICAgdmFsdWUgPSBpbml0aWFsU3RhdGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlID0gdGhpcy5pc0tleUJhc2VkID8gdGhpcy5pbml0aWFsVmFsdWUgOiAodGhpcyBhcyBhbnkpLmZhY3RvcnlGbk9yUGF0aCgpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzS2V5QmFzZWQpIHtcbiAgICAgIE9iamVjdC5rZXlzKHRoaXMuaW5pdGlhbFZhbHVlKS5mb3JFYWNoKHN0YXRlS2V5ID0+IHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmluaXRpYWxWYWx1ZVtzdGF0ZUtleV07XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSAmJiB0aGlzLmJ1aWxkZXIpIHtcbiAgICAgICAgICBjb25zdCBmb3JtQXJyYXkgPSB0aGlzLmZvcm0uY29udHJvbHNbc3RhdGVLZXldO1xuICAgICAgICAgIHRoaXMuY2xlYW5BcnJheShmb3JtQXJyYXkpO1xuICAgICAgICAgIHZhbHVlLmZvckVhY2goKHYsIGkpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZm9ybS5nZXQoc3RhdGVLZXkpLmluc2VydChpLCAodGhpcy5wYXJhbXMuYXJyQ29udHJvbEZhY3RvcnkgYXMgRnVuY3Rpb24pKHYpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuZm9ybS5wYXRjaFZhbHVlKHZhbHVlLCB7IGVtaXRFdmVudDogdGhpcy5wYXJhbXMuZW1pdEV2ZW50IH0pO1xuXG4gICAgY29uc3Qgc3RvcmVWYWx1ZSA9IHRoaXMuaXNLZXlCYXNlZCA/IHNldFZhbHVlKHRoaXMuZ2V0UXVlcnkoKS5nZXRTbmFwc2hvdCgpLCBgJHt0aGlzLmdldFN0b3JlKCkuc3RvcmVOYW1lfS4ke3RoaXMuZmFjdG9yeUZuT3JQYXRofWAsIHZhbHVlKSA6IHsgW3RoaXMucGFyYW1zLmZvcm1LZXldOiB2YWx1ZSB9O1xuICAgIHRoaXMudXBkYXRlU3RvcmUoc3RvcmVWYWx1ZSk7XG4gIH1cblxuICBwcml2YXRlIGNsZWFuQXJyYXkoY29udHJvbCkge1xuICAgIHdoaWxlIChjb250cm9sLmxlbmd0aCAhPT0gMCkge1xuICAgICAgY29udHJvbC5yZW1vdmVBdCgwKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHJlc29sdmVJbml0aWFsVmFsdWUoZm9ybVZhbHVlLCByb290KSB7XG4gICAgaWYgKCFmb3JtVmFsdWUpIHJldHVybjtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoZm9ybVZhbHVlKS5yZWR1Y2UoKGFjYywgc3RhdGVLZXkpID0+IHtcbiAgICAgIGNvbnN0IHZhbHVlID0gcm9vdFtzdGF0ZUtleV07XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdGhpcy5idWlsZGVyKSB7XG4gICAgICAgIGNvbnN0IGZhY3RvcnkgPSB0aGlzLnBhcmFtcy5hcnJDb250cm9sRmFjdG9yeTtcbiAgICAgICAgdGhpcy5jbGVhbkFycmF5KHRoaXMuZm9ybS5nZXQoc3RhdGVLZXkpKTtcbiAgICAgICAgdmFsdWUuZm9yRWFjaCgodiwgaSkgPT4ge1xuICAgICAgICAgIHRoaXMuZm9ybS5nZXQoc3RhdGVLZXkpLmluc2VydChpLCAoZmFjdG9yeSBhcyBGdW5jdGlvbikodikpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGFjY1tzdGF0ZUtleV0gPSByb290W3N0YXRlS2V5XTtcbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30pO1xuICB9XG5cbiAgcHJpdmF0ZSBhY3RpdmF0ZSgpIHtcbiAgICBsZXQgcGF0aDtcblxuICAgIGlmICh0aGlzLmlzS2V5QmFzZWQpIHtcbiAgICAgIGlmICh0aGlzLmlzUm9vdEtleXMpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsVmFsdWUgPSB0aGlzLnJlc29sdmVJbml0aWFsVmFsdWUodGhpcy5mb3JtLnZhbHVlLCB0aGlzLmdldFF1ZXJ5KCkuZ2V0U25hcHNob3QoKSk7XG4gICAgICAgIHRoaXMuZm9ybS5wYXRjaFZhbHVlKHRoaXMuaW5pdGlhbFZhbHVlLCB7IGVtaXRFdmVudDogdGhpcy5wYXJhbXMuZW1pdEV2ZW50IH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGF0aCA9IGAke3RoaXMuZ2V0U3RvcmUoKS5zdG9yZU5hbWV9LiR7dGhpcy5mYWN0b3J5Rm5PclBhdGh9YDtcbiAgICAgICAgY29uc3Qgcm9vdCA9IGdldFZhbHVlKHRoaXMuZ2V0UXVlcnkoKS5nZXRTbmFwc2hvdCgpLCBwYXRoKTtcbiAgICAgICAgdGhpcy5pbml0aWFsVmFsdWUgPSB0aGlzLnJlc29sdmVJbml0aWFsVmFsdWUocm9vdCwgcm9vdCk7XG4gICAgICAgIHRoaXMuZm9ybS5wYXRjaFZhbHVlKHRoaXMuaW5pdGlhbFZhbHVlLCB7IGVtaXRFdmVudDogdGhpcy5wYXJhbXMuZW1pdEV2ZW50IH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoISh0aGlzLmdldFF1ZXJ5KCkuZ2V0U25hcHNob3QoKSBhcyBBa2l0YUZvcm1Qcm9wPFQ+KVt0aGlzLnBhcmFtcy5mb3JtS2V5XSkge1xuICAgICAgICBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdAUGVyc2lzdE5nRm9ybVBsdWdpbiBhY3RpdmF0ZScgfSk7XG4gICAgICAgIHRoaXMudXBkYXRlU3RvcmUoeyBbdGhpcy5wYXJhbXMuZm9ybUtleV06ICh0aGlzIGFzIGFueSkuZmFjdG9yeUZuT3JQYXRoKCkgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5nZXRRdWVyeSgpLmdldFNuYXBzaG90KClbdGhpcy5wYXJhbXMuZm9ybUtleV07XG4gICAgICB0aGlzLmZvcm0ucGF0Y2hWYWx1ZSh2YWx1ZSk7XG4gICAgfVxuXG4gICAgdGhpcy5mb3JtQ2hhbmdlcyA9IHRoaXMuZm9ybS52YWx1ZUNoYW5nZXMucGlwZShkZWJvdW5jZVRpbWUodGhpcy5wYXJhbXMuZGVib3VuY2VUaW1lKSkuc3Vic2NyaWJlKHZhbHVlID0+IHtcbiAgICAgIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKHsgdHlwZTogJ0BQZXJzaXN0Rm9ybSAtIFVwZGF0ZScgfSk7XG4gICAgICBsZXQgbmV3U3RhdGU7XG4gICAgICBpZiAodGhpcy5pc0tleUJhc2VkKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUm9vdEtleXMpIHtcbiAgICAgICAgICBuZXdTdGF0ZSA9IHN0YXRlID0+ICh7IC4uLnN0YXRlLCAuLi52YWx1ZSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdTdGF0ZSA9IHN0YXRlID0+IHNldFZhbHVlKHN0YXRlLCBwYXRoLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld1N0YXRlID0gKCkgPT4gKHsgW3RoaXMucGFyYW1zLmZvcm1LZXldOiB2YWx1ZSB9KTtcbiAgICAgIH1cbiAgICAgIHRoaXMudXBkYXRlU3RvcmUobmV3U3RhdGUodGhpcy5nZXRRdWVyeSgpLmdldFNuYXBzaG90KCkpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlc3Ryb3koKSB7XG4gICAgdGhpcy5mb3JtQ2hhbmdlcyAmJiB0aGlzLmZvcm1DaGFuZ2VzLnVuc3Vic2NyaWJlKCk7XG4gICAgdGhpcy5mb3JtID0gbnVsbDtcbiAgICB0aGlzLmJ1aWxkZXIgPSBudWxsO1xuICB9XG59XG4iLCJpbXBvcnQgeyBBa2l0YUVycm9yIH0gZnJvbSAnLi4vaW50ZXJuYWwvZXJyb3InO1xuaW1wb3J0IHsgX19zdG9yZXNfXywgQWN0aW9ucywgcm9vdERpc3BhdGNoZXIgfSBmcm9tICcuLi9hcGkvc3RvcmUnO1xuaW1wb3J0IHsgc2tpcCwgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgZ2V0VmFsdWUsIHNldFZhbHVlIH0gZnJvbSAnLi4vaW50ZXJuYWwvdXRpbHMnO1xuaW1wb3J0IHsgX19nbG9iYWxTdGF0ZSB9IGZyb20gJy4uL2ludGVybmFsL2dsb2JhbC1zdGF0ZSc7XG5cbmNvbnN0IG5vdEJzID0gdHlwZW9mIGxvY2FsU3RvcmFnZSA9PT0gJ3VuZGVmaW5lZCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGVyc2lzdFN0YXRlUGFyYW1zIHtcbiAgLyoqIFRoZSBzdG9yYWdlIGtleSAqL1xuICBrZXk6IHN0cmluZztcbiAgLyoqIFN0b3JhZ2Ugc3RyYXRlZ3kgdG8gdXNlLiBUaGlzIGRlZmF1bHRzIHRvIExvY2FsU3RvcmFnZSBidXQgeW91IGNhbiBwYXNzIFNlc3Npb25TdG9yYWdlIG9yIGFueXRoaW5nIHRoYXQgaW1wbGVtZW50cyB0aGUgU3RvcmFnZUVuZ2luZSBBUEkuICovXG4gIHN0b3JhZ2U6IFN0b3JhZ2U7XG4gIC8qKiBDdXN0b20gZGVzZXJpYWxpemVyLiBEZWZhdWx0cyB0byBKU09OLnBhcnNlICovXG4gIGRlc2VyaWFsaXplOiBGdW5jdGlvbjtcbiAgLyoqIEN1c3RvbSBzZXJpYWxpemVyLCBkZWZhdWx0cyB0byBKU09OLnN0cmluZ2lmeSAqL1xuICBzZXJpYWxpemU6IEZ1bmN0aW9uO1xuICAvKipcbiAgICogQnkgZGVmYXVsdCB0aGUgd2hvbGUgc3RhdGUgaXMgc2F2ZWQgdG8gc3RvcmFnZSwgdXNlIHRoaXMgcGFyYW0gdG8gaW5jbHVkZSBvbmx5IHRoZSBzdG9yZXMgeW91IG5lZWQuXG4gICAqIFBheSBhdHRlbnRpb24gdGhhdCB5b3UgY2FuJ3QgdXNlIGJvdGggaW5jbHVkZSBhbmQgZXhjbHVkZVxuICAgKi9cbiAgaW5jbHVkZTogc3RyaW5nW107XG4gIC8qKlxuICAgKiAgQnkgZGVmYXVsdCB0aGUgd2hvbGUgc3RhdGUgaXMgc2F2ZWQgdG8gc3RvcmFnZSwgdXNlIHRoaXMgcGFyYW0gdG8gZXhjbHVkZSBzdG9yZXMgdGhhdCB5b3UgZG9uJ3QgbmVlZC5cbiAgICogIFBheSBhdHRlbnRpb24gdGhhdCB5b3UgY2FuJ3QgdXNlIGJvdGggaW5jbHVkZSBhbmQgZXhjbHVkZVxuICAgKi9cbiAgZXhjbHVkZTogc3RyaW5nW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwZXJzaXN0U3RhdGUocGFyYW1zPzogUGFydGlhbDxQZXJzaXN0U3RhdGVQYXJhbXM+KSB7XG4gIGlmIChub3RCcykgcmV0dXJuO1xuXG4gIGNvbnN0IGRlZmF1bHRzOiBQZXJzaXN0U3RhdGVQYXJhbXMgPSB7XG4gICAga2V5OiAnQWtpdGFTdG9yZXMnLFxuICAgIHN0b3JhZ2U6IGxvY2FsU3RvcmFnZSxcbiAgICBkZXNlcmlhbGl6ZTogSlNPTi5wYXJzZSxcbiAgICBzZXJpYWxpemU6IEpTT04uc3RyaW5naWZ5LFxuICAgIGluY2x1ZGU6IFtdLFxuICAgIGV4Y2x1ZGU6IFtdXG4gIH07XG4gIGNvbnN0IHsgc3RvcmFnZSwgZGVzZXJpYWxpemUsIHNlcmlhbGl6ZSwgaW5jbHVkZSwgZXhjbHVkZSwga2V5IH0gPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0cywgcGFyYW1zKTtcblxuICBjb25zdCBoYXNJbmNsdWRlID0gaW5jbHVkZS5sZW5ndGggPiAwO1xuICBjb25zdCBoYXNFeGNsdWRlID0gZXhjbHVkZS5sZW5ndGggPiAwO1xuICBsZXQgaW5jbHVkZVN0b3JlcztcblxuICBpZiAoaGFzSW5jbHVkZSAmJiBoYXNFeGNsdWRlKSB7XG4gICAgdGhyb3cgbmV3IEFraXRhRXJyb3IoXCJZb3UgY2FuJ3QgdXNlIGJvdGggaW5jbHVkZSBhbmQgZXhjbHVkZVwiKTtcbiAgfVxuXG4gIGlmIChoYXNJbmNsdWRlKSB7XG4gICAgaW5jbHVkZVN0b3JlcyA9IGluY2x1ZGUucmVkdWNlKChhY2MsIHBhdGgpID0+IHtcbiAgICAgIGNvbnN0IHN0b3JlTmFtZSA9IHBhdGguc3BsaXQoJy4nKVswXTtcbiAgICAgIGFjY1tzdG9yZU5hbWVdID0gcGF0aDtcbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30pO1xuICB9XG5cbiAgY29uc3Qgc3RvcmFnZVN0YXRlID0gZGVzZXJpYWxpemUoc3RvcmFnZS5nZXRJdGVtKGtleSkgfHwgJ3t9Jyk7XG5cbiAgbGV0IHN0b3JlcyA9IHt9O1xuICBsZXQgYWNjID0ge307XG5cbiAgZnVuY3Rpb24gc2F2ZSgpIHtcbiAgICBzdG9yYWdlLnNldEl0ZW0oa2V5LCBzZXJpYWxpemUoT2JqZWN0LmFzc2lnbih7fSwgc3RvcmFnZVN0YXRlLCBhY2MpKSk7XG4gIH1cblxuICBmdW5jdGlvbiBzdWJzY3JpYmUoc3RvcmVOYW1lLCBwYXRoKSB7XG4gICAgc3RvcmVzW3N0b3JlTmFtZV0gPSBfX3N0b3Jlc19fW3N0b3JlTmFtZV1cbiAgICAgIC5fc2VsZWN0KHN0YXRlID0+IGdldFZhbHVlKHN0YXRlLCBwYXRoKSlcbiAgICAgIC5waXBlKHNraXAoMSkpXG4gICAgICAuc3Vic2NyaWJlKGRhdGEgPT4ge1xuICAgICAgICBhY2Nbc3RvcmVOYW1lXSA9IGRhdGE7XG4gICAgICAgIHNhdmUoKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0SW5pdGlhbChzdG9yZU5hbWUsIHN0b3JlLCBwYXRoKSB7XG4gICAgaWYgKHN0b3JhZ2VTdGF0ZVtzdG9yZU5hbWVdKSB7XG4gICAgICBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdAUGVyc2lzdFN0YXRlJyB9KTtcbiAgICAgIHN0b3JlLnNldFN0YXRlKHN0YXRlID0+IHtcbiAgICAgICAgcmV0dXJuIHNldFZhbHVlKHN0YXRlLCBwYXRoLCBzdG9yYWdlU3RhdGVbc3RvcmVOYW1lXSk7XG4gICAgICB9KTtcbiAgICAgIGlmIChzdG9yZS5zZXREaXJ0eSkge1xuICAgICAgICBzdG9yZS5zZXREaXJ0eSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHJvb3REaXNwYXRjaGVyLnBpcGUoZmlsdGVyKGFjdGlvbiA9PiBhY3Rpb24udHlwZSA9PT0gQWN0aW9ucy5ORVdfU1RPUkUpKS5zdWJzY3JpYmUoYWN0aW9uID0+IHtcbiAgICBsZXQgY3VycmVudFN0b3JlTmFtZSA9IGFjdGlvbi5wYXlsb2FkLnN0b3JlLnN0b3JlTmFtZTtcblxuICAgIGlmIChoYXNFeGNsdWRlICYmIGV4Y2x1ZGUuaW5jbHVkZXMoY3VycmVudFN0b3JlTmFtZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoaGFzSW5jbHVkZSkge1xuICAgICAgY29uc3QgcGF0aCA9IGluY2x1ZGVTdG9yZXNbY3VycmVudFN0b3JlTmFtZV07XG4gICAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2V0SW5pdGlhbChjdXJyZW50U3RvcmVOYW1lLCBhY3Rpb24ucGF5bG9hZC5zdG9yZSwgcGF0aCk7XG4gICAgICBzdWJzY3JpYmUoY3VycmVudFN0b3JlTmFtZSwgcGF0aCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldEluaXRpYWwoY3VycmVudFN0b3JlTmFtZSwgYWN0aW9uLnBheWxvYWQuc3RvcmUsIGN1cnJlbnRTdG9yZU5hbWUpO1xuICAgICAgc3Vic2NyaWJlKGN1cnJlbnRTdG9yZU5hbWUsIGN1cnJlbnRTdG9yZU5hbWUpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBkZXN0cm95KCkge1xuICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICBmb3IgKGxldCBpID0gMCwga2V5cyA9IE9iamVjdC5rZXlzKHN0b3Jlcyk7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHN0b3JlTmFtZSA9IGtleXNbaV07XG4gICAgICAgIHN0b3Jlc1tzdG9yZU5hbWVdLnVuc3Vic2NyaWJlKCk7XG4gICAgICB9XG4gICAgICBzdG9yZXMgPSB7fTtcbiAgICB9LFxuICAgIGNsZWFyKCkge1xuICAgICAgc3RvcmFnZS5jbGVhcigpO1xuICAgIH0sXG4gICAgY2xlYXJTdG9yZShzdG9yZU5hbWU6IHN0cmluZykge1xuICAgICAgY29uc3Qgc3RvcmFnZVN0YXRlID0gZGVzZXJpYWxpemUoc3RvcmFnZS5nZXRJdGVtKGtleSkgfHwgJ3t9Jyk7XG5cbiAgICAgIGlmIChzdG9yYWdlU3RhdGVbc3RvcmVOYW1lXSkge1xuICAgICAgICBkZWxldGUgc3RvcmFnZVN0YXRlW3N0b3JlTmFtZV07XG4gICAgICAgIHN0b3JhZ2Uuc2V0SXRlbShrZXksIHNlcmlhbGl6ZShzdG9yYWdlU3RhdGUpKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG4iLCJpbXBvcnQgeyBfX3N0b3Jlc19fLCBBY3Rpb25zLCByb290RGlzcGF0Y2hlciB9IGZyb20gJy4uL2FwaS9zdG9yZSc7XG5pbXBvcnQgeyBfX2dsb2JhbFN0YXRlIH0gZnJvbSAnLi4vaW50ZXJuYWwvZ2xvYmFsLXN0YXRlJztcbmltcG9ydCB7IGlzRGVmaW5lZCB9IGZyb20gJy4uL2ludGVybmFsL3V0aWxzJztcblxuZXhwb3J0IHR5cGUgRGV2dG9vbHNPcHRpb25zID0ge1xuICAvKiogIG1heGltdW0gYWxsb3dlZCBhY3Rpb25zIHRvIGJlIHN0b3JlZCBpbiB0aGUgaGlzdG9yeSB0cmVlICovXG4gIG1heEFnZTogbnVtYmVyO1xuICBsYXRlbmN5OiBudW1iZXI7XG4gIGFjdGlvbnNCbGFja2xpc3Q6IHN0cmluZ1tdO1xuICBhY3Rpb25zV2hpdGVsaXN0OiBzdHJpbmdbXTtcbiAgc2hvdWxkQ2F0Y2hFcnJvcnM6IGJvb2xlYW47XG4gIGxvZ1RyYWNlOiBib29sZWFuO1xuICBwcmVkaWNhdGU6IChzdGF0ZTogYW55LCBhY3Rpb246IGFueSkgPT4gYm9vbGVhbjtcbn07XG5sZXQgcm9vdERpc3BhdGNoZXJTdWIsIGRldnRvb2xzU3ViO1xuXG5leHBvcnQgdHlwZSBOZ1pvbmVMaWtlID0geyBydW46IGFueSB9O1xuXG5leHBvcnQgZnVuY3Rpb24gYWtpdGFEZXZ0b29scyhuZ1pvbmU6IE5nWm9uZUxpa2UsIG9wdGlvbnM/OiBQYXJ0aWFsPERldnRvb2xzT3B0aW9ucz4pO1xuZXhwb3J0IGZ1bmN0aW9uIGFraXRhRGV2dG9vbHMob3B0aW9ucz86IFBhcnRpYWw8RGV2dG9vbHNPcHRpb25zPik7XG5leHBvcnQgZnVuY3Rpb24gYWtpdGFEZXZ0b29scyhuZ1pvbmVPck9wdGlvbnM/OiBOZ1pvbmVMaWtlIHwgUGFydGlhbDxEZXZ0b29sc09wdGlvbnM+LCBvcHRpb25zOiBQYXJ0aWFsPERldnRvb2xzT3B0aW9ucz4gPSB7fSkge1xuICBpZiAoISh3aW5kb3cgYXMgYW55KS5fX1JFRFVYX0RFVlRPT0xTX0VYVEVOU0lPTl9fKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcm9vdERpc3BhdGNoZXJTdWIgJiYgcm9vdERpc3BhdGNoZXJTdWIudW5zdWJzY3JpYmUoKTtcbiAgZGV2dG9vbHNTdWIgJiYgZGV2dG9vbHNTdWIoKTtcblxuICBjb25zdCBpc0FuZ3VsYXIgPSBuZ1pvbmVPck9wdGlvbnMgJiYgbmdab25lT3JPcHRpb25zWydydW4nXTtcblxuICBpZiAoIWlzQW5ndWxhcikge1xuICAgIG5nWm9uZU9yT3B0aW9ucyA9IG5nWm9uZU9yT3B0aW9ucyB8fCB7fTtcbiAgICAobmdab25lT3JPcHRpb25zIGFzIGFueSkucnVuID0gY2IgPT4gY2IoKTtcbiAgICBvcHRpb25zID0gbmdab25lT3JPcHRpb25zIGFzIFBhcnRpYWw8RGV2dG9vbHNPcHRpb25zPjtcbiAgfVxuXG4gIGNvbnN0IGRlZmF1bHRPcHRpb25zOiBQYXJ0aWFsPERldnRvb2xzT3B0aW9ucz4gJiB7IG5hbWU6IHN0cmluZyB9ID0geyBuYW1lOiAnQWtpdGEnIH07XG4gIGNvbnN0IG1lcmdlZCA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICBjb25zdCBkZXZUb29scyA9ICh3aW5kb3cgYXMgYW55KS5fX1JFRFVYX0RFVlRPT0xTX0VYVEVOU0lPTl9fLmNvbm5lY3QobWVyZ2VkKTtcbiAgbGV0IGFwcFN0YXRlID0ge307XG5cbiAgcm9vdERpc3BhdGNoZXJTdWIgPSByb290RGlzcGF0Y2hlci5zdWJzY3JpYmUoYWN0aW9uID0+IHtcbiAgICBpZiAoYWN0aW9uLnR5cGUgPT09IEFjdGlvbnMuREVMRVRFX1NUT1JFKSB7XG4gICAgICBjb25zdCBzdG9yZU5hbWUgPSBhY3Rpb24ucGF5bG9hZC5zdG9yZU5hbWU7XG4gICAgICBkZWxldGUgYXBwU3RhdGVbc3RvcmVOYW1lXTtcbiAgICAgIGRldlRvb2xzLnNlbmQoeyB0eXBlOiBgWyR7c3RvcmVOYW1lfV0gLSBEZWxldGUgU3RvcmVgIH0sIGFwcFN0YXRlKTtcbiAgICB9XG5cbiAgICBpZiAoYWN0aW9uLnR5cGUgPT09IEFjdGlvbnMuTkVXX1NUQVRFKSB7XG4gICAgICBpZiAoX19nbG9iYWxTdGF0ZS5za2lwQWN0aW9uKSB7XG4gICAgICAgIF9fZ2xvYmFsU3RhdGUuc2V0U2tpcEFjdGlvbihmYWxzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgYXBwU3RhdGUgPSB7XG4gICAgICAgIC4uLmFwcFN0YXRlLFxuICAgICAgICBbYWN0aW9uLnBheWxvYWQubmFtZV06IF9fc3RvcmVzX19bYWN0aW9uLnBheWxvYWQubmFtZV0uX3ZhbHVlKClcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHsgdHlwZSwgZW50aXR5SWQgfSA9IF9fZ2xvYmFsU3RhdGUuY3VycmVudEFjdGlvbjtcbiAgICAgIGNvbnN0IHN0b3JlTmFtZSA9IGNhcGl0YWxpemUoYWN0aW9uLnBheWxvYWQubmFtZSk7XG4gICAgICBsZXQgbXNnID0gaXNEZWZpbmVkKGVudGl0eUlkKSA/IGBbJHtzdG9yZU5hbWV9XSAtICR7dHlwZX0gKGlkczogJHtlbnRpdHlJZH0pYCA6IGBbJHtzdG9yZU5hbWV9XSAtICR7dHlwZX1gO1xuXG4gICAgICBpZiAob3B0aW9ucy5sb2dUcmFjZSkge1xuICAgICAgICBjb25zb2xlLmdyb3VwKG1zZyk7XG4gICAgICAgIGNvbnNvbGUudHJhY2UoKTtcbiAgICAgICAgY29uc29sZS5ncm91cEVuZCgpO1xuICAgICAgfVxuXG4gICAgICBkZXZUb29scy5zZW5kKHsgdHlwZTogbXNnLCB0cmFuc2FjdGlvbjogX19nbG9iYWxTdGF0ZS5jdXJyZW50VC5tYXAodCA9PiB0LnR5cGUpIH0sIGFwcFN0YXRlKTtcbiAgICB9XG4gIH0pO1xuXG4gIGRldnRvb2xzU3ViID0gZGV2VG9vbHMuc3Vic2NyaWJlKG1lc3NhZ2UgPT4ge1xuICAgIGlmIChtZXNzYWdlLnR5cGUgPT09ICdBQ1RJT04nKSB7XG4gICAgICBjb25zdCBbc3RvcmVOYW1lXSA9IG1lc3NhZ2UucGF5bG9hZC5zcGxpdCgnLicpO1xuXG4gICAgICBpZiAoX19zdG9yZXNfX1tzdG9yZU5hbWVdKSB7XG4gICAgICAgIChuZ1pvbmVPck9wdGlvbnMgYXMgTmdab25lTGlrZSkucnVuKCgpID0+IHtcbiAgICAgICAgICBjb25zdCBmdW5jQ2FsbCA9IG1lc3NhZ2UucGF5bG9hZC5yZXBsYWNlKHN0b3JlTmFtZSwgYHRoaXNbJyR7c3RvcmVOYW1lfSddYCk7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG5ldyBGdW5jdGlvbihgJHtmdW5jQ2FsbH1gKS5jYWxsKF9fc3RvcmVzX18pO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignVW5rbm93biBNZXRob2Qgw6LCmMK5w6/CuMKPJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobWVzc2FnZS50eXBlID09PSAnRElTUEFUQ0gnKSB7XG4gICAgICBjb25zdCBwYXlsb2FkVHlwZSA9IG1lc3NhZ2UucGF5bG9hZC50eXBlO1xuXG4gICAgICBpZiAocGF5bG9hZFR5cGUgPT09ICdDT01NSVQnKSB7XG4gICAgICAgIGRldlRvb2xzLmluaXQoYXBwU3RhdGUpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChtZXNzYWdlLnN0YXRlKSB7XG4gICAgICAgIGNvbnN0IHJvb3RTdGF0ZSA9IEpTT04ucGFyc2UobWVzc2FnZS5zdGF0ZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBrZXlzID0gT2JqZWN0LmtleXMocm9vdFN0YXRlKTsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBzdG9yZU5hbWUgPSBrZXlzW2ldO1xuICAgICAgICAgIGlmIChfX3N0b3Jlc19fW3N0b3JlTmFtZV0pIHtcbiAgICAgICAgICAgIChuZ1pvbmVPck9wdGlvbnMgYXMgTmdab25lTGlrZSkucnVuKCgpID0+IHtcbiAgICAgICAgICAgICAgX19zdG9yZXNfX1tzdG9yZU5hbWVdLnNldFN0YXRlKCgpID0+IHJvb3RTdGF0ZVtzdG9yZU5hbWVdLCBmYWxzZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjYXBpdGFsaXplKHN0cmluZykge1xuICByZXR1cm4gc3RyaW5nICYmIHN0cmluZy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0cmluZy5zbGljZSgxKTtcbn1cbiIsImltcG9ydCB7Y29lcmNlQXJyYXksIGlzRnVuY3Rpb24sIGlzVW5kZWZpbmVkLCB0b0Jvb2xlYW59IGZyb20gJy4uL2ludGVybmFsL3V0aWxzJztcbmltcG9ydCB7UXVlcnlFbnRpdHl9IGZyb20gJy4uL2FwaS9xdWVyeS1lbnRpdHknO1xuaW1wb3J0IHtJRCwgSURTfSBmcm9tICcuLi9hcGkvdHlwZXMnO1xuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcblxuLyoqXG4gKiBFYWNoIHBsdWdpbiB0aGF0IHdhbnRzIHRvIGFkZCBzdXBwb3J0IGZvciBlbnRpdGllcyBzaG91bGQgZXh0ZW5kIHRoaXMgaW50ZXJmYWNlLlxuICovXG5leHBvcnQgdHlwZSBFbnRpdHlQYXJhbSA9IElEO1xuXG5leHBvcnQgdHlwZSBFbnRpdHlDb2xsZWN0aW9uUGFyYW1zID0gSUQgfCBJRFtdO1xuXG5leHBvcnQgdHlwZSBSZWJhc2VBY3Rpb25zPFAgPSBhbnk+ID0geyBiZWZvcmVSZW1vdmU/OiBGdW5jdGlvbjsgYmVmb3JlQWRkPzogRnVuY3Rpb247IGFmdGVyQWRkPzogKHBsdWdpbjogUCkgPT4gYW55OyB9O1xuXG5jb25zdCBkZWZhdWx0QWN0aW9uczogUmViYXNlQWN0aW9ucyA9IHtiZWZvcmVSZW1vdmU6IHBsdWdpbiA9PiBwbHVnaW4uZGVzdHJveSgpfTtcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEVudGl0eUNvbGxlY3Rpb25QbHVnaW48RSwgUD4ge1xuICBwcm90ZWN0ZWQgZW50aXRpZXMgPSBuZXcgTWFwPElELCBQPigpO1xuXG4gIHByb3RlY3RlZCBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgcXVlcnk6IFF1ZXJ5RW50aXR5PGFueSwgRT4sIHByaXZhdGUgZW50aXR5SWRzOiBFbnRpdHlDb2xsZWN0aW9uUGFyYW1zKSB7fVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGVudGl0eSBwbHVnaW4gaW5zdGFuY2UuXG4gICAqL1xuICBwcm90ZWN0ZWQgZ2V0RW50aXR5KGlkOiBJRCk6IFAge1xuICAgIHJldHVybiB0aGlzLmVudGl0aWVzLmdldChpZCk7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGUgZW50aXR5IHBsdWdpbiBleGlzdC5cbiAgICovXG4gIHByb3RlY3RlZCBoYXNFbnRpdHkoaWQ6IElEKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZW50aXRpZXMuaGFzKGlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlIGVudGl0eSBwbHVnaW4gaW5zdGFuY2UuXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVtb3ZlRW50aXR5KGlkOiBJRCkge1xuICAgIHJldHVybiB0aGlzLmVudGl0aWVzLmRlbGV0ZShpZCk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSBlbnRpdHkgcGx1Z2luIGluc3RhbmNlLlxuICAgKi9cbiAgcHJvdGVjdGVkIGNyZWF0ZUVudGl0eShpZDogSUQsIHBsdWdpbjogUCkge1xuICAgIHJldHVybiB0aGlzLmVudGl0aWVzLnNldChpZCwgcGx1Z2luKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJZiB0aGUgdXNlciBwYXNzZXMgYGVudGl0eUlkc2Agd2UgdGFrZSB0aGVtOyBvdGhlcndpc2UsIHdlIHRha2UgYWxsLlxuICAgKi9cbiAgcHJvdGVjdGVkIGdldElkcygpOiBJRFtdIHtcbiAgICByZXR1cm4gaXNVbmRlZmluZWQodGhpcy5lbnRpdHlJZHMpID8gdGhpcy5xdWVyeS5nZXRTbmFwc2hvdCgpLmlkcyA6IGNvZXJjZUFycmF5KHRoaXMuZW50aXR5SWRzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBXaGVuIHlvdSBjYWxsIG9uZSBvZiB0aGUgcGx1Z2luIG1ldGhvZHMsIHlvdSBjYW4gcGFzcyBpZC9pZHMgb3IgdW5kZWZpbmVkIHdoaWNoIG1lYW5zIGFsbC5cbiAgICovXG4gIHByb3RlY3RlZCByZXNvbHZlZElkcyhpZHM/KTogSURbXSB7XG4gICAgcmV0dXJuIGlzVW5kZWZpbmVkKGlkcykgPyB0aGlzLmdldElkcygpIDogY29lcmNlQXJyYXkoaWRzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIHRoaXMgbWV0aG9kIHdoZW4geW91IHdhbnQgdG8gYWN0aXZhdGUgdGhlIHBsdWdpbiBvbiBpbml0IG9yIHdoZW4geW91IG5lZWQgdG8gbGlzdGVuIHRvIGFkZC9yZW1vdmUgb2YgZW50aXRpZXMgZHluYW1pY2FsbHkuXG4gICAqXG4gICAqIEZvciBleGFtcGxlIGluIHlvdXIgcGx1Z2luIHlvdSBtYXkgZG8gdGhlIGZvbGxvd2luZzpcbiAgICpcbiAgICogdGhpcy5xdWVyeS5zZWxlY3Qoc3RhdGUgPT4gc3RhdGUuaWRzKS5waXBlKHNraXAoMSkpLnN1YnNjcmliZShpZHMgPT4gdGhpcy5hY3RpdmF0ZShpZHMpKTtcbiAgICovXG4gIHByb3RlY3RlZCByZWJhc2UoaWRzOiBJRFtdLCBhY3Rpb25zOiBSZWJhc2VBY3Rpb25zPFA+ID0gZGVmYXVsdEFjdGlvbnMpIHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIElmIHRoZSB1c2VyIHBhc3NlcyBgZW50aXR5SWRzYCAmIHdlIGhhdmUgbmV3IGlkcyBjaGVjayBpZiB3ZSBuZWVkIHRvIGFkZC9yZW1vdmUgaW5zdGFuY2VzLlxuICAgICAqXG4gICAgICogVGhpcyBwaGFzZSB3aWxsIGJlIGNhbGxlZCBvbmx5IHVwb24gdXBkYXRlLlxuICAgICAqL1xuICAgIGlmICh0b0Jvb2xlYW4oaWRzKSkge1xuICAgICAgLyoqXG4gICAgICAgKiBXaGljaCBtZWFucyBhbGxcbiAgICAgICAqL1xuICAgICAgaWYgKGlzVW5kZWZpbmVkKHRoaXMuZW50aXR5SWRzKSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gaWRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgZW50aXR5SWQgPSBpZHNbaV07XG4gICAgICAgICAgaWYgKHRoaXMuaGFzRW50aXR5KGVudGl0eUlkKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGlzRnVuY3Rpb24oYWN0aW9ucy5iZWZvcmVBZGQpICYmIGFjdGlvbnMuYmVmb3JlQWRkKGVudGl0eUlkKTtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbiA9IHRoaXMuaW5zdGFudGlhdGVQbHVnaW4oZW50aXR5SWQpO1xuICAgICAgICAgICAgdGhpcy5lbnRpdGllcy5zZXQoZW50aXR5SWQsIHBsdWdpbik7XG4gICAgICAgICAgICBpc0Z1bmN0aW9uKGFjdGlvbnMuYWZ0ZXJBZGQpICYmIGFjdGlvbnMuYWZ0ZXJBZGQocGx1Z2luKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVudGl0aWVzLmZvckVhY2goKHBsdWdpbiwgZW50aXR5SWQpID0+IHtcbiAgICAgICAgICBpZiAoaWRzLmluZGV4T2YoZW50aXR5SWQpID09PSAtMSkge1xuICAgICAgICAgICAgaXNGdW5jdGlvbihhY3Rpb25zLmJlZm9yZVJlbW92ZSkgJiYgYWN0aW9ucy5iZWZvcmVSZW1vdmUocGx1Z2luKTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRW50aXR5KGVudGl0eUlkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoaWNoIG1lYW5zIHRoZSB1c2VyIHBhc3NlcyBzcGVjaWZpYyBpZHNcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0IF9pZHMgPSBjb2VyY2VBcnJheSh0aGlzLmVudGl0eUlkcyk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBfaWRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgZW50aXR5SWQgPSBfaWRzW2ldO1xuICAgICAgICAgIC8qKiBUaGUgRW50aXR5IGluIGN1cnJlbnQgaWRzIGFuZCBkb2Vzbid0IGV4aXN0LCBhZGQgaXQuICovXG4gICAgICAgICAgaWYgKGlkcy5pbmRleE9mKGVudGl0eUlkKSA+IC0xICYmIHRoaXMuaGFzRW50aXR5KGVudGl0eUlkKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGlzRnVuY3Rpb24oYWN0aW9ucy5iZWZvcmVBZGQpICYmIGFjdGlvbnMuYmVmb3JlQWRkKGVudGl0eUlkKTtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbiA9IHRoaXMuaW5zdGFudGlhdGVQbHVnaW4oZW50aXR5SWQpO1xuICAgICAgICAgICAgdGhpcy5lbnRpdGllcy5zZXQoZW50aXR5SWQsIHBsdWdpbik7XG4gICAgICAgICAgICBpc0Z1bmN0aW9uKGFjdGlvbnMuYWZ0ZXJBZGQpICYmIGFjdGlvbnMuYWZ0ZXJBZGQocGx1Z2luKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbnRpdGllcy5mb3JFYWNoKChwbHVnaW4sIGVudGl0eUlkKSA9PiB7XG4gICAgICAgICAgICAgIC8qKiBUaGUgRW50aXR5IG5vdCBpbiBjdXJyZW50IGlkcyBhbmQgZXhpc3RzLCByZW1vdmUgaXQuICovXG4gICAgICAgICAgICAgIGlmIChpZHMuaW5kZXhPZihlbnRpdHlJZCkgPT09IC0xICYmIHRoaXMuaGFzRW50aXR5KGVudGl0eUlkKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGlzRnVuY3Rpb24oYWN0aW9ucy5iZWZvcmVSZW1vdmUpICYmIGFjdGlvbnMuYmVmb3JlUmVtb3ZlKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVFbnRpdHkoZW50aXR5SWQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLyoqXG4gICAgICAgKiBPdGhlcndpc2UsIHN0YXJ0IHdpdGggdGhlIHByb3ZpZGVkIGlkcyBvciBhbGwuXG4gICAgICAgKi9cbiAgICAgIHRoaXMuZ2V0SWRzKCkuZm9yRWFjaChpZCA9PiB7XG4gICAgICAgIGlmICghdGhpcy5oYXNFbnRpdHkoaWQpKSB0aGlzLmNyZWF0ZUVudGl0eShpZCwgdGhpcy5pbnN0YW50aWF0ZVBsdWdpbihpZCkpXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTGlzdGVuIGZvciBhZGQvcmVtb3ZlIGVudGl0aWVzLlxuICAgKi9cbiAgcHJvdGVjdGVkIHNlbGVjdElkcygpOiBPYnNlcnZhYmxlPElEW10+IHtcbiAgICByZXR1cm4gdGhpcy5xdWVyeS5zZWxlY3Qoc3RhdGUgPT4gc3RhdGUuaWRzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCYXNlIG1ldGhvZCBmb3IgYWN0aXZhdGlvbiwgeW91IGNhbiBvdmVycmlkZSBpdCBpZiB5b3UgbmVlZCB0by5cbiAgICovXG4gIHByb3RlY3RlZCBhY3RpdmF0ZShpZHM/OiBJRFtdKSB7XG4gICAgdGhpcy5yZWJhc2UoaWRzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIG1ldGhvZCBpcyByZXNwb25zaWJsZSBmb3IgcGx1Z2luIGluc3RhbnRpYXRpb24uXG4gICAqXG4gICAqIEZvciBleGFtcGxlOlxuICAgKiByZXR1cm4gbmV3IFN0YXRlSGlzdG9yeSh0aGlzLnF1ZXJ5LCB0aGlzLnBhcmFtcywgaWQpIGFzIFA7XG4gICAqL1xuICBwcm90ZWN0ZWQgYWJzdHJhY3QgaW5zdGFudGlhdGVQbHVnaW4oaWQ6IElEKTogUDtcblxuICAvKipcbiAgICogVGhpcyBtZXRob2QgaXMgcmVzcG9uc2libGUgZm9yIGNsZWFuaW5nLlxuICAgKi9cbiAgcHVibGljIGFic3RyYWN0IGRlc3Ryb3koaWQ/OiBJRCk7XG5cbiAgLyoqXG4gICAqIExvb3Agb3ZlciBlYWNoIGlkIGFuZCBpbnZva2UgdGhlIHBsdWdpbiBtZXRob2QuXG4gICAqL1xuICBwcm90ZWN0ZWQgZm9yRWFjaElkKGlkczogSURTLCBjYjogKGVudGl0eTogUCkgPT4gYW55KSB7XG4gICAgY29uc3QgX2lkcyA9IHRoaXMucmVzb2x2ZWRJZHMoaWRzKTtcblxuICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBfaWRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBjb25zdCBpZCA9IF9pZHNbaV07XG4gICAgICBpZiAodGhpcy5oYXNFbnRpdHkoaWQpKSB7XG4gICAgICAgIGNiKHRoaXMuZ2V0RW50aXR5KGlkKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBmaWx0ZXIsIHBhaXJ3aXNlIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgX19nbG9iYWxTdGF0ZSB9IGZyb20gJy4uLy4uL2ludGVybmFsL2dsb2JhbC1zdGF0ZSc7XG5pbXBvcnQgeyB0b0Jvb2xlYW4gfSBmcm9tICcuLi8uLi9pbnRlcm5hbC91dGlscyc7XG5pbXBvcnQgeyBBa2l0YVBsdWdpbiwgUXVlcmllcyB9IGZyb20gJy4uL3BsdWdpbic7XG5pbXBvcnQgeyBFbnRpdHlQYXJhbSB9IGZyb20gJy4uL2VudGl0eS1jb2xsZWN0aW9uLXBsdWdpbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGVIaXN0b3J5UGFyYW1zIHtcbiAgbWF4QWdlPzogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgU3RhdGVIaXN0b3J5UGx1Z2luPEUgPSBhbnksIFMgPSBhbnk+IGV4dGVuZHMgQWtpdGFQbHVnaW48RSwgUz4ge1xuICAvKiogQWxsb3cgc2tpcHBpbmcgYW4gdXBkYXRlIGZyb20gb3V0c2lkZSAqL1xuICBwcml2YXRlIHNraXAgPSBmYWxzZTtcblxuICBwcml2YXRlIGhpc3RvcnkgPSB7XG4gICAgcGFzdDogW10sXG4gICAgcHJlc2VudDogbnVsbCxcbiAgICBmdXR1cmU6IFtdXG4gIH07XG5cbiAgLyoqIFNraXAgdGhlIHVwZGF0ZSB3aGVuIHJlZG8vdW5kbyAqL1xuICBwcml2YXRlIHNraXBVcGRhdGUgPSBmYWxzZTtcbiAgcHJpdmF0ZSBzdWJzY3JpcHRpb247XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIHF1ZXJ5OiBRdWVyaWVzPEUsIFM+LCBwcml2YXRlIHBhcmFtczogU3RhdGVIaXN0b3J5UGFyYW1zID0ge30sIHByaXZhdGUgX2VudGl0eUlkPzogRW50aXR5UGFyYW0pIHtcbiAgICBzdXBlcihxdWVyeSwge1xuICAgICAgcmVzZXRGbjogKCkgPT4gdGhpcy5jbGVhcigpXG4gICAgfSk7XG4gICAgcGFyYW1zLm1heEFnZSA9IHRvQm9vbGVhbihwYXJhbXMubWF4QWdlKSA/IHBhcmFtcy5tYXhBZ2UgOiAxMDtcbiAgICB0aGlzLmFjdGl2YXRlKCk7XG4gIH1cblxuICBnZXQgaGFzUGFzdCgpIHtcbiAgICByZXR1cm4gdGhpcy5oaXN0b3J5LnBhc3QubGVuZ3RoID4gMDtcbiAgfVxuXG4gIGdldCBoYXNGdXR1cmUoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGlzdG9yeS5mdXR1cmUubGVuZ3RoID4gMDtcbiAgfVxuXG4gIGFjdGl2YXRlKCkge1xuICAgIHRoaXMuaGlzdG9yeS5wcmVzZW50ID0gdGhpcy5nZXRTb3VyY2UodGhpcy5fZW50aXR5SWQpO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gdGhpcy5zZWxlY3RTb3VyY2UodGhpcy5fZW50aXR5SWQpXG4gICAgICAucGlwZShwYWlyd2lzZSgpKVxuICAgICAgLnN1YnNjcmliZSgoW3Bhc3QsIHByZXNlbnRdKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnNraXApIHtcbiAgICAgICAgICB0aGlzLnNraXAgPSBmYWxzZTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnNraXBVcGRhdGUpIHtcbiAgICAgICAgICBpZiAodGhpcy5oaXN0b3J5LnBhc3QubGVuZ3RoID09PSB0aGlzLnBhcmFtcy5tYXhBZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuaGlzdG9yeS5wYXN0ID0gdGhpcy5oaXN0b3J5LnBhc3Quc2xpY2UoMSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuaGlzdG9yeS5wYXN0ID0gWy4uLnRoaXMuaGlzdG9yeS5wYXN0LCBwYXN0XTtcbiAgICAgICAgICB0aGlzLmhpc3RvcnkucHJlc2VudCA9IHByZXNlbnQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgdW5kbygpIHtcbiAgICBpZiAodGhpcy5oaXN0b3J5LnBhc3QubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgeyBwYXN0LCBwcmVzZW50LCBmdXR1cmUgfSA9IHRoaXMuaGlzdG9yeTtcbiAgICAgIGNvbnN0IHByZXZpb3VzID0gcGFzdFtwYXN0Lmxlbmd0aCAtIDFdO1xuICAgICAgY29uc3QgbmV3UGFzdCA9IHBhc3Quc2xpY2UoMCwgcGFzdC5sZW5ndGggLSAxKTtcblxuICAgICAgdGhpcy5oaXN0b3J5LnBhc3QgPSBuZXdQYXN0O1xuICAgICAgdGhpcy5oaXN0b3J5LnByZXNlbnQgPSBwcmV2aW91cztcbiAgICAgIHRoaXMuaGlzdG9yeS5mdXR1cmUgPSBbcHJlc2VudCwgLi4udGhpcy5oaXN0b3J5LmZ1dHVyZV07XG4gICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH1cbiAgfVxuXG4gIHJlZG8oKSB7XG4gICAgaWYgKHRoaXMuaGlzdG9yeS5mdXR1cmUubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgeyBwYXN0LCBwcmVzZW50LCBmdXR1cmUgfSA9IHRoaXMuaGlzdG9yeTtcbiAgICAgIGNvbnN0IG5leHQgPSB0aGlzLmhpc3RvcnkuZnV0dXJlWzBdO1xuICAgICAgY29uc3QgbmV3RnV0dXJlID0gdGhpcy5oaXN0b3J5LmZ1dHVyZS5zbGljZSgxKTtcbiAgICAgIHRoaXMuaGlzdG9yeS5wYXN0ID0gWy4uLnBhc3QsIHByZXNlbnRdO1xuICAgICAgdGhpcy5oaXN0b3J5LnByZXNlbnQgPSBuZXh0O1xuICAgICAgdGhpcy5oaXN0b3J5LmZ1dHVyZSA9IG5ld0Z1dHVyZTtcbiAgICAgIHRoaXMudXBkYXRlKCdSZWRvJyk7XG4gICAgfVxuICB9XG5cbiAganVtcFRvUGFzdChpbmRleDogbnVtYmVyKSB7XG4gICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmhpc3RvcnkucGFzdC5sZW5ndGgpIHJldHVybjtcblxuICAgIGNvbnN0IHsgcGFzdCwgZnV0dXJlIH0gPSB0aGlzLmhpc3Rvcnk7XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBjb25zdCBwYXN0ID0gWzEsIDIsIDMsIDQsIDVdO1xuICAgICAqXG4gICAgICogbmV3UGFzdCA9IHBhc3Quc2xpY2UoMCwgMikgPSBbMSwgMl07XG4gICAgICogcHJlc2VudCA9IHBhc3RbaW5kZXhdID0gMztcbiAgICAgKiBbLi4ucGFzdC5zbGljZSgyICsgMSksIC4uLmZ1dHVyZV0gPSBbNCwgNV07XG4gICAgICpcbiAgICAgKi9cbiAgICBjb25zdCBuZXdQYXN0ID0gcGFzdC5zbGljZSgwLCBpbmRleCk7XG4gICAgY29uc3QgbmV3RnV0dXJlID0gWy4uLnBhc3Quc2xpY2UoaW5kZXggKyAxKSwgLi4uZnV0dXJlXTtcbiAgICBjb25zdCBuZXdQcmVzZW50ID0gcGFzdFtpbmRleF07XG4gICAgdGhpcy5oaXN0b3J5LnBhc3QgPSBuZXdQYXN0O1xuICAgIHRoaXMuaGlzdG9yeS5wcmVzZW50ID0gbmV3UHJlc2VudDtcbiAgICB0aGlzLmhpc3RvcnkuZnV0dXJlID0gbmV3RnV0dXJlO1xuICAgIHRoaXMudXBkYXRlKCk7XG4gIH1cblxuICBqdW1wVG9GdXR1cmUoaW5kZXg6IG51bWJlcikge1xuICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5oaXN0b3J5LmZ1dHVyZS5sZW5ndGgpIHJldHVybjtcblxuICAgIGNvbnN0IHsgcGFzdCwgZnV0dXJlIH0gPSB0aGlzLmhpc3Rvcnk7XG5cbiAgICBjb25zdCBuZXdQYXN0ID0gWy4uLnBhc3QsIC4uLmZ1dHVyZS5zbGljZSgwLCBpbmRleCldO1xuICAgIGNvbnN0IG5ld1ByZXNlbnQgPSBmdXR1cmVbaW5kZXhdO1xuICAgIGNvbnN0IG5ld0Z1dHVyZSA9IGZ1dHVyZS5zbGljZShpbmRleCArIDEpO1xuXG4gICAgdGhpcy5oaXN0b3J5LnBhc3QgPSBuZXdQYXN0O1xuICAgIHRoaXMuaGlzdG9yeS5wcmVzZW50ID0gbmV3UHJlc2VudDtcbiAgICB0aGlzLmhpc3RvcnkuZnV0dXJlID0gbmV3RnV0dXJlO1xuICAgIHRoaXMudXBkYXRlKCdSZWRvJyk7XG4gIH1cblxuICBjbGVhcigpIHtcbiAgICB0aGlzLmhpc3RvcnkgPSB7XG4gICAgICBwYXN0OiBbXSxcbiAgICAgIHByZXNlbnQ6IG51bGwsXG4gICAgICBmdXR1cmU6IFtdXG4gICAgfTtcbiAgfVxuXG4gIGRlc3Ryb3koY2xlYXJIaXN0b3J5ID0gZmFsc2UpIHtcbiAgICBpZiAoY2xlYXJIaXN0b3J5KSB7XG4gICAgICB0aGlzLmNsZWFyKCk7XG4gICAgfVxuICAgIHRoaXMuc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBpZ25vcmVOZXh0KCkge1xuICAgIHRoaXMuc2tpcCA9IHRydWU7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZShhY3Rpb24gPSAnVW5kbycpIHtcbiAgICB0aGlzLnNraXBVcGRhdGUgPSB0cnVlO1xuICAgIF9fZ2xvYmFsU3RhdGUuc2V0Q3VzdG9tQWN0aW9uKHsgdHlwZTogYEBTdGF0ZUhpc3RvcnkgLSAke2FjdGlvbn1gIH0pO1xuICAgIHRoaXMudXBkYXRlU3RvcmUodGhpcy5oaXN0b3J5LnByZXNlbnQsIHRoaXMuX2VudGl0eUlkKTtcbiAgICB0aGlzLnNraXBVcGRhdGUgPSBmYWxzZTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgSUQsIElEUyB9IGZyb20gJy4uLy4uL2FwaS90eXBlcyc7XG5pbXBvcnQgeyBRdWVyeUVudGl0eSB9IGZyb20gJy4uLy4uL2FwaS9xdWVyeS1lbnRpdHknO1xuaW1wb3J0IHsgU3RhdGVIaXN0b3J5UGx1Z2luLCBTdGF0ZUhpc3RvcnlQYXJhbXMgfSBmcm9tICcuL3N0YXRlLWhpc3RvcnktcGx1Z2luJztcbmltcG9ydCB7IHRvQm9vbGVhbiB9IGZyb20gJy4uLy4uL2ludGVybmFsL3V0aWxzJztcbmltcG9ydCB7IHNraXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBFbnRpdHlDb2xsZWN0aW9uUGx1Z2luLCBFbnRpdHlDb2xsZWN0aW9uUGFyYW1zIH0gZnJvbSAnLi4vZW50aXR5LWNvbGxlY3Rpb24tcGx1Z2luJztcblxuZXhwb3J0IGludGVyZmFjZSBTdGF0ZUhpc3RvcnlFbnRpdHlQYXJhbXMgZXh0ZW5kcyBTdGF0ZUhpc3RvcnlQYXJhbXMge1xuICBlbnRpdHlJZHM/OiBFbnRpdHlDb2xsZWN0aW9uUGFyYW1zO1xufVxuXG5leHBvcnQgY2xhc3MgRW50aXR5U3RhdGVIaXN0b3J5UGx1Z2luPEUsIFAgZXh0ZW5kcyBTdGF0ZUhpc3RvcnlQbHVnaW48RSwgYW55PiA9IFN0YXRlSGlzdG9yeVBsdWdpbjxFLCBhbnk+PiBleHRlbmRzIEVudGl0eUNvbGxlY3Rpb25QbHVnaW48RSwgUD4ge1xuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgcXVlcnk6IFF1ZXJ5RW50aXR5PGFueSwgRT4sIHByb3RlY3RlZCByZWFkb25seSBwYXJhbXM6IFN0YXRlSGlzdG9yeUVudGl0eVBhcmFtcyA9IHt9KSB7XG4gICAgc3VwZXIocXVlcnksIHBhcmFtcy5lbnRpdHlJZHMpO1xuICAgIHBhcmFtcy5tYXhBZ2UgPSB0b0Jvb2xlYW4ocGFyYW1zLm1heEFnZSkgPyBwYXJhbXMubWF4QWdlIDogMTA7XG4gICAgdGhpcy5hY3RpdmF0ZSgpO1xuICAgIHRoaXMuc2VsZWN0SWRzKClcbiAgICAgIC5waXBlKHNraXAoMSkpXG4gICAgICAuc3Vic2NyaWJlKGlkcyA9PiB0aGlzLmFjdGl2YXRlKGlkcykpO1xuICB9XG5cbiAgcmVkbyhpZHM/OiBJRFMpIHtcbiAgICB0aGlzLmZvckVhY2hJZChpZHMsIGUgPT4gZS5yZWRvKCkpO1xuICB9XG5cbiAgdW5kbyhpZHM/OiBJRFMpIHtcbiAgICB0aGlzLmZvckVhY2hJZChpZHMsIGUgPT4gZS51bmRvKCkpO1xuICB9XG5cbiAgaGFzUGFzdChpZDogSUQpIHtcbiAgICBpZiAodGhpcy5oYXNFbnRpdHkoaWQpKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRFbnRpdHkoaWQpLmhhc1Bhc3Q7XG4gICAgfVxuICB9XG5cbiAgaGFzRnV0dXJlKGlkOiBJRCkge1xuICAgIGlmICh0aGlzLmhhc0VudGl0eShpZCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldEVudGl0eShpZCkuaGFzRnV0dXJlO1xuICAgIH1cbiAgfVxuXG4gIGp1bXBUb0Z1dHVyZShpZHM6IElEUywgaW5kZXg6IG51bWJlcikge1xuICAgIHRoaXMuZm9yRWFjaElkKGlkcywgZSA9PiBlLmp1bXBUb0Z1dHVyZShpbmRleCkpO1xuICB9XG5cbiAganVtcFRvUGFzdChpZHM6IElEUywgaW5kZXg6IG51bWJlcikge1xuICAgIHRoaXMuZm9yRWFjaElkKGlkcywgZSA9PiBlLmp1bXBUb1Bhc3QoaW5kZXgpKTtcbiAgfVxuXG4gIGNsZWFyKGlkcz86IElEUykge1xuICAgIHRoaXMuZm9yRWFjaElkKGlkcywgZSA9PiBlLmNsZWFyKCkpO1xuICB9XG5cbiAgZGVzdHJveShpZHM/OiBJRFMsIGNsZWFySGlzdG9yeSA9IGZhbHNlKSB7XG4gICAgdGhpcy5mb3JFYWNoSWQoaWRzLCBlID0+IGUuZGVzdHJveShjbGVhckhpc3RvcnkpKTtcbiAgfVxuXG4gIGlnbm9yZU5leHQoaWRzPzogSURTKSB7XG4gICAgdGhpcy5mb3JFYWNoSWQoaWRzLCBlID0+IGUuaWdub3JlTmV4dCgpKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBpbnN0YW50aWF0ZVBsdWdpbihpZDogSUQpIHtcbiAgICByZXR1cm4gbmV3IFN0YXRlSGlzdG9yeVBsdWdpbjxFLCBhbnk+KHRoaXMucXVlcnksIHRoaXMucGFyYW1zLCBpZCkgYXMgUDtcbiAgfVxufVxuIiwiaW1wb3J0IHsgQWtpdGFQbHVnaW4sIFF1ZXJpZXMgfSBmcm9tICcuLi9wbHVnaW4nO1xuaW1wb3J0IHsgUXVlcnlFbnRpdHkgfSBmcm9tICcuLi8uLi9hcGkvcXVlcnktZW50aXR5JztcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgT2JzZXJ2YWJsZSwgU3ViamVjdCwgU3Vic2NyaXB0aW9uLCBjb21iaW5lTGF0ZXN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBkaXN0aW5jdFVudGlsQ2hhbmdlZCwgbWFwLCBza2lwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgY29lcmNlQXJyYXksIGlzRnVuY3Rpb24sIGlzVW5kZWZpbmVkLCB0b0Jvb2xlYW4gfSBmcm9tICcuLi8uLi9pbnRlcm5hbC91dGlscyc7XG5pbXBvcnQgeyBFbnRpdHlQYXJhbSB9IGZyb20gJy4uL2VudGl0eS1jb2xsZWN0aW9uLXBsdWdpbic7XG5pbXBvcnQgeyBfX2dsb2JhbFN0YXRlIH0gZnJvbSAnLi4vLi4vaW50ZXJuYWwvZ2xvYmFsLXN0YXRlJztcbmltcG9ydCB7IFF1ZXJ5IH0gZnJvbSAnLi4vLi4vYXBpL3F1ZXJ5JztcblxudHlwZSBIZWFkPFN0b3JlU3RhdGUgPSBhbnksIEVudGl0eSA9IGFueT4gPSBTdG9yZVN0YXRlIHwgUGFydGlhbDxTdG9yZVN0YXRlPiB8IEVudGl0eTtcblxuZXhwb3J0IHR5cGUgRGlydHlDaGVja0NvbXBhcmF0b3I8RW50aXR5PiA9IChoZWFkOiBFbnRpdHksIGN1cnJlbnQ6IEVudGl0eSkgPT4gYm9vbGVhbjtcblxuZXhwb3J0IHR5cGUgRGlydHlDaGVja1BhcmFtczxTdG9yZVN0YXRlID0gYW55PiA9IHtcbiAgY29tcGFyYXRvcj86IERpcnR5Q2hlY2tDb21wYXJhdG9yPFN0b3JlU3RhdGU+O1xuICB3YXRjaFByb3BlcnR5Pzoga2V5b2YgU3RvcmVTdGF0ZSB8IChrZXlvZiBTdG9yZVN0YXRlKVtdO1xufTtcblxuZXhwb3J0IGNvbnN0IGRpcnR5Q2hlY2tEZWZhdWx0UGFyYW1zID0ge1xuICBjb21wYXJhdG9yOiAoaGVhZCwgY3VycmVudCkgPT4gSlNPTi5zdHJpbmdpZnkoaGVhZCkgIT09IEpTT04uc3RyaW5naWZ5KGN1cnJlbnQpXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmVzdGVkUGF0aChuZXN0ZWRPYmosIHBhdGg6IHN0cmluZykge1xuICBjb25zdCBwYXRoQXNBcnJheTogc3RyaW5nW10gPSBwYXRoLnNwbGl0KCcuJyk7XG4gIHJldHVybiBwYXRoQXNBcnJheS5yZWR1Y2UoKG9iaiwga2V5KSA9PiAob2JqICYmIG9ialtrZXldICE9PSAndW5kZWZpbmVkJyA/IG9ialtrZXldIDogdW5kZWZpbmVkKSwgbmVzdGVkT2JqKTtcbn1cblxuZXhwb3J0IHR5cGUgRGlydHlDaGVja1Jlc2V0UGFyYW1zPFN0b3JlU3RhdGUgPSBhbnk+ID0ge1xuICB1cGRhdGVGbj86IFN0b3JlU3RhdGUgfCAoKGhlYWQ6IFN0b3JlU3RhdGUsIGN1cnJlbnQ6IFN0b3JlU3RhdGUpID0+IGFueSk7XG59O1xuXG5leHBvcnQgY2xhc3MgRGlydHlDaGVja1BsdWdpbjxFbnRpdHkgPSBhbnksIFN0b3JlU3RhdGUgPSBhbnk+IGV4dGVuZHMgQWtpdGFQbHVnaW48RW50aXR5LCBTdG9yZVN0YXRlPiB7XG4gIHByaXZhdGUgaGVhZDogSGVhZDxTdG9yZVN0YXRlLCBFbnRpdHk+O1xuICBwcml2YXRlIGRpcnR5ID0gbmV3IEJlaGF2aW9yU3ViamVjdChmYWxzZSk7XG4gIHByaXZhdGUgc3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG4gIHByaXZhdGUgYWN0aXZlID0gZmFsc2U7XG4gIHByaXZhdGUgX3Jlc2V0ID0gbmV3IFN1YmplY3QoKTtcblxuICBpc0RpcnR5JDogT2JzZXJ2YWJsZTxib29sZWFuPiA9IHRoaXMuZGlydHkuYXNPYnNlcnZhYmxlKCkucGlwZShkaXN0aW5jdFVudGlsQ2hhbmdlZCgpKTtcbiAgcmVzZXQkID0gdGhpcy5fcmVzZXQuYXNPYnNlcnZhYmxlKCk7XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIHF1ZXJ5OiBRdWVyaWVzPEVudGl0eSwgU3RvcmVTdGF0ZT4sIHByaXZhdGUgcGFyYW1zPzogRGlydHlDaGVja1BhcmFtcywgcHJpdmF0ZSBfZW50aXR5SWQ/OiBFbnRpdHlQYXJhbSkge1xuICAgIHN1cGVyKHF1ZXJ5KTtcbiAgICB0aGlzLnBhcmFtcyA9IHsgLi4uZGlydHlDaGVja0RlZmF1bHRQYXJhbXMsIC4uLnBhcmFtcyB9O1xuICAgIGlmICh0aGlzLnBhcmFtcy53YXRjaFByb3BlcnR5KSB7XG4gICAgICBsZXQgd2F0Y2hQcm9wID0gY29lcmNlQXJyYXkodGhpcy5wYXJhbXMud2F0Y2hQcm9wZXJ0eSkgYXMgYW55W107XG4gICAgICBpZiAocXVlcnkgaW5zdGFuY2VvZiBRdWVyeUVudGl0eSAmJiB3YXRjaFByb3AuaW5jbHVkZXMoJ2VudGl0aWVzJykgJiYgIXdhdGNoUHJvcC5pbmNsdWRlcygnaWRzJykpIHtcbiAgICAgICAgd2F0Y2hQcm9wLnB1c2goJ2lkcycpO1xuICAgICAgfVxuICAgICAgdGhpcy5wYXJhbXMud2F0Y2hQcm9wZXJ0eSA9IHdhdGNoUHJvcDtcbiAgICB9XG4gIH1cblxuICByZXNldChwYXJhbXM6IERpcnR5Q2hlY2tSZXNldFBhcmFtcyA9IHt9KSB7XG4gICAgbGV0IGN1cnJlbnRWYWx1ZSA9IHRoaXMuaGVhZDtcbiAgICBpZiAoaXNGdW5jdGlvbihwYXJhbXMudXBkYXRlRm4pKSB7XG4gICAgICBpZiAodGhpcy5pc0VudGl0eUJhc2VkKHRoaXMuX2VudGl0eUlkKSkge1xuICAgICAgICBjdXJyZW50VmFsdWUgPSBwYXJhbXMudXBkYXRlRm4odGhpcy5oZWFkLCAodGhpcy5nZXRRdWVyeSgpIGFzIFF1ZXJ5RW50aXR5PFN0b3JlU3RhdGUsIEVudGl0eT4pLmdldEVudGl0eSh0aGlzLl9lbnRpdHlJZCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudFZhbHVlID0gcGFyYW1zLnVwZGF0ZUZuKHRoaXMuaGVhZCwgKHRoaXMuZ2V0UXVlcnkoKSBhcyBRdWVyeTxTdG9yZVN0YXRlPikuZ2V0U25hcHNob3QoKSk7XG4gICAgICB9XG4gICAgfVxuICAgIF9fZ2xvYmFsU3RhdGUuc2V0Q3VzdG9tQWN0aW9uKHsgdHlwZTogYEBEaXJ0eUNoZWNrIC0gUmV2ZXJ0YCB9KTtcbiAgICB0aGlzLnVwZGF0ZVN0b3JlKGN1cnJlbnRWYWx1ZSwgdGhpcy5fZW50aXR5SWQpO1xuICAgIHRoaXMuX3Jlc2V0Lm5leHQoKTtcbiAgfVxuXG4gIHNldEhlYWQoKSB7XG4gICAgaWYgKCF0aGlzLmFjdGl2ZSkge1xuICAgICAgdGhpcy5hY3RpdmF0ZSgpO1xuICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhlYWQgPSB0aGlzLl9nZXRIZWFkKCk7XG4gICAgfVxuICAgIHRoaXMudXBkYXRlRGlydGluZXNzKGZhbHNlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGlzRGlydHkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRvQm9vbGVhbih0aGlzLmRpcnR5LnZhbHVlKTtcbiAgfVxuXG4gIGhhc0hlYWQoKSB7XG4gICAgcmV0dXJuIHRvQm9vbGVhbih0aGlzLmdldEhlYWQoKSk7XG4gIH1cblxuICBkZXN0cm95KCkge1xuICAgIHRoaXMuaGVhZCA9IG51bGw7XG4gICAgdGhpcy5zdWJzY3JpcHRpb24gJiYgdGhpcy5zdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICB0aGlzLl9yZXNldCAmJiB0aGlzLl9yZXNldC5jb21wbGV0ZSgpO1xuICB9XG5cbiAgaXNQYXRoRGlydHkocGF0aDogc3RyaW5nKSB7XG4gICAgY29uc3QgaGVhZCA9IHRoaXMuZ2V0SGVhZCgpO1xuICAgIGNvbnN0IGN1cnJlbnQgPSAodGhpcy5nZXRRdWVyeSgpIGFzIFF1ZXJ5PFN0b3JlU3RhdGU+KS5nZXRTbmFwc2hvdCgpO1xuICAgIGNvbnN0IGN1cnJlbnRQYXRoVmFsdWUgPSBnZXROZXN0ZWRQYXRoKGN1cnJlbnQsIHBhdGgpO1xuICAgIGNvbnN0IGhlYWRQYXRoVmFsdWUgPSBnZXROZXN0ZWRQYXRoKGhlYWQsIHBhdGgpO1xuXG4gICAgcmV0dXJuIHRoaXMucGFyYW1zLmNvbXBhcmF0b3IoY3VycmVudFBhdGhWYWx1ZSwgaGVhZFBhdGhWYWx1ZSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0SGVhZCgpIHtcbiAgICByZXR1cm4gdGhpcy5oZWFkO1xuICB9XG5cbiAgcHJpdmF0ZSBhY3RpdmF0ZSgpIHtcbiAgICB0aGlzLmhlYWQgPSB0aGlzLl9nZXRIZWFkKCk7XG4gICAgLyoqIGlmIHdlIGFyZSB0cmFja2luZyBzcGVjaWZpYyBwcm9wZXJ0aWVzIHNlbGVjdCBvbmx5IHRoZSByZWxldmFudCBvbmVzICovXG4gICAgY29uc3Qgc291cmNlID0gdGhpcy5wYXJhbXMud2F0Y2hQcm9wZXJ0eVxuICAgICAgPyAodGhpcy5wYXJhbXMud2F0Y2hQcm9wZXJ0eSBhcyAoa2V5b2YgU3RvcmVTdGF0ZSlbXSkubWFwKHByb3AgPT5cbiAgICAgICAgICB0aGlzLnF1ZXJ5LnNlbGVjdChzdGF0ZSA9PiBzdGF0ZVtwcm9wXSkucGlwZShcbiAgICAgICAgICAgIG1hcCh2YWwgPT4gKHtcbiAgICAgICAgICAgICAgdmFsLFxuICAgICAgICAgICAgICBfX2FraXRhS2V5OiBwcm9wXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIDogW3RoaXMuc2VsZWN0U291cmNlKHRoaXMuX2VudGl0eUlkKV07XG4gICAgdGhpcy5zdWJzY3JpcHRpb24gPSBjb21iaW5lTGF0ZXN0KC4uLnNvdXJjZSlcbiAgICAgIC5waXBlKHNraXAoMSkpXG4gICAgICAuc3Vic2NyaWJlKChjdXJyZW50U3RhdGU6IGFueVtdKSA9PiB7XG4gICAgICAgIGlmIChpc1VuZGVmaW5lZCh0aGlzLmhlYWQpKSByZXR1cm47XG4gICAgICAgIC8qKiBfX2FraXRhS2V5IGlzIHVzZWQgdG8gZGV0ZXJtaW5lIGlmIHdlIGFyZSB0cmFja2luZyBhIHNwZWNpZmljIHByb3BlcnR5IG9yIGEgc3RvcmUgY2hhbmdlICovXG4gICAgICAgIGNvbnN0IGlzQ2hhbmdlID0gY3VycmVudFN0YXRlLnNvbWUoc3RhdGUgPT4ge1xuICAgICAgICAgIGNvbnN0IGhlYWQgPSBzdGF0ZS5fX2FraXRhS2V5ID8gdGhpcy5oZWFkW3N0YXRlLl9fYWtpdGFLZXkgYXMgYW55XSA6IHRoaXMuaGVhZDtcbiAgICAgICAgICBjb25zdCBjb21wYXJlVG8gPSBzdGF0ZS5fX2FraXRhS2V5ID8gc3RhdGUudmFsIDogc3RhdGU7XG5cbiAgICAgICAgICByZXR1cm4gdGhpcy5wYXJhbXMuY29tcGFyYXRvcihoZWFkLCBjb21wYXJlVG8pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnVwZGF0ZURpcnRpbmVzcyhpc0NoYW5nZSk7XG4gICAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlRGlydGluZXNzKGlzRGlydHk6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmRpcnR5Lm5leHQoaXNEaXJ0eSk7XG4gIH1cblxuICBwcml2YXRlIF9nZXRIZWFkKCk6IEhlYWQ8U3RvcmVTdGF0ZSwgRW50aXR5PiB7XG4gICAgbGV0IGhlYWQ6IEhlYWQ8U3RvcmVTdGF0ZSwgRW50aXR5PiA9IHRoaXMuZ2V0U291cmNlKHRoaXMuX2VudGl0eUlkKTtcbiAgICBpZiAodGhpcy5wYXJhbXMud2F0Y2hQcm9wZXJ0eSkge1xuICAgICAgaGVhZCA9IHRoaXMuZ2V0V2F0Y2hlZFZhbHVlcyhoZWFkIGFzIFN0b3JlU3RhdGUpO1xuICAgIH1cbiAgICByZXR1cm4gaGVhZDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0V2F0Y2hlZFZhbHVlcyhzb3VyY2U6IFN0b3JlU3RhdGUpOiBQYXJ0aWFsPFN0b3JlU3RhdGU+IHtcbiAgICByZXR1cm4gKHRoaXMucGFyYW1zLndhdGNoUHJvcGVydHkgYXMgKGtleW9mIFN0b3JlU3RhdGUpW10pLnJlZHVjZShcbiAgICAgICh3YXRjaGVkLCBwcm9wKSA9PiB7XG4gICAgICAgIHdhdGNoZWRbcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gICAgICAgIHJldHVybiB3YXRjaGVkO1xuICAgICAgfSxcbiAgICAgIHt9IGFzIFBhcnRpYWw8U3RvcmVTdGF0ZT5cbiAgICApO1xuICB9XG59XG4iLCJpbXBvcnQgeyBIYXNoTWFwLCBJRCwgSURTIH0gZnJvbSAnLi4vLi4vYXBpL3R5cGVzJztcbmltcG9ydCB7XG4gIERpcnR5Q2hlY2tDb21wYXJhdG9yLFxuICBkaXJ0eUNoZWNrRGVmYXVsdFBhcmFtcyxcbiAgRGlydHlDaGVja1BsdWdpbixcbiAgRGlydHlDaGVja1Jlc2V0UGFyYW1zLFxuICBnZXROZXN0ZWRQYXRoXG59IGZyb20gJy4vZGlydHktY2hlY2stcGx1Z2luJztcbmltcG9ydCB7IFF1ZXJ5RW50aXR5IH0gZnJvbSAnLi4vLi4vYXBpL3F1ZXJ5LWVudGl0eSc7XG5pbXBvcnQgeyBFbnRpdHlDb2xsZWN0aW9uUGx1Z2luIH0gZnJvbSAnLi4vZW50aXR5LWNvbGxlY3Rpb24tcGx1Z2luJztcbmltcG9ydCB7IG1hcCwgc2tpcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcblxuZXhwb3J0IHR5cGUgRGlydHlDaGVja0NvbGxlY3Rpb25QYXJhbXM8RT4gPSB7XG4gIGNvbXBhcmF0b3I/OiBEaXJ0eUNoZWNrQ29tcGFyYXRvcjxFPjtcbiAgZW50aXR5SWRzPzogSUQgfCBJRFtdO1xufTtcblxuZXhwb3J0IGNsYXNzIEVudGl0eURpcnR5Q2hlY2tQbHVnaW48RSwgUCBleHRlbmRzIERpcnR5Q2hlY2tQbHVnaW48RSwgYW55PiA9IERpcnR5Q2hlY2tQbHVnaW48RSwgYW55Pj4gZXh0ZW5kcyBFbnRpdHlDb2xsZWN0aW9uUGx1Z2luPEUsIFA+IHtcbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkIFVzZSBzb21lRGlydHkkIGluc3RlYWRcbiAgICovXG4gIGlzU29tZURpcnR5JDogT2JzZXJ2YWJsZTxib29sZWFuPiA9IHRoaXMucXVlcnkuc2VsZWN0KHN0YXRlID0+IHN0YXRlLmVudGl0aWVzKS5waXBlKG1hcCgoZW50aXRpZXM6IGFueSkgPT4gdGhpcy5jaGVja1NvbWVEaXJ0eShlbnRpdGllcykpKTtcblxuICBzb21lRGlydHkkID0gdGhpcy5pc1NvbWVEaXJ0eSQ7XG4gIHNvbWVEaXJ0eSA9IHRoaXMuaXNTb21lRGlydHk7XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIHF1ZXJ5OiBRdWVyeUVudGl0eTxhbnksIEU+LCBwcml2YXRlIHJlYWRvbmx5IHBhcmFtczogRGlydHlDaGVja0NvbGxlY3Rpb25QYXJhbXM8RT4gPSB7fSkge1xuICAgIHN1cGVyKHF1ZXJ5LCBwYXJhbXMuZW50aXR5SWRzKTtcbiAgICB0aGlzLnBhcmFtcyA9IHsgLi4uZGlydHlDaGVja0RlZmF1bHRQYXJhbXMsIC4uLnBhcmFtcyB9O1xuICAgIHRoaXMuYWN0aXZhdGUoKTtcbiAgICB0aGlzLnNlbGVjdElkcygpXG4gICAgICAucGlwZShza2lwKDEpKVxuICAgICAgLnN1YnNjcmliZShpZHMgPT4ge1xuICAgICAgICB0aGlzLnJlYmFzZShpZHMsIHsgYWZ0ZXJBZGQ6IHBsdWdpbiA9PiBwbHVnaW4uc2V0SGVhZCgpIH0pO1xuICAgICAgfSk7XG4gIH1cblxuICBzZXRIZWFkKGlkcz86IElEUykge1xuICAgIHRoaXMuZm9yRWFjaElkKGlkcywgZSA9PiBlLnNldEhlYWQoKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBoYXNIZWFkKGlkOiBJRCk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLmVudGl0aWVzLmhhcyhpZCkpIHtcbiAgICAgIGNvbnN0IGVudGl0eSA9IHRoaXMuZ2V0RW50aXR5KGlkKTtcbiAgICAgIHJldHVybiBlbnRpdHkuaGFzSGVhZCgpO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJlc2V0KGlkcz86IElEUywgcGFyYW1zOiBEaXJ0eUNoZWNrUmVzZXRQYXJhbXMgPSB7fSkge1xuICAgIHRoaXMuZm9yRWFjaElkKGlkcywgZSA9PiBlLnJlc2V0KHBhcmFtcykpO1xuICB9XG5cbiAgaXNEaXJ0eShpZDogSUQpOiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xuICBpc0RpcnR5KGlkOiBJRCwgYXNPYnNlcnZhYmxlOiB0cnVlKTogT2JzZXJ2YWJsZTxib29sZWFuPjtcbiAgaXNEaXJ0eShpZDogSUQsIGFzT2JzZXJ2YWJsZTogZmFsc2UpOiBib29sZWFuO1xuICBpc0RpcnR5KGlkOiBJRCwgYXNPYnNlcnZhYmxlID0gdHJ1ZSk6IE9ic2VydmFibGU8Ym9vbGVhbj4gfCBib29sZWFuIHtcbiAgICBpZiAodGhpcy5lbnRpdGllcy5oYXMoaWQpKSB7XG4gICAgICBjb25zdCBlbnRpdHkgPSB0aGlzLmdldEVudGl0eShpZCk7XG4gICAgICByZXR1cm4gYXNPYnNlcnZhYmxlID8gZW50aXR5LmlzRGlydHkkIDogZW50aXR5LmlzRGlydHkoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQGRlcHJlY2F0ZWQgVXNlIHNvbWVEaXJ0eSgpIGluc3RlYWRcbiAgICovXG4gIGlzU29tZURpcnR5KCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGVudGl0aWVzID0gdGhpcy5xdWVyeS5nZXRBbGwoeyBhc09iamVjdDogdHJ1ZSB9KTtcbiAgICByZXR1cm4gdGhpcy5jaGVja1NvbWVEaXJ0eShlbnRpdGllcyk7XG4gIH1cblxuICBpc1BhdGhEaXJ0eShpZDogSUQsIHBhdGg6IHN0cmluZykge1xuICAgIGlmICh0aGlzLmVudGl0aWVzLmhhcyhpZCkpIHtcbiAgICAgIGNvbnN0IGhlYWQgPSAodGhpcy5nZXRFbnRpdHkoaWQpIGFzIGFueSkuZ2V0SGVhZCgpO1xuICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMucXVlcnkuZ2V0RW50aXR5KGlkKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRQYXRoVmFsdWUgPSBnZXROZXN0ZWRQYXRoKGN1cnJlbnQsIHBhdGgpO1xuICAgICAgY29uc3QgaGVhZFBhdGhWYWx1ZSA9IGdldE5lc3RlZFBhdGgoaGVhZCwgcGF0aCk7XG5cbiAgICAgIHJldHVybiB0aGlzLnBhcmFtcy5jb21wYXJhdG9yKGN1cnJlbnRQYXRoVmFsdWUsIGhlYWRQYXRoVmFsdWUpO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZGVzdHJveShpZHM/OiBJRFMpIHtcbiAgICB0aGlzLmZvckVhY2hJZChpZHMsIGUgPT4gZS5kZXN0cm95KCkpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGluc3RhbnRpYXRlUGx1Z2luKGlkOiBJRCk6IFAge1xuICAgIHJldHVybiBuZXcgRGlydHlDaGVja1BsdWdpbih0aGlzLnF1ZXJ5LCB0aGlzLnBhcmFtcywgaWQpIGFzIFA7XG4gIH1cblxuICBwcml2YXRlIGNoZWNrU29tZURpcnR5KGVudGl0aWVzOiBIYXNoTWFwPEU+KTogYm9vbGVhbiB7XG4gICAgY29uc3QgZW50aXRpZXNJZHMgPSB0aGlzLnJlc29sdmVkSWRzKCk7XG4gICAgZm9yIChjb25zdCBpZCBvZiBlbnRpdGllc0lkcykge1xuICAgICAgY29uc3QgZGlydHkgPSB0aGlzLnBhcmFtcy5jb21wYXJhdG9yKCh0aGlzLmdldEVudGl0eShpZCkgYXMgYW55KS5nZXRIZWFkKCksIGVudGl0aWVzW2lkXSk7XG4gICAgICBpZiAoZGlydHkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgaXNOdW1iZXIgfSBmcm9tICcuLi9pbnRlcm5hbC91dGlscyc7XG5pbXBvcnQgeyBfX3N0b3Jlc19fIH0gZnJvbSAnLi9zdG9yZSc7XG5pbXBvcnQgeyBhcHBseVRyYW5zYWN0aW9uIH0gZnJvbSAnLi90cmFuc2FjdGlvbic7XG5cbi8qKlxuICogQGV4YW1wbGVcbiAqXG4gKiB0aGlzLnBlb3BsZVN0b3JlLnVwZGF0ZShpZCwgcGVyc29uID0+ICh7XG4gKiAgIGd1ZXN0czogaW5jcmVtZW50KHBlcnNvbi5ndWVzdHMpXG4gKiB9KSk7XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbmNyZW1lbnQodmFsdWU6IG51bWJlciwgcGFyYW1zOiB7IG1heFZhbHVlOiBudW1iZXIgfCB1bmRlZmluZWQgfSA9IHsgbWF4VmFsdWU6IHVuZGVmaW5lZCB9KSB7XG4gIGlmIChpc051bWJlcih2YWx1ZSkgPT09IGZhbHNlKSByZXR1cm47XG4gIGlmIChwYXJhbXMubWF4VmFsdWUgJiYgdmFsdWUgPT09IHBhcmFtcy5tYXhWYWx1ZSkgcmV0dXJuIHZhbHVlO1xuICByZXR1cm4gdmFsdWUgKyAxO1xufVxuXG4vKipcbiAqIEBleGFtcGxlXG4gKlxuICogdGhpcy5wZW9wbGVTdG9yZS51cGRhdGUoaWQsIHBlcnNvbiA9PiAoe1xuICogICBndWVzdHM6IGRlY3JlbWVudChwZXJzb24uZ3Vlc3RzKVxuICogfSkpO1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjcmVtZW50KHZhbHVlLCBwYXJhbXM6IHsgYWxsb3dOZWdhdGl2ZTogYm9vbGVhbiB9ID0geyBhbGxvd05lZ2F0aXZlOiBmYWxzZSB9KSB7XG4gIGlmIChpc051bWJlcih2YWx1ZSkgPT09IGZhbHNlKSByZXR1cm47XG4gIGlmIChwYXJhbXMuYWxsb3dOZWdhdGl2ZSA9PT0gZmFsc2UgJiYgdmFsdWUgPT09IDApIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHZhbHVlIC0gMTtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSByYW5kb20gZ3VpZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ3VpZCgpIHtcbiAgcmV0dXJuICd4eHh4eHg0eHl4Jy5yZXBsYWNlKC9beHldL2csIGMgPT4ge1xuICAgIGNvbnN0IHIgPSAoTWF0aC5yYW5kb20oKSAqIDE2KSB8IDAsXG4gICAgICB2ID0gYyA9PSAneCcgPyByIDogKHIgJiAweDMpIHwgMHg4O1xuICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcbiAgfSk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVzZXRTdG9yZXNQYXJhbXMge1xuICAvKipcbiAgICogIEJ5IGRlZmF1bHQgdGhlIHdob2xlIHN0YXRlIGlzIHJlc2V0dGVkLCB1c2UgdGhpcyBwYXJhbSB0byBleGNsdWRlIHN0b3JlcyB0aGF0IHlvdSBkb24ndCB3YW50IHRvIHJlc2V0LlxuICAgKi9cbiAgZXhjbHVkZTogc3RyaW5nW107XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBvcHRpb25zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXNldFN0b3JlcyhvcHRpb25zPzogUGFydGlhbDxSZXNldFN0b3Jlc1BhcmFtcz4pIHtcbiAgY29uc3QgZGVmYXVsdHM6IFJlc2V0U3RvcmVzUGFyYW1zID0ge1xuICAgIGV4Y2x1ZGU6IFtdXG4gIH07XG5cbiAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRzLCBvcHRpb25zKTtcbiAgY29uc3Qgc3RvcmVzID0gT2JqZWN0LmtleXMoX19zdG9yZXNfXyk7XG5cbiAgYXBwbHlUcmFuc2FjdGlvbigoKSA9PiB7XG4gICAgZm9yIChjb25zdCBzdG9yZSBvZiBzdG9yZXMpIHtcbiAgICAgIGNvbnN0IHMgPSBfX3N0b3Jlc19fW3N0b3JlXTtcbiAgICAgIGlmICghb3B0aW9ucy5leGNsdWRlKSB7XG4gICAgICAgIHMucmVzZXQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChvcHRpb25zLmV4Y2x1ZGUuaW5kZXhPZihzLnN0b3JlTmFtZSkgPT09IC0xKSB7XG4gICAgICAgICAgcy5yZXNldCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJza2lwIiwibWFwIiwidHNsaWJfMS5fX2RlY29yYXRlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7Ozs7OztBQUlBLFNBQWdCLFdBQVcsQ0FBSSxLQUFjO0lBQzNDLE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztDQUMvQzs7Ozs7O0FBR0QsU0FBZ0IsUUFBUSxDQUFDLEtBQVU7SUFDakMsT0FBTyxNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssaUJBQWlCLENBQUM7Q0FDcEU7Ozs7O0FBRUQsU0FBZ0IsYUFBYSxDQUFDLEtBQUs7SUFDakMsT0FBTyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxDQUFDLFdBQVcsQ0FBQyxJQUFJLEtBQUssUUFBUSxDQUFDO0NBQ2hFOzs7OztBQUVELFNBQWdCLFVBQVUsQ0FBQyxLQUFLO0lBQzlCLE9BQU8sT0FBTyxLQUFLLEtBQUssVUFBVSxDQUFDO0NBQ3BDOzs7OztBQUVELFNBQWdCLFNBQVMsQ0FBQyxLQUFVO0lBQ2xDLE9BQU8sS0FBSyxJQUFJLElBQUksSUFBSSxHQUFHLEtBQUssRUFBRSxLQUFLLE9BQU8sQ0FBQztDQUNoRDs7Ozs7QUFFRCxTQUFnQixXQUFXLENBQUMsS0FBSztJQUMvQixPQUFPLEtBQUssS0FBSyxTQUFTLENBQUM7Q0FDNUI7Ozs7O0FBRUQsU0FBZ0IsS0FBSyxDQUFDLENBQUM7SUFDckIsT0FBTyxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsS0FBSyxT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