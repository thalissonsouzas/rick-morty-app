(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('rxjs'), require('rxjs/operators')) :
    typeof define === 'function' && define.amd ? define('@datorama/akita', ['exports', 'rxjs', 'rxjs/operators'], factory) :
    (factory((global.datorama = global.datorama || {}, global.datorama.akita = {}),global.rxjs,global.rxjs.operators));
}(this, (function (exports,rxjs,operators) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    /* global Reflect, Promise */
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b)
                if (b.hasOwnProperty(p))
                    d[p] = b[p]; };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function () {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s)
                    if (Object.prototype.hasOwnProperty.call(s, p))
                        t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __rest(s, e) {
        var t = {};
        for (var p in s)
            if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
                t[p] = s[p];
        if (s != null && typeof Object.getOwnPropertySymbols === "function")
            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++)
                if (e.indexOf(p[i]) < 0)
                    t[p[i]] = s[p[i]];
        return t;
    }
    function __decorate(decorators, target, key, desc) {
        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
        if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
            r = Reflect.decorate(decorators, target, key, desc);
        else
            for (var i = decorators.length - 1; i >= 0; i--)
                if (d = decorators[i])
                    r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
        return c > 3 && r && Object.defineProperty(target, key, r), r;
    }
    function __metadata(metadataKey, metadataValue) {
        if (typeof Reflect === "object" && typeof Reflect.metadata === "function")
            return Reflect.metadata(metadataKey, metadataValue);
    }
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m)
            return m.call(o);
        return {
            next: function () {
                if (o && i >= o.length)
                    o = void 0;
                return { value: o && o[i++], done: !o };
            }
        };
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m)
            return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)
                ar.push(r.value);
        }
        catch (error) {
            e = { error: error };
        }
        finally {
            try {
                if (r && !r.done && (m = i["return"]))
                    m.call(i);
            }
            finally {
                if (e)
                    throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++)
            ar = ar.concat(__read(arguments[i]));
        return ar;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * Wraps the provided value in an array, unless the provided _value is an array.
     * @template T
     * @param {?} value
     * @return {?}
     */
    function coerceArray(value) {
        return Array.isArray(value) ? value : [value];
    }
    /**
     * Check if a value is an object
     * @param {?} value
     * @return {?}
     */
    function isObject(value) {
        return Object.prototype.toString.call(value) === '[object Object]';
    }
    /**
     * @param {?} value
     * @return {?}
     */
    function isPlainObject(value) {
        return toBoolean(value) && value.constructor.name === 'Object';
    }
    /**
     * @param {?} value
     * @return {?}
     */
    function isFunction(value) {
        return typeof value === 'function';
    }
    /**
     * @param {?} value
     * @return {?}
     */
    function toBoolean(value) {
        return value != null && "" + value !== 'false';
    }
    /**
     * @param {?} value
     * @return {?}
     */
    function isUndefined(value) {
        return value === undefined;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    function isNil(v) {
        return v === null || v === undefined;
    }
    /**
     * Check if entity exists
     * @template E
     * @param {?} id
     * @param {?} entities
     * @return {?}
     */
    function entityExists(id, entities) {
        return entities.hasOwnProperty(id);
    }
    /**
     * Observable that emits empty value and complete
     * @template T
     * @return {?}
     */
    function noop() {
        return new rxjs.Observable(function (observer) {
            observer.next();
            observer.complete();
        });
    }
    /**
     * @param {?} value
     * @return {?}
     */
    function isObservable(value) {
        return toBoolean(value) && isFunction(value.subscribe);
    }
    /**
     * @param {?} val
     * @return {?}
     */
    function isString(val) {
        return typeof val === 'string';
    }
    /**
     * @param {?} value
     * @return {?}
     */
    function isNumber(value) {
        return typeof value === 'number';
    }
    /**
     * @param {?} val
     * @return {?}
     */
    function isDefined(val) {
        return val !== null && typeof val !== 'undefined';
    }
    /**
     * Check if the active entity exist
     * @template E
     * @param {?} state
     * @return {?}
     */
    function resetActive(state) {
        return isActiveState(state) && entityExists((( /** @type {?} */(state))).active, state.entities) === false;
    }
    /**
     * Check if the store supports active entity
     * @template E
     * @param {?} state
     * @return {?}
     */
    function isActiveState(state) {
        return (( /** @type {?} */(state))).hasOwnProperty('active');
    }
    /**
     * setValue(state, 'todos.ui', { filter: {}})
     * @type {?}
     */
    var setValue = function (obj, prop, val) {
        /** @type {?} */
        var split = prop.split('.');
        if (split.length === 1)
            return val;
        obj = __assign({}, obj);
        /** @type {?} */
        var lastIndex = split.length - 2;
        /** @type {?} */
        var removeStoreName = prop.split('.').slice(1);
        removeStoreName.reduce(function (acc, part, index) {
            if (index === lastIndex) {
                acc[part] = val;
            }
            else {
                acc[part] = __assign({}, acc[part]);
            }
            return acc && acc[part];
        }, obj);
        return obj;
    };
    /**
     * getValue(state, 'todos.ui')
     * @type {?}
     */
    var getValue = function (obj, prop) {
        /** return the whole state  */
        if (prop.split('.').length === 1) {
            return obj;
        }
        /** @type {?} */
        var removeStoreName = prop
            .split('.')
            .slice(1)
            .join('.');
        return removeStoreName.split('.').reduce(function (acc, part) { return acc && acc[part]; }, obj);
    };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    var AkitaError = /** @class */ (function (_super) {
        __extends(AkitaError, _super);
        function AkitaError(message) {
            return _super.call(this, message) || this;
        }
        return AkitaError;
    }(Error));
    var AkitaImmutabilityError = /** @class */ (function (_super) {
        __extends(AkitaImmutabilityError, _super);
        function AkitaImmutabilityError(storeName) {
            return _super.call(this, "The new state should be immutable. Make sure to return a new immutable state. \n store: \n " + storeName) || this;
        }
        return AkitaImmutabilityError;
    }(AkitaError));
    var AkitaEntityNotExistsError = /** @class */ (function (_super) {
        __extends(AkitaEntityNotExistsError, _super);
        function AkitaEntityNotExistsError(id) {
            return _super.call(this, "Entity " + id + " does not exists") || this;
        }
        return AkitaEntityNotExistsError;
    }(AkitaError));
    var AkitaNoActiveError = /** @class */ (function (_super) {
        __extends(AkitaNoActiveError, _super);
        function AkitaNoActiveError() {
            return _super.call(this, "Active is null/undefined") || this;
        }
        return AkitaNoActiveError;
    }(AkitaError));
    var AkitaInvalidEntityState = /** @class */ (function (_super) {
        __extends(AkitaInvalidEntityState, _super);
        function AkitaInvalidEntityState() {
            return _super.call(this, "Entity state is invalid") || this;
        }
        return AkitaInvalidEntityState;
    }(AkitaError));
    var AkitaUpdateIdKeyError = /** @class */ (function (_super) {
        __extends(AkitaUpdateIdKeyError, _super);
        function AkitaUpdateIdKeyError() {
            return _super.call(this, "Updating entity id is not permitted when updating many entities") || this;
        }
        return AkitaUpdateIdKeyError;
    }(AkitaError));
    /**
     * @param {?} id
     * @param {?} entities
     * @return {?}
     */
    function assertEntityExists(id, entities) {
        if (!entityExists(id, entities)) {
            throw new AkitaEntityNotExistsError(id);
        }
    }
    /**
     * @param {?} store
     * @return {?}
     */
    function assertActive(store) {
        if (!toBoolean(store.active)) {
            throw new AkitaNoActiveError();
        }
    }
    /**
     * @param {?} state
     * @return {?}
     */
    function assertEntityState(state) {
        /** @type {?} */
        var assertEntities = isObject(state);
        if (!assertEntities) {
            throw new AkitaInvalidEntityState();
        }
    }
    /**
     * @param {?} name
     * @param {?} className
     * @return {?}
     */
    function assertDecorator(name, className) {
        if (!name) {
            console.error("@StoreConfig({ name }) is missing in " + className);
        }
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    var CRUD = /** @class */ (function () {
        function CRUD() {
        }
        /**
         * @template S, E
         * @param {?} state
         * @param {?} entities
         * @param {?} entityClass
         * @param {?} idKey
         * @return {?}
         */
        CRUD.prototype._set = /**
         * @template S, E
         * @param {?} state
         * @param {?} entities
         * @param {?} entityClass
         * @param {?} idKey
         * @return {?}
         */
            function (state, entities, entityClass, idKey) {
                /** @type {?} */
                var ids;
                /** @type {?} */
                var normalized;
                if ((( /** @type {?} */(entities))).ids && (( /** @type {?} */(entities))).entities) {
                    ids = (( /** @type {?} */(entities))).ids;
                    normalized = (( /** @type {?} */(entities))).entities;
                }
                else {
                    /** @type {?} */
                    var isArray = Array.isArray(entities);
                    normalized = entities;
                    if (isArray) {
                        normalized = ( /** @type {?} */(this.keyBy(( /** @type {?} */(entities)), entityClass, idKey)));
                    }
                    else {
                        assertEntityState(entities);
                    }
                    ids = isArray ? (( /** @type {?} */(entities))).map(function (entity) { return entity[idKey]; }) : Object.keys(( /** @type {?} */(normalized))).map(function (id) { return entities[id][idKey]; });
                }
                /** @type {?} */
                var newState = __assign({}, (( /** @type {?} */(state))), { entities: normalized, ids: ids, loading: false });
                if (resetActive(newState)) {
                    newState.active = null;
                }
                return newState;
            };
        /**
         * @template T
         * @param {?} state
         * @param {?} id
         * @param {?} entity
         * @return {?}
         */
        CRUD.prototype._replaceEntity = /**
         * @template T
         * @param {?} state
         * @param {?} id
         * @param {?} entity
         * @return {?}
         */
            function (state, id, entity) {
                var _a;
                return __assign({}, (( /** @type {?} */(state))), { entities: __assign({}, state.entities, (_a = {}, _a[id] = entity, _a)) });
            };
        /**
         * @template S, E
         * @param {?} state
         * @param {?} entities
         * @param {?} idKey
         * @param {?=} options
         * @return {?}
         */
        CRUD.prototype._add = /**
         * @template S, E
         * @param {?} state
         * @param {?} entities
         * @param {?} idKey
         * @param {?=} options
         * @return {?}
         */
            function (state, entities, idKey, options) {
                if (options === void 0) {
                    options = {};
                }
                /** @type {?} */
                var addedEntities = {};
                /** @type {?} */
                var addedIds = [];
                for (var i = 0; i < entities.length; i++) {
                    /** @type {?} */
                    var entity = entities[i];
                    /** @type {?} */
                    var entityId = entity[idKey];
                    if (!entityExists(entityId, state.entities)) {
                        addedEntities[entityId] = entity;
                        if (options.prepend)
                            addedIds.unshift(entityId);
                        else
                            addedIds.push(entityId);
                    }
                }
                return __assign({}, (( /** @type {?} */(state))), { entities: __assign({}, state.entities, addedEntities), ids: options.prepend ? __spread(addedIds, state.ids) : __spread(state.ids, addedIds) });
            };
        /**
         * @template T
         * @param {?} state
         * @param {?} ids
         * @param {?} newStateOrFn
         * @param {?} idKey
         * @return {?}
         */
        CRUD.prototype._update = /**
         * @template T
         * @param {?} state
         * @param {?} ids
         * @param {?} newStateOrFn
         * @param {?} idKey
         * @return {?}
         */
            function (state, ids, newStateOrFn, idKey) {
                /** @type {?} */
                var updatedEntities = {};
                /** @type {?} */
                var isUpdatingIdKey = false;
                /** @type {?} */
                var idToUpdate;
                for (var i = 0; i < ids.length; i++) {
                    /** @type {?} */
                    var id = ids[i];
                    idToUpdate = id;
                    assertEntityExists(id, state.entities);
                    /** @type {?} */
                    var oldEntity = state.entities[id];
                    /** @type {?} */
                    var newState = isFunction(newStateOrFn) ? newStateOrFn(oldEntity) : newStateOrFn;
                    if (newState.hasOwnProperty(idKey) && newState[idKey] !== oldEntity[idKey]) {
                        if (ids.length > 1) {
                            throw new AkitaUpdateIdKeyError();
                        }
                        isUpdatingIdKey = true;
                        idToUpdate = newState[idKey];
                    }
                    /** @type {?} */
                    var newEntity = void 0;
                    /** @type {?} */
                    var merged = __assign({}, oldEntity, newState);
                    if (isPlainObject(oldEntity)) {
                        newEntity = merged;
                    }
                    else {
                        /**
                         * In case that new state is class of it's own, there's
                         * a possibility that it will be different than the old
                         * class.
                         * For example, Old state is an instance of animal class
                         * and new state is instance of person class.
                         * To avoid run over new person class with the old animal
                         * class we check if the new state is a class of it's own.
                         * If so, use it. Otherwise, use the old state class
                         */
                        if (isPlainObject(newState)) {
                            newEntity = new oldEntity.constructor(merged);
                        }
                        else {
                            newEntity = new (( /** @type {?} */(newState))).constructor(merged);
                        }
                    }
                    updatedEntities[idToUpdate] = newEntity;
                }
                /** @type {?} */
                var updatedIds = state.ids;
                /** @type {?} */
                var stateEntities = state.entities;
                if (isUpdatingIdKey) {
                    var _a = __read(ids, 1), id_1 = _a[0];
                    var _b = state.entities, _c = id_1, deletedEntity = _b[_c], rest = __rest(_b, [typeof _c === "symbol" ? _c : _c + ""]);
                    stateEntities = rest;
                    updatedIds = state.ids.map(function (current) { return (current === id_1 ? idToUpdate : current); });
                }
                return __assign({}, (( /** @type {?} */(state))), { entities: __assign({}, stateEntities, updatedEntities), ids: updatedIds });
            };
        /**
         * @template T
         * @param {?} state
         * @param {?} ids
         * @return {?}
         */
        CRUD.prototype._remove = /**
         * @template T
         * @param {?} state
         * @param {?} ids
         * @return {?}
         */
            function (state, ids) {
                if (!ids)
                    return this._removeAll(state);
                /** @type {?} */
                var removed = ids.reduce(function (acc, id) {
                    var _a = id, entity = acc[_a], rest = __rest(acc, [typeof _a === "symbol" ? _a : _a + ""]);
                    return rest;
                }, state.entities);
                /** @type {?} */
                var newState = __assign({}, (( /** @type {?} */(state))), { entities: removed, ids: state.ids.filter(function (current) { return ids.indexOf(current) === -1; }) });
                if (resetActive(newState)) {
                    newState.active = null;
                }
                return newState;
            };
        /**
         * @template T
         * @param {?} state
         * @return {?}
         */
        CRUD.prototype._removeAll = /**
         * @template T
         * @param {?} state
         * @return {?}
         */
            function (state) {
                /** @type {?} */
                var newState = __assign({}, (( /** @type {?} */(state))), { entities: {}, ids: [], active: null });
                return newState;
            };
        /**
         * @param {?} entities
         * @param {?=} entityClass
         * @param {?=} id
         * @return {?}
         */
        CRUD.prototype.keyBy = /**
         * @param {?} entities
         * @param {?=} entityClass
         * @param {?=} id
         * @return {?}
         */
            function (entities, entityClass, id) {
                if (id === void 0) {
                    id = 'id';
                }
                /** @type {?} */
                var acc = {};
                for (var i = 0, len = entities.length; i < len; i++) {
                    /** @type {?} */
                    var entity = entities[i];
                    acc[entity[id]] = entityClass ? new entityClass(entity) : entity;
                }
                return acc;
            };
        return CRUD;
    }());
    /** @type {?} */
    var _crud = new CRUD();

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    var AkitaGlobals = /** @class */ (function () {
        function AkitaGlobals() {
            this.skipAction = false;
            this.skipTransactionMsg = false;
            this.currentT = [];
            this.activeTransactions = 0;
        }
        /**
         * @param {?} _action
         * @return {?}
         */
        AkitaGlobals.prototype.setAction = /**
         * @param {?} _action
         * @return {?}
         */
            function (_action) {
                if (this.customAction) {
                    this.currentAction = this.customAction;
                    this.customAction = null;
                    this.skipTransactionMsg = false;
                }
                else {
                    if (this.activeTransactions === 0) {
                        this.currentAction = _action;
                    }
                }
                if (this.activeTransactions > 0) {
                    this.currentT.push(_action);
                }
            };
        /**
         * @param {?} action
         * @param {?=} skipTransactionMsg
         * @return {?}
         */
        AkitaGlobals.prototype.setCustomAction = /**
         * @param {?} action
         * @param {?=} skipTransactionMsg
         * @return {?}
         */
            function (action, skipTransactionMsg) {
                if (skipTransactionMsg === void 0) {
                    skipTransactionMsg = false;
                }
                this.currentAction = this.customAction = action;
                this.skipTransactionMsg = skipTransactionMsg;
            };
        /**
         * @param {?=} skip
         * @return {?}
         */
        AkitaGlobals.prototype.setSkipAction = /**
         * @param {?=} skip
         * @return {?}
         */
            function (skip) {
                if (skip === void 0) {
                    skip = true;
                }
                this.skipAction = skip;
            };
        return AkitaGlobals;
    }());
    /** @type {?} */
    var __globalState = new AkitaGlobals();

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * Start a new transaction batch
     * @return {?}
     */
    function startBatch() {
        if (!isTransactionInProcess()) {
            __globalState.batchTransaction = new rxjs.Subject();
        }
        __globalState.activeTransactions++;
    }
    /**
     * End the transaction
     * @return {?}
     */
    function endBatch() {
        if (--__globalState.activeTransactions === 0) {
            __globalState.batchTransaction.next(true);
            __globalState.batchTransaction.complete();
        }
    }
    /**
     * Whether we're inside batch
     * @return {?}
     */
    function isTransactionInProcess() {
        return __globalState.activeTransactions > 0;
    }
    /**
     *
     * @return {?}
     */
    function commit() {
        return __globalState.batchTransaction ? __globalState.batchTransaction.asObservable() : rxjs.of(true);
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * @param {?} o
     * @return {?}
     */
    function deepFreeze(o) {
        Object.freeze(o);
        /** @type {?} */
        var oIsFunction = typeof o === 'function';
        /** @type {?} */
        var hasOwnProp = Object.prototype.hasOwnProperty;
        Object.getOwnPropertyNames(o).forEach(function (prop) {
            if (hasOwnProp.call(o, prop) &&
                (oIsFunction ? prop !== 'caller' && prop !== 'callee' && prop !== 'arguments' : true) &&
                o[prop] !== null &&
                (typeof o[prop] === 'object' || typeof o[prop] === 'function') &&
                !Object.isFrozen(o[prop])) {
                deepFreeze(o[prop]);
            }
        });
        return o;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @type {?} */
    var configKey = 'akitaConfig';
    /**
     * @param {?} metadata
     * @return {?}
     */
    function StoreConfig(metadata) {
        return function (constructor) {
            constructor[configKey] = { idKey: 'id' };
            for (var i = 0, keys = Object.keys(metadata); i < keys.length; i++) {
                /** @type {?} */
                var key = keys[i];
                /* name is preserved read only key */
                if (key === 'name') {
                    constructor[configKey]['storeName'] = metadata[key];
                }
                else {
                    constructor[configKey][key] = metadata[key];
                }
            }
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @type {?} */
    var CONFIG = {
        resettable: false
    };
    /**
     * @param {?} config
     * @return {?}
     */
    function akitaConfig(config) {
        CONFIG = __assign({}, CONFIG, config);
    }
    /**
     * @return {?}
     */
    function getAkitaConfig() {
        return CONFIG;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @type {?} */
    var __DEV__ = true;
    /** @type {?} */
    var isNotBrowser = typeof window === 'undefined';
    /** @type {?} */
    var __stores__ = {};
    /** @type {?} */
    var rootDispatcher = new rxjs.ReplaySubject();
    /**
     * @param {?} storeName
     * @param {?=} initialState
     * @return {?}
     */
    function nextState(storeName, initialState) {
        if (initialState === void 0) {
            initialState = false;
        }
        return {
            type: 2 /* NEW_STATE */,
            payload: {
                name: storeName,
                initialState: initialState
            }
        };
    }
    /**
     * Enable production mode to disable objectFreeze
     * @return {?}
     */
    function enableAkitaProdMode() {
        __DEV__ = false;
    }
    /**
     * @return {?}
     */
    function isDev() {
        return __DEV__;
    }
    /**
     * The Root Store that every sub store needs to inherit and
     * invoke `super` with the initial state.
     * @template S
     */
    var /**
     * The Root Store that every sub store needs to inherit and
     * invoke `super` with the initial state.
     * @template S
     */ Store = /** @class */ (function () {
        /**
         *
         * Initial the store with the state
         */
        function Store(initialState, options) {
            if (options === void 0) {
                options = {};
            }
            this.options = options;
            /**
             * Whether we are inside transaction *
             */
            this.inTransaction = false;
            this._isPristine = true;
            this.destroy = this.ngOnDestroy;
            __globalState.setAction({ type: '@@INIT' });
            __stores__[this.storeName] = this;
            this.setState(function () { return initialState; });
            rootDispatcher.next({
                type: 0 /* NEW_STORE */,
                payload: { store: this }
            });
            isDev() && assertDecorator(this.storeName, this.constructor.name);
            if (this.isRessetable()) {
                this._initialState = initialState;
            }
        }
        /**
         * @param {?=} loading
         * @return {?}
         */
        Store.prototype.setLoading = /**
         * @param {?=} loading
         * @return {?}
         */
            function (loading) {
                if (loading === void 0) {
                    loading = false;
                }
                if (loading !== (( /** @type {?} */(this._value()))).loading) {
                    isDev() && __globalState.setAction({ type: 'Set Loading' });
                    this.setState(function (s) { return (( /** @type {?} */(__assign({}, (( /** @type {?} */(s))), { loading: loading })))); });
                }
            };
        /**
         * Update the store's error state.
         */
        /**
         * Update the store's error state.
         * @template T
         * @param {?} error
         * @return {?}
         */
        Store.prototype.setError = /**
         * Update the store's error state.
         * @template T
         * @param {?} error
         * @return {?}
         */
            function (error) {
                if (error !== (( /** @type {?} */(this._value()))).error) {
                    isDev() && __globalState.setAction({ type: 'Set Error' });
                    this.setState(function (s) { return (( /** @type {?} */(__assign({}, (( /** @type {?} */(s))), { error: error })))); });
                }
            };
        /**
         * Select a slice from the store
         *
         * @example
         * this.store.select(state => state.entities)
         *
         */
        /**
         * Select a slice from the store
         *
         * \@example
         * this.store.select(state => state.entities)
         *
         * @template R
         * @param {?} project
         * @return {?}
         */
        Store.prototype._select = /**
         * Select a slice from the store
         *
         * \@example
         * this.store.select(state => state.entities)
         *
         * @template R
         * @param {?} project
         * @return {?}
         */
            function (project) {
                return this.store$.pipe(operators.map(project), operators.distinctUntilChanged());
            };
        /**
         * @return {?}
         */
        Store.prototype._value = /**
         * @return {?}
         */
            function () {
                return this.storeValue;
            };
        Object.defineProperty(Store.prototype, "config", {
            get: /**
             * @return {?}
             */ function () {
                return this.constructor[configKey];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Store.prototype, "storeName", {
            get: /**
             * @return {?}
             */ function () {
                return this.options.storeName || (this.config && this.config['storeName']);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Store.prototype, "idKey", {
            get: /**
             * @return {?}
             */ function () {
                /**
                 * backward compatibility
                 * @type {?}
                 */
                var newIdKey = this.config && this.config.idKey;
                if (!newIdKey) {
                    return this.options.idKey || 'id';
                }
                return newIdKey;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Store.prototype, "isPristine", {
            get: /**
             * @return {?}
             */ function () {
                return this._isPristine;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * `setState()` is the only way to update a store; It receives a callback function,
         * which gets the current state, and returns a new immutable state,
         * which will be the new value of the store.
         */
        /**
         * `setState()` is the only way to update a store; It receives a callback function,
         * which gets the current state, and returns a new immutable state,
         * which will be the new value of the store.
         * @param {?} newStateFn
         * @param {?=} _rootDispatcher
         * @return {?}
         */
        Store.prototype.setState = /**
         * `setState()` is the only way to update a store; It receives a callback function,
         * which gets the current state, and returns a new immutable state,
         * which will be the new value of the store.
         * @param {?} newStateFn
         * @param {?=} _rootDispatcher
         * @return {?}
         */
            function (newStateFn, _rootDispatcher) {
                if (_rootDispatcher === void 0) {
                    _rootDispatcher = true;
                }
                /** @type {?} */
                var prevState = this._value();
                this.storeValue = __DEV__ ? deepFreeze(newStateFn(this._value())) : newStateFn(this._value());
                if (prevState === this.storeValue) {
                    throw new AkitaImmutabilityError(this.storeName);
                }
                if (!this.store) {
                    this.store = new rxjs.BehaviorSubject(this.storeValue);
                    rootDispatcher.next(nextState(this.storeName, true));
                    return;
                }
                if (isTransactionInProcess()) {
                    this.handleTransaction();
                    return;
                }
                this.dispatch(this.storeValue, _rootDispatcher);
            };
        /**
         * Resets the store to it's initial state and set the store to a pristine state.
         */
        /**
         * Resets the store to it's initial state and set the store to a pristine state.
         * @return {?}
         */
        Store.prototype.reset = /**
         * Resets the store to it's initial state and set the store to a pristine state.
         * @return {?}
         */
            function () {
                var _this = this;
                if (this.isRessetable()) {
                    __globalState.setAction({ type: 'Reset Store' });
                    this.setState(function () { return Object.assign({}, _this._initialState); });
                    this.setPristine();
                }
                else {
                    throw new AkitaError("You need to enable the reset functionality");
                }
            };
        /**
         * @param {?} newStateOrId
         * @param {?=} newState
         * @return {?}
         */
        Store.prototype.update = /**
         * @param {?} newStateOrId
         * @param {?=} newState
         * @return {?}
         */
            function (newStateOrId, newState) {
                __globalState.setAction({ type: 'Update Store' });
                this.setState(function (state) {
                    /** @type {?} */
                    var value = isFunction(newStateOrId) ? newStateOrId(state) : newStateOrId;
                    /** @type {?} */
                    var merged = Object.assign({}, state, value);
                    return isPlainObject(state) ? merged : new (( /** @type {?} */(state))).constructor(merged);
                });
                this.setDirty();
            };
        /**
         * Sets the store to a pristine state.
         */
        /**
         * Sets the store to a pristine state.
         * @return {?}
         */
        Store.prototype.setPristine = /**
         * Sets the store to a pristine state.
         * @return {?}
         */
            function () {
                this._isPristine = true;
            };
        /**
         * Sets the store to a dirty state, indicating that it is not pristine.
         */
        /**
         * Sets the store to a dirty state, indicating that it is not pristine.
         * @return {?}
         */
        Store.prototype.setDirty = /**
         * Sets the store to a dirty state, indicating that it is not pristine.
         * @return {?}
         */
            function () {
                this._isPristine = false;
            };
        /**
         * @param {?} state
         * @param {?=} _rootDispatcher
         * @return {?}
         */
        Store.prototype.dispatch = /**
         * @param {?} state
         * @param {?=} _rootDispatcher
         * @return {?}
         */
            function (state, _rootDispatcher) {
                if (_rootDispatcher === void 0) {
                    _rootDispatcher = true;
                }
                this.store.next(state);
                if (_rootDispatcher) {
                    rootDispatcher.next(nextState(this.storeName));
                    isDev() && __globalState.setAction({ type: 'Set State' });
                }
            };
        Object.defineProperty(Store.prototype, "store$", {
            get: /**
             * @return {?}
             */ function () {
                return this.store.asObservable();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * When the transaction ends dispatch the final value once
         */
        /**
         * When the transaction ends dispatch the final value once
         * @return {?}
         */
        Store.prototype.watchTransaction = /**
         * When the transaction ends dispatch the final value once
         * @return {?}
         */
            function () {
                var _this = this;
                commit().subscribe(function () {
                    _this.inTransaction = false;
                    if (isDev() && !__globalState.skipTransactionMsg) {
                        __globalState.setAction({ type: '@Transaction' });
                    }
                    _this.dispatch(_this._value());
                    __globalState.currentT = [];
                    __globalState.skipTransactionMsg = false;
                });
            };
        /**
         * @return {?}
         */
        Store.prototype.isRessetable = /**
         * @return {?}
         */
            function () {
                return this.config.resettable || getAkitaConfig().resettable;
            };
        /**
         * Listen to the transaction stream
         */
        /**
         * Listen to the transaction stream
         * @return {?}
         */
        Store.prototype.handleTransaction = /**
         * Listen to the transaction stream
         * @return {?}
         */
            function () {
                if (!this.inTransaction) {
                    this.watchTransaction();
                    this.inTransaction = true;
                }
            };
        /**
         * @return {?}
         */
        Store.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                if (isNotBrowser)
                    return;
                if (!(( /** @type {?} */(window))).hmrEnabled && this === __stores__[this.storeName]) {
                    delete __stores__[this.storeName];
                    rootDispatcher.next({
                        type: 1 /* DELETE_STORE */,
                        payload: { storeName: this.storeName }
                    });
                }
            };
        return Store;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * The Root Store that every sub store needs to inherit and
     * invoke `super` with the initial state.
     * @template S, E, ActiveEntity
     */
    var /**
     * The Root Store that every sub store needs to inherit and
     * invoke `super` with the initial state.
     * @template S, E, ActiveEntity
     */ EntityStore = /** @class */ (function (_super) {
        __extends(EntityStore, _super);
        /**
         *
         * Initiate the store with the state
         */
        function EntityStore(initialState, options) {
            if (initialState === void 0) {
                initialState = {};
            }
            if (options === void 0) {
                options = {};
            }
            return _super.call(this, __assign({}, getInitialEntitiesState(), initialState), options) || this;
        }
        Object.defineProperty(EntityStore.prototype, "entities", {
            get: /**
             * @return {?}
             */ function () {
                return this._value().entities;
            },
            enumerable: true,
            configurable: true
        });
        /**
         *
         * Replace current collection with provided collection
         *
         * @example
         * this.store.set([Entity, Entity]);
         * this.store.set({1: Entity, 2: Entity});
         * this.store.set([{id: 1}, {id: 2}], { entityClass: Product });
         *
         */
        /**
         *
         * Replace current collection with provided collection
         *
         * \@example
         * this.store.set([Entity, Entity]);
         * this.store.set({1: Entity, 2: Entity});
         * this.store.set([{id: 1}, {id: 2}], { entityClass: Product });
         *
         * @param {?} entities
         * @param {?=} options
         * @return {?}
         */
        EntityStore.prototype.set = /**
         *
         * Replace current collection with provided collection
         *
         * \@example
         * this.store.set([Entity, Entity]);
         * this.store.set({1: Entity, 2: Entity});
         * this.store.set([{id: 1}, {id: 2}], { entityClass: Product });
         *
         * @param {?} entities
         * @param {?=} options
         * @return {?}
         */
            function (entities, options) {
                var _this = this;
                if (options === void 0) {
                    options = {};
                }
                isDev() && __globalState.setAction({ type: 'Set Entities' });
                this.setState(function (state) { return _crud._set(state, isNil(entities) ? [] : entities, options.entityClass, _this.idKey); });
                this.setDirty();
            };
        /**
         * Create or replace an entity in the store.
         *
         * @example
         * this.store.createOrReplace(3, Entity);
         *
         */
        /**
         * Create or replace an entity in the store.
         *
         * \@example
         * this.store.createOrReplace(3, Entity);
         *
         * @param {?} id
         * @param {?} entity
         * @return {?}
         */
        EntityStore.prototype.createOrReplace = /**
         * Create or replace an entity in the store.
         *
         * \@example
         * this.store.createOrReplace(3, Entity);
         *
         * @param {?} id
         * @param {?} entity
         * @return {?}
         */
            function (id, entity) {
                if (!entityExists(id, this._value().entities)) {
                    this.addWhenNotExists(id, entity);
                }
                else {
                    isDev() && __globalState.setAction({ type: 'Create or Replace Entity', entityId: [id] });
                    this.setState(function (state) { return _crud._replaceEntity(state, id, entity); });
                }
            };
        /**
         *
         * Insert or Update
         */
        /**
         *
         * Insert or Update
         * @param {?} id
         * @param {?} entityOrFn
         * @return {?}
         */
        EntityStore.prototype.upsert = /**
         *
         * Insert or Update
         * @param {?} id
         * @param {?} entityOrFn
         * @return {?}
         */
            function (id, entityOrFn) {
                if (!entityExists(id, this._value().entities)) {
                    /** @type {?} */
                    var resolve = isFunction(entityOrFn) ? (( /** @type {?} */(entityOrFn)))({}) : entityOrFn;
                    this.addWhenNotExists(id, resolve);
                }
                else {
                    this.update(id, ( /** @type {?} */(entityOrFn)));
                }
            };
        /**
         * Add an entity or entities to the store.
         *
         * @example
         * this.store.add([Entity, Entity]);
         * this.store.add(Entity);
         * this.store.add(Entity, { prepend: true });
         */
        /**
         * Add an entity or entities to the store.
         *
         * \@example
         * this.store.add([Entity, Entity]);
         * this.store.add(Entity);
         * this.store.add(Entity, { prepend: true });
         * @param {?} entities
         * @param {?=} options
         * @return {?}
         */
        EntityStore.prototype.add = /**
         * Add an entity or entities to the store.
         *
         * \@example
         * this.store.add([Entity, Entity]);
         * this.store.add(Entity);
         * this.store.add(Entity, { prepend: true });
         * @param {?} entities
         * @param {?=} options
         * @return {?}
         */
            function (entities, options) {
                var _this = this;
                /** @type {?} */
                var toArray = coerceArray(entities);
                if (toArray.length === 0)
                    return;
                /**
                 * If we pass entities that already exist, we should ignore them
                 * @type {?}
                 */
                var allExists = toArray.every(function (entity) { return _this._value().ids.indexOf(entity[_this.idKey]) > -1; });
                if (allExists)
                    return;
                isDev() && __globalState.setAction({ type: 'Add Entity' });
                this.setState(function (state) { return _crud._add(state, toArray, _this.idKey, options); });
            };
        /**
         * @param {?} idsOrFn
         * @param {?=} newStateOrFn
         * @return {?}
         */
        EntityStore.prototype.update = /**
         * @param {?} idsOrFn
         * @param {?=} newStateOrFn
         * @return {?}
         */
            function (idsOrFn, newStateOrFn) {
                var _this = this;
                /** @type {?} */
                var ids = [];
                /** @type {?} */
                var storeIds = this._value().ids;
                if (isFunction(idsOrFn)) {
                    for (var i = 0, len = storeIds.length; i < len; i++) {
                        /** @type {?} */
                        var id = storeIds[i];
                        /** @type {?} */
                        var entity = this._value().entities[id];
                        if (entity && (( /** @type {?} */(idsOrFn)))(entity)) {
                            ids.push(id);
                        }
                    }
                }
                else {
                    ids = toBoolean(idsOrFn) ? coerceArray(idsOrFn) : storeIds;
                }
                if (ids.length === 0)
                    return;
                isDev() && __globalState.setAction({ type: 'Update Entity', entityId: ids });
                this.setState(function (state) {
                    return _crud._update(state, ids, newStateOrFn, _this.idKey);
                });
            };
        /**
         * An alias to update all.
         */
        /**
         * An alias to update all.
         * @param {?} state
         * @return {?}
         */
        EntityStore.prototype.updateAll = /**
         * An alias to update all.
         * @param {?} state
         * @return {?}
         */
            function (state) {
                if (this._value().ids.length === 0)
                    return;
                this.update(null, state);
            };
        /**
         * Update the root state (data which is external to the entities).
         *
         * @example
         * this.store.updateRoot({
         *   metadata: 'new metadata
         * });
         *
         *  this.store.updateRoot(state => {
         *    return {
         *      metadata: {
         *        ...state.metadata,
         *        key: 'new value'
         *      }
         *    }
         *  });
         */
        /**
         * Update the root state (data which is external to the entities).
         *
         * \@example
         * this.store.updateRoot({
         *   metadata: 'new metadata
         * });
         *
         *  this.store.updateRoot(state => {
         *    return {
         *      metadata: {
         *        ...state.metadata,
         *        key: 'new value'
         *      }
         *    }
         *  });
         * @param {?} newStateFn
         * @param {?=} action
         * @return {?}
         */
        EntityStore.prototype.updateRoot = /**
         * Update the root state (data which is external to the entities).
         *
         * \@example
         * this.store.updateRoot({
         *   metadata: 'new metadata
         * });
         *
         *  this.store.updateRoot(state => {
         *    return {
         *      metadata: {
         *        ...state.metadata,
         *        key: 'new value'
         *      }
         *    }
         *  });
         * @param {?} newStateFn
         * @param {?=} action
         * @return {?}
         */
            function (newStateFn, action) {
                /** @type {?} */
                var newState = isFunction(newStateFn) ? newStateFn(this._value()) : newStateFn;
                if (newState === this._value()) {
                    throw new AkitaImmutabilityError(this.storeName);
                }
                isDev() && __globalState.setAction(action || { type: 'Update Root' });
                this.setState(function (state) {
                    return __assign({}, (( /** @type {?} */(state))), (( /** @type {?} */(newState))));
                });
            };
        /**
         * @param {?=} idsOrFn
         * @return {?}
         */
        EntityStore.prototype.remove = /**
         * @param {?=} idsOrFn
         * @return {?}
         */
            function (idsOrFn) {
                /** @type {?} */
                var storeIds = this._value().ids;
                if (storeIds.length === 0)
                    return;
                /** @type {?} */
                var idPassed = toBoolean(idsOrFn);
                if (!idPassed)
                    this.setPristine();
                /** @type {?} */
                var ids = [];
                if (isFunction(idsOrFn)) {
                    for (var i = 0, len = storeIds.length; i < len; i++) {
                        /** @type {?} */
                        var id = storeIds[i];
                        /** @type {?} */
                        var entity = this._value().entities[id];
                        if (entity && idsOrFn(entity)) {
                            ids.push(id);
                        }
                    }
                }
                else {
                    ids = idPassed ? coerceArray(idsOrFn) : null;
                }
                if (ids && ids.length === 0)
                    return;
                isDev() && __globalState.setAction({ type: 'Remove Entity', entityId: ids });
                this.setState(function (state) {
                    return _crud._remove(state, ids);
                });
            };
        /**
         *
         * Update the active entity.
         *
         * @example
         * this.store.updateActive(active => {
         *   return {
         *     config: {
         *      ..active.config,
         *      date
         *     }
         *   }
         * })
         */
        /**
         *
         * Update the active entity.
         *
         * \@example
         * this.store.updateActive(active => {
         *   return {
         *     config: {
         *      ..active.config,
         *      date
         *     }
         *   }
         * })
         * @param {?} newStateFn
         * @return {?}
         */
        EntityStore.prototype.updateActive = /**
         *
         * Update the active entity.
         *
         * \@example
         * this.store.updateActive(active => {
         *   return {
         *     config: {
         *      ..active.config,
         *      date
         *     }
         *   }
         * })
         * @param {?} newStateFn
         * @return {?}
         */
            function (newStateFn) {
                var _this = this;
                assertActive(this._value());
                isDev() && __globalState.setAction({ type: 'Update Active Entity', entityId: this._value().active });
                this.setState(function (state) {
                    /** @type {?} */
                    var activeId = ( /** @type {?} */(state.active));
                    /** @type {?} */
                    var newState = isFunction(newStateFn) ? newStateFn(state.entities[activeId]) : newStateFn;
                    if (newState === state) {
                        throw new AkitaImmutabilityError(_this.storeName);
                    }
                    return _crud._update(state, [activeId], newState, _this.idKey);
                });
            };
        /**
         * Set the given entity as active.
         */
        /**
         * Set the given entity as active.
         * @param {?} idOrOptions
         * @return {?}
         */
        EntityStore.prototype.setActive = /**
         * Set the given entity as active.
         * @param {?} idOrOptions
         * @return {?}
         */
            function (idOrOptions) {
                /** @type {?} */
                var activeId;
                if (isObject(idOrOptions)) {
                    if (isNil(this._value().active))
                        return;
                    (( /** @type {?} */(idOrOptions))) = Object.assign({ wrap: true }, idOrOptions);
                    /** @type {?} */
                    var ids = this._value().ids;
                    /** @type {?} */
                    var currentIdIndex = ids.indexOf(this._value().active);
                    if ((( /** @type {?} */(idOrOptions))).prev) {
                        /** @type {?} */
                        var isFirst = currentIdIndex === 0;
                        if (isFirst && !(( /** @type {?} */(idOrOptions))).wrap)
                            return;
                        activeId = isFirst ? ids[ids.length - 1] : (( /** @type {?} */(ids[currentIdIndex - 1])));
                    }
                    else if ((( /** @type {?} */(idOrOptions))).next) {
                        /** @type {?} */
                        var isLast = ids.length === currentIdIndex + 1;
                        if (isLast && !(( /** @type {?} */(idOrOptions))).wrap)
                            return;
                        activeId = isLast ? ids[0] : (( /** @type {?} */(ids[currentIdIndex + 1])));
                    }
                }
                else {
                    if (idOrOptions === this._value().active)
                        return;
                    activeId = ( /** @type {?} */(idOrOptions));
                }
                isDev() && __globalState.setAction({ type: 'Set Active Entity', entityId: activeId });
                this.setState(function (state) {
                    return __assign({}, (( /** @type {?} */(state))), { active: activeId });
                });
            };
        /**
         * @param {?} id
         * @param {?} entity
         * @return {?}
         */
        EntityStore.prototype.addWhenNotExists = /**
         * @param {?} id
         * @param {?} entity
         * @return {?}
         */
            function (id, entity) {
                if (!entity[this.idKey]) {
                    entity[this.idKey] = id;
                }
                this.add(entity);
            };
        return EntityStore;
    }(Store));
    /** @type {?} */
    var getInitialEntitiesState = function () {
        return (( /** @type {?} */({
            entities: {},
            ids: [],
            loading: true,
            error: null
        })));
    };
    /** @type {?} */
    var getInitialActiveState = function () {
        return (( /** @type {?} */({
            active: null
        })));
    };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @enum {string} */
    var Order = {
        ASC: 'asc',
        DESC: 'desc',
    };
    /**
     * @param {?} key
     * @param {?=} order
     * @return {?}
     */
    function compareValues(key, order) {
        if (order === void 0) {
            order = Order.ASC;
        }
        return function (a, b) {
            if (!a.hasOwnProperty(key) || !b.hasOwnProperty(key)) {
                return 0;
            }
            /** @type {?} */
            var varA = typeof a[key] === 'string' ? a[key].toUpperCase() : a[key];
            /** @type {?} */
            var varB = typeof b[key] === 'string' ? b[key].toUpperCase() : b[key];
            /** @type {?} */
            var comparison = 0;
            if (varA > varB) {
                comparison = 1;
            }
            else if (varA < varB) {
                comparison = -1;
            }
            return order == Order.DESC ? comparison * -1 : comparison;
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * @param {?} fn
     * @return {?}
     */
    function memoizeOne(fn) {
        /** @type {?} */
        var lastArgs;
        /** @type {?} */
        var changed = false;
        /** @type {?} */
        var firstInit = true;
        /** @type {?} */
        var lastResult;
        return function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (lastArgs) {
                /** If entities nor ids doesn't change return the last value */
                changed = lastArgs[1] !== args[1] || lastArgs[0] !== args[0];
            }
            if (firstInit || (changed && !firstInit)) {
                lastResult = fn.apply(this, args);
            }
            firstInit = false;
            lastArgs = args;
            return lastResult;
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @type {?} */
    var queryConfigKey = 'akitaQueryConfig';
    /**
     * @template E
     * @param {?} metadata
     * @return {?}
     */
    function QueryConfig(metadata) {
        return function (constructor) {
            constructor[queryConfigKey] = {};
            for (var i = 0, keys = Object.keys(metadata); i < keys.length; i++) {
                /** @type {?} */
                var key = keys[i];
                constructor[queryConfigKey][key] = metadata[key];
            }
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * @template S
     */
    var /**
     * @template S
     */ Query = /** @class */ (function () {
        function Query(store) {
            this.store = store;
            this.__store__ = store;
        }
        /**
         * @template R
         * @param {?=} project
         * @return {?}
         */
        Query.prototype.select = /**
         * @template R
         * @param {?=} project
         * @return {?}
         */
            function (project) {
                /** @type {?} */
                var state = project ? project : function (state) { return state; };
                return this.store._select(state);
            };
        /**
         * Select once and complete.
         */
        /**
         * Select once and complete.
         * @template R
         * @param {?} project
         * @return {?}
         */
        Query.prototype.selectOnce = /**
         * Select once and complete.
         * @template R
         * @param {?} project
         * @return {?}
         */
            function (project) {
                return this.select(project).pipe(operators.take(1));
            };
        /**
         * Select the store's loading state.
         */
        /**
         * Select the store's loading state.
         * @return {?}
         */
        Query.prototype.selectLoading = /**
         * Select the store's loading state.
         * @return {?}
         */
            function () {
                return this.select(function (state) { return (( /** @type {?} */(state))).loading; });
            };
        /**
         * Select the store's error state.
         */
        /**
         * Select the store's error state.
         * @return {?}
         */
        Query.prototype.selectError = /**
         * Select the store's error state.
         * @return {?}
         */
            function () {
                return this.select(function (state) { return (( /** @type {?} */(state))).error; });
            };
        /**
         * Get the raw value of the store.
         */
        /**
         * Get the raw value of the store.
         * @return {?}
         */
        Query.prototype.getSnapshot = /**
         * Get the raw value of the store.
         * @return {?}
         */
            function () {
                return this.store._value();
            };
        Object.defineProperty(Query.prototype, "isPristine", {
            /**
             *  Returns whether the state of the store is pristine (the set() method hasn't been explicitly called
             *  since the store creation, or the last time setPristine()was called).
             */
            get: /**
             *  Returns whether the state of the store is pristine (the set() method hasn't been explicitly called
             *  since the store creation, or the last time setPristine()was called).
             * @return {?}
             */ function () {
                return this.store.isPristine;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Query.prototype, "isDirty", {
            /**
             * Returns whether the state of the store is dirty (the set() method
             * or the setDirty() method has been explicitly called since the store creation,
             * or the last time setPristine() was called).
             */
            get: /**
             * Returns whether the state of the store is dirty (the set() method
             * or the setDirty() method has been explicitly called since the store creation,
             * or the last time setPristine() was called).
             * @return {?}
             */ function () {
                return !this.store.isPristine;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Query.prototype, "config", {
            get: /**
             * @return {?}
             */ function () {
                return this.constructor[queryConfigKey];
            },
            enumerable: true,
            configurable: true
        });
        return Query;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     *  An abstraction for querying the entities from the store
     * @template S, E, ActiveEntity
     */
    var /**
     *  An abstraction for querying the entities from the store
     * @template S, E, ActiveEntity
     */ QueryEntity = /** @class */ (function (_super) {
        __extends(QueryEntity, _super);
        function QueryEntity(store) {
            var _this = _super.call(this, store) || this;
            _this.__store__ = store;
            return _this;
        }
        /**
         * @param {?=} options
         * @return {?}
         */
        QueryEntity.prototype.selectAll = /**
         * @param {?=} options
         * @return {?}
         */
            function (options) {
                var _this = this;
                if (options === void 0) {
                    options = {
                        asObject: false
                    };
                }
                /** @type {?} */
                var selectState$ = this.select(function (state) { return state; });
                /** @type {?} */
                var selectEntities$ = this.select(function (state) { return state.entities; });
                this.sortByOptions(options);
                return selectEntities$.pipe(operators.withLatestFrom(selectState$, function (entities, state) {
                    var ids = state.ids;
                    if (options.asObject) {
                        return toMap(ids, entities, options);
                    }
                    else {
                        if (!options.filterBy && !options.sortBy) {
                            if (!_this.memoized) {
                                _this.memoized = memoizeOne(toArray);
                            }
                            return _this.memoized(state, options);
                        }
                        return toArray(state, options);
                    }
                }));
            };
        /**
         * @param {?=} options
         * @return {?}
         */
        QueryEntity.prototype.getAll = /**
         * @param {?=} options
         * @return {?}
         */
            function (options) {
                if (options === void 0) {
                    options = { asObject: false, filterBy: undefined, limitTo: undefined };
                }
                /** @type {?} */
                var state = this.getSnapshot();
                if (options.asObject) {
                    return toMap(state.ids, state.entities, options, true);
                }
                this.sortByOptions(options);
                return toArray(state, options);
            };
        /**
         * Select multiple entities from the store.
         *
         * @example
         * this.store.selectMany([1,2]);
         */
        /**
         * Select multiple entities from the store.
         *
         * \@example
         * this.store.selectMany([1,2]);
         * @param {?} ids
         * @param {?=} options
         * @return {?}
         */
        QueryEntity.prototype.selectMany = /**
         * Select multiple entities from the store.
         *
         * \@example
         * this.store.selectMany([1,2]);
         * @param {?} ids
         * @param {?=} options
         * @return {?}
         */
            function (ids, options) {
                var _this = this;
                if (options === void 0) {
                    options = {};
                }
                /** @type {?} */
                var filterUndefined = isUndefined(options.filterUndefined) ? true : options.filterUndefined;
                /** @type {?} */
                var entities = ids.map(function (id) { return _this.selectEntity(id); });
                return rxjs.combineLatest(entities).pipe(operators.map(function (entities) {
                    return filterUndefined ? entities.filter(function (val) { return !isUndefined(val); }) : entities;
                }), operators.auditTime(0));
            };
        /**
         * @template R
         * @param {?} id
         * @param {?=} project
         * @return {?}
         */
        QueryEntity.prototype.selectEntity = /**
         * @template R
         * @param {?} id
         * @param {?=} project
         * @return {?}
         */
            function (id, project) {
                var _this = this;
                if (!project) {
                    return this._byId(id);
                }
                return this.select(function (state) {
                    if (_this.hasEntity(id)) {
                        return project(_this.getEntity(id));
                    }
                    return undefined;
                });
            };
        /**
         * Get an entity by id
         *
         * @example
         * this.store.getEntity(1);
         */
        /**
         * Get an entity by id
         *
         * \@example
         * this.store.getEntity(1);
         * @param {?} id
         * @return {?}
         */
        QueryEntity.prototype.getEntity = /**
         * Get an entity by id
         *
         * \@example
         * this.store.getEntity(1);
         * @param {?} id
         * @return {?}
         */
            function (id) {
                return this.getSnapshot().entities[( /** @type {?} */(id))];
            };
        /**
         * Select the active entity's id.
         */
        /**
         * Select the active entity's id.
         * @return {?}
         */
        QueryEntity.prototype.selectActiveId = /**
         * Select the active entity's id.
         * @return {?}
         */
            function () {
                return this.select(function (state) { return (( /** @type {?} */(state))).active; });
            };
        /**
         * Get the active id
         */
        /**
         * Get the active id
         * @return {?}
         */
        QueryEntity.prototype.getActiveId = /**
         * Get the active id
         * @return {?}
         */
            function () {
                return (( /** @type {?} */(this.getSnapshot()))).active;
            };
        /**
         * @template R
         * @param {?=} project
         * @return {?}
         */
        QueryEntity.prototype.selectActive = /**
         * @template R
         * @param {?=} project
         * @return {?}
         */
            function (project) {
                var _this = this;
                return this.selectActiveId().pipe(operators.switchMap(function (activeId) { return _this.selectEntity(activeId, project); }));
            };
        /**
         * Get the active entity.
         */
        /**
         * Get the active entity.
         * @return {?}
         */
        QueryEntity.prototype.getActive = /**
         * Get the active entity.
         * @return {?}
         */
            function () {
                /** @type {?} */
                var activeId = this.getActiveId();
                return toBoolean(activeId) ? this.getEntity(activeId) : undefined;
            };
        /**
         * Select the store's entity collection length.
         */
        /**
         * Select the store's entity collection length.
         * @param {?=} predicate
         * @return {?}
         */
        QueryEntity.prototype.selectCount = /**
         * Select the store's entity collection length.
         * @param {?=} predicate
         * @return {?}
         */
            function (predicate) {
                if (isFunction(predicate)) {
                    return this.selectAll({
                        filterBy: predicate
                    }).pipe(operators.map(function (entities) { return entities.length; }));
                }
                return this.select(function (store) { return store.ids.length; });
            };
        /**
         * Get the store's entity collection length.
         */
        /**
         * Get the store's entity collection length.
         * @param {?=} predicate
         * @return {?}
         */
        QueryEntity.prototype.getCount = /**
         * Get the store's entity collection length.
         * @param {?=} predicate
         * @return {?}
         */
            function (predicate) {
                if (isFunction(predicate)) {
                    return this.getAll().filter(predicate).length;
                }
                return this.getSnapshot().ids.length;
            };
        /**
         * @param {?} projectOrIds
         * @return {?}
         */
        QueryEntity.prototype.hasEntity = /**
         * @param {?} projectOrIds
         * @return {?}
         */
            function (projectOrIds) {
                var _this = this;
                if (isFunction(projectOrIds)) {
                    return this.getAll().some(projectOrIds);
                }
                if (Array.isArray(projectOrIds)) {
                    return projectOrIds.every(function (id) { return (( /** @type {?} */(id))) in _this.store.entities; });
                }
                return (( /** @type {?} */(projectOrIds))) in this.store.entities;
            };
        /**
         * Returns whether entity store has an active entity.
         */
        /**
         * Returns whether entity store has an active entity.
         * @return {?}
         */
        QueryEntity.prototype.hasActive = /**
         * Returns whether entity store has an active entity.
         * @return {?}
         */
            function () {
                return this.getSnapshot().active != null;
            };
        /**
         * @return {?}
         */
        QueryEntity.prototype.isEmpty = /**
         * @return {?}
         */
            function () {
                return this.getSnapshot().ids.length === 0;
            };
        /**
         * @param {?} id
         * @return {?}
         */
        QueryEntity.prototype._byId = /**
         * @param {?} id
         * @return {?}
         */
            function (id) {
                var _this = this;
                return this.select(function (state) { return _this.getEntity(id); });
            };
        /**
         * @param {?} options
         * @return {?}
         */
        QueryEntity.prototype.sortByOptions = /**
         * @param {?} options
         * @return {?}
         */
            function (options) {
                options.sortBy = options.sortBy || (this.config && (( /** @type {?} */(this.config.sortBy))));
                options.sortByOrder = options.sortByOrder || (this.config && this.config.sortByOrder);
            };
        /**
         * @return {?}
         */
        QueryEntity.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this.memoized = null;
            };
        return QueryEntity;
    }(Query));
    /**
     * @template E, S
     * @param {?} state
     * @param {?} options
     * @return {?}
     */
    function toArray(state, options) {
        /** @type {?} */
        var arr = [];
        var ids = state.ids, entities = state.entities;
        var filterBy = options.filterBy, limitTo = options.limitTo, sortBy = options.sortBy, sortByOrder = options.sortByOrder;
        var _loop_1 = function (i) {
            /** @type {?} */
            var id = ids[i];
            if (!entityExists(id, entities)) {
                return "continue";
            }
            if (!filterBy) {
                arr.push(entities[id]);
                return "continue";
            }
            if (Array.isArray(filterBy)) {
                /** @type {?} */
                var allPass = filterBy.every(function (fn) { return fn(entities[id], i); });
                if (allPass) {
                    arr.push(entities[id]);
                }
            }
            else {
                if (filterBy(entities[id], i)) {
                    arr.push(entities[id]);
                }
            }
        };
        for (var i = 0; i < ids.length; i++) {
            _loop_1(i);
        }
        if (sortBy) {
            /** @type {?} */
            var _sortBy_1 = isFunction(sortBy) ? sortBy : compareValues(sortBy, sortByOrder);
            arr = arr.sort(function (a, b) { return _sortBy_1(a, b, state); });
        }
        /** @type {?} */
        var length = Math.min(limitTo || arr.length, arr.length);
        return length === arr.length ? arr : arr.slice(0, length);
    }
    /**
     * @template E
     * @param {?} ids
     * @param {?} entities
     * @param {?} options
     * @param {?=} get
     * @return {?}
     */
    function toMap(ids, entities, options, get) {
        if (get === void 0) {
            get = false;
        }
        /** @type {?} */
        var map = {};
        var filterBy = options.filterBy, limitTo = options.limitTo;
        if (get && !filterBy && !limitTo) {
            return entities;
        }
        /** @type {?} */
        var length = Math.min(limitTo || ids.length, ids.length);
        if (filterBy && isUndefined(limitTo) === false) {
            /** @type {?} */
            var count = 0;
            var _loop_2 = function (i, length_1) {
                if (count === limitTo)
                    return "break";
                /** @type {?} */
                var id = ids[i];
                if (!entityExists(id, entities)) {
                    return "continue";
                }
                if (Array.isArray(filterBy)) {
                    /** @type {?} */
                    var allPass = filterBy.every(function (fn) { return fn(entities[id], i); });
                    if (allPass) {
                        map[id] = entities[id];
                        count++;
                    }
                }
                else {
                    if (filterBy(entities[id], i)) {
                        map[id] = entities[id];
                        count++;
                    }
                }
            };
            for (var i = 0, length_1 = ids.length; i < length_1; i++) {
                var state_1 = _loop_2(i, length_1);
                if (state_1 === "break")
                    break;
            }
        }
        else {
            var _loop_3 = function (i) {
                /** @type {?} */
                var id = ids[i];
                if (!entityExists(id, entities)) {
                    return "continue";
                }
                if (!filterBy) {
                    map[id] = entities[id];
                    return "continue";
                }
                if (Array.isArray(filterBy)) {
                    /** @type {?} */
                    var allPass = filterBy.every(function (fn) { return fn(entities[id], i); });
                    if (allPass) {
                        map[id] = entities[id];
                    }
                }
                else {
                    if (filterBy(entities[id], i)) {
                        map[id] = entities[id];
                    }
                }
            };
            for (var i = 0; i < length; i++) {
                _loop_3(i);
            }
        }
        return map;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     *  A logical transaction.
     *  Use this transaction to optimize the dispatch of all the stores.
     *  The following code will update the store, BUT  emits only once
     *
     * \@example
     *  applyTransaction(() => {
     *    this.todosStore.add(new Todo(1, title));
     *    this.todosStore.add(new Todo(2, title));
     *  });
     *
     * @template T
     * @param {?} action
     * @param {?=} thisArg
     * @return {?}
     */
    function applyTransaction(action, thisArg) {
        if (thisArg === void 0) {
            thisArg = undefined;
        }
        startBatch();
        try {
            return action.apply(thisArg);
        }
        finally {
            endBatch();
        }
    }
    /**
     *  A logical transaction.
     *  Use this transaction to optimize the dispatch of all the stores.
     *
     *  The following code will update the store, BUT  emits only once.
     *
     * \@example
     * \@transaction
     *  addTodos() {
     *    this.todosStore.add(new Todo(1, title));
     *    this.todosStore.add(new Todo(2, title));
     *  }
     *
     *
     * @return {?}
     */
    function transaction() {
        return function (target, propertyKey, descriptor) {
            /** @type {?} */
            var originalMethod = descriptor.value;
            descriptor.value = function () {
                var _this = this;
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                return applyTransaction(function () {
                    return originalMethod.apply(_this, args);
                }, this);
            };
            return descriptor;
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    // https://github.com/georapbox/immutable-arrays
    /**
     * Adds one or more elements to the end of an array by returning
     * a new array instead of mutating the original one.
     *
     * \@example
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = push(originalArray, 'f', 'g');
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['a', 'b', 'c', 'd', 'e', 'f', 'g']
     * @template T
     * @param {?} array
     * @param {...?} elementN
     * @return {?}
     */
    function push(array) {
        var elementN = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            elementN[_i - 1] = arguments[_i];
        }
        return __spread(array, elementN);
    }
    /**
     * Deletes an element from an array by its index in the array.
     *
     * \@example
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = remove(originalArray, 2);
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['a', 'b', 'd', 'e']
     * @template T
     * @param {?} array
     * @param {?} index
     * @return {?}
     */
    function remove(array, index) {
        return index >= 0 ? __spread(array.slice(0, index), array.slice(index + 1)) : __spread(array);
    }
    /**
     * Removes the last element from an array by returning
     * a new array instead of mutating the original one.
     *
     * \@example
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = pop(originalArray);
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['a', 'b', 'c', 'd']
     * @template T
     * @param {?} array
     * @return {?}
     */
    function pop(array) {
        return array.slice(0, -1);
    }
    /**
     * Adds one or more elements to the beginning of an array.
     *
     * \@example
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = unshift(originalArray, 'f', 'g');
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['f', 'g', 'a', 'b', 'c', 'd', 'e']
     * @template T
     * @param {?} array
     * @param {...?} elementN
     * @return {?}
     */
    function unshift(array) {
        var elementN = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            elementN[_i - 1] = arguments[_i];
        }
        return __spread(elementN, array);
    }
    /**
     * Sorts the elements of an array (not in place) and returns a sorted array.
     *
     * \@example
     * const numberArray = [20, 3, 4, 10, -3, 1, 0, 5];
     * const stringArray = ['Blue', 'Humpback', 'Beluga'];
     *
     * const resultArray = sort(numberArray, (a, b) => a - b);
     * // -> numberArray [20, 3, 4, 10, -3, 1, 0, 5]
     * // -> resultArray [-3, 0, 1, 3, 4, 5, 10, 20]
     *
     * const resultArray = sort(numberArray, (a, b) => b - a);
     * // -> numberArray [20, 3, 4, 10, -3, 1, 0, 5]
     * // -> resultArray [20, 10, 5, 4, 3, 1, 0, -3]
     *
     * const resultArray = sort(stringArray);
     * // -> stringArray ['Blue', 'Humpback', 'Beluga']
     * // -> resultArray ['Beluga', 'Blue', 'Humpback']
     *
     * const resultArray = sort(stringArray, (a, b) => a.toLowerCase() < b.toLowerCase());
     * // -> stringArray ['Blue', 'Humpback', 'Beluga']
     * // -> resultArray ['Humpback', 'Blue', 'Beluga']
     * @template T
     * @param {?} array
     * @param {?=} compareFunction
     * @return {?}
     */
    function sort(array, compareFunction) {
        return __spread(array).sort(compareFunction);
    }
    /**
     * Reverses an array (not in place).
     * The first array element becomes the last, and the last array element becomes the first.
     *
     * \@example
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = reverse(originalArray);
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['e', 'd', 'c', 'b', 'a']
     * @template T
     * @param {?} array
     * @return {?}
     */
    function reverse(array) {
        return __spread(array).reverse();
    }
    /**
     * Swap items in the array
     *
     * \@example
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = swap(originalArray, 1, 4);
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['a', 'e', 'c', 'd', 'b']
     * @template T
     * @param {?} array
     * @param {?} firstIndex
     * @param {?} secondIndex
     * @return {?}
     */
    function swap(array, firstIndex, secondIndex) {
        /** @type {?} */
        var results = array.slice();
        /** @type {?} */
        var firstItem = array[firstIndex];
        results[firstIndex] = array[secondIndex];
        results[secondIndex] = firstItem;
        return results;
    }
    /**
     * Update item in the array
     *
     * \@example
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = update(originalArray, 1, 'newItem');
     * // -> resultArray ['a', 'newItem', 'c', 'd', 'b']
     *
     * const originalArray = [{title: 1}, {title: 2}];
     * const resultArray = update(originalArray, originalArray[0], {title: 3});
     * // -> resultArray  [{title: 3}, {title: 2}];
     * @template T
     * @param {?} array
     * @param {?} indexOrItem
     * @param {?} updated
     * @return {?}
     */
    function update(array, indexOrItem, updated) {
        return array.map(function (current, idx) {
            if (typeof indexOrItem === 'number' && idx === indexOrItem) {
                return updated;
            }
            if (isObject(indexOrItem) && (( /** @type {?} */(indexOrItem))) === current) {
                return __assign({}, (( /** @type {?} */(indexOrItem))), (( /** @type {?} */(updated))));
            }
            return current;
        });
    }
    /**
     * Removes existing elements and/or adds new elements to an array.
     *
     * \@example
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = splice(originalArray, 0);
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray []
     *
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = splice(originalArray, 0, 1);
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['b', 'c', 'd', 'e']
     *
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = splice(originalArray, 0, 3);
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['d', 'e']
     *
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = splice(originalArray, 0, originalArray.length);
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray []
     *
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = splice(originalArray, 0, -3);
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['a', 'b', 'c', 'd', 'e']
     *
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = splice(originalArray, 0, 0, 'lorem', 'ipsum');
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['lorem', 'ipsum', 'a', 'b', 'c', 'd', 'e']
     *
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = splice(originalArray, originalArray.length, 0, 'lorem', 'ipsum');
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['a', 'b', 'c', 'd', 'e', 'lorem', 'ipsum']
     *
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = splice(originalArray, 0, 2, 'lorem', 'ipsum');
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['lorem', 'ipsum', 'c', 'd', 'e']
     *
     * const originalArray = ['a', 'b', 'c', 'd', 'e'];
     * const resultArray = splice(originalArray, originalArray.length - 2, 2, 'lorem', 'ipsum');
     * // -> originalArray ['a', 'b', 'c', 'd', 'e']
     * // -> resultArray ['a', 'b', 'c', 'lorem', 'ipsum']
     * @template T
     * @param {?} array
     * @param {?=} start
     * @param {?=} deleteCount
     * @param {...?} elementN
     * @return {?}
     */
    function splice(array, start, deleteCount) {
        if (start === void 0) {
            start = array.length;
        }
        if (deleteCount === void 0) {
            deleteCount = array.length - start;
        }
        var elementN = [];
        for (var _i = 3; _i < arguments.length; _i++) {
            elementN[_i - 3] = arguments[_i];
        }
        return __spread(array.slice(0, start), elementN, array.slice(start + (deleteCount < 0 ? 0 : deleteCount)));
    }
    /**
     * @template T
     * @param {?} arr
     * @param {?} item
     * @return {?}
     */
    function toggle(arr, item) {
        return arr.indexOf(item) > -1 ? arr.filter(function (current) { return item !== current; }) : push(arr, item);
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @type {?} */
    var filterNil = function (source) { return source.pipe(operators.filter(function (value) { return value !== null && typeof value !== 'undefined'; })); };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * @template T
     * @param {?} func
     * @param {?} action
     * @param {?=} thisArg
     * @return {?}
     */
    function applyAction(func, action, thisArg) {
        if (thisArg === void 0) {
            thisArg = undefined;
        }
        __globalState.setCustomAction(action, true);
        return func.apply(thisArg);
    }
    /**
     * @param {?} action
     * @param {?=} skipTransactionMsg
     * @return {?}
     */
    function action(action, skipTransactionMsg) {
        if (skipTransactionMsg === void 0) {
            skipTransactionMsg = true;
        }
        return function (target, propertyKey, descriptor) {
            /** @type {?} */
            var originalMethod = descriptor.value;
            descriptor.value = function () {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                __globalState.setCustomAction(action, skipTransactionMsg);
                return originalMethod.apply(this, args);
            };
            return descriptor;
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * @param {?} object
     * @return {?}
     */
    function serialize(object) {
        return JSON.stringify(object, function (key, value) {
            if (typeof value === 'function') {
                return value.toString();
            }
            return value;
        });
    }
    /**
     * @return {?}
     */
    function createWorker() {
        /** @type {?} */
        var blob = new Blob([
            "self.onmessage = function(e) {\n\n      function deserialize(str) {\n        return JSON.parse(str || '', function(key, value) {\n          if (value &&\n            typeof value === \"string\" &&\n            value.substr(0, 8) == \"function\") {\n            var startBody = value.indexOf('{') + 1;\n            var endBody = value.lastIndexOf('}');\n            var startArgs = value.indexOf('(') + 1;\n            var endArgs = value.indexOf(')');\n            return new Function(value.substring(startArgs, endArgs), value.substring(startBody, endBody));\n          }\n          return value;\n        });\n      }\n\n      var deserialized = deserialize(e.data);\n      var mapped = deserialized.data.map(function(d) {\n        return deserialized.factory(d);\n      });\n\n      self.postMessage(mapped);\n    }"
        ], {
            type: 'text/javascript'
        });
        /** @type {?} */
        var url = URL.createObjectURL(blob);
        return new Worker(url);
    }
    /**
     * \@example
     *   const mockTodos = Array.from({length: 10000}, (_, x) => ({id: x}));
     *
     *   of(mockTodos).pipe(mapInWorker<Todo>(createTodo))
     *   .subscribe(res => console.log(res));
     * @template T
     * @param {?} factoryFn
     * @return {?}
     */
    function mapInWorker(factoryFn) {
        return function (source) {
            return new rxjs.Observable(function (observer) {
                /** @type {?} */
                var worker = createWorker();
                worker.onmessage = function (e) {
                    observer.next(e.data);
                    observer.complete();
                    worker.terminate();
                };
                worker.onerror = function (err) {
                    observer.error(err);
                    observer.complete();
                    worker.terminate();
                };
                return source.subscribe(function (value) {
                    /** @type {?} */
                    var input = {
                        factory: factoryFn,
                        data: value
                    };
                    /** @type {?} */
                    var serialized = serialize(input);
                    worker.postMessage(serialized);
                });
            });
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    var SnapshotManager = /** @class */ (function () {
        function SnapshotManager() {
        }
        /**
         * Get a snapshot of the whole state or a specific stores
         * Use it ONLY for things like saving the state in the server
         */
        /**
         * Get a snapshot of the whole state or a specific stores
         * Use it ONLY for things like saving the state in the server
         * @param {?=} stores
         * @return {?}
         */
        SnapshotManager.prototype.getStoresSnapshot = /**
         * Get a snapshot of the whole state or a specific stores
         * Use it ONLY for things like saving the state in the server
         * @param {?=} stores
         * @return {?}
         */
            function (stores) {
                if (stores === void 0) {
                    stores = [];
                }
                /** @type {?} */
                var acc = {};
                /** @type {?} */
                var hasInclude = stores.length > 0;
                /** @type {?} */
                var keys = hasInclude ? stores : Object.keys(__stores__);
                for (var i = 0; i < keys.length; i++) {
                    /** @type {?} */
                    var storeName = keys[i];
                    acc[storeName] = __stores__[storeName]._value();
                }
                return acc;
            };
        /**
         * Set snapshot we get from the server
         */
        /**
         * Set snapshot we get from the server
         * @param {?} stores
         * @return {?}
         */
        SnapshotManager.prototype.setStoresSnapshot = /**
         * Set snapshot we get from the server
         * @param {?} stores
         * @return {?}
         */
            function (stores) {
                /** @type {?} */
                var normalizedStores = stores;
                if (isString(stores)) {
                    normalizedStores = JSON.parse(( /** @type {?} */(normalizedStores)));
                }
                var _loop_1 = function (i, keys) {
                    /** @type {?} */
                    var storeName = keys[i];
                    if (__stores__[storeName]) {
                        __stores__[storeName].setState(function () { return normalizedStores[storeName]; });
                    }
                };
                for (var i = 0, keys = Object.keys(normalizedStores); i < keys.length; i++) {
                    _loop_1(i, keys);
                }
            };
        return SnapshotManager;
    }());
    /** @type {?} */
    var snapshotManager = new SnapshotManager();

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * @abstract
     * @template E, S
     */
    var /**
     * @abstract
     * @template E, S
     */ AkitaPlugin = /** @class */ (function () {
        function AkitaPlugin(query, config) {
            this.query = query;
            if (config && config.resetFn) {
                if (getAkitaConfig().resettable) {
                    this.onReset(config.resetFn);
                }
            }
        }
        /** This method is responsible for getting access to the query. */
        /**
         * This method is responsible for getting access to the query.
         * @return {?}
         */
        AkitaPlugin.prototype.getQuery = /**
         * This method is responsible for getting access to the query.
         * @return {?}
         */
            function () {
                return this.query;
            };
        /** This method is responsible for getting access to the store. */
        /**
         * This method is responsible for getting access to the store.
         * @return {?}
         */
        AkitaPlugin.prototype.getStore = /**
         * This method is responsible for getting access to the store.
         * @return {?}
         */
            function () {
                return this.getQuery().__store__;
            };
        /** This method is responsible tells whether the plugin is entityBased or not.  */
        /**
         * This method is responsible tells whether the plugin is entityBased or not.
         * @param {?} entityId
         * @return {?}
         */
        AkitaPlugin.prototype.isEntityBased = /**
         * This method is responsible tells whether the plugin is entityBased or not.
         * @param {?} entityId
         * @return {?}
         */
            function (entityId) {
                return toBoolean(entityId);
            };
        /** This method is responsible for selecting the source; it can be the whole store or one entity. */
        /**
         * This method is responsible for selecting the source; it can be the whole store or one entity.
         * @param {?} entityId
         * @return {?}
         */
        AkitaPlugin.prototype.selectSource = /**
         * This method is responsible for selecting the source; it can be the whole store or one entity.
         * @param {?} entityId
         * @return {?}
         */
            function (entityId) {
                if (this.isEntityBased(entityId)) {
                    return (( /** @type {?} */(this.getQuery()))).selectEntity(entityId).pipe(filterNil);
                }
                return (( /** @type {?} */(this.getQuery()))).select(function (state) { return state; });
            };
        /**
         * @param {?} entityId
         * @return {?}
         */
        AkitaPlugin.prototype.getSource = /**
         * @param {?} entityId
         * @return {?}
         */
            function (entityId) {
                if (this.isEntityBased(entityId)) {
                    return (( /** @type {?} */(this.getQuery()))).getEntity(entityId);
                }
                return this.getQuery().getSnapshot();
            };
        /** This method is responsible for updating the store or one entity; it can be the whole store or one entity. */
        /**
         * This method is responsible for updating the store or one entity; it can be the whole store or one entity.
         * @param {?} newState
         * @param {?=} entityId
         * @return {?}
         */
        AkitaPlugin.prototype.updateStore = /**
         * This method is responsible for updating the store or one entity; it can be the whole store or one entity.
         * @param {?} newState
         * @param {?=} entityId
         * @return {?}
         */
            function (newState, entityId) {
                if (this.isEntityBased(entityId)) {
                    this.getStore().update(entityId, newState);
                }
                else {
                    this.getStore().setState(function (state) { return (__assign({}, state, newState)); });
                }
            };
        /**
         * Function to invoke upon reset
         */
        /**
         * Function to invoke upon reset
         * @param {?} fn
         * @return {?}
         */
        AkitaPlugin.prototype.onReset = /**
         * Function to invoke upon reset
         * @param {?} fn
         * @return {?}
         */
            function (fn) {
                var _this = this;
                /** @type {?} */
                var original = this.getStore().reset;
                this.getStore().reset = function () {
                    var params = [];
                    for (var _i = 0; _i < arguments.length; _i++) {
                        params[_i] = arguments[_i];
                    }
                    /** It should run after the plugin destroy method */
                    setTimeout(function () {
                        original.apply(_this.getStore(), params);
                        fn();
                    });
                };
            };
        return AkitaPlugin;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @type {?} */
    var paginatorDefaults = {
        pagesControls: false,
        range: false,
        startWith: 1,
        cacheTimeout: undefined
    };
    /**
     * @template E
     */
    var PaginatorPlugin = /** @class */ (function (_super) {
        __extends(PaginatorPlugin, _super);
        function PaginatorPlugin(query, config) {
            if (config === void 0) {
                config = {};
            }
            var _this = _super.call(this, query, {
                resetFn: function () {
                    _this.initial = false;
                    _this.destroy({ clearCache: true, currentPage: 1 });
                }
            }) || this;
            _this.query = query;
            _this.config = config;
            /**
             * Save current filters, sorting, etc. in cache
             */
            _this.metadata = new Map();
            _this.pages = new Map();
            _this.pagination = {
                currentPage: 1,
                perPage: 0,
                total: 0,
                lastPage: 0,
                data: []
            };
            /**
             * When the user navigates to a different page and return
             * we don't want to call `clearCache` on first time.
             */
            _this.initial = false;
            /**
             * Proxy to the query loading
             */
            _this.isLoading$ = _this.query.selectLoading().pipe(operators.delay(0));
            _this.config = Object.assign(paginatorDefaults, config);
            var _a = _this.config, startWith = _a.startWith, cacheTimeout = _a.cacheTimeout;
            _this.page = new rxjs.BehaviorSubject(startWith);
            if (isObservable(cacheTimeout)) {
                _this.clearCacheSubscription = cacheTimeout.subscribe(function (_) { return _this.clearCache(); });
            }
            return _this;
        }
        Object.defineProperty(PaginatorPlugin.prototype, "pageChanges", {
            /**
             * Listen to page changes
             */
            get: /**
             * Listen to page changes
             * @return {?}
             */ function () {
                return this.page.asObservable();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(PaginatorPlugin.prototype, "currentPage", {
            /**
             * Get the current page number
             */
            get: /**
             * Get the current page number
             * @return {?}
             */ function () {
                return this.pagination.currentPage;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(PaginatorPlugin.prototype, "isFirst", {
            /**
             * Check if current page is the first one
             */
            get: /**
             * Check if current page is the first one
             * @return {?}
             */ function () {
                return this.currentPage === 1;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(PaginatorPlugin.prototype, "isLast", {
            /**
             * Check if current page is the last one
             */
            get: /**
             * Check if current page is the last one
             * @return {?}
             */ function () {
                return this.currentPage === this.pagination.lastPage;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Whether to generate an array of pages for *ngFor
         * [1, 2, 3, 4]
         */
        /**
         * Whether to generate an array of pages for *ngFor
         * [1, 2, 3, 4]
         * @template THIS
         * @this {THIS}
         * @return {THIS}
         */
        PaginatorPlugin.prototype.withControls = /**
         * Whether to generate an array of pages for *ngFor
         * [1, 2, 3, 4]
         * @template THIS
         * @this {THIS}
         * @return {THIS}
         */
            function () {
                ( /** @type {?} */(this)).config.pagesControls = true;
                return ( /** @type {?} */(this));
            };
        /**
         * Whether to generate the `from` and `to` keys
         * [1, 2, 3, 4]
         */
        /**
         * Whether to generate the `from` and `to` keys
         * [1, 2, 3, 4]
         * @template THIS
         * @this {THIS}
         * @return {THIS}
         */
        PaginatorPlugin.prototype.withRange = /**
         * Whether to generate the `from` and `to` keys
         * [1, 2, 3, 4]
         * @template THIS
         * @this {THIS}
         * @return {THIS}
         */
            function () {
                ( /** @type {?} */(this)).config.range = true;
                return ( /** @type {?} */(this));
            };
        /**
         * Set the loading state
         */
        /**
         * Set the loading state
         * @param {?=} value
         * @return {?}
         */
        PaginatorPlugin.prototype.setLoading = /**
         * Set the loading state
         * @param {?=} value
         * @return {?}
         */
            function (value) {
                if (value === void 0) {
                    value = true;
                }
                this.getStore().setLoading(value);
            };
        /**
         * Update the pagination object and add the page
         */
        /**
         * Update the pagination object and add the page
         * @param {?} response
         * @return {?}
         */
        PaginatorPlugin.prototype.update = /**
         * Update the pagination object and add the page
         * @param {?} response
         * @return {?}
         */
            function (response) {
                this.pagination = response;
                this.addPage(response.data);
            };
        /**
         *
         * Set the ids and add the page to store
         */
        /**
         *
         * Set the ids and add the page to store
         * @param {?} data
         * @return {?}
         */
        PaginatorPlugin.prototype.addPage = /**
         *
         * Set the ids and add the page to store
         * @param {?} data
         * @return {?}
         */
            function (data) {
                var _this = this;
                this.pages.set(this.currentPage, { ids: data.map(function (entity) { return entity[_this.getStore().idKey]; }) });
                this.getStore().add(data);
            };
        /**
         * Clear the cache.
         */
        /**
         * Clear the cache.
         * @return {?}
         */
        PaginatorPlugin.prototype.clearCache = /**
         * Clear the cache.
         * @return {?}
         */
            function () {
                var _this = this;
                if (!this.initial) {
                    applyAction(function () {
                        _this.getStore().remove();
                    }, { type: '@Pagination - Clear Cache' });
                    this.pages = new Map();
                    this.metadata = new Map();
                }
                this.initial = false;
            };
        /**
         * @param {?} page
         * @return {?}
         */
        PaginatorPlugin.prototype.clearPage = /**
         * @param {?} page
         * @return {?}
         */
            function (page) {
                this.pages.delete(page);
            };
        /**
         * Clear the cache timeout and optionally the pages
         */
        /**
         * Clear the cache timeout and optionally the pages
         * @param {?=} __0
         * @return {?}
         */
        PaginatorPlugin.prototype.destroy = /**
         * Clear the cache timeout and optionally the pages
         * @param {?=} __0
         * @return {?}
         */
            function (_a) {
                var _b = _a === void 0 ? {} : _a, clearCache = _b.clearCache, currentPage = _b.currentPage;
                if (this.clearCacheSubscription) {
                    this.clearCacheSubscription.unsubscribe();
                }
                if (clearCache) {
                    this.clearCache();
                }
                if (!isUndefined(currentPage)) {
                    this.setPage(currentPage);
                }
                this.initial = true;
            };
        /**
         * Whether the provided page is active
         */
        /**
         * Whether the provided page is active
         * @param {?} page
         * @return {?}
         */
        PaginatorPlugin.prototype.isPageActive = /**
         * Whether the provided page is active
         * @param {?} page
         * @return {?}
         */
            function (page) {
                return this.currentPage === page;
            };
        /**
         * Set the current page
         */
        /**
         * Set the current page
         * @param {?} page
         * @return {?}
         */
        PaginatorPlugin.prototype.setPage = /**
         * Set the current page
         * @param {?} page
         * @return {?}
         */
            function (page) {
                if (page !== this.currentPage || !this.hasPage(page)) {
                    this.page.next((this.pagination.currentPage = page));
                }
            };
        /**
         * Increment current page
         */
        /**
         * Increment current page
         * @return {?}
         */
        PaginatorPlugin.prototype.nextPage = /**
         * Increment current page
         * @return {?}
         */
            function () {
                if (this.currentPage !== this.pagination.lastPage) {
                    this.setPage(this.pagination.currentPage + 1);
                }
            };
        /**
         * Decrement current page
         */
        /**
         * Decrement current page
         * @return {?}
         */
        PaginatorPlugin.prototype.prevPage = /**
         * Decrement current page
         * @return {?}
         */
            function () {
                if (this.pagination.currentPage > 1) {
                    this.setPage(this.pagination.currentPage - 1);
                }
            };
        /**
         * Set current page to last
         */
        /**
         * Set current page to last
         * @return {?}
         */
        PaginatorPlugin.prototype.setLastPage = /**
         * Set current page to last
         * @return {?}
         */
            function () {
                this.setPage(this.pagination.lastPage);
            };
        /**
         * Set current page to first
         */
        /**
         * Set current page to first
         * @return {?}
         */
        PaginatorPlugin.prototype.setFirstPage = /**
         * Set current page to first
         * @return {?}
         */
            function () {
                this.setPage(1);
            };
        /**
         * Check if page exists in cache
         */
        /**
         * Check if page exists in cache
         * @param {?} page
         * @return {?}
         */
        PaginatorPlugin.prototype.hasPage = /**
         * Check if page exists in cache
         * @param {?} page
         * @return {?}
         */
            function (page) {
                return this.pages.has(page);
            };
        /**
         * Get the current page if it's in cache, otherwise invoke the request
         */
        /**
         * Get the current page if it's in cache, otherwise invoke the request
         * @param {?} req
         * @return {?}
         */
        PaginatorPlugin.prototype.getPage = /**
         * Get the current page if it's in cache, otherwise invoke the request
         * @param {?} req
         * @return {?}
         */
            function (req) {
                var _this = this;
                /** @type {?} */
                var page = this.pagination.currentPage;
                if (this.hasPage(page)) {
                    return this.selectPage(page);
                }
                else {
                    this.setLoading(true);
                    return rxjs.from(req()).pipe(operators.switchMap(function (config) {
                        applyTransaction(function () {
                            _this.setLoading(false);
                            _this.update(config);
                        });
                        return _this.selectPage(page);
                    }));
                }
            };
        /**
         * @return {?}
         */
        PaginatorPlugin.prototype.getQuery = /**
         * @return {?}
         */
            function () {
                return this.query;
            };
        /**
         * @return {?}
         */
        PaginatorPlugin.prototype.getFrom = /**
         * @return {?}
         */
            function () {
                if (this.isFirst) {
                    return 1;
                }
                return (this.currentPage - 1) * this.pagination.perPage + 1;
            };
        /**
         * @return {?}
         */
        PaginatorPlugin.prototype.getTo = /**
         * @return {?}
         */
            function () {
                return this.currentPage * this.pagination.perPage;
            };
        /**
         * Select the page
         */
        /**
         * Select the page
         * @param {?} page
         * @return {?}
         */
        PaginatorPlugin.prototype.selectPage = /**
         * Select the page
         * @param {?} page
         * @return {?}
         */
            function (page) {
                var _this = this;
                return this.query.selectAll({ asObject: true }).pipe(operators.take(1), operators.map(function (entities) {
                    /** @type {?} */
                    var response = __assign({}, _this.pagination, { data: _this.pages.get(page).ids.map(function (id) { return entities[id]; }) });
                    var _a = _this.config, range = _a.range, pagesControls = _a.pagesControls;
                    /** If no total - calc it */
                    if (isNaN(_this.pagination.total)) {
                        if (response.lastPage === 1) {
                            response.total = response.data ? response.data.length : 0;
                        }
                        else {
                            response.total = response.perPage * response.lastPage;
                        }
                        _this.pagination.total = response.total;
                    }
                    if (range) {
                        response.from = _this.getFrom();
                        response.to = _this.getTo();
                    }
                    if (pagesControls) {
                        response.pageControls = generatePages(_this.pagination.total, _this.pagination.perPage);
                    }
                    return response;
                }));
            };
        __decorate([
            action({ type: '@Pagination - New Page' }, true),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object]),
            __metadata("design:returntype", void 0)
        ], PaginatorPlugin.prototype, "update", null);
        return PaginatorPlugin;
    }(AkitaPlugin));
    /**
     * Generate an array so we can ngFor them to navigate between pages
     * @param {?} total
     * @param {?} perPage
     * @return {?}
     */
    function generatePages(total, perPage) {
        /** @type {?} */
        var len = Math.ceil(total / perPage);
        /** @type {?} */
        var arr = [];
        for (var i = 0; i < len; i++) {
            arr.push(i + 1);
        }
        return arr;
    }
    /**
     * backward compatibility
     * @type {?}
     */
    var Paginator = PaginatorPlugin;

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    // Todo: Return  AbstractControl interface
    /**
     * @template T
     */
    var  
    // Todo: Return  AbstractControl interface
    /**
     * @template T
     */
    PersistNgFormPlugin = /** @class */ (function (_super) {
        __extends(PersistNgFormPlugin, _super);
        function PersistNgFormPlugin(query, factoryFnOrPath, params) {
            if (params === void 0) {
                params = {};
            }
            var _this = _super.call(this, query) || this;
            _this.query = query;
            _this.factoryFnOrPath = factoryFnOrPath;
            _this.params = params;
            _this.params = __assign({ debounceTime: 300, formKey: 'akitaForm', emitEvent: false, arrControlFactory: function (v) { return _this.builder.control(v); } }, params);
            _this.isRootKeys = toBoolean(factoryFnOrPath) === false;
            _this.isKeyBased = isString(factoryFnOrPath) || _this.isRootKeys;
            return _this;
        }
        /**
         * @template THIS
         * @this {THIS}
         * @param {?} form
         * @param {?=} builder
         * @return {THIS}
         */
        PersistNgFormPlugin.prototype.setForm = /**
         * @template THIS
         * @this {THIS}
         * @param {?} form
         * @param {?=} builder
         * @return {THIS}
         */
            function (form, builder) {
                ( /** @type {?} */(this)).form = form;
                ( /** @type {?} */(this)).builder = builder;
                ( /** @type {?} */(this)).activate();
                return ( /** @type {?} */(this));
            };
        /**
         * @param {?=} initialState
         * @return {?}
         */
        PersistNgFormPlugin.prototype.reset = /**
         * @param {?=} initialState
         * @return {?}
         */
            function (initialState) {
                var _this = this;
                var _a;
                /** @type {?} */
                var value;
                if (initialState) {
                    value = initialState;
                }
                else {
                    value = this.isKeyBased ? this.initialValue : (( /** @type {?} */(this))).factoryFnOrPath();
                }
                if (this.isKeyBased) {
                    Object.keys(this.initialValue).forEach(function (stateKey) {
                        /** @type {?} */
                        var value = _this.initialValue[stateKey];
                        if (Array.isArray(value) && _this.builder) {
                            /** @type {?} */
                            var formArray = _this.form.controls[stateKey];
                            _this.cleanArray(formArray);
                            value.forEach(function (v, i) {
                                _this.form.get(stateKey).insert(i, (( /** @type {?} */(_this.params.arrControlFactory)))(v));
                            });
                        }
                    });
                }
                this.form.patchValue(value, { emitEvent: this.params.emitEvent });
                /** @type {?} */
                var storeValue = this.isKeyBased ? setValue(this.getQuery().getSnapshot(), this.getStore().storeName + "." + this.factoryFnOrPath, value) : (_a = {}, _a[this.params.formKey] = value, _a);
                this.updateStore(storeValue);
            };
        /**
         * @param {?} control
         * @return {?}
         */
        PersistNgFormPlugin.prototype.cleanArray = /**
         * @param {?} control
         * @return {?}
         */
            function (control) {
                while (control.length !== 0) {
                    control.removeAt(0);
                }
            };
        /**
         * @param {?} formValue
         * @param {?} root
         * @return {?}
         */
        PersistNgFormPlugin.prototype.resolveInitialValue = /**
         * @param {?} formValue
         * @param {?} root
         * @return {?}
         */
            function (formValue, root) {
                var _this = this;
                if (!formValue)
                    return;
                return Object.keys(formValue).reduce(function (acc, stateKey) {
                    /** @type {?} */
                    var value = root[stateKey];
                    if (Array.isArray(value) && _this.builder) {
                        /** @type {?} */
                        var factory_1 = _this.params.arrControlFactory;
                        _this.cleanArray(_this.form.get(stateKey));
                        value.forEach(function (v, i) {
                            _this.form.get(stateKey).insert(i, (( /** @type {?} */(factory_1)))(v));
                        });
                    }
                    acc[stateKey] = root[stateKey];
                    return acc;
                }, {});
            };
        /**
         * @return {?}
         */
        PersistNgFormPlugin.prototype.activate = /**
         * @return {?}
         */
            function () {
                var _this = this;
                var _a;
                /** @type {?} */
                var path;
                if (this.isKeyBased) {
                    if (this.isRootKeys) {
                        this.initialValue = this.resolveInitialValue(this.form.value, this.getQuery().getSnapshot());
                        this.form.patchValue(this.initialValue, { emitEvent: this.params.emitEvent });
                    }
                    else {
                        path = this.getStore().storeName + "." + this.factoryFnOrPath;
                        /** @type {?} */
                        var root = getValue(this.getQuery().getSnapshot(), path);
                        this.initialValue = this.resolveInitialValue(root, root);
                        this.form.patchValue(this.initialValue, { emitEvent: this.params.emitEvent });
                    }
                }
                else {
                    if (!(( /** @type {?} */(this.getQuery().getSnapshot())))[this.params.formKey]) {
                        __globalState.setAction({ type: '@PersistNgFormPlugin activate' });
                        this.updateStore((_a = {}, _a[this.params.formKey] = (( /** @type {?} */(this))).factoryFnOrPath(), _a));
                    }
                    /** @type {?} */
                    var value = this.getQuery().getSnapshot()[this.params.formKey];
                    this.form.patchValue(value);
                }
                this.formChanges = this.form.valueChanges.pipe(operators.debounceTime(this.params.debounceTime)).subscribe(function (value) {
                    __globalState.setAction({ type: '@PersistForm - Update' });
                    /** @type {?} */
                    var newState;
                    if (_this.isKeyBased) {
                        if (_this.isRootKeys) {
                            newState = function (state) { return (__assign({}, state, value)); };
                        }
                        else {
                            newState = function (state) { return setValue(state, path, value); };
                        }
                    }
                    else {
                        newState = function () {
                            var _a;
                            return (_a = {}, _a[_this.params.formKey] = value, _a);
                        };
                    }
                    _this.updateStore(newState(_this.getQuery().getSnapshot()));
                });
            };
        /**
         * @return {?}
         */
        PersistNgFormPlugin.prototype.destroy = /**
         * @return {?}
         */
            function () {
                this.formChanges && this.formChanges.unsubscribe();
                this.form = null;
                this.builder = null;
            };
        return PersistNgFormPlugin;
    }(AkitaPlugin));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @type {?} */
    var notBs = typeof localStorage === 'undefined';
    /**
     * @param {?=} params
     * @return {?}
     */
    function persistState(params) {
        if (notBs)
            return;
        /** @type {?} */
        var defaults = {
            key: 'AkitaStores',
            storage: localStorage,
            deserialize: JSON.parse,
            serialize: JSON.stringify,
            include: [],
            exclude: []
        };
        var _a = Object.assign({}, defaults, params), storage = _a.storage, deserialize = _a.deserialize, serialize = _a.serialize, include = _a.include, exclude = _a.exclude, key = _a.key;
        /** @type {?} */
        var hasInclude = include.length > 0;
        /** @type {?} */
        var hasExclude = exclude.length > 0;
        /** @type {?} */
        var includeStores;
        if (hasInclude && hasExclude) {
            throw new AkitaError("You can't use both include and exclude");
        }
        if (hasInclude) {
            includeStores = include.reduce(function (acc, path) {
                /** @type {?} */
                var storeName = path.split('.')[0];
                acc[storeName] = path;
                return acc;
            }, {});
        }
        /** @type {?} */
        var storageState = deserialize(storage.getItem(key) || '{}');
        /** @type {?} */
        var stores = {};
        /** @type {?} */
        var acc = {};
        /**
         * @return {?}
         */
        function save() {
            storage.setItem(key, serialize(Object.assign({}, storageState, acc)));
        }
        /**
         * @param {?} storeName
         * @param {?} path
         * @return {?}
         */
        function subscribe(storeName, path) {
            stores[storeName] = __stores__[storeName]
                ._select(function (state) { return getValue(state, path); })
                .pipe(operators.skip(1))
                .subscribe(function (data) {
                acc[storeName] = data;
                save();
            });
        }
        /**
         * @param {?} storeName
         * @param {?} store
         * @param {?} path
         * @return {?}
         */
        function setInitial(storeName, store, path) {
            if (storageState[storeName]) {
                __globalState.setAction({ type: '@PersistState' });
                store.setState(function (state) {
                    return setValue(state, path, storageState[storeName]);
                });
                if (store.setDirty) {
                    store.setDirty();
                }
            }
        }
        /** @type {?} */
        var subscription = rootDispatcher.pipe(operators.filter(function (action) { return action.type === 0 /* NEW_STORE */; })).subscribe(function (action) {
            /** @type {?} */
            var currentStoreName = action.payload.store.storeName;
            if (hasExclude && exclude.includes(currentStoreName)) {
                return;
            }
            if (hasInclude) {
                /** @type {?} */
                var path = includeStores[currentStoreName];
                if (!path) {
                    return;
                }
                setInitial(currentStoreName, action.payload.store, path);
                subscribe(currentStoreName, path);
            }
            else {
                setInitial(currentStoreName, action.payload.store, currentStoreName);
                subscribe(currentStoreName, currentStoreName);
            }
        });
        return {
            destroy: /**
             * @return {?}
             */ function () {
                subscription.unsubscribe();
                for (var i = 0, keys = Object.keys(stores); i < keys.length; i++) {
                    /** @type {?} */
                    var storeName = keys[i];
                    stores[storeName].unsubscribe();
                }
                stores = {};
            },
            clear: /**
             * @return {?}
             */ function () {
                storage.clear();
            },
            clearStore: /**
             * @param {?} storeName
             * @return {?}
             */ function (storeName) {
                /** @type {?} */
                var storageState = deserialize(storage.getItem(key) || '{}');
                if (storageState[storeName]) {
                    delete storageState[storeName];
                    storage.setItem(key, serialize(storageState));
                }
            }
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @type {?} */
    var rootDispatcherSub;
    /** @type {?} */
    var devtoolsSub;
    /**
     * @param {?=} ngZoneOrOptions
     * @param {?=} options
     * @return {?}
     */
    function akitaDevtools(ngZoneOrOptions, options) {
        if (options === void 0) {
            options = {};
        }
        if (!(( /** @type {?} */(window))).__REDUX_DEVTOOLS_EXTENSION__) {
            return;
        }
        rootDispatcherSub && rootDispatcherSub.unsubscribe();
        devtoolsSub && devtoolsSub();
        /** @type {?} */
        var isAngular = ngZoneOrOptions && ngZoneOrOptions['run'];
        if (!isAngular) {
            ngZoneOrOptions = ngZoneOrOptions || {};
            (( /** @type {?} */(ngZoneOrOptions))).run = function (cb) { return cb(); };
            options = ( /** @type {?} */(ngZoneOrOptions));
        }
        /** @type {?} */
        var defaultOptions = { name: 'Akita' };
        /** @type {?} */
        var merged = Object.assign({}, defaultOptions, options);
        /** @type {?} */
        var devTools = (( /** @type {?} */(window))).__REDUX_DEVTOOLS_EXTENSION__.connect(merged);
        /** @type {?} */
        var appState = {};
        rootDispatcherSub = rootDispatcher.subscribe(function (action) {
            var _a;
            if (action.type === 1 /* DELETE_STORE */) {
                /** @type {?} */
                var storeName = action.payload.storeName;
                delete appState[storeName];
                devTools.send({ type: "[" + storeName + "] - Delete Store" }, appState);
            }
            if (action.type === 2 /* NEW_STATE */) {
                if (__globalState.skipAction) {
                    __globalState.setSkipAction(false);
                    return;
                }
                appState = __assign({}, appState, (_a = {}, _a[action.payload.name] = __stores__[action.payload.name]._value(), _a));
                var _b = __globalState.currentAction, type = _b.type, entityId = _b.entityId;
                /** @type {?} */
                var storeName = capitalize(action.payload.name);
                /** @type {?} */
                var msg = isDefined(entityId) ? "[" + storeName + "] - " + type + " (ids: " + entityId + ")" : "[" + storeName + "] - " + type;
                if (options.logTrace) {
                    console.group(msg);
                    console.trace();
                    console.groupEnd();
                }
                devTools.send({ type: msg, transaction: __globalState.currentT.map(function (t) { return t.type; }) }, appState);
            }
        });
        devtoolsSub = devTools.subscribe(function (message) {
            if (message.type === 'ACTION') {
                var _a = __read(message.payload.split('.'), 1), storeName_1 = _a[0];
                if (__stores__[storeName_1]) {
                    (( /** @type {?} */(ngZoneOrOptions))).run(function () {
                        /** @type {?} */
                        var funcCall = message.payload.replace(storeName_1, "this['" + storeName_1 + "']");
                        try {
                            new Function("" + funcCall).call(__stores__);
                        }
                        catch (e) {
                            console.warn('Unknown Method ');
                        }
                    });
                }
            }
            if (message.type === 'DISPATCH') {
                /** @type {?} */
                var payloadType = message.payload.type;
                if (payloadType === 'COMMIT') {
                    devTools.init(appState);
                    return;
                }
                if (message.state) {
                    /** @type {?} */
                    var rootState_1 = JSON.parse(message.state);
                    var _loop_1 = function (i, keys) {
                        /** @type {?} */
                        var storeName = keys[i];
                        if (__stores__[storeName]) {
                            (( /** @type {?} */(ngZoneOrOptions))).run(function () {
                                __stores__[storeName].setState(function () { return rootState_1[storeName]; }, false);
                            });
                        }
                    };
                    for (var i = 0, keys = Object.keys(rootState_1); i < keys.length; i++) {
                        _loop_1(i, keys);
                    }
                }
            }
        });
    }
    /**
     * @param {?} string
     * @return {?}
     */
    function capitalize(string) {
        return string && string.charAt(0).toUpperCase() + string.slice(1);
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    var 0 = function (plugin) { return plugin.destroy(); };
    /** @type {?} */
    var defaultActions = { beforeRemove: 0 };
    /**
     * @abstract
     * @template E, P
     */
    var /**
     * @abstract
     * @template E, P
     */ EntityCollectionPlugin = /** @class */ (function () {
        function EntityCollectionPlugin(query, entityIds) {
            this.query = query;
            this.entityIds = entityIds;
            this.entities = new Map();
        }
        /**
         * Get the entity plugin instance.
         */
        /**
         * Get the entity plugin instance.
         * @param {?} id
         * @return {?}
         */
        EntityCollectionPlugin.prototype.getEntity = /**
         * Get the entity plugin instance.
         * @param {?} id
         * @return {?}
         */
            function (id) {
                return this.entities.get(id);
            };
        /**
         * Whether the entity plugin exist.
         */
        /**
         * Whether the entity plugin exist.
         * @param {?} id
         * @return {?}
         */
        EntityCollectionPlugin.prototype.hasEntity = /**
         * Whether the entity plugin exist.
         * @param {?} id
         * @return {?}
         */
            function (id) {
                return this.entities.has(id);
            };
        /**
         * Remove the entity plugin instance.
         */
        /**
         * Remove the entity plugin instance.
         * @param {?} id
         * @return {?}
         */
        EntityCollectionPlugin.prototype.removeEntity = /**
         * Remove the entity plugin instance.
         * @param {?} id
         * @return {?}
         */
            function (id) {
                return this.entities.delete(id);
            };
        /**
         * Set the entity plugin instance.
         */
        /**
         * Set the entity plugin instance.
         * @param {?} id
         * @param {?} plugin
         * @return {?}
         */
        EntityCollectionPlugin.prototype.createEntity = /**
         * Set the entity plugin instance.
         * @param {?} id
         * @param {?} plugin
         * @return {?}
         */
            function (id, plugin) {
                return this.entities.set(id, plugin);
            };
        /**
         * If the user passes `entityIds` we take them; otherwise, we take all.
         */
        /**
         * If the user passes `entityIds` we take them; otherwise, we take all.
         * @return {?}
         */
        EntityCollectionPlugin.prototype.getIds = /**
         * If the user passes `entityIds` we take them; otherwise, we take all.
         * @return {?}
         */
            function () {
                return isUndefined(this.entityIds) ? this.query.getSnapshot().ids : coerceArray(this.entityIds);
            };
        /**
         * When you call one of the plugin methods, you can pass id/ids or undefined which means all.
         */
        /**
         * When you call one of the plugin methods, you can pass id/ids or undefined which means all.
         * @param {?=} ids
         * @return {?}
         */
        EntityCollectionPlugin.prototype.resolvedIds = /**
         * When you call one of the plugin methods, you can pass id/ids or undefined which means all.
         * @param {?=} ids
         * @return {?}
         */
            function (ids) {
                return isUndefined(ids) ? this.getIds() : coerceArray(ids);
            };
        /**
         * Call this method when you want to activate the plugin on init or when you need to listen to add/remove of entities dynamically.
         *
         * For example in your plugin you may do the following:
         *
         * this.query.select(state => state.ids).pipe(skip(1)).subscribe(ids => this.activate(ids));
         */
        /**
         * Call this method when you want to activate the plugin on init or when you need to listen to add/remove of entities dynamically.
         *
         * For example in your plugin you may do the following:
         *
         * this.query.select(state => state.ids).pipe(skip(1)).subscribe(ids => this.activate(ids));
         * @param {?} ids
         * @param {?=} actions
         * @return {?}
         */
        EntityCollectionPlugin.prototype.rebase = /**
         * Call this method when you want to activate the plugin on init or when you need to listen to add/remove of entities dynamically.
         *
         * For example in your plugin you may do the following:
         *
         * this.query.select(state => state.ids).pipe(skip(1)).subscribe(ids => this.activate(ids));
         * @param {?} ids
         * @param {?=} actions
         * @return {?}
         */
            function (ids, actions) {
                var _this = this;
                if (actions === void 0) {
                    actions = defaultActions;
                }
                /**
                 *
                 * If the user passes `entityIds` & we have new ids check if we need to add/remove instances.
                 *
                 * This phase will be called only upon update.
                 */
                if (toBoolean(ids)) {
                    /**
                     * Which means all
                     */
                    if (isUndefined(this.entityIds)) {
                        for (var i = 0, len = ids.length; i < len; i++) {
                            /** @type {?} */
                            var entityId = ids[i];
                            if (this.hasEntity(entityId) === false) {
                                isFunction(actions.beforeAdd) && actions.beforeAdd(entityId);
                                /** @type {?} */
                                var plugin = this.instantiatePlugin(entityId);
                                this.entities.set(entityId, plugin);
                                isFunction(actions.afterAdd) && actions.afterAdd(plugin);
                            }
                        }
                        this.entities.forEach(function (plugin, entityId) {
                            if (ids.indexOf(entityId) === -1) {
                                isFunction(actions.beforeRemove) && actions.beforeRemove(plugin);
                                _this.removeEntity(entityId);
                            }
                        });
                    }
                    else {
                        /**
                         * Which means the user passes specific ids
                         * @type {?}
                         */
                        var _ids = coerceArray(this.entityIds);
                        for (var i = 0, len = _ids.length; i < len; i++) {
                            /** @type {?} */
                            var entityId = _ids[i];
                            /** The Entity in current ids and doesn't exist, add it. */
                            if (ids.indexOf(entityId) > -1 && this.hasEntity(entityId) === false) {
                                isFunction(actions.beforeAdd) && actions.beforeAdd(entityId);
                                /** @type {?} */
                                var plugin = this.instantiatePlugin(entityId);
                                this.entities.set(entityId, plugin);
                                isFunction(actions.afterAdd) && actions.afterAdd(plugin);
                            }
                            else {
                                this.entities.forEach(function (plugin, entityId) {
                                    /** The Entity not in current ids and exists, remove it. */
                                    if (ids.indexOf(entityId) === -1 && _this.hasEntity(entityId) === true) {
                                        isFunction(actions.beforeRemove) && actions.beforeRemove(plugin);
                                        _this.removeEntity(entityId);
                                    }
                                });
                            }
                        }
                    }
                }
                else {
                    /**
                     * Otherwise, start with the provided ids or all.
                     */
                    this.getIds().forEach(function (id) {
                        if (!_this.hasEntity(id))
                            _this.createEntity(id, _this.instantiatePlugin(id));
                    });
                }
            };
        /**
         * Listen for add/remove entities.
         */
        /**
         * Listen for add/remove entities.
         * @return {?}
         */
        EntityCollectionPlugin.prototype.selectIds = /**
         * Listen for add/remove entities.
         * @return {?}
         */
            function () {
                return this.query.select(function (state) { return state.ids; });
            };
        /**
         * Base method for activation, you can override it if you need to.
         */
        /**
         * Base method for activation, you can override it if you need to.
         * @param {?=} ids
         * @return {?}
         */
        EntityCollectionPlugin.prototype.activate = /**
         * Base method for activation, you can override it if you need to.
         * @param {?=} ids
         * @return {?}
         */
            function (ids) {
                this.rebase(ids);
            };
        /**
         * Loop over each id and invoke the plugin method.
         */
        /**
         * Loop over each id and invoke the plugin method.
         * @param {?} ids
         * @param {?} cb
         * @return {?}
         */
        EntityCollectionPlugin.prototype.forEachId = /**
         * Loop over each id and invoke the plugin method.
         * @param {?} ids
         * @param {?} cb
         * @return {?}
         */
            function (ids, cb) {
                /** @type {?} */
                var _ids = this.resolvedIds(ids);
                for (var i = 0, len = _ids.length; i < len; i++) {
                    /** @type {?} */
                    var id = _ids[i];
                    if (this.hasEntity(id)) {
                        cb(this.getEntity(id));
                    }
                }
            };
        return EntityCollectionPlugin;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * @template E, S
     */
    var /**
     * @template E, S
     */ StateHistoryPlugin = /** @class */ (function (_super) {
        __extends(StateHistoryPlugin, _super);
        function StateHistoryPlugin(query, params, _entityId) {
            if (params === void 0) {
                params = {};
            }
            var _this = _super.call(this, query, {
                resetFn: function () { return _this.clear(); }
            }) || this;
            _this.query = query;
            _this.params = params;
            _this._entityId = _entityId;
            /**
             * Allow skipping an update from outside
             */
            _this.skip = false;
            _this.history = {
                past: [],
                present: null,
                future: []
            };
            /**
             * Skip the update when redo/undo
             */
            _this.skipUpdate = false;
            params.maxAge = toBoolean(params.maxAge) ? params.maxAge : 10;
            _this.activate();
            return _this;
        }
        Object.defineProperty(StateHistoryPlugin.prototype, "hasPast", {
            get: /**
             * @return {?}
             */ function () {
                return this.history.past.length > 0;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(StateHistoryPlugin.prototype, "hasFuture", {
            get: /**
             * @return {?}
             */ function () {
                return this.history.future.length > 0;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        StateHistoryPlugin.prototype.activate = /**
         * @return {?}
         */
            function () {
                var _this = this;
                this.history.present = this.getSource(this._entityId);
                this.subscription = this.selectSource(this._entityId)
                    .pipe(operators.pairwise())
                    .subscribe(function (_a) {
                    var _b = __read(_a, 2), past = _b[0], present = _b[1];
                    if (_this.skip) {
                        _this.skip = false;
                        return;
                    }
                    if (!_this.skipUpdate) {
                        if (_this.history.past.length === _this.params.maxAge) {
                            _this.history.past = _this.history.past.slice(1);
                        }
                        _this.history.past = __spread(_this.history.past, [past]);
                        _this.history.present = present;
                    }
                });
            };
        /**
         * @return {?}
         */
        StateHistoryPlugin.prototype.undo = /**
         * @return {?}
         */
            function () {
                if (this.history.past.length > 0) {
                    var _a = this.history, past = _a.past, present = _a.present, future = _a.future;
                    /** @type {?} */
                    var previous = past[past.length - 1];
                    /** @type {?} */
                    var newPast = past.slice(0, past.length - 1);
                    this.history.past = newPast;
                    this.history.present = previous;
                    this.history.future = __spread([present], this.history.future);
                    this.update();
                }
            };
        /**
         * @return {?}
         */
        StateHistoryPlugin.prototype.redo = /**
         * @return {?}
         */
            function () {
                if (this.history.future.length > 0) {
                    var _a = this.history, past = _a.past, present = _a.present, future = _a.future;
                    /** @type {?} */
                    var next = this.history.future[0];
                    /** @type {?} */
                    var newFuture = this.history.future.slice(1);
                    this.history.past = __spread(past, [present]);
                    this.history.present = next;
                    this.history.future = newFuture;
                    this.update('Redo');
                }
            };
        /**
         * @param {?} index
         * @return {?}
         */
        StateHistoryPlugin.prototype.jumpToPast = /**
         * @param {?} index
         * @return {?}
         */
            function (index) {
                if (index < 0 || index >= this.history.past.length)
                    return;
                var _a = this.history, past = _a.past, future = _a.future;
                /**
                 *
                 * const past = [1, 2, 3, 4, 5];
                 *
                 * newPast = past.slice(0, 2) = [1, 2];
                 * present = past[index] = 3;
                 * [...past.slice(2 + 1), ...future] = [4, 5];
                 *
                 * @type {?}
                 */
                var newPast = past.slice(0, index);
                /** @type {?} */
                var newFuture = __spread(past.slice(index + 1), future);
                /** @type {?} */
                var newPresent = past[index];
                this.history.past = newPast;
                this.history.present = newPresent;
                this.history.future = newFuture;
                this.update();
            };
        /**
         * @param {?} index
         * @return {?}
         */
        StateHistoryPlugin.prototype.jumpToFuture = /**
         * @param {?} index
         * @return {?}
         */
            function (index) {
                if (index < 0 || index >= this.history.future.length)
                    return;
                var _a = this.history, past = _a.past, future = _a.future;
                /** @type {?} */
                var newPast = __spread(past, future.slice(0, index));
                /** @type {?} */
                var newPresent = future[index];
                /** @type {?} */
                var newFuture = future.slice(index + 1);
                this.history.past = newPast;
                this.history.present = newPresent;
                this.history.future = newFuture;
                this.update('Redo');
            };
        /**
         * @return {?}
         */
        StateHistoryPlugin.prototype.clear = /**
         * @return {?}
         */
            function () {
                this.history = {
                    past: [],
                    present: null,
                    future: []
                };
            };
        /**
         * @param {?=} clearHistory
         * @return {?}
         */
        StateHistoryPlugin.prototype.destroy = /**
         * @param {?=} clearHistory
         * @return {?}
         */
            function (clearHistory) {
                if (clearHistory === void 0) {
                    clearHistory = false;
                }
                if (clearHistory) {
                    this.clear();
                }
                this.subscription.unsubscribe();
            };
        /**
         * @return {?}
         */
        StateHistoryPlugin.prototype.ignoreNext = /**
         * @return {?}
         */
            function () {
                this.skip = true;
            };
        /**
         * @param {?=} action
         * @return {?}
         */
        StateHistoryPlugin.prototype.update = /**
         * @param {?=} action
         * @return {?}
         */
            function (action) {
                if (action === void 0) {
                    action = 'Undo';
                }
                this.skipUpdate = true;
                __globalState.setCustomAction({ type: "@StateHistory - " + action });
                this.updateStore(this.history.present, this._entityId);
                this.skipUpdate = false;
            };
        return StateHistoryPlugin;
    }(AkitaPlugin));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * @template E, P
     */
    var /**
     * @template E, P
     */ EntityStateHistoryPlugin = /** @class */ (function (_super) {
        __extends(EntityStateHistoryPlugin, _super);
        function EntityStateHistoryPlugin(query, params) {
            if (params === void 0) {
                params = {};
            }
            var _this = _super.call(this, query, params.entityIds) || this;
            _this.query = query;
            _this.params = params;
            params.maxAge = toBoolean(params.maxAge) ? params.maxAge : 10;
            _this.activate();
            _this.selectIds()
                .pipe(operators.skip(1))
                .subscribe(function (ids) { return _this.activate(ids); });
            return _this;
        }
        /**
         * @param {?=} ids
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.redo = /**
         * @param {?=} ids
         * @return {?}
         */
            function (ids) {
                this.forEachId(ids, function (e) { return e.redo(); });
            };
        /**
         * @param {?=} ids
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.undo = /**
         * @param {?=} ids
         * @return {?}
         */
            function (ids) {
                this.forEachId(ids, function (e) { return e.undo(); });
            };
        /**
         * @param {?} id
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.hasPast = /**
         * @param {?} id
         * @return {?}
         */
            function (id) {
                if (this.hasEntity(id)) {
                    return this.getEntity(id).hasPast;
                }
            };
        /**
         * @param {?} id
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.hasFuture = /**
         * @param {?} id
         * @return {?}
         */
            function (id) {
                if (this.hasEntity(id)) {
                    return this.getEntity(id).hasFuture;
                }
            };
        /**
         * @param {?} ids
         * @param {?} index
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.jumpToFuture = /**
         * @param {?} ids
         * @param {?} index
         * @return {?}
         */
            function (ids, index) {
                this.forEachId(ids, function (e) { return e.jumpToFuture(index); });
            };
        /**
         * @param {?} ids
         * @param {?} index
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.jumpToPast = /**
         * @param {?} ids
         * @param {?} index
         * @return {?}
         */
            function (ids, index) {
                this.forEachId(ids, function (e) { return e.jumpToPast(index); });
            };
        /**
         * @param {?=} ids
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.clear = /**
         * @param {?=} ids
         * @return {?}
         */
            function (ids) {
                this.forEachId(ids, function (e) { return e.clear(); });
            };
        /**
         * @param {?=} ids
         * @param {?=} clearHistory
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.destroy = /**
         * @param {?=} ids
         * @param {?=} clearHistory
         * @return {?}
         */
            function (ids, clearHistory) {
                if (clearHistory === void 0) {
                    clearHistory = false;
                }
                this.forEachId(ids, function (e) { return e.destroy(clearHistory); });
            };
        /**
         * @param {?=} ids
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.ignoreNext = /**
         * @param {?=} ids
         * @return {?}
         */
            function (ids) {
                this.forEachId(ids, function (e) { return e.ignoreNext(); });
            };
        /**
         * @param {?} id
         * @return {?}
         */
        EntityStateHistoryPlugin.prototype.instantiatePlugin = /**
         * @param {?} id
         * @return {?}
         */
            function (id) {
                return ( /** @type {?} */(new StateHistoryPlugin(this.query, this.params, id)));
            };
        return EntityStateHistoryPlugin;
    }(EntityCollectionPlugin));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /** @type {?} */
    var dirtyCheckDefaultParams = {
        comparator: function (head, current) { return JSON.stringify(head) !== JSON.stringify(current); }
    };
    /**
     * @param {?} nestedObj
     * @param {?} path
     * @return {?}
     */
    function getNestedPath(nestedObj, path) {
        /** @type {?} */
        var pathAsArray = path.split('.');
        return pathAsArray.reduce(function (obj, key) { return (obj && obj[key] !== 'undefined' ? obj[key] : undefined); }, nestedObj);
    }
    /**
     * @template Entity, StoreState
     */
    var /**
     * @template Entity, StoreState
     */ DirtyCheckPlugin = /** @class */ (function (_super) {
        __extends(DirtyCheckPlugin, _super);
        function DirtyCheckPlugin(query, params, _entityId) {
            var _this = _super.call(this, query) || this;
            _this.query = query;
            _this.params = params;
            _this._entityId = _entityId;
            _this.dirty = new rxjs.BehaviorSubject(false);
            _this.active = false;
            _this._reset = new rxjs.Subject();
            _this.isDirty$ = _this.dirty.asObservable().pipe(operators.distinctUntilChanged());
            _this.reset$ = _this._reset.asObservable();
            _this.params = __assign({}, dirtyCheckDefaultParams, params);
            if (_this.params.watchProperty) {
                /** @type {?} */
                var watchProp = ( /** @type {?} */(coerceArray(_this.params.watchProperty)));
                if (query instanceof QueryEntity && watchProp.includes('entities') && !watchProp.includes('ids')) {
                    watchProp.push('ids');
                }
                _this.params.watchProperty = watchProp;
            }
            return _this;
        }
        /**
         * @param {?=} params
         * @return {?}
         */
        DirtyCheckPlugin.prototype.reset = /**
         * @param {?=} params
         * @return {?}
         */
            function (params) {
                if (params === void 0) {
                    params = {};
                }
                /** @type {?} */
                var currentValue = this.head;
                if (isFunction(params.updateFn)) {
                    if (this.isEntityBased(this._entityId)) {
                        currentValue = params.updateFn(this.head, (( /** @type {?} */(this.getQuery()))).getEntity(this._entityId));
                    }
                    else {
                        currentValue = params.updateFn(this.head, (( /** @type {?} */(this.getQuery()))).getSnapshot());
                    }
                }
                __globalState.setCustomAction({ type: "@DirtyCheck - Revert" });
                this.updateStore(currentValue, this._entityId);
                this._reset.next();
            };
        /**
         * @template THIS
         * @this {THIS}
         * @return {THIS}
         */
        DirtyCheckPlugin.prototype.setHead = /**
         * @template THIS
         * @this {THIS}
         * @return {THIS}
         */
            function () {
                if (!( /** @type {?} */(this)).active) {
                    ( /** @type {?} */(this)).activate();
                    ( /** @type {?} */(this)).active = true;
                }
                else {
                    ( /** @type {?} */(this)).head = ( /** @type {?} */(this))._getHead();
                }
                ( /** @type {?} */(this)).updateDirtiness(false);
                return ( /** @type {?} */(this));
            };
        /**
         * @return {?}
         */
        DirtyCheckPlugin.prototype.isDirty = /**
         * @return {?}
         */
            function () {
                return toBoolean(this.dirty.value);
            };
        /**
         * @return {?}
         */
        DirtyCheckPlugin.prototype.hasHead = /**
         * @return {?}
         */
            function () {
                return toBoolean(this.getHead());
            };
        /**
         * @return {?}
         */
        DirtyCheckPlugin.prototype.destroy = /**
         * @return {?}
         */
            function () {
                this.head = null;
                this.subscription && this.subscription.unsubscribe();
                this._reset && this._reset.complete();
            };
        /**
         * @param {?} path
         * @return {?}
         */
        DirtyCheckPlugin.prototype.isPathDirty = /**
         * @param {?} path
         * @return {?}
         */
            function (path) {
                /** @type {?} */
                var head = this.getHead();
                /** @type {?} */
                var current = (( /** @type {?} */(this.getQuery()))).getSnapshot();
                /** @type {?} */
                var currentPathValue = getNestedPath(current, path);
                /** @type {?} */
                var headPathValue = getNestedPath(head, path);
                return this.params.comparator(currentPathValue, headPathValue);
            };
        /**
         * @return {?}
         */
        DirtyCheckPlugin.prototype.getHead = /**
         * @return {?}
         */
            function () {
                return this.head;
            };
        /**
         * @return {?}
         */
        DirtyCheckPlugin.prototype.activate = /**
         * @return {?}
         */
            function () {
                var _this = this;
                this.head = this._getHead();
                /**
                 * if we are tracking specific properties select only the relevant ones
                 * @type {?}
                 */
                var source = this.params.watchProperty
                    ? (( /** @type {?} */(this.params.watchProperty))).map(function (prop) {
                        return _this.query.select(function (state) { return state[prop]; }).pipe(operators.map(function (val) {
                            return ({
                                val: val,
                                __akitaKey: prop
                            });
                        }));
                    })
                    : [this.selectSource(this._entityId)];
                this.subscription = rxjs.combineLatest.apply(void 0, __spread(source)).pipe(operators.skip(1))
                    .subscribe(function (currentState) {
                    if (isUndefined(_this.head))
                        return;
                    /**
                     * __akitaKey is used to determine if we are tracking a specific property or a store change
                     * @type {?}
                     */
                    var isChange = currentState.some(function (state) {
                        /** @type {?} */
                        var head = state.__akitaKey ? _this.head[( /** @type {?} */(state.__akitaKey))] : _this.head;
                        /** @type {?} */
                        var compareTo = state.__akitaKey ? state.val : state;
                        return _this.params.comparator(head, compareTo);
                    });
                    _this.updateDirtiness(isChange);
                });
            };
        /**
         * @param {?} isDirty
         * @return {?}
         */
        DirtyCheckPlugin.prototype.updateDirtiness = /**
         * @param {?} isDirty
         * @return {?}
         */
            function (isDirty) {
                this.dirty.next(isDirty);
            };
        /**
         * @return {?}
         */
        DirtyCheckPlugin.prototype._getHead = /**
         * @return {?}
         */
            function () {
                /** @type {?} */
                var head = this.getSource(this._entityId);
                if (this.params.watchProperty) {
                    head = this.getWatchedValues(( /** @type {?} */(head)));
                }
                return head;
            };
        /**
         * @param {?} source
         * @return {?}
         */
        DirtyCheckPlugin.prototype.getWatchedValues = /**
         * @param {?} source
         * @return {?}
         */
            function (source) {
                return (( /** @type {?} */(this.params.watchProperty))).reduce(function (watched, prop) {
                    watched[prop] = source[prop];
                    return watched;
                }, ( /** @type {?} */({})));
            };
        return DirtyCheckPlugin;
    }(AkitaPlugin));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * @template E, P
     */
    var /**
     * @template E, P
     */ EntityDirtyCheckPlugin = /** @class */ (function (_super) {
        __extends(EntityDirtyCheckPlugin, _super);
        function EntityDirtyCheckPlugin(query, params) {
            if (params === void 0) {
                params = {};
            }
            var _this = _super.call(this, query, params.entityIds) || this;
            _this.query = query;
            _this.params = params;
            /**
             * @deprecated Use someDirty$ instead
             */
            _this.isSomeDirty$ = _this.query.select(function (state) { return state.entities; }).pipe(operators.map(function (entities) { return _this.checkSomeDirty(entities); }));
            _this.someDirty$ = _this.isSomeDirty$;
            _this.someDirty = _this.isSomeDirty;
            _this.params = __assign({}, dirtyCheckDefaultParams, params);
            _this.activate();
            _this.selectIds()
                .pipe(operators.skip(1))
                .subscribe(function (ids) {
                _this.rebase(ids, { afterAdd: function (plugin) { return plugin.setHead(); } });
            });
            return _this;
        }
        /**
         * @template THIS
         * @this {THIS}
         * @param {?=} ids
         * @return {THIS}
         */
        EntityDirtyCheckPlugin.prototype.setHead = /**
         * @template THIS
         * @this {THIS}
         * @param {?=} ids
         * @return {THIS}
         */
            function (ids) {
                ( /** @type {?} */(this)).forEachId(ids, function (e) { return e.setHead(); });
                return ( /** @type {?} */(this));
            };
        /**
         * @param {?} id
         * @return {?}
         */
        EntityDirtyCheckPlugin.prototype.hasHead = /**
         * @param {?} id
         * @return {?}
         */
            function (id) {
                if (this.entities.has(id)) {
                    /** @type {?} */
                    var entity = this.getEntity(id);
                    return entity.hasHead();
                }
                return false;
            };
        /**
         * @param {?=} ids
         * @param {?=} params
         * @return {?}
         */
        EntityDirtyCheckPlugin.prototype.reset = /**
         * @param {?=} ids
         * @param {?=} params
         * @return {?}
         */
            function (ids, params) {
                if (params === void 0) {
                    params = {};
                }
                this.forEachId(ids, function (e) { return e.reset(params); });
            };
        /**
         * @param {?} id
         * @param {?=} asObservable
         * @return {?}
         */
        EntityDirtyCheckPlugin.prototype.isDirty = /**
         * @param {?} id
         * @param {?=} asObservable
         * @return {?}
         */
            function (id, asObservable) {
                if (asObservable === void 0) {
                    asObservable = true;
                }
                if (this.entities.has(id)) {
                    /** @type {?} */
                    var entity = this.getEntity(id);
                    return asObservable ? entity.isDirty$ : entity.isDirty();
                }
                return false;
            };
        /**
         * @deprecated Use someDirty() instead
         */
        /**
         * @deprecated Use someDirty() instead
         * @return {?}
         */
        EntityDirtyCheckPlugin.prototype.isSomeDirty = /**
         * @deprecated Use someDirty() instead
         * @return {?}
         */
            function () {
                /** @type {?} */
                var entities = this.query.getAll({ asObject: true });
                return this.checkSomeDirty(entities);
            };
        /**
         * @param {?} id
         * @param {?} path
         * @return {?}
         */
        EntityDirtyCheckPlugin.prototype.isPathDirty = /**
         * @param {?} id
         * @param {?} path
         * @return {?}
         */
            function (id, path) {
                if (this.entities.has(id)) {
                    /** @type {?} */
                    var head = (( /** @type {?} */(this.getEntity(id)))).getHead();
                    /** @type {?} */
                    var current = this.query.getEntity(id);
                    /** @type {?} */
                    var currentPathValue = getNestedPath(current, path);
                    /** @type {?} */
                    var headPathValue = getNestedPath(head, path);
                    return this.params.comparator(currentPathValue, headPathValue);
                }
                return null;
            };
        /**
         * @param {?=} ids
         * @return {?}
         */
        EntityDirtyCheckPlugin.prototype.destroy = /**
         * @param {?=} ids
         * @return {?}
         */
            function (ids) {
                this.forEachId(ids, function (e) { return e.destroy(); });
            };
        /**
         * @param {?} id
         * @return {?}
         */
        EntityDirtyCheckPlugin.prototype.instantiatePlugin = /**
         * @param {?} id
         * @return {?}
         */
            function (id) {
                return ( /** @type {?} */(new DirtyCheckPlugin(this.query, this.params, id)));
            };
        /**
         * @param {?} entities
         * @return {?}
         */
        EntityDirtyCheckPlugin.prototype.checkSomeDirty = /**
         * @param {?} entities
         * @return {?}
         */
            function (entities) {
                var e_1, _a;
                /** @type {?} */
                var entitiesIds = this.resolvedIds();
                try {
                    for (var entitiesIds_1 = __values(entitiesIds), entitiesIds_1_1 = entitiesIds_1.next(); !entitiesIds_1_1.done; entitiesIds_1_1 = entitiesIds_1.next()) {
                        var id = entitiesIds_1_1.value;
                        /** @type {?} */
                        var dirty = this.params.comparator((( /** @type {?} */(this.getEntity(id)))).getHead(), entities[id]);
                        if (dirty) {
                            return true;
                        }
                    }
                }
                catch (e_1_1) {
                    e_1 = { error: e_1_1 };
                }
                finally {
                    try {
                        if (entitiesIds_1_1 && !entitiesIds_1_1.done && (_a = entitiesIds_1.return))
                            _a.call(entitiesIds_1);
                    }
                    finally {
                        if (e_1)
                            throw e_1.error;
                    }
                }
                return false;
            };
        return EntityDirtyCheckPlugin;
    }(EntityCollectionPlugin));

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    /**
     * \@example
     *
     * this.peopleStore.update(id, person => ({
     *   guests: increment(person.guests)
     * }));
     * @param {?} value
     * @param {?=} params
     * @return {?}
     */
    function increment(value, params) {
        if (params === void 0) {
            params = { maxValue: undefined };
        }
        if (isNumber(value) === false)
            return;
        if (params.maxValue && value === params.maxValue)
            return value;
        return value + 1;
    }
    /**
     * \@example
     *
     * this.peopleStore.update(id, person => ({
     *   guests: decrement(person.guests)
     * }));
     * @param {?} value
     * @param {?=} params
     * @return {?}
     */
    function decrement(value, params) {
        if (params === void 0) {
            params = { allowNegative: false };
        }
        if (isNumber(value) === false)
            return;
        if (params.allowNegative === false && value === 0) {
            return value;
        }
        return value - 1;
    }
    /**
     * Generate random guid
     * @return {?}
     */
    function guid() {
        return 'xxxxxx4xyx'.replace(/[xy]/g, function (c) {
            /** @type {?} */
            var r = (Math.random() * 16) | 0;
            /** @type {?} */
            var v = c == 'x' ? r : (r & 0x3) | 0x8;
            return v.toString(16);
        });
    }
    /**
     *
     * @param {?=} options
     * @return {?}
     */
    function resetStores(options) {
        /** @type {?} */
        var defaults = {
            exclude: []
        };
        options = Object.assign({}, defaults, options);
        /** @type {?} */
        var stores = Object.keys(__stores__);
        applyTransaction(function () {
            var e_1, _a;
            try {
                for (var stores_1 = __values(stores), stores_1_1 = stores_1.next(); !stores_1_1.done; stores_1_1 = stores_1.next()) {
                    var store = stores_1_1.value;
                    /** @type {?} */
                    var s = __stores__[store];
                    if (!options.exclude) {
                        s.reset();
                    }
                    else {
                        if (options.exclude.indexOf(s.storeName) === -1) {
                            s.reset();
                        }
                    }
                }
            }
            catch (e_1_1) {
                e_1 = { error: e_1_1 };
            }
            finally {
                try {
                    if (stores_1_1 && !stores_1_1.done && (_a = stores_1.return))
                        _a.call(stores_1);
                }
                finally {
                    if (e_1)
                        throw e_1.error;
                }
            }
        });
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */

    exports.__globalState = __globalState;
    exports.EntityStore = EntityStore;
    exports.getInitialEntitiesState = getInitialEntitiesState;
    exports.getInitialActiveState = getInitialActiveState;
    exports.QueryEntity = QueryEntity;
    exports.Query = Query;
    exports.enableAkitaProdMode = enableAkitaProdMode;
    exports.isDev = isDev;
    exports.__stores__ = __stores__;
    exports.rootDispatcher = rootDispatcher;
    exports.Store = Store;
    exports.applyTransaction = applyTransaction;
    exports.transaction = transaction;
    exports.push = push;
    exports.remove = remove;
    exports.pop = pop;
    exports.unshift = unshift;
    exports.sort = sort;
    exports.reverse = reverse;
    exports.swap = swap;
    exports.update = update;
    exports.splice = splice;
    exports.toggle = toggle;
    exports.filterNil = filterNil;
    exports.coerceArray = coerceArray;
    exports.isObject = isObject;
    exports.isPlainObject = isPlainObject;
    exports.isFunction = isFunction;
    exports.toBoolean = toBoolean;
    exports.isUndefined = isUndefined;
    exports.isNil = isNil;
    exports.entityExists = entityExists;
    exports.noop = noop;
    exports.isObservable = isObservable;
    exports.isString = isString;
    exports.isNumber = isNumber;
    exports.isDefined = isDefined;
    exports.resetActive = resetActive;
    exports.isActiveState = isActiveState;
    exports.setValue = setValue;
    exports.getValue = getValue;
    exports.applyAction = applyAction;
    exports.action = action;
    exports.mapInWorker = mapInWorker;
    exports.memoizeOne = memoizeOne;
    exports.SnapshotManager = SnapshotManager;
    exports.snapshotManager = snapshotManager;
    exports.StoreConfig = StoreConfig;
    exports.configKey = configKey;
    exports.QueryConfig = QueryConfig;
    exports.queryConfigKey = queryConfigKey;
    exports.akitaConfig = akitaConfig;
    exports.getAkitaConfig = getAkitaConfig;
    exports.compareValues = compareValues;
    exports.Order = Order;
    exports.AkitaPlugin = AkitaPlugin;
    exports.PaginatorPlugin = PaginatorPlugin;
    exports.Paginator = Paginator;
    exports.PersistNgFormPlugin = PersistNgFormPlugin;
    exports.persistState = persistState;
    exports.akitaDevtools = akitaDevtools;
    exports.EntityCollectionPlugin = EntityCollectionPlugin;
    exports.StateHistoryPlugin = StateHistoryPlugin;
    exports.EntityStateHistoryPlugin = EntityStateHistoryPlugin;
    exports.getNestedPath = getNestedPath;
    exports.dirtyCheckDefaultParams = dirtyCheckDefaultParams;
    exports.DirtyCheckPlugin = DirtyCheckPlugin;
    exports.EntityDirtyCheckPlugin = EntityDirtyCheckPlugin;
    exports.increment = increment;
    exports.decrement = decrement;
    exports.guid = guid;
    exports.resetStores = resetStores;
    exports.a = AkitaGlobals;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0b3JhbWEtYWtpdGEudW1kLmpzLm1hcCIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9pbnRlcm5hbC91dGlscy50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9pbnRlcm5hbC9lcnJvci50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9pbnRlcm5hbC9jcnVkLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2ludGVybmFsL2dsb2JhbC1zdGF0ZS50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9pbnRlcm5hbC90cmFuc2FjdGlvbi5pbnRlcm5hbC50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9pbnRlcm5hbC9kZWVwLWZyZWV6ZS50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvc3RvcmUtY29uZmlnLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2FwaS9jb25maWcudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvYXBpL3N0b3JlLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2FwaS9lbnRpdHktc3RvcmUudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvaW50ZXJuYWwvc29ydC50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvbWVtb2l6ZS50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvcXVlcnktY29uZmlnLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2FwaS9xdWVyeS50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvcXVlcnktZW50aXR5LnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2FwaS90cmFuc2FjdGlvbi50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9hcGkvYXJyYXlzLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2FwaS9vcGVyYXRvcnMudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvaW50ZXJuYWwvYWN0aW9uLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2FwaS93b3JrZXIudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvYXBpL3NuYXBzaG90LW1hbmFnZXIudHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvcGx1Z2lucy9wbHVnaW4udHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvcGx1Z2lucy9wYWdpbmF0b3IvcGFnaW5hdG9yLXBsdWdpbi50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9wbHVnaW5zL3BlcnNpc3QtZm9ybS9wZXJzaXN0LW5nLWZvcm0tcGx1Z2luLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2VuaGFuY2Vycy9wZXJzaXN0LXN0YXRlLnRzIiwibmc6Ly9AZGF0b3JhbWEvYWtpdGEvc3JjL2VuaGFuY2Vycy9kZXZ0b29scy50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9wbHVnaW5zL2VudGl0eS1jb2xsZWN0aW9uLXBsdWdpbi50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9wbHVnaW5zL3N0YXRlLWhpc3Rvcnkvc3RhdGUtaGlzdG9yeS1wbHVnaW4udHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvcGx1Z2lucy9zdGF0ZS1oaXN0b3J5L2VudGl0eS1zdGF0ZS1oaXN0b3J5LXBsdWdpbi50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9wbHVnaW5zL2RpcnR5LWNoZWNrL2RpcnR5LWNoZWNrLXBsdWdpbi50cyIsIm5nOi8vQGRhdG9yYW1hL2FraXRhL3NyYy9wbHVnaW5zL2RpcnR5LWNoZWNrL2VudGl0eS1kaXJ0eS1jaGVjay1wbHVnaW4udHMiLCJuZzovL0BkYXRvcmFtYS9ha2l0YS9zcmMvYXBpL3N0b3JlLXV0aWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgQWN0aXZlU3RhdGUsIEVudGl0eVN0YXRlLCBIYXNoTWFwLCBJRCB9IGZyb20gJy4uL2FwaS90eXBlcyc7XG5cbi8qKiBXcmFwcyB0aGUgcHJvdmlkZWQgdmFsdWUgaW4gYW4gYXJyYXksIHVubGVzcyB0aGUgcHJvdmlkZWQgX3ZhbHVlIGlzIGFuIGFycmF5LiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvZXJjZUFycmF5PFQ+KHZhbHVlOiBUIHwgVFtdKTogVFtdIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsdWUpID8gdmFsdWUgOiBbdmFsdWVdO1xufVxuXG4vKiogQ2hlY2sgaWYgYSB2YWx1ZSBpcyBhbiBvYmplY3QgKi9cbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdCh2YWx1ZTogYW55KSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBPYmplY3RdJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUGxhaW5PYmplY3QodmFsdWUpIHtcbiAgcmV0dXJuIHRvQm9vbGVhbih2YWx1ZSkgJiYgdmFsdWUuY29uc3RydWN0b3IubmFtZSA9PT0gJ09iamVjdCc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbHVlKTogdmFsdWUgaXMgRnVuY3Rpb24ge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9Cb29sZWFuKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcbiAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgYCR7dmFsdWV9YCAhPT0gJ2ZhbHNlJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVW5kZWZpbmVkKHZhbHVlKSB7XG4gIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNOaWwodikge1xuICByZXR1cm4gdiA9PT0gbnVsbCB8fCB2ID09PSB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgZW50aXR5IGV4aXN0c1xuICovXG5leHBvcnQgZnVuY3Rpb24gZW50aXR5RXhpc3RzPEU+KGlkOiBJRCwgZW50aXRpZXM6IEhhc2hNYXA8RT4pIHtcbiAgcmV0dXJuIGVudGl0aWVzLmhhc093blByb3BlcnR5KGlkKTtcbn1cblxuLyoqXG4gKiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgZW1wdHkgdmFsdWUgYW5kIGNvbXBsZXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBub29wPFQ+KCk6IE9ic2VydmFibGU8VD4ge1xuICByZXR1cm4gbmV3IE9ic2VydmFibGUob2JzZXJ2ZXIgPT4ge1xuICAgIG9ic2VydmVyLm5leHQoKTtcbiAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzT2JzZXJ2YWJsZSh2YWx1ZSkge1xuICByZXR1cm4gdG9Cb29sZWFuKHZhbHVlKSAmJiBpc0Z1bmN0aW9uKHZhbHVlLnN1YnNjcmliZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1N0cmluZyh2YWw6IHN0cmluZyB8IGFueSk6IHZhbCBpcyBzdHJpbmcge1xuICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ3N0cmluZyc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc051bWJlcih2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRGVmaW5lZCh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsICE9PSAndW5kZWZpbmVkJztcbn1cblxuLyoqXG4gKiBDaGVjayBpZiB0aGUgYWN0aXZlIGVudGl0eSBleGlzdFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRBY3RpdmU8RT4oc3RhdGU6IEVudGl0eVN0YXRlPEU+KSB7XG4gIHJldHVybiBpc0FjdGl2ZVN0YXRlKHN0YXRlKSAmJiBlbnRpdHlFeGlzdHMoKHN0YXRlIGFzIEFjdGl2ZVN0YXRlKS5hY3RpdmUsIHN0YXRlLmVudGl0aWVzKSA9PT0gZmFsc2U7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdGhlIHN0b3JlIHN1cHBvcnRzIGFjdGl2ZSBlbnRpdHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQWN0aXZlU3RhdGU8RT4oc3RhdGU6IEVudGl0eVN0YXRlPEU+KSB7XG4gIHJldHVybiAoc3RhdGUgYXMgQWN0aXZlU3RhdGUpLmhhc093blByb3BlcnR5KCdhY3RpdmUnKTtcbn1cblxuLyoqXG4gKiBzZXRWYWx1ZShzdGF0ZSwgJ3RvZG9zLnVpJywgeyBmaWx0ZXI6IHt9fSlcbiAqL1xuZXhwb3J0IGNvbnN0IHNldFZhbHVlID0gKG9iajogYW55LCBwcm9wOiBzdHJpbmcsIHZhbDogYW55KSA9PiB7XG4gIGNvbnN0IHNwbGl0ID0gcHJvcC5zcGxpdCgnLicpO1xuXG4gIGlmIChzcGxpdC5sZW5ndGggPT09IDEpIHJldHVybiB2YWw7XG5cbiAgb2JqID0geyAuLi5vYmogfTtcblxuICBjb25zdCBsYXN0SW5kZXggPSBzcGxpdC5sZW5ndGggLSAyO1xuICBjb25zdCByZW1vdmVTdG9yZU5hbWUgPSBwcm9wLnNwbGl0KCcuJykuc2xpY2UoMSk7XG5cbiAgcmVtb3ZlU3RvcmVOYW1lLnJlZHVjZSgoYWNjLCBwYXJ0LCBpbmRleCkgPT4ge1xuICAgIGlmIChpbmRleCA9PT0gbGFzdEluZGV4KSB7XG4gICAgICBhY2NbcGFydF0gPSB2YWw7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFjY1twYXJ0XSA9IHsgLi4uYWNjW3BhcnRdIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIGFjYyAmJiBhY2NbcGFydF07XG4gIH0sIG9iaik7XG5cbiAgcmV0dXJuIG9iajtcbn07XG5cbi8qKlxuICogZ2V0VmFsdWUoc3RhdGUsICd0b2Rvcy51aScpXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRWYWx1ZSA9IChvYmo6IGFueSwgcHJvcDogc3RyaW5nKSA9PiB7XG4gIC8qKiByZXR1cm4gdGhlIHdob2xlIHN0YXRlICAqL1xuICBpZiAocHJvcC5zcGxpdCgnLicpLmxlbmd0aCA9PT0gMSkge1xuICAgIHJldHVybiBvYmo7XG4gIH1cbiAgY29uc3QgcmVtb3ZlU3RvcmVOYW1lID0gcHJvcFxuICAgIC5zcGxpdCgnLicpXG4gICAgLnNsaWNlKDEpXG4gICAgLmpvaW4oJy4nKTtcbiAgcmV0dXJuIHJlbW92ZVN0b3JlTmFtZS5zcGxpdCgnLicpLnJlZHVjZSgoYWNjOiBhbnksIHBhcnQ6IHN0cmluZykgPT4gYWNjICYmIGFjY1twYXJ0XSwgb2JqKTtcbn07XG4iLCJpbXBvcnQgeyBlbnRpdHlFeGlzdHMsIGlzT2JqZWN0LCB0b0Jvb2xlYW4gfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IEVudGl0eVN0YXRlLCBJRCB9IGZyb20gJy4uL2FwaS90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBBa2l0YUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQWtpdGFJbW11dGFiaWxpdHlFcnJvciBleHRlbmRzIEFraXRhRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihzdG9yZU5hbWUpIHtcbiAgICBzdXBlcihgVGhlIG5ldyBzdGF0ZSBzaG91bGQgYmUgaW1tdXRhYmxlLiBNYWtlIHN1cmUgdG8gcmV0dXJuIGEgbmV3IGltbXV0YWJsZSBzdGF0ZS4gXFxuIHN0b3JlOiBcXG4gJHtzdG9yZU5hbWV9YCk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFraXRhRW50aXR5Tm90RXhpc3RzRXJyb3IgZXh0ZW5kcyBBa2l0YUVycm9yIHtcbiAgY29uc3RydWN0b3IoaWQpIHtcbiAgICBzdXBlcihgRW50aXR5ICR7aWR9IGRvZXMgbm90IGV4aXN0c2ApO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBa2l0YU5vQWN0aXZlRXJyb3IgZXh0ZW5kcyBBa2l0YUVycm9yIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoYEFjdGl2ZSBpcyBudWxsL3VuZGVmaW5lZGApO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBa2l0YUludmFsaWRFbnRpdHlTdGF0ZSBleHRlbmRzIEFraXRhRXJyb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihgRW50aXR5IHN0YXRlIGlzIGludmFsaWRgKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQWtpdGFVcGRhdGVJZEtleUVycm9yIGV4dGVuZHMgQWtpdGFFcnJvciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKGBVcGRhdGluZyBlbnRpdHkgaWQgaXMgbm90IHBlcm1pdHRlZCB3aGVuIHVwZGF0aW5nIG1hbnkgZW50aXRpZXNgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RW50aXR5RXhpc3RzKGlkOiBJRCwgZW50aXRpZXMpIHtcbiAgaWYgKCFlbnRpdHlFeGlzdHMoaWQsIGVudGl0aWVzKSkge1xuICAgIHRocm93IG5ldyBBa2l0YUVudGl0eU5vdEV4aXN0c0Vycm9yKGlkKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0QWN0aXZlKHN0b3JlKSB7XG4gIGlmICghdG9Cb29sZWFuKHN0b3JlLmFjdGl2ZSkpIHtcbiAgICB0aHJvdyBuZXcgQWtpdGFOb0FjdGl2ZUVycm9yKCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydEVudGl0eVN0YXRlKHN0YXRlOiBFbnRpdHlTdGF0ZTxhbnk+KSB7XG4gIGNvbnN0IGFzc2VydEVudGl0aWVzID0gaXNPYmplY3Qoc3RhdGUpO1xuXG4gIGlmICghYXNzZXJ0RW50aXRpZXMpIHtcbiAgICB0aHJvdyBuZXcgQWtpdGFJbnZhbGlkRW50aXR5U3RhdGUoKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0RGVjb3JhdG9yKG5hbWU6IHN0cmluZywgY2xhc3NOYW1lOiBzdHJpbmcpIHtcbiAgaWYgKCFuYW1lKSB7XG4gICAgY29uc29sZS5lcnJvcihgQFN0b3JlQ29uZmlnKHsgbmFtZSB9KSBpcyBtaXNzaW5nIGluICR7Y2xhc3NOYW1lfWApO1xuICB9XG59XG4iLCJpbXBvcnQgeyBFbnRpdGllcywgRW50aXR5U3RhdGUsIEhhc2hNYXAsIElELCBOZXdhYmxlLCBBZGRPcHRpb25zIH0gZnJvbSAnLi4vYXBpL3R5cGVzJztcbmltcG9ydCB7IEFraXRhVXBkYXRlSWRLZXlFcnJvciwgYXNzZXJ0RW50aXR5RXhpc3RzLCBhc3NlcnRFbnRpdHlTdGF0ZSB9IGZyb20gJy4vZXJyb3InO1xuaW1wb3J0IHsgZW50aXR5RXhpc3RzLCBpc0Z1bmN0aW9uLCBpc1BsYWluT2JqZWN0LCByZXNldEFjdGl2ZSB9IGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgQ1JVRCB7XG4gIF9zZXQ8UywgRT4oc3RhdGU6IFMsIGVudGl0aWVzOiBFW10gfCBIYXNoTWFwPEU+IHwgRW50aXRpZXM8RT4sIGVudGl0eUNsYXNzOiBOZXdhYmxlPEU+IHwgdW5kZWZpbmVkLCBpZEtleSk6IFMge1xuICAgIGxldCBpZHMsIG5vcm1hbGl6ZWQ7XG5cbiAgICBpZiAoKGVudGl0aWVzIGFzIEVudGl0aWVzPEU+KS5pZHMgJiYgKGVudGl0aWVzIGFzIEVudGl0aWVzPEU+KS5lbnRpdGllcykge1xuICAgICAgaWRzID0gKGVudGl0aWVzIGFzIEVudGl0aWVzPEU+KS5pZHM7XG4gICAgICBub3JtYWxpemVkID0gKGVudGl0aWVzIGFzIEVudGl0aWVzPEU+KS5lbnRpdGllcztcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoZW50aXRpZXMpO1xuICAgICAgbm9ybWFsaXplZCA9IGVudGl0aWVzO1xuXG4gICAgICBpZiAoaXNBcnJheSkge1xuICAgICAgICBub3JtYWxpemVkID0gdGhpcy5rZXlCeShlbnRpdGllcyBhcyBFW10sIGVudGl0eUNsYXNzLCBpZEtleSkgYXMgRVtdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXNzZXJ0RW50aXR5U3RhdGUoZW50aXRpZXMpO1xuICAgICAgfVxuXG4gICAgICBpZHMgPSBpc0FycmF5ID8gKGVudGl0aWVzIGFzIEVbXSkubWFwKGVudGl0eSA9PiBlbnRpdHlbaWRLZXldKSA6IE9iamVjdC5rZXlzKG5vcm1hbGl6ZWQgYXMgSGFzaE1hcDxFPikubWFwKGlkID0+IGVudGl0aWVzW2lkXVtpZEtleV0pO1xuICAgIH1cblxuICAgIGNvbnN0IG5ld1N0YXRlID0ge1xuICAgICAgLi4uKHN0YXRlIGFzIGFueSksXG4gICAgICBlbnRpdGllczogbm9ybWFsaXplZCxcbiAgICAgIGlkcyxcbiAgICAgIGxvYWRpbmc6IGZhbHNlXG4gICAgfTtcblxuICAgIGlmIChyZXNldEFjdGl2ZShuZXdTdGF0ZSkpIHtcbiAgICAgIG5ld1N0YXRlLmFjdGl2ZSA9IG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ld1N0YXRlO1xuICB9XG5cbiAgX3JlcGxhY2VFbnRpdHk8VCBleHRlbmRzIEVudGl0eVN0YXRlPihzdGF0ZTogVCwgaWQ6IElELCBlbnRpdHkpOiBUIHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uKHN0YXRlIGFzIGFueSksXG4gICAgICBlbnRpdGllczoge1xuICAgICAgICAuLi5zdGF0ZS5lbnRpdGllcyxcbiAgICAgICAgW2lkXTogZW50aXR5XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIF9hZGQ8UyBleHRlbmRzIEVudGl0eVN0YXRlLCBFPihzdGF0ZTogUywgZW50aXRpZXM6IEVbXSwgaWRLZXksIG9wdGlvbnM6IEFkZE9wdGlvbnMgPSB7fSk6IFMge1xuICAgIGxldCBhZGRlZEVudGl0aWVzID0ge307XG4gICAgbGV0IGFkZGVkSWRzID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVudGl0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBlbnRpdHkgPSBlbnRpdGllc1tpXTtcbiAgICAgIGNvbnN0IGVudGl0eUlkID0gZW50aXR5W2lkS2V5XTtcblxuICAgICAgaWYgKCFlbnRpdHlFeGlzdHMoZW50aXR5SWQsIHN0YXRlLmVudGl0aWVzKSkge1xuICAgICAgICBhZGRlZEVudGl0aWVzW2VudGl0eUlkXSA9IGVudGl0eTtcbiAgICAgICAgaWYgKG9wdGlvbnMucHJlcGVuZCkgYWRkZWRJZHMudW5zaGlmdChlbnRpdHlJZCk7XG4gICAgICAgIGVsc2UgYWRkZWRJZHMucHVzaChlbnRpdHlJZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLihzdGF0ZSBhcyBhbnkpLFxuICAgICAgZW50aXRpZXM6IHtcbiAgICAgICAgLi4uc3RhdGUuZW50aXRpZXMsXG4gICAgICAgIC4uLmFkZGVkRW50aXRpZXNcbiAgICAgIH0sXG4gICAgICBpZHM6IG9wdGlvbnMucHJlcGVuZCA/IFsuLi5hZGRlZElkcywgLi4uc3RhdGUuaWRzXSA6IFsuLi5zdGF0ZS5pZHMsIC4uLmFkZGVkSWRzXVxuICAgIH07XG4gIH1cblxuICBfdXBkYXRlPFQgZXh0ZW5kcyBFbnRpdHlTdGF0ZT4oc3RhdGU6IFQsIGlkczogSURbXSwgbmV3U3RhdGVPckZuOiBvYmplY3QgfCAoKGU6IFJlYWRvbmx5PGFueT4pID0+IG9iamVjdCksIGlkS2V5OiBzdHJpbmcpOiBUIHtcbiAgICBjb25zdCB1cGRhdGVkRW50aXRpZXMgPSB7fTtcblxuICAgIGxldCBpc1VwZGF0aW5nSWRLZXkgPSBmYWxzZTtcbiAgICBsZXQgaWRUb1VwZGF0ZTogSUQ7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlkcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgaWQgPSBpZHNbaV07XG4gICAgICBpZFRvVXBkYXRlID0gaWQ7XG4gICAgICBhc3NlcnRFbnRpdHlFeGlzdHMoaWQsIHN0YXRlLmVudGl0aWVzKTtcblxuICAgICAgY29uc3Qgb2xkRW50aXR5ID0gc3RhdGUuZW50aXRpZXNbaWRdO1xuICAgICAgY29uc3QgbmV3U3RhdGUgPSBpc0Z1bmN0aW9uKG5ld1N0YXRlT3JGbikgPyBuZXdTdGF0ZU9yRm4ob2xkRW50aXR5KSA6IG5ld1N0YXRlT3JGbjtcblxuICAgICAgaWYgKG5ld1N0YXRlLmhhc093blByb3BlcnR5KGlkS2V5KSAmJiBuZXdTdGF0ZVtpZEtleV0gIT09IG9sZEVudGl0eVtpZEtleV0pIHtcbiAgICAgICAgaWYgKGlkcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFraXRhVXBkYXRlSWRLZXlFcnJvcigpO1xuICAgICAgICB9XG4gICAgICAgIGlzVXBkYXRpbmdJZEtleSA9IHRydWU7XG4gICAgICAgIGlkVG9VcGRhdGUgPSBuZXdTdGF0ZVtpZEtleV07XG4gICAgICB9XG5cbiAgICAgIGxldCBuZXdFbnRpdHk7XG5cbiAgICAgIGNvbnN0IG1lcmdlZCA9IHtcbiAgICAgICAgLi4ub2xkRW50aXR5LFxuICAgICAgICAuLi5uZXdTdGF0ZVxuICAgICAgfTtcblxuICAgICAgaWYgKGlzUGxhaW5PYmplY3Qob2xkRW50aXR5KSkge1xuICAgICAgICBuZXdFbnRpdHkgPSBtZXJnZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvKipcbiAgICAgICAgICogSW4gY2FzZSB0aGF0IG5ldyBzdGF0ZSBpcyBjbGFzcyBvZiBpdCdzIG93biwgdGhlcmUnc1xuICAgICAgICAgKiBhIHBvc3NpYmlsaXR5IHRoYXQgaXQgd2lsbCBiZSBkaWZmZXJlbnQgdGhhbiB0aGUgb2xkXG4gICAgICAgICAqIGNsYXNzLlxuICAgICAgICAgKiBGb3IgZXhhbXBsZSwgT2xkIHN0YXRlIGlzIGFuIGluc3RhbmNlIG9mIGFuaW1hbCBjbGFzc1xuICAgICAgICAgKiBhbmQgbmV3IHN0YXRlIGlzIGluc3RhbmNlIG9mIHBlcnNvbiBjbGFzcy5cbiAgICAgICAgICogVG8gYXZvaWQgcnVuIG92ZXIgbmV3IHBlcnNvbiBjbGFzcyB3aXRoIHRoZSBvbGQgYW5pbWFsXG4gICAgICAgICAqIGNsYXNzIHdlIGNoZWNrIGlmIHRoZSBuZXcgc3RhdGUgaXMgYSBjbGFzcyBvZiBpdCdzIG93bi5cbiAgICAgICAgICogSWYgc28sIHVzZSBpdC4gT3RoZXJ3aXNlLCB1c2UgdGhlIG9sZCBzdGF0ZSBjbGFzc1xuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGlzUGxhaW5PYmplY3QobmV3U3RhdGUpKSB7XG4gICAgICAgICAgbmV3RW50aXR5ID0gbmV3IG9sZEVudGl0eS5jb25zdHJ1Y3RvcihtZXJnZWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld0VudGl0eSA9IG5ldyAobmV3U3RhdGUgYXMgYW55KS5jb25zdHJ1Y3RvcihtZXJnZWQpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZWRFbnRpdGllc1tpZFRvVXBkYXRlXSA9IG5ld0VudGl0eTtcbiAgICB9XG5cbiAgICBsZXQgdXBkYXRlZElkcyA9IHN0YXRlLmlkcztcbiAgICBsZXQgc3RhdGVFbnRpdGllcyA9IHN0YXRlLmVudGl0aWVzO1xuICAgIGlmIChpc1VwZGF0aW5nSWRLZXkpIHtcbiAgICAgIGNvbnN0IFtpZF0gPSBpZHM7XG4gICAgICBjb25zdCB7IFtpZF06IGRlbGV0ZWRFbnRpdHksIC4uLnJlc3QgfSA9IHN0YXRlLmVudGl0aWVzO1xuICAgICAgc3RhdGVFbnRpdGllcyA9IHJlc3Q7XG4gICAgICB1cGRhdGVkSWRzID0gc3RhdGUuaWRzLm1hcChjdXJyZW50ID0+IChjdXJyZW50ID09PSBpZCA/IGlkVG9VcGRhdGUgOiBjdXJyZW50KSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLihzdGF0ZSBhcyBhbnkpLFxuICAgICAgZW50aXRpZXM6IHtcbiAgICAgICAgLi4uc3RhdGVFbnRpdGllcyxcbiAgICAgICAgLi4udXBkYXRlZEVudGl0aWVzXG4gICAgICB9LFxuICAgICAgaWRzOiB1cGRhdGVkSWRzXG4gICAgfTtcbiAgfVxuXG4gIF9yZW1vdmU8VCBleHRlbmRzIEVudGl0eVN0YXRlPihzdGF0ZTogVCwgaWRzOiBJRFtdIHwgbnVsbCk6IFQge1xuICAgIGlmICghaWRzKSByZXR1cm4gdGhpcy5fcmVtb3ZlQWxsKHN0YXRlKTtcblxuICAgIGNvbnN0IHJlbW92ZWQgPSBpZHMucmVkdWNlKChhY2MsIGlkKSA9PiB7XG4gICAgICBjb25zdCB7IFtpZF06IGVudGl0eSwgLi4ucmVzdCB9ID0gYWNjO1xuICAgICAgcmV0dXJuIHJlc3Q7XG4gICAgfSwgc3RhdGUuZW50aXRpZXMpO1xuICAgIGNvbnN0IG5ld1N0YXRlID0ge1xuICAgICAgLi4uKHN0YXRlIGFzIGFueSksXG4gICAgICBlbnRpdGllczogcmVtb3ZlZCxcbiAgICAgIGlkczogc3RhdGUuaWRzLmZpbHRlcihjdXJyZW50ID0+IGlkcy5pbmRleE9mKGN1cnJlbnQpID09PSAtMSlcbiAgICB9O1xuXG4gICAgaWYgKHJlc2V0QWN0aXZlKG5ld1N0YXRlKSkge1xuICAgICAgbmV3U3RhdGUuYWN0aXZlID0gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3U3RhdGU7XG4gIH1cblxuICBwcml2YXRlIF9yZW1vdmVBbGw8VCBleHRlbmRzIEVudGl0eVN0YXRlPihzdGF0ZTogVCk6IFQge1xuICAgIGNvbnN0IG5ld1N0YXRlID0ge1xuICAgICAgLi4uKHN0YXRlIGFzIGFueSksXG4gICAgICBlbnRpdGllczoge30sXG4gICAgICBpZHM6IFtdLFxuICAgICAgYWN0aXZlOiBudWxsXG4gICAgfTtcblxuICAgIHJldHVybiBuZXdTdGF0ZTtcbiAgfVxuXG4gIHByaXZhdGUga2V5QnkoZW50aXRpZXM6IGFueVtdLCBlbnRpdHlDbGFzcz86IE5ld2FibGU8YW55PiwgaWQgPSAnaWQnKSB7XG4gICAgY29uc3QgYWNjID0ge307XG5cbiAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gZW50aXRpZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGNvbnN0IGVudGl0eSA9IGVudGl0aWVzW2ldO1xuICAgICAgYWNjW2VudGl0eVtpZF1dID0gZW50aXR5Q2xhc3MgPyBuZXcgZW50aXR5Q2xhc3MoZW50aXR5KSA6IGVudGl0eTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWNjO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBfY3J1ZCA9IG5ldyBDUlVEKCk7XG4iLCJpbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5cbmV4cG9ydCB0eXBlIEFjdGlvbiA9IHtcbiAgdHlwZTogc3RyaW5nO1xuICBlbnRpdHlJZD86IGFueVtdIHwgYW55O1xuICBwYXlsb2FkPzogYW55O1xufTtcblxuZXhwb3J0IGNsYXNzIEFraXRhR2xvYmFscyB7XG4gIHByaXZhdGUgY3VzdG9tQWN0aW9uO1xuICBjdXJyZW50QWN0aW9uOiBBY3Rpb247XG4gIHNraXBBY3Rpb24gPSBmYWxzZTtcbiAgc2tpcFRyYW5zYWN0aW9uTXNnID0gZmFsc2U7XG4gIGN1cnJlbnRUID0gW107XG4gIGFjdGl2ZVRyYW5zYWN0aW9ucyA9IDA7XG4gIGJhdGNoVHJhbnNhY3Rpb246IFN1YmplY3Q8Ym9vbGVhbj47XG5cbiAgc2V0QWN0aW9uKF9hY3Rpb246IEFjdGlvbikge1xuICAgIGlmICh0aGlzLmN1c3RvbUFjdGlvbikge1xuICAgICAgdGhpcy5jdXJyZW50QWN0aW9uID0gdGhpcy5jdXN0b21BY3Rpb247XG4gICAgICB0aGlzLmN1c3RvbUFjdGlvbiA9IG51bGw7XG4gICAgICB0aGlzLnNraXBUcmFuc2FjdGlvbk1zZyA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5hY3RpdmVUcmFuc2FjdGlvbnMgPT09IDApIHtcbiAgICAgICAgdGhpcy5jdXJyZW50QWN0aW9uID0gX2FjdGlvbjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5hY3RpdmVUcmFuc2FjdGlvbnMgPiAwKSB7XG4gICAgICB0aGlzLmN1cnJlbnRULnB1c2goX2FjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgc2V0Q3VzdG9tQWN0aW9uKGFjdGlvbjogQWN0aW9uLCBza2lwVHJhbnNhY3Rpb25Nc2cgPSBmYWxzZSkge1xuICAgIHRoaXMuY3VycmVudEFjdGlvbiA9IHRoaXMuY3VzdG9tQWN0aW9uID0gYWN0aW9uO1xuICAgIHRoaXMuc2tpcFRyYW5zYWN0aW9uTXNnID0gc2tpcFRyYW5zYWN0aW9uTXNnO1xuICB9XG5cbiAgc2V0U2tpcEFjdGlvbihza2lwID0gdHJ1ZSkge1xuICAgIHRoaXMuc2tpcEFjdGlvbiA9IHNraXA7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IF9fZ2xvYmFsU3RhdGUgPSBuZXcgQWtpdGFHbG9iYWxzKCk7XG4iLCJpbXBvcnQgeyBfX2dsb2JhbFN0YXRlIH0gZnJvbSAnLi9nbG9iYWwtc3RhdGUnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCwgb2YgfSBmcm9tICdyeGpzJztcblxuLyoqXG4gKiBTdGFydCBhIG5ldyB0cmFuc2FjdGlvbiBiYXRjaFxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRCYXRjaCgpIHtcbiAgaWYgKCFpc1RyYW5zYWN0aW9uSW5Qcm9jZXNzKCkpIHtcbiAgICBfX2dsb2JhbFN0YXRlLmJhdGNoVHJhbnNhY3Rpb24gPSBuZXcgU3ViamVjdCgpO1xuICB9XG4gIF9fZ2xvYmFsU3RhdGUuYWN0aXZlVHJhbnNhY3Rpb25zKys7XG59XG5cbi8qKlxuICogRW5kIHRoZSB0cmFuc2FjdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gZW5kQmF0Y2goKSB7XG4gIGlmICgtLV9fZ2xvYmFsU3RhdGUuYWN0aXZlVHJhbnNhY3Rpb25zID09PSAwKSB7XG4gICAgX19nbG9iYWxTdGF0ZS5iYXRjaFRyYW5zYWN0aW9uLm5leHQodHJ1ZSk7XG4gICAgX19nbG9iYWxTdGF0ZS5iYXRjaFRyYW5zYWN0aW9uLmNvbXBsZXRlKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBXaGV0aGVyIHdlJ3JlIGluc2lkZSBiYXRjaFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNUcmFuc2FjdGlvbkluUHJvY2VzcygpIHtcbiAgcmV0dXJuIF9fZ2xvYmFsU3RhdGUuYWN0aXZlVHJhbnNhY3Rpb25zID4gMDtcbn1cblxuLyoqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb21taXQoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gIHJldHVybiBfX2dsb2JhbFN0YXRlLmJhdGNoVHJhbnNhY3Rpb24gPyBfX2dsb2JhbFN0YXRlLmJhdGNoVHJhbnNhY3Rpb24uYXNPYnNlcnZhYmxlKCkgOiBvZih0cnVlKTtcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBkZWVwRnJlZXplKG8pIHtcbiAgT2JqZWN0LmZyZWV6ZShvKTtcblxuICB2YXIgb0lzRnVuY3Rpb24gPSB0eXBlb2YgbyA9PT0gJ2Z1bmN0aW9uJztcbiAgdmFyIGhhc093blByb3AgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXG4gIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG8pLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgIGlmIChcbiAgICAgIGhhc093blByb3AuY2FsbChvLCBwcm9wKSAmJlxuICAgICAgKG9Jc0Z1bmN0aW9uID8gcHJvcCAhPT0gJ2NhbGxlcicgJiYgcHJvcCAhPT0gJ2NhbGxlZScgJiYgcHJvcCAhPT0gJ2FyZ3VtZW50cycgOiB0cnVlKSAmJlxuICAgICAgb1twcm9wXSAhPT0gbnVsbCAmJlxuICAgICAgKHR5cGVvZiBvW3Byb3BdID09PSAnb2JqZWN0JyB8fCB0eXBlb2Ygb1twcm9wXSA9PT0gJ2Z1bmN0aW9uJykgJiZcbiAgICAgICFPYmplY3QuaXNGcm96ZW4ob1twcm9wXSlcbiAgICApIHtcbiAgICAgIGRlZXBGcmVlemUob1twcm9wXSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gbztcbn1cbiIsImV4cG9ydCB0eXBlIFN0b3JlQ29uZmlnT3B0aW9ucyA9IHtcbiAgbmFtZTogc3RyaW5nO1xuICByZXNldHRhYmxlPzogYm9vbGVhbjtcbiAgaWRLZXk/OiBzdHJpbmc7XG59O1xuXG5leHBvcnQgY29uc3QgY29uZmlnS2V5ID0gJ2FraXRhQ29uZmlnJztcblxuZXhwb3J0IGZ1bmN0aW9uIFN0b3JlQ29uZmlnKG1ldGFkYXRhOiBTdG9yZUNvbmZpZ09wdGlvbnMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGNvbnN0cnVjdG9yOiBGdW5jdGlvbikge1xuICAgIGNvbnN0cnVjdG9yW2NvbmZpZ0tleV0gPSB7IGlkS2V5OiAnaWQnIH07XG5cbiAgICBmb3IgKGxldCBpID0gMCwga2V5cyA9IE9iamVjdC5rZXlzKG1ldGFkYXRhKTsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGtleSA9IGtleXNbaV07XG4gICAgICAvKiBuYW1lIGlzIHByZXNlcnZlZCByZWFkIG9ubHkga2V5ICovXG4gICAgICBpZiAoa2V5ID09PSAnbmFtZScpIHtcbiAgICAgICAgY29uc3RydWN0b3JbY29uZmlnS2V5XVsnc3RvcmVOYW1lJ10gPSBtZXRhZGF0YVtrZXldO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3RydWN0b3JbY29uZmlnS2V5XVtrZXldID0gbWV0YWRhdGFba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG4iLCJleHBvcnQgaW50ZXJmYWNlIEFraXRhQ29uZmlnIHtcbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gYWxsb3dlZCB0aGUgcmVzZXQoKSBzdG9yZXMgZnVuY3Rpb25hbGl0eVxuICAgKi9cbiAgcmVzZXR0YWJsZT86IGJvb2xlYW47XG59XG5cbmxldCBDT05GSUc6IEFraXRhQ29uZmlnID0ge1xuICByZXNldHRhYmxlOiBmYWxzZVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGFraXRhQ29uZmlnKGNvbmZpZzogQWtpdGFDb25maWcpIHtcbiAgQ09ORklHID0geyAuLi5DT05GSUcsIC4uLmNvbmZpZyB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWtpdGFDb25maWcoKSB7XG4gIHJldHVybiBDT05GSUc7XG59XG4iLCJpbXBvcnQgeyBIYXNoTWFwLCBJRCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBPYnNlcnZhYmxlLCBSZXBsYXlTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBkaXN0aW5jdFVudGlsQ2hhbmdlZCwgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgQWtpdGFFcnJvciwgQWtpdGFJbW11dGFiaWxpdHlFcnJvciwgYXNzZXJ0RGVjb3JhdG9yIH0gZnJvbSAnLi4vaW50ZXJuYWwvZXJyb3InO1xuaW1wb3J0IHsgY29tbWl0LCBpc1RyYW5zYWN0aW9uSW5Qcm9jZXNzIH0gZnJvbSAnLi4vaW50ZXJuYWwvdHJhbnNhY3Rpb24uaW50ZXJuYWwnO1xuaW1wb3J0IHsgaXNGdW5jdGlvbiwgaXNQbGFpbk9iamVjdCB9IGZyb20gJy4uL2ludGVybmFsL3V0aWxzJztcbmltcG9ydCB7IGRlZXBGcmVlemUgfSBmcm9tICcuLi9pbnRlcm5hbC9kZWVwLWZyZWV6ZSc7XG5pbXBvcnQgeyBjb25maWdLZXksIFN0b3JlQ29uZmlnT3B0aW9ucyB9IGZyb20gJy4vc3RvcmUtY29uZmlnJztcbmltcG9ydCB7IF9fZ2xvYmFsU3RhdGUgfSBmcm9tICcuLi9pbnRlcm5hbC9nbG9iYWwtc3RhdGUnO1xuaW1wb3J0IHsgZ2V0QWtpdGFDb25maWcgfSBmcm9tICcuL2NvbmZpZyc7XG5cbmxldCBfX0RFVl9fID0gdHJ1ZTtcbmNvbnN0IGlzTm90QnJvd3NlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnO1xuXG5leHBvcnQgY29uc3QgX19zdG9yZXNfXzogeyBbc3RvcmVOYW1lOiBzdHJpbmddOiBTdG9yZTxhbnk+IH0gPSB7fTtcblxuZXhwb3J0IGNvbnN0IGVudW0gQWN0aW9ucyB7XG4gIE5FV19TVE9SRSxcbiAgREVMRVRFX1NUT1JFLFxuICBORVdfU1RBVEVcbn1cblxuZXhwb3J0IHR5cGUgQWN0aW9uID0ge1xuICB0eXBlOiBBY3Rpb25zO1xuICBwYXlsb2FkOiBIYXNoTWFwPGFueT47XG59O1xuXG5leHBvcnQgY29uc3Qgcm9vdERpc3BhdGNoZXIgPSBuZXcgUmVwbGF5U3ViamVjdDxBY3Rpb24+KCk7XG5cbmZ1bmN0aW9uIG5leHRTdGF0ZShzdG9yZU5hbWUsIGluaXRpYWxTdGF0ZSA9IGZhbHNlKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogQWN0aW9ucy5ORVdfU1RBVEUsXG4gICAgcGF5bG9hZDoge1xuICAgICAgbmFtZTogc3RvcmVOYW1lLFxuICAgICAgaW5pdGlhbFN0YXRlXG4gICAgfVxuICB9O1xufVxuXG4vKipcbiAqIEVuYWJsZSBwcm9kdWN0aW9uIG1vZGUgdG8gZGlzYWJsZSBvYmplY3RGcmVlemVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuYWJsZUFraXRhUHJvZE1vZGUoKSB7XG4gIF9fREVWX18gPSBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRGV2KCkge1xuICByZXR1cm4gX19ERVZfXztcbn1cblxuLyoqXG4gKiBUaGUgUm9vdCBTdG9yZSB0aGF0IGV2ZXJ5IHN1YiBzdG9yZSBuZWVkcyB0byBpbmhlcml0IGFuZFxuICogaW52b2tlIGBzdXBlcmAgd2l0aCB0aGUgaW5pdGlhbCBzdGF0ZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFN0b3JlPFM+IHtcbiAgLyoqIE1hbmFnZSB0aGUgc3RvcmUgd2l0aCBCZWhhdmlvclN1YmplY3QgKi9cbiAgcHJpdmF0ZSBzdG9yZTogQmVoYXZpb3JTdWJqZWN0PFJlYWRvbmx5PFM+PjtcblxuICAvKiogVGhlIGN1cnJlbnQgc3RhdGUgdmFsdWUgKi9cbiAgcHJpdmF0ZSBzdG9yZVZhbHVlOiBTO1xuXG4gIC8qKiBXaGV0aGVyIHdlIGFyZSBpbnNpZGUgdHJhbnNhY3Rpb24gKiovXG4gIHByaXZhdGUgaW5UcmFuc2FjdGlvbiA9IGZhbHNlO1xuXG4gIHByaXZhdGUgX2lzUHJpc3RpbmUgPSB0cnVlO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgX2luaXRpYWxTdGF0ZTogUztcblxuICAvKipcbiAgICpcbiAgICogSW5pdGlhbCB0aGUgc3RvcmUgd2l0aCB0aGUgc3RhdGVcbiAgICovXG4gIGNvbnN0cnVjdG9yKGluaXRpYWxTdGF0ZSwgcHJpdmF0ZSBvcHRpb25zOiB7IGlkS2V5Pzogc3RyaW5nOyBzdG9yZU5hbWU/OiBzdHJpbmcgfSA9IHt9KSB7XG4gICAgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnQEBJTklUJyB9KTtcbiAgICBfX3N0b3Jlc19fW3RoaXMuc3RvcmVOYW1lXSA9IHRoaXM7XG4gICAgdGhpcy5zZXRTdGF0ZSgoKSA9PiBpbml0aWFsU3RhdGUpO1xuICAgIHJvb3REaXNwYXRjaGVyLm5leHQoe1xuICAgICAgdHlwZTogQWN0aW9ucy5ORVdfU1RPUkUsXG4gICAgICBwYXlsb2FkOiB7IHN0b3JlOiB0aGlzIH1cbiAgICB9KTtcbiAgICBpc0RldigpICYmIGFzc2VydERlY29yYXRvcih0aGlzLnN0b3JlTmFtZSwgdGhpcy5jb25zdHJ1Y3Rvci5uYW1lKTtcbiAgICBpZiAodGhpcy5pc1Jlc3NldGFibGUoKSkge1xuICAgICAgdGhpcy5faW5pdGlhbFN0YXRlID0gaW5pdGlhbFN0YXRlO1xuICAgIH1cbiAgfVxuXG4gIHNldExvYWRpbmcobG9hZGluZyA9IGZhbHNlKSB7XG4gICAgaWYgKGxvYWRpbmcgIT09ICh0aGlzLl92YWx1ZSgpIGFzIFMgJiB7IGxvYWRpbmc6IGJvb2xlYW4gfSkubG9hZGluZykge1xuICAgICAgaXNEZXYoKSAmJiBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdTZXQgTG9hZGluZycgfSk7XG4gICAgICB0aGlzLnNldFN0YXRlKHMgPT4gKHsgLi4uKHMgYXMgb2JqZWN0KSwgbG9hZGluZyB9IGFzIGFueSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIHN0b3JlJ3MgZXJyb3Igc3RhdGUuXG4gICAqL1xuICBzZXRFcnJvcjxUPihlcnJvcjogVCkge1xuICAgIGlmIChlcnJvciAhPT0gKHRoaXMuX3ZhbHVlKCkgYXMgUyAmIHsgZXJyb3I6IGFueSB9KS5lcnJvcikge1xuICAgICAgaXNEZXYoKSAmJiBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdTZXQgRXJyb3InIH0pO1xuICAgICAgdGhpcy5zZXRTdGF0ZShzID0+ICh7IC4uLihzIGFzIG9iamVjdCksIGVycm9yIH0gYXMgYW55KSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdCBhIHNsaWNlIGZyb20gdGhlIHN0b3JlXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMuc3RvcmUuc2VsZWN0KHN0YXRlID0+IHN0YXRlLmVudGl0aWVzKVxuICAgKlxuICAgKi9cbiAgX3NlbGVjdDxSPihwcm9qZWN0OiAoc3RvcmU6IFMpID0+IFIpOiBPYnNlcnZhYmxlPFI+IHtcbiAgICByZXR1cm4gdGhpcy5zdG9yZSQucGlwZShcbiAgICAgIG1hcChwcm9qZWN0KSxcbiAgICAgIGRpc3RpbmN0VW50aWxDaGFuZ2VkKClcbiAgICApO1xuICB9XG5cbiAgX3ZhbHVlKCk6IFMge1xuICAgIHJldHVybiB0aGlzLnN0b3JlVmFsdWU7XG4gIH1cblxuICBnZXQgY29uZmlnKCk6IFN0b3JlQ29uZmlnT3B0aW9ucyB7XG4gICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3JbY29uZmlnS2V5XTtcbiAgfVxuXG4gIGdldCBzdG9yZU5hbWUoKSB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5zdG9yZU5hbWUgfHwgKHRoaXMuY29uZmlnICYmIHRoaXMuY29uZmlnWydzdG9yZU5hbWUnXSk7XG4gIH1cblxuICBnZXQgaWRLZXkoKSB7XG4gICAgLyoqIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgKi9cbiAgICBjb25zdCBuZXdJZEtleSA9IHRoaXMuY29uZmlnICYmIHRoaXMuY29uZmlnLmlkS2V5O1xuICAgIGlmICghbmV3SWRLZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuaWRLZXkgfHwgJ2lkJztcbiAgICB9XG4gICAgcmV0dXJuIG5ld0lkS2V5O1xuICB9XG5cbiAgZ2V0IGlzUHJpc3RpbmUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzUHJpc3RpbmU7XG4gIH1cblxuICAvKipcbiAgICogYHNldFN0YXRlKClgIGlzIHRoZSBvbmx5IHdheSB0byB1cGRhdGUgYSBzdG9yZTsgSXQgcmVjZWl2ZXMgYSBjYWxsYmFjayBmdW5jdGlvbixcbiAgICogd2hpY2ggZ2V0cyB0aGUgY3VycmVudCBzdGF0ZSwgYW5kIHJldHVybnMgYSBuZXcgaW1tdXRhYmxlIHN0YXRlLFxuICAgKiB3aGljaCB3aWxsIGJlIHRoZSBuZXcgdmFsdWUgb2YgdGhlIHN0b3JlLlxuICAgKi9cbiAgc2V0U3RhdGUobmV3U3RhdGVGbjogKHN0YXRlOiBSZWFkb25seTxTPikgPT4gUywgX3Jvb3REaXNwYXRjaGVyID0gdHJ1ZSkge1xuICAgIGNvbnN0IHByZXZTdGF0ZSA9IHRoaXMuX3ZhbHVlKCk7XG4gICAgdGhpcy5zdG9yZVZhbHVlID0gX19ERVZfXyA/IGRlZXBGcmVlemUobmV3U3RhdGVGbih0aGlzLl92YWx1ZSgpKSkgOiBuZXdTdGF0ZUZuKHRoaXMuX3ZhbHVlKCkpO1xuXG4gICAgaWYgKHByZXZTdGF0ZSA9PT0gdGhpcy5zdG9yZVZhbHVlKSB7XG4gICAgICB0aHJvdyBuZXcgQWtpdGFJbW11dGFiaWxpdHlFcnJvcih0aGlzLnN0b3JlTmFtZSk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnN0b3JlKSB7XG4gICAgICB0aGlzLnN0b3JlID0gbmV3IEJlaGF2aW9yU3ViamVjdCh0aGlzLnN0b3JlVmFsdWUpO1xuICAgICAgcm9vdERpc3BhdGNoZXIubmV4dChuZXh0U3RhdGUodGhpcy5zdG9yZU5hbWUsIHRydWUpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoaXNUcmFuc2FjdGlvbkluUHJvY2VzcygpKSB7XG4gICAgICB0aGlzLmhhbmRsZVRyYW5zYWN0aW9uKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5kaXNwYXRjaCh0aGlzLnN0b3JlVmFsdWUsIF9yb290RGlzcGF0Y2hlcik7XG4gIH1cblxuICAvKipcbiAgICogUmVzZXRzIHRoZSBzdG9yZSB0byBpdCdzIGluaXRpYWwgc3RhdGUgYW5kIHNldCB0aGUgc3RvcmUgdG8gYSBwcmlzdGluZSBzdGF0ZS5cbiAgICovXG4gIHJlc2V0KCkge1xuICAgIGlmICh0aGlzLmlzUmVzc2V0YWJsZSgpKSB7XG4gICAgICBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdSZXNldCBTdG9yZScgfSk7XG4gICAgICB0aGlzLnNldFN0YXRlKCgpID0+IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuX2luaXRpYWxTdGF0ZSkpO1xuICAgICAgdGhpcy5zZXRQcmlzdGluZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgQWtpdGFFcnJvcihgWW91IG5lZWQgdG8gZW5hYmxlIHRoZSByZXNldCBmdW5jdGlvbmFsaXR5YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgbWV0aG9kIGlzIGEgc2hvcnRjdXQgZm9yIGBzZXRTdGF0ZSgpYC5cbiAgICogSXQgY2FuIGJlIHVzZWZ1bCB3aGVuIHlvdSB3YW50IHRvIHBhc3MgdGhlIHdob2xlIHN0YXRlIG9iamVjdCBpbnN0ZWFkIG9mIG1lcmdpbmcgYSBwYXJ0aWFsIHN0YXRlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB0aGlzLnN0b3JlLnVwZGF0ZShuZXdTdGF0ZSlcbiAgICovXG4gIHVwZGF0ZShuZXdTdGF0ZTogKHN0YXRlOiBSZWFkb25seTxTPikgPT4gUGFydGlhbDxTPik7XG4gIHVwZGF0ZShuZXdTdGF0ZTogUGFydGlhbDxTPik7XG4gIHVwZGF0ZShpZDogSUQgfCBJRFtdIHwgbnVsbCwgbmV3U3RhdGU6IFBhcnRpYWw8Uz4pO1xuICB1cGRhdGUobmV3U3RhdGVPcklkOiBQYXJ0aWFsPFM+IHwgSUQgfCBJRFtdIHwgbnVsbCB8ICgoc3RhdGU6IFJlYWRvbmx5PFM+KSA9PiBQYXJ0aWFsPFM+KSwgbmV3U3RhdGU/OiBQYXJ0aWFsPFM+KSB7XG4gICAgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnVXBkYXRlIFN0b3JlJyB9KTtcbiAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHtcbiAgICAgIGxldCB2YWx1ZSA9IGlzRnVuY3Rpb24obmV3U3RhdGVPcklkKSA/IG5ld1N0YXRlT3JJZChzdGF0ZSkgOiBuZXdTdGF0ZU9ySWQ7XG4gICAgICBsZXQgbWVyZ2VkID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUsIHZhbHVlKTtcbiAgICAgIHJldHVybiBpc1BsYWluT2JqZWN0KHN0YXRlKSA/IG1lcmdlZCA6IG5ldyAoc3RhdGUgYXMgYW55KS5jb25zdHJ1Y3RvcihtZXJnZWQpO1xuICAgIH0pO1xuICAgIHRoaXMuc2V0RGlydHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBzdG9yZSB0byBhIHByaXN0aW5lIHN0YXRlLlxuICAgKi9cbiAgc2V0UHJpc3RpbmUoKSB7XG4gICAgdGhpcy5faXNQcmlzdGluZSA9IHRydWU7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgc3RvcmUgdG8gYSBkaXJ0eSBzdGF0ZSwgaW5kaWNhdGluZyB0aGF0IGl0IGlzIG5vdCBwcmlzdGluZS5cbiAgICovXG4gIHNldERpcnR5KCkge1xuICAgIHRoaXMuX2lzUHJpc3RpbmUgPSBmYWxzZTtcbiAgfVxuXG4gIGRlc3Ryb3kgPSB0aGlzLm5nT25EZXN0cm95O1xuXG4gIHByaXZhdGUgZGlzcGF0Y2goc3RhdGU6IFMsIF9yb290RGlzcGF0Y2hlciA9IHRydWUpIHtcbiAgICB0aGlzLnN0b3JlLm5leHQoc3RhdGUpO1xuICAgIGlmIChfcm9vdERpc3BhdGNoZXIpIHtcbiAgICAgIHJvb3REaXNwYXRjaGVyLm5leHQobmV4dFN0YXRlKHRoaXMuc3RvcmVOYW1lKSk7XG4gICAgICBpc0RldigpICYmIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKHsgdHlwZTogJ1NldCBTdGF0ZScgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXQgc3RvcmUkKCkge1xuICAgIHJldHVybiB0aGlzLnN0b3JlLmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIHRyYW5zYWN0aW9uIGVuZHMgZGlzcGF0Y2ggdGhlIGZpbmFsIHZhbHVlIG9uY2VcbiAgICovXG4gIHByaXZhdGUgd2F0Y2hUcmFuc2FjdGlvbigpIHtcbiAgICBjb21taXQoKS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgdGhpcy5pblRyYW5zYWN0aW9uID0gZmFsc2U7XG4gICAgICBpZiAoaXNEZXYoKSAmJiAhX19nbG9iYWxTdGF0ZS5za2lwVHJhbnNhY3Rpb25Nc2cpIHtcbiAgICAgICAgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnQFRyYW5zYWN0aW9uJyB9KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZGlzcGF0Y2godGhpcy5fdmFsdWUoKSk7XG4gICAgICBfX2dsb2JhbFN0YXRlLmN1cnJlbnRUID0gW107XG4gICAgICBfX2dsb2JhbFN0YXRlLnNraXBUcmFuc2FjdGlvbk1zZyA9IGZhbHNlO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBpc1Jlc3NldGFibGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLnJlc2V0dGFibGUgfHwgZ2V0QWtpdGFDb25maWcoKS5yZXNldHRhYmxlO1xuICB9XG5cbiAgLyoqXG4gICAqIExpc3RlbiB0byB0aGUgdHJhbnNhY3Rpb24gc3RyZWFtXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVRyYW5zYWN0aW9uKCkge1xuICAgIGlmICghdGhpcy5pblRyYW5zYWN0aW9uKSB7XG4gICAgICB0aGlzLndhdGNoVHJhbnNhY3Rpb24oKTtcbiAgICAgIHRoaXMuaW5UcmFuc2FjdGlvbiA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgaWYgKGlzTm90QnJvd3NlcikgcmV0dXJuO1xuICAgIGlmICghKHdpbmRvdyBhcyBhbnkpLmhtckVuYWJsZWQgJiYgdGhpcyA9PT0gX19zdG9yZXNfX1t0aGlzLnN0b3JlTmFtZV0pIHtcbiAgICAgIGRlbGV0ZSBfX3N0b3Jlc19fW3RoaXMuc3RvcmVOYW1lXTtcbiAgICAgIHJvb3REaXNwYXRjaGVyLm5leHQoe1xuICAgICAgICB0eXBlOiBBY3Rpb25zLkRFTEVURV9TVE9SRSxcbiAgICAgICAgcGF5bG9hZDogeyBzdG9yZU5hbWU6IHRoaXMuc3RvcmVOYW1lIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgX2NydWQgfSBmcm9tICcuLi9pbnRlcm5hbC9jcnVkJztcbmltcG9ydCB7IEFraXRhSW1tdXRhYmlsaXR5RXJyb3IsIGFzc2VydEFjdGl2ZSB9IGZyb20gJy4uL2ludGVybmFsL2Vycm9yJztcbmltcG9ydCB7IEFjdGlvbiwgX19nbG9iYWxTdGF0ZSB9IGZyb20gJy4uL2ludGVybmFsL2dsb2JhbC1zdGF0ZSc7XG5pbXBvcnQgeyBjb2VyY2VBcnJheSwgZW50aXR5RXhpc3RzLCBpc0Z1bmN0aW9uLCBpc05pbCwgaXNPYmplY3QsIGlzVW5kZWZpbmVkLCB0b0Jvb2xlYW4gfSBmcm9tICcuLi9pbnRlcm5hbC91dGlscyc7XG5pbXBvcnQgeyBpc0RldiwgU3RvcmUgfSBmcm9tICcuL3N0b3JlJztcbmltcG9ydCB7IEFjdGl2ZVN0YXRlLCBFbnRpdGllcywgRW50aXR5U3RhdGUsIEhhc2hNYXAsIElELCBOZXdhYmxlLCBBZGRPcHRpb25zLCBTZXRBY3RpdmVPcHRpb25zIH0gZnJvbSAnLi90eXBlcyc7XG5cbi8qKlxuICogVGhlIFJvb3QgU3RvcmUgdGhhdCBldmVyeSBzdWIgc3RvcmUgbmVlZHMgdG8gaW5oZXJpdCBhbmRcbiAqIGludm9rZSBgc3VwZXJgIHdpdGggdGhlIGluaXRpYWwgc3RhdGUuXG4gKi9cbmV4cG9ydCBjbGFzcyBFbnRpdHlTdG9yZTxTIGV4dGVuZHMgRW50aXR5U3RhdGU8RT4sIEUsIEFjdGl2ZUVudGl0eSA9IElEPiBleHRlbmRzIFN0b3JlPFM+IHtcbiAgLyoqXG4gICAqXG4gICAqIEluaXRpYXRlIHRoZSBzdG9yZSB3aXRoIHRoZSBzdGF0ZVxuICAgKi9cbiAgY29uc3RydWN0b3IoaW5pdGlhbFN0YXRlID0ge30sIG9wdGlvbnM6IHsgaWRLZXk/OiBzdHJpbmc7IHN0b3JlTmFtZT86IHN0cmluZyB9ID0ge30pIHtcbiAgICBzdXBlcih7IC4uLmdldEluaXRpYWxFbnRpdGllc1N0YXRlKCksIC4uLmluaXRpYWxTdGF0ZSB9LCBvcHRpb25zKTtcbiAgfVxuXG4gIGdldCBlbnRpdGllcygpIHtcbiAgICByZXR1cm4gdGhpcy5fdmFsdWUoKS5lbnRpdGllcztcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBSZXBsYWNlIGN1cnJlbnQgY29sbGVjdGlvbiB3aXRoIHByb3ZpZGVkIGNvbGxlY3Rpb25cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5zdG9yZS5zZXQoW0VudGl0eSwgRW50aXR5XSk7XG4gICAqIHRoaXMuc3RvcmUuc2V0KHsxOiBFbnRpdHksIDI6IEVudGl0eX0pO1xuICAgKiB0aGlzLnN0b3JlLnNldChbe2lkOiAxfSwge2lkOiAyfV0sIHsgZW50aXR5Q2xhc3M6IFByb2R1Y3QgfSk7XG4gICAqXG4gICAqL1xuICBzZXQoZW50aXRpZXM6IEVbXSB8IEhhc2hNYXA8RT4gfCBFbnRpdGllczxFPiwgb3B0aW9uczogeyBlbnRpdHlDbGFzcz86IE5ld2FibGU8RT4gfCB1bmRlZmluZWQgfSA9IHt9KSB7XG4gICAgaXNEZXYoKSAmJiBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdTZXQgRW50aXRpZXMnIH0pO1xuICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUgPT4gX2NydWQuX3NldChzdGF0ZSwgaXNOaWwoZW50aXRpZXMpID8gW10gOiBlbnRpdGllcywgb3B0aW9ucy5lbnRpdHlDbGFzcywgdGhpcy5pZEtleSkpO1xuICAgIHRoaXMuc2V0RGlydHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgb3IgcmVwbGFjZSBhbiBlbnRpdHkgaW4gdGhlIHN0b3JlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB0aGlzLnN0b3JlLmNyZWF0ZU9yUmVwbGFjZSgzLCBFbnRpdHkpO1xuICAgKlxuICAgKi9cbiAgY3JlYXRlT3JSZXBsYWNlKGlkOiBJRCwgZW50aXR5OiBFKSB7XG4gICAgaWYgKCFlbnRpdHlFeGlzdHMoaWQsIHRoaXMuX3ZhbHVlKCkuZW50aXRpZXMpKSB7XG4gICAgICB0aGlzLmFkZFdoZW5Ob3RFeGlzdHMoaWQsIGVudGl0eSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlzRGV2KCkgJiYgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnQ3JlYXRlIG9yIFJlcGxhY2UgRW50aXR5JywgZW50aXR5SWQ6IFtpZF0gfSk7XG4gICAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IF9jcnVkLl9yZXBsYWNlRW50aXR5KHN0YXRlLCBpZCwgZW50aXR5KSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEluc2VydCBvciBVcGRhdGVcbiAgICovXG4gIHVwc2VydChpZDogSUQsIGVudGl0eU9yRm46IFBhcnRpYWw8RT4gfCAoKGVudGl0eTogUmVhZG9ubHk8RT4pID0+IFBhcnRpYWw8RT4pKSB7XG4gICAgaWYgKCFlbnRpdHlFeGlzdHMoaWQsIHRoaXMuX3ZhbHVlKCkuZW50aXRpZXMpKSB7XG4gICAgICBjb25zdCByZXNvbHZlID0gaXNGdW5jdGlvbihlbnRpdHlPckZuKSA/IChlbnRpdHlPckZuIGFzIEZ1bmN0aW9uKSh7fSkgOiBlbnRpdHlPckZuO1xuICAgICAgdGhpcy5hZGRXaGVuTm90RXhpc3RzKGlkLCByZXNvbHZlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy51cGRhdGUoaWQsIGVudGl0eU9yRm4gYXMgYW55KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGFuIGVudGl0eSBvciBlbnRpdGllcyB0byB0aGUgc3RvcmUuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMuc3RvcmUuYWRkKFtFbnRpdHksIEVudGl0eV0pO1xuICAgKiB0aGlzLnN0b3JlLmFkZChFbnRpdHkpO1xuICAgKiB0aGlzLnN0b3JlLmFkZChFbnRpdHksIHsgcHJlcGVuZDogdHJ1ZSB9KTtcbiAgICovXG4gIGFkZChlbnRpdGllczogRVtdIHwgRSwgb3B0aW9ucz86IEFkZE9wdGlvbnMpIHtcbiAgICBjb25zdCB0b0FycmF5ID0gY29lcmNlQXJyYXkoZW50aXRpZXMpO1xuXG4gICAgaWYgKHRvQXJyYXkubGVuZ3RoID09PSAwKSByZXR1cm47XG4gICAgLyoqICBJZiB3ZSBwYXNzIGVudGl0aWVzIHRoYXQgYWxyZWFkeSBleGlzdCwgd2Ugc2hvdWxkIGlnbm9yZSB0aGVtICovXG4gICAgY29uc3QgYWxsRXhpc3RzID0gdG9BcnJheS5ldmVyeShlbnRpdHkgPT4gdGhpcy5fdmFsdWUoKS5pZHMuaW5kZXhPZihlbnRpdHlbdGhpcy5pZEtleV0pID4gLTEpO1xuICAgIGlmIChhbGxFeGlzdHMpIHJldHVybjtcblxuICAgIGlzRGV2KCkgJiYgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnQWRkIEVudGl0eScgfSk7XG4gICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSA9PiBfY3J1ZC5fYWRkPFMsIEU+KHN0YXRlLCB0b0FycmF5LCB0aGlzLmlkS2V5LCBvcHRpb25zKSk7XG4gIH1cblxuICAvKipcbiAgICpcbiAgICogVXBkYXRlIGFuIGVudGl0eSBvciBlbnRpdGllcyBpbiB0aGUgc3RvcmUuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMuc3RvcmUudXBkYXRlKDMsIHtcbiAgICogICBuYW1lOiAnTmV3IE5hbWUnXG4gICAqIH0pO1xuICAgKlxuICAgKiAgdGhpcy5zdG9yZS51cGRhdGUoMywgZW50aXR5ID0+IHtcbiAgICogICAgcmV0dXJuIHtcbiAgICogICAgICBjb25maWc6IHtcbiAgICogICAgICAgIC4uLmVudGl0eS5maWx0ZXIsXG4gICAqICAgICAgICBkYXRlXG4gICAqICAgICAgfVxuICAgKiAgICB9XG4gICAqICB9KTtcbiAgICpcbiAgICogdGhpcy5zdG9yZS51cGRhdGUoWzEsMiwzXSwge1xuICAgKiAgIG5hbWU6ICdOZXcgTmFtZSdcbiAgICogfSk7XG4gICAqXG4gICAqIHRoaXMuc3RvcmUudXBkYXRlKGUgPT4gZS5uYW1lID09PSAndmFsdWUnLCB7XG4gICAqICAgbmFtZTogJ05ldyBOYW1lJ1xuICAgKiB9KTtcbiAgICpcbiAgICogdGhpcy5zdG9yZS51cGRhdGUobnVsbCwge1xuICAgKiAgIG5hbWU6ICdOZXcgTmFtZSdcbiAgICogfSk7XG4gICAqXG4gICAqL1xuICB1cGRhdGUoaWQ6IElEIHwgSURbXSB8IG51bGwsIG5ld1N0YXRlRm46ICgoZW50aXR5OiBSZWFkb25seTxFPikgPT4gUGFydGlhbDxFPikpO1xuICB1cGRhdGUoaWQ6IElEIHwgSURbXSB8IG51bGwsIG5ld1N0YXRlOiBQYXJ0aWFsPEU+KTtcbiAgdXBkYXRlKGlkOiBJRCB8IElEW10gfCBudWxsLCBuZXdTdGF0ZTogUGFydGlhbDxTPik7XG4gIHVwZGF0ZShuZXdTdGF0ZTogKHN0YXRlOiBSZWFkb25seTxTPikgPT4gUGFydGlhbDxTPik7XG4gIHVwZGF0ZShwcmVkaWNhdGU6ICgoZW50aXR5OiBSZWFkb25seTxFPikgPT4gYm9vbGVhbiksIG5ld1N0YXRlRm46ICgoZW50aXR5OiBSZWFkb25seTxFPikgPT4gUGFydGlhbDxFPikpO1xuICB1cGRhdGUocHJlZGljYXRlOiAoKGVudGl0eTogUmVhZG9ubHk8RT4pID0+IGJvb2xlYW4pLCBuZXdTdGF0ZTogUGFydGlhbDxFPik7XG4gIHVwZGF0ZShwcmVkaWNhdGU6ICgoZW50aXR5OiBSZWFkb25seTxFPikgPT4gYm9vbGVhbiksIG5ld1N0YXRlOiBQYXJ0aWFsPFM+KTtcbiAgdXBkYXRlKG5ld1N0YXRlOiBQYXJ0aWFsPFM+KTtcbiAgdXBkYXRlKFxuICAgIGlkc09yRm46IElEIHwgSURbXSB8IG51bGwgfCBQYXJ0aWFsPFM+IHwgKChzdGF0ZTogUmVhZG9ubHk8Uz4pID0+IFBhcnRpYWw8Uz4pIHwgKChlbnRpdHk6IFJlYWRvbmx5PEU+KSA9PiBib29sZWFuKSxcbiAgICBuZXdTdGF0ZU9yRm4/OiAoKGVudGl0eTogUmVhZG9ubHk8RT4pID0+IFBhcnRpYWw8RT4pIHwgUGFydGlhbDxFPiB8IFBhcnRpYWw8Uz5cbiAgKSB7XG4gICAgbGV0IGlkczogSURbXSA9IFtdO1xuICAgIGNvbnN0IHN0b3JlSWRzID0gdGhpcy5fdmFsdWUoKS5pZHM7XG5cbiAgICBpZiAoaXNGdW5jdGlvbihpZHNPckZuKSkge1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHN0b3JlSWRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGlkID0gc3RvcmVJZHNbaV07XG4gICAgICAgIGNvbnN0IGVudGl0eSA9IHRoaXMuX3ZhbHVlKCkuZW50aXRpZXNbaWRdO1xuICAgICAgICBpZiAoZW50aXR5ICYmIChpZHNPckZuIGFzIEZ1bmN0aW9uKShlbnRpdHkpKSB7XG4gICAgICAgICAgaWRzLnB1c2goaWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlkcyA9IHRvQm9vbGVhbihpZHNPckZuKSA/IGNvZXJjZUFycmF5KGlkc09yRm4pIDogc3RvcmVJZHM7XG4gICAgfVxuXG4gICAgaWYgKGlkcy5sZW5ndGggPT09IDApIHJldHVybjtcbiAgICBpc0RldigpICYmIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKHsgdHlwZTogJ1VwZGF0ZSBFbnRpdHknLCBlbnRpdHlJZDogaWRzIH0pO1xuXG4gICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSA9PiB7XG4gICAgICByZXR1cm4gX2NydWQuX3VwZGF0ZShzdGF0ZSwgaWRzLCBuZXdTdGF0ZU9yRm4sIHRoaXMuaWRLZXkpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFuIGFsaWFzIHRvIHVwZGF0ZSBhbGwuXG4gICAqL1xuICB1cGRhdGVBbGwoc3RhdGU6IFBhcnRpYWw8RT4pIHtcbiAgICBpZiAodGhpcy5fdmFsdWUoKS5pZHMubGVuZ3RoID09PSAwKSByZXR1cm47XG4gICAgdGhpcy51cGRhdGUobnVsbCwgc3RhdGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgcm9vdCBzdGF0ZSAoZGF0YSB3aGljaCBpcyBleHRlcm5hbCB0byB0aGUgZW50aXRpZXMpLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB0aGlzLnN0b3JlLnVwZGF0ZVJvb3Qoe1xuICAgKiAgIG1ldGFkYXRhOiAnbmV3IG1ldGFkYXRhXG4gICAqIH0pO1xuICAgKlxuICAgKiAgdGhpcy5zdG9yZS51cGRhdGVSb290KHN0YXRlID0+IHtcbiAgICogICAgcmV0dXJuIHtcbiAgICogICAgICBtZXRhZGF0YToge1xuICAgKiAgICAgICAgLi4uc3RhdGUubWV0YWRhdGEsXG4gICAqICAgICAgICBrZXk6ICduZXcgdmFsdWUnXG4gICAqICAgICAgfVxuICAgKiAgICB9XG4gICAqICB9KTtcbiAgICovXG4gIHVwZGF0ZVJvb3QobmV3U3RhdGVGbjogKChzdGF0ZTogUmVhZG9ubHk8Uz4pID0+IFBhcnRpYWw8Uz4pIHwgUGFydGlhbDxTPiwgYWN0aW9uPzogQWN0aW9uKSB7XG4gICAgY29uc3QgbmV3U3RhdGUgPSBpc0Z1bmN0aW9uKG5ld1N0YXRlRm4pID8gbmV3U3RhdGVGbih0aGlzLl92YWx1ZSgpKSA6IG5ld1N0YXRlRm47XG5cbiAgICBpZiAobmV3U3RhdGUgPT09IHRoaXMuX3ZhbHVlKCkpIHtcbiAgICAgIHRocm93IG5ldyBBa2l0YUltbXV0YWJpbGl0eUVycm9yKHRoaXMuc3RvcmVOYW1lKTtcbiAgICB9XG5cbiAgICBpc0RldigpICYmIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKGFjdGlvbiB8fCB7IHR5cGU6ICdVcGRhdGUgUm9vdCcgfSk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLihzdGF0ZSBhcyBhbnkpLFxuICAgICAgICAuLi4obmV3U3RhdGUgYXMgYW55KVxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBSZW1vdmUgb25lIG9yIG1vcmUgZW50aXRpZXMgZnJvbSB0aGUgc3RvcmU6XG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMuc3RvcmUucmVtb3ZlKDUpO1xuICAgKiB0aGlzLnN0b3JlLnJlbW92ZShbMSwyLDNdKTtcbiAgICogdGhpcy5zdG9yZS5yZW1vdmUoZW50aXR5ID0+IGVudGl0eS5pZCA9PT0gMSk7XG4gICAqIHRoaXMuc3RvcmUucmVtb3ZlKCk7XG4gICAqL1xuICByZW1vdmUoaWQ/OiBJRCB8IElEW10pO1xuICByZW1vdmUocHJlZGljYXRlOiAoZW50aXR5OiBSZWFkb25seTxFPikgPT4gYm9vbGVhbik7XG4gIHJlbW92ZShpZHNPckZuPzogSUQgfCBJRFtdIHwgKChlbnRpdHk6IFJlYWRvbmx5PEU+KSA9PiBib29sZWFuKSkge1xuICAgIGNvbnN0IHN0b3JlSWRzID0gdGhpcy5fdmFsdWUoKS5pZHM7XG5cbiAgICBpZiAoc3RvcmVJZHMubGVuZ3RoID09PSAwKSByZXR1cm47XG4gICAgY29uc3QgaWRQYXNzZWQgPSB0b0Jvb2xlYW4oaWRzT3JGbik7XG4gICAgaWYgKCFpZFBhc3NlZCkgdGhpcy5zZXRQcmlzdGluZSgpO1xuXG4gICAgbGV0IGlkczogSURbXSA9IFtdO1xuICAgIGlmIChpc0Z1bmN0aW9uKGlkc09yRm4pKSB7XG4gICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gc3RvcmVJZHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY29uc3QgaWQgPSBzdG9yZUlkc1tpXTtcbiAgICAgICAgY29uc3QgZW50aXR5ID0gdGhpcy5fdmFsdWUoKS5lbnRpdGllc1tpZF07XG4gICAgICAgIGlmIChlbnRpdHkgJiYgaWRzT3JGbihlbnRpdHkpKSB7XG4gICAgICAgICAgaWRzLnB1c2goaWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlkcyA9IGlkUGFzc2VkID8gY29lcmNlQXJyYXkoaWRzT3JGbikgOiBudWxsO1xuICAgIH1cblxuICAgIGlmIChpZHMgJiYgaWRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICAgIGlzRGV2KCkgJiYgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnUmVtb3ZlIEVudGl0eScsIGVudGl0eUlkOiBpZHMgfSk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHtcbiAgICAgIHJldHVybiBfY3J1ZC5fcmVtb3ZlKHN0YXRlLCBpZHMpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIFVwZGF0ZSB0aGUgYWN0aXZlIGVudGl0eS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5zdG9yZS51cGRhdGVBY3RpdmUoYWN0aXZlID0+IHtcbiAgICogICByZXR1cm4ge1xuICAgKiAgICAgY29uZmlnOiB7XG4gICAqICAgICAgLi5hY3RpdmUuY29uZmlnLFxuICAgKiAgICAgIGRhdGVcbiAgICogICAgIH1cbiAgICogICB9XG4gICAqIH0pXG4gICAqL1xuICB1cGRhdGVBY3RpdmUobmV3U3RhdGVGbjogKChlbnRpdHk6IFJlYWRvbmx5PEU+KSA9PiBQYXJ0aWFsPEU+KSB8IFBhcnRpYWw8RT4pIHtcbiAgICBhc3NlcnRBY3RpdmUodGhpcy5fdmFsdWUoKSk7XG4gICAgaXNEZXYoKSAmJiBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdVcGRhdGUgQWN0aXZlIEVudGl0eScsIGVudGl0eUlkOiB0aGlzLl92YWx1ZSgpLmFjdGl2ZSB9KTtcbiAgICB0aGlzLnNldFN0YXRlKHN0YXRlID0+IHtcbiAgICAgIGNvbnN0IGFjdGl2ZUlkID0gc3RhdGUuYWN0aXZlIGFzIElEO1xuICAgICAgY29uc3QgbmV3U3RhdGUgPSBpc0Z1bmN0aW9uKG5ld1N0YXRlRm4pID8gbmV3U3RhdGVGbihzdGF0ZS5lbnRpdGllc1thY3RpdmVJZF0pIDogbmV3U3RhdGVGbjtcbiAgICAgIGlmIChuZXdTdGF0ZSA9PT0gc3RhdGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFraXRhSW1tdXRhYmlsaXR5RXJyb3IodGhpcy5zdG9yZU5hbWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIF9jcnVkLl91cGRhdGUoc3RhdGUsIFthY3RpdmVJZF0sIG5ld1N0YXRlLCB0aGlzLmlkS2V5KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIGdpdmVuIGVudGl0eSBhcyBhY3RpdmUuXG4gICAqL1xuICBzZXRBY3RpdmUoaWRPck9wdGlvbnM6IEFjdGl2ZUVudGl0eSB8IFNldEFjdGl2ZU9wdGlvbnMgfCBudWxsKSB7XG4gICAgbGV0IGFjdGl2ZUlkOiBBY3RpdmVFbnRpdHk7XG5cbiAgICBpZiAoaXNPYmplY3QoaWRPck9wdGlvbnMpKSB7XG4gICAgICBpZiAoaXNOaWwodGhpcy5fdmFsdWUoKS5hY3RpdmUpKSByZXR1cm47XG4gICAgICAoaWRPck9wdGlvbnMgYXMgU2V0QWN0aXZlT3B0aW9ucykgPSBPYmplY3QuYXNzaWduKHsgd3JhcDogdHJ1ZSB9LCBpZE9yT3B0aW9ucyk7XG4gICAgICBjb25zdCBpZHMgPSB0aGlzLl92YWx1ZSgpLmlkcztcbiAgICAgIGNvbnN0IGN1cnJlbnRJZEluZGV4ID0gaWRzLmluZGV4T2YodGhpcy5fdmFsdWUoKS5hY3RpdmUpO1xuICAgICAgaWYgKChpZE9yT3B0aW9ucyBhcyBTZXRBY3RpdmVPcHRpb25zKS5wcmV2KSB7XG4gICAgICAgIGNvbnN0IGlzRmlyc3QgPSBjdXJyZW50SWRJbmRleCA9PT0gMDtcbiAgICAgICAgaWYgKGlzRmlyc3QgJiYgIShpZE9yT3B0aW9ucyBhcyBTZXRBY3RpdmVPcHRpb25zKS53cmFwKSByZXR1cm47XG4gICAgICAgIGFjdGl2ZUlkID0gaXNGaXJzdCA/IGlkc1tpZHMubGVuZ3RoIC0gMV0gOiAoaWRzW2N1cnJlbnRJZEluZGV4IC0gMV0gYXMgYW55KTtcbiAgICAgIH0gZWxzZSBpZiAoKGlkT3JPcHRpb25zIGFzIFNldEFjdGl2ZU9wdGlvbnMpLm5leHQpIHtcbiAgICAgICAgY29uc3QgaXNMYXN0ID0gaWRzLmxlbmd0aCA9PT0gY3VycmVudElkSW5kZXggKyAxO1xuICAgICAgICBpZiAoaXNMYXN0ICYmICEoaWRPck9wdGlvbnMgYXMgU2V0QWN0aXZlT3B0aW9ucykud3JhcCkgcmV0dXJuO1xuICAgICAgICBhY3RpdmVJZCA9IGlzTGFzdCA/IGlkc1swXSA6IChpZHNbY3VycmVudElkSW5kZXggKyAxXSBhcyBhbnkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoaWRPck9wdGlvbnMgPT09IHRoaXMuX3ZhbHVlKCkuYWN0aXZlKSByZXR1cm47XG4gICAgICBhY3RpdmVJZCA9IGlkT3JPcHRpb25zIGFzIEFjdGl2ZUVudGl0eTtcbiAgICB9XG5cbiAgICBpc0RldigpICYmIF9fZ2xvYmFsU3RhdGUuc2V0QWN0aW9uKHsgdHlwZTogJ1NldCBBY3RpdmUgRW50aXR5JywgZW50aXR5SWQ6IGFjdGl2ZUlkIH0pO1xuICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uKHN0YXRlIGFzIGFueSksXG4gICAgICAgIGFjdGl2ZTogYWN0aXZlSWRcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFkZFdoZW5Ob3RFeGlzdHMoaWQ6IElELCBlbnRpdHk6IEUpIHtcbiAgICBpZiAoIWVudGl0eVt0aGlzLmlkS2V5XSkge1xuICAgICAgZW50aXR5W3RoaXMuaWRLZXldID0gaWQ7XG4gICAgfVxuICAgIHRoaXMuYWRkKGVudGl0eSk7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGdldEluaXRpYWxFbnRpdGllc1N0YXRlID0gKCkgPT5cbiAgKHtcbiAgICBlbnRpdGllczoge30sXG4gICAgaWRzOiBbXSxcbiAgICBsb2FkaW5nOiB0cnVlLFxuICAgIGVycm9yOiBudWxsXG4gIH0gYXMgRW50aXR5U3RhdGUpO1xuXG5leHBvcnQgY29uc3QgZ2V0SW5pdGlhbEFjdGl2ZVN0YXRlID0gKCkgPT5cbiAgKHtcbiAgICBhY3RpdmU6IG51bGxcbiAgfSBhcyBBY3RpdmVTdGF0ZSk7XG4iLCJleHBvcnQgZW51bSBPcmRlciB7XG4gIEFTQyA9ICdhc2MnLFxuICBERVNDID0gJ2Rlc2MnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlVmFsdWVzKGtleSwgb3JkZXI6IE9yZGVyID0gT3JkZXIuQVNDKSB7XG4gIHJldHVybiBmdW5jdGlvbihhLCBiKSB7XG4gICAgaWYgKCFhLmhhc093blByb3BlcnR5KGtleSkgfHwgIWIuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgY29uc3QgdmFyQSA9IHR5cGVvZiBhW2tleV0gPT09ICdzdHJpbmcnID8gYVtrZXldLnRvVXBwZXJDYXNlKCkgOiBhW2tleV07XG4gICAgY29uc3QgdmFyQiA9IHR5cGVvZiBiW2tleV0gPT09ICdzdHJpbmcnID8gYltrZXldLnRvVXBwZXJDYXNlKCkgOiBiW2tleV07XG5cbiAgICBsZXQgY29tcGFyaXNvbiA9IDA7XG4gICAgaWYgKHZhckEgPiB2YXJCKSB7XG4gICAgICBjb21wYXJpc29uID0gMTtcbiAgICB9IGVsc2UgaWYgKHZhckEgPCB2YXJCKSB7XG4gICAgICBjb21wYXJpc29uID0gLTE7XG4gICAgfVxuICAgIHJldHVybiBvcmRlciA9PSBPcmRlci5ERVNDID8gY29tcGFyaXNvbiAqIC0xIDogY29tcGFyaXNvbjtcbiAgfTtcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBtZW1vaXplT25lKGZuOiBGdW5jdGlvbikge1xuICBsZXQgbGFzdEFyZ3M7XG4gIGxldCBjaGFuZ2VkID0gZmFsc2U7XG4gIGxldCBmaXJzdEluaXQgPSB0cnVlO1xuICBsZXQgbGFzdFJlc3VsdDtcblxuICByZXR1cm4gZnVuY3Rpb24oLi4uYXJncykge1xuICAgIGlmIChsYXN0QXJncykge1xuICAgICAgLyoqIElmIGVudGl0aWVzIG5vciBpZHMgZG9lc24ndCBjaGFuZ2UgcmV0dXJuIHRoZSBsYXN0IHZhbHVlICovXG4gICAgICBjaGFuZ2VkID0gbGFzdEFyZ3NbMV0gIT09IGFyZ3NbMV0gfHwgbGFzdEFyZ3NbMF0gIT09IGFyZ3NbMF07XG4gICAgfVxuXG4gICAgaWYgKGZpcnN0SW5pdCB8fCAoY2hhbmdlZCAmJiAhZmlyc3RJbml0KSkge1xuICAgICAgbGFzdFJlc3VsdCA9IGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cblxuICAgIGZpcnN0SW5pdCA9IGZhbHNlO1xuICAgIGxhc3RBcmdzID0gYXJncztcbiAgICByZXR1cm4gbGFzdFJlc3VsdDtcbiAgfTtcbn1cbiIsImltcG9ydCB7IE9yZGVyIH0gZnJvbSAnLi4vaW50ZXJuYWwvc29ydCc7XG5cbmV4cG9ydCB0eXBlIFNvcnRCeTxFLCBTID0gYW55PiA9ICgoYTogRSwgYjogRSwgc3RhdGU/OiBTKSA9PiBudW1iZXIpIHwga2V5b2YgRTtcblxuZXhwb3J0IGludGVyZmFjZSBTb3J0QnlPcHRpb25zPEU+IHtcbiAgc29ydEJ5PzogU29ydEJ5PEU+O1xuICBzb3J0QnlPcmRlcj86IE9yZGVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5Q29uZmlnT3B0aW9uczxFID0gYW55PiBleHRlbmRzIFNvcnRCeU9wdGlvbnM8RT4ge31cblxuZXhwb3J0IGNvbnN0IHF1ZXJ5Q29uZmlnS2V5ID0gJ2FraXRhUXVlcnlDb25maWcnO1xuXG5leHBvcnQgZnVuY3Rpb24gUXVlcnlDb25maWc8RT4obWV0YWRhdGE6IFF1ZXJ5Q29uZmlnT3B0aW9uczxFPikge1xuICByZXR1cm4gZnVuY3Rpb24oY29uc3RydWN0b3I6IEZ1bmN0aW9uKSB7XG4gICAgY29uc3RydWN0b3JbcXVlcnlDb25maWdLZXldID0ge307XG4gICAgZm9yIChsZXQgaSA9IDAsIGtleXMgPSBPYmplY3Qua2V5cyhtZXRhZGF0YSk7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBrZXkgPSBrZXlzW2ldO1xuICAgICAgY29uc3RydWN0b3JbcXVlcnlDb25maWdLZXldW2tleV0gPSBtZXRhZGF0YVtrZXldO1xuICAgIH1cbiAgfTtcbn1cbiIsImltcG9ydCB7IFN0b3JlIH0gZnJvbSAnLi9zdG9yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyB0YWtlIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgcXVlcnlDb25maWdLZXksIFF1ZXJ5Q29uZmlnT3B0aW9ucyB9IGZyb20gJy4vcXVlcnktY29uZmlnJztcblxuZXhwb3J0IGNsYXNzIFF1ZXJ5PFM+IHtcbiAgLyoqIFVzZSBvbmx5IGZvciBpbnRlcm5hbCBwbHVnaW5zIGxpa2UgUGFnaW5hdGlvbiAtIGRvbid0IHVzZSB0aGlzIHByb3BlcnR5ICoqL1xuICBfX3N0b3JlX186IFN0b3JlPFM+O1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBzdG9yZTogU3RvcmU8Uz4pIHtcbiAgICB0aGlzLl9fc3RvcmVfXyA9IHN0b3JlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdCBhIHNsaWNlIGZyb20gdGhlIHN0b3JlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB0aGlzLnF1ZXJ5LnNlbGVjdCgpXG4gICAqIHRoaXMucXVlcnkuc2VsZWN0KHN0YXRlID0+IHN0YXRlLmVudGl0aWVzKVxuICAgKi9cbiAgc2VsZWN0PFI+KHByb2plY3Q/OiAoc3RvcmU6IFMpID0+IFIpOiBPYnNlcnZhYmxlPFI+O1xuICBzZWxlY3QoKTogT2JzZXJ2YWJsZTxTPjtcbiAgc2VsZWN0PFI+KHByb2plY3Q/OiAoc3RvcmU6IFMpID0+IFIpOiBPYnNlcnZhYmxlPFIgfCBTPiB7XG4gICAgbGV0IHN0YXRlID0gcHJvamVjdCA/IHByb2plY3QgOiBzdGF0ZSA9PiBzdGF0ZTtcbiAgICByZXR1cm4gdGhpcy5zdG9yZS5fc2VsZWN0KHN0YXRlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY3Qgb25jZSBhbmQgY29tcGxldGUuXG4gICAqL1xuICBzZWxlY3RPbmNlPFI+KHByb2plY3Q6IChzdG9yZTogUykgPT4gUik6IE9ic2VydmFibGU8Uj4ge1xuICAgIHJldHVybiB0aGlzLnNlbGVjdChwcm9qZWN0KS5waXBlKHRha2UoMSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdCB0aGUgc3RvcmUncyBsb2FkaW5nIHN0YXRlLlxuICAgKi9cbiAgc2VsZWN0TG9hZGluZygpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3Qoc3RhdGUgPT4gKHN0YXRlIGFzIFMgJiB7IGxvYWRpbmc6IGJvb2xlYW4gfSkubG9hZGluZyk7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IHRoZSBzdG9yZSdzIGVycm9yIHN0YXRlLlxuICAgKi9cbiAgc2VsZWN0RXJyb3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0KHN0YXRlID0+IChzdGF0ZSBhcyBTICYgeyBlcnJvcjogYW55IH0pLmVycm9yKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIHJhdyB2YWx1ZSBvZiB0aGUgc3RvcmUuXG4gICAqL1xuICBnZXRTbmFwc2hvdCgpOiBTIHtcbiAgICByZXR1cm4gdGhpcy5zdG9yZS5fdmFsdWUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiAgUmV0dXJucyB3aGV0aGVyIHRoZSBzdGF0ZSBvZiB0aGUgc3RvcmUgaXMgcHJpc3RpbmUgKHRoZSBzZXQoKSBtZXRob2QgaGFzbid0IGJlZW4gZXhwbGljaXRseSBjYWxsZWRcbiAgICogIHNpbmNlIHRoZSBzdG9yZSBjcmVhdGlvbiwgb3IgdGhlIGxhc3QgdGltZSBzZXRQcmlzdGluZSgpd2FzIGNhbGxlZCkuXG4gICAqL1xuICBnZXQgaXNQcmlzdGluZSgpIHtcbiAgICByZXR1cm4gdGhpcy5zdG9yZS5pc1ByaXN0aW5lO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgd2hldGhlciB0aGUgc3RhdGUgb2YgdGhlIHN0b3JlIGlzIGRpcnR5ICh0aGUgc2V0KCkgbWV0aG9kXG4gICAqIG9yIHRoZSBzZXREaXJ0eSgpIG1ldGhvZCBoYXMgYmVlbiBleHBsaWNpdGx5IGNhbGxlZCBzaW5jZSB0aGUgc3RvcmUgY3JlYXRpb24sXG4gICAqIG9yIHRoZSBsYXN0IHRpbWUgc2V0UHJpc3RpbmUoKSB3YXMgY2FsbGVkKS5cbiAgICovXG4gIGdldCBpc0RpcnR5KCkge1xuICAgIHJldHVybiAhdGhpcy5zdG9yZS5pc1ByaXN0aW5lO1xuICB9XG5cbiAgZ2V0IGNvbmZpZygpOiBRdWVyeUNvbmZpZ09wdGlvbnMge1xuICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdG9yW3F1ZXJ5Q29uZmlnS2V5XTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgY29tYmluZUxhdGVzdCwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgYXVkaXRUaW1lLCBtYXAsIHN3aXRjaE1hcCwgd2l0aExhdGVzdEZyb20gfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7IGNvbXBhcmVWYWx1ZXMsIE9yZGVyIH0gZnJvbSAnLi4vaW50ZXJuYWwvc29ydCc7XG5pbXBvcnQgeyBlbnRpdHlFeGlzdHMsIGlzRnVuY3Rpb24sIGlzVW5kZWZpbmVkLCB0b0Jvb2xlYW4gfSBmcm9tICcuLi9pbnRlcm5hbC91dGlscyc7XG5pbXBvcnQgeyBFbnRpdHlTdG9yZSB9IGZyb20gJy4vZW50aXR5LXN0b3JlJztcbmltcG9ydCB7IG1lbW9pemVPbmUgfSBmcm9tICcuL21lbW9pemUnO1xuaW1wb3J0IHsgUXVlcnkgfSBmcm9tICcuL3F1ZXJ5JztcbmltcG9ydCB7IFNvcnRCeSwgU29ydEJ5T3B0aW9ucyB9IGZyb20gJy4vcXVlcnktY29uZmlnJztcbmltcG9ydCB7IEFjdGl2ZVN0YXRlLCBFbnRpdHlTdGF0ZSwgSGFzaE1hcCwgSUQgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBTZWxlY3RPcHRpb25zPEU+IGV4dGVuZHMgU29ydEJ5T3B0aW9uczxFPiB7XG4gIGFzT2JqZWN0PzogYm9vbGVhbjtcbiAgZmlsdGVyQnk/OiAoKGVudGl0eTogRSwgaW5kZXg/OiBudW1iZXIpID0+IGJvb2xlYW4pIHwgKChlbnRpdHk6IEUsIGluZGV4PzogbnVtYmVyKSA9PiBib29sZWFuKVtdIHwgdW5kZWZpbmVkO1xuICBsaW1pdFRvPzogbnVtYmVyO1xufVxuXG4vKipcbiAqICBBbiBhYnN0cmFjdGlvbiBmb3IgcXVlcnlpbmcgdGhlIGVudGl0aWVzIGZyb20gdGhlIHN0b3JlXG4gKi9cbmV4cG9ydCBjbGFzcyBRdWVyeUVudGl0eTxTIGV4dGVuZHMgRW50aXR5U3RhdGUsIEUsIEFjdGl2ZUVudGl0eSA9IElEPiBleHRlbmRzIFF1ZXJ5PFM+IHtcbiAgcHJvdGVjdGVkIHN0b3JlOiBFbnRpdHlTdG9yZTxTLCBFLCBBY3RpdmVFbnRpdHk+O1xuICBwcml2YXRlIG1lbW9pemVkO1xuXG4gIC8qKiBVc2Ugb25seSBmb3IgaW50ZXJuYWwgcGx1Z2lucyBsaWtlIFBhZ2luYXRpb24gLSBkb24ndCB1c2UgdGhpcyBwcm9wZXJ0eSAqKi9cbiAgX19zdG9yZV9fO1xuXG4gIGNvbnN0cnVjdG9yKHN0b3JlOiBFbnRpdHlTdG9yZTxTLCBFLCBBY3RpdmVFbnRpdHk+KSB7XG4gICAgc3VwZXIoc3RvcmUpO1xuICAgIHRoaXMuX19zdG9yZV9fID0gc3RvcmU7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IHRoZSBlbnRpcmUgc3RvcmUncyBlbnRpdHkgY29sbGVjdGlvbi5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5zdG9yZS5zZWxlY3RBbGwoKTtcbiAgICovXG4gIHNlbGVjdEFsbChvcHRpb25zOiB7IGFzT2JqZWN0OiB0cnVlOyBmaWx0ZXJCeT86IFNlbGVjdE9wdGlvbnM8RT5bJ2ZpbHRlckJ5J107IGxpbWl0VG8/OiBudW1iZXI7IHNvcnRCeT86IHVuZGVmaW5lZDsgc29ydEJ5T3JkZXI/OiB1bmRlZmluZWQgfSk6IE9ic2VydmFibGU8SGFzaE1hcDxFPj47XG4gIHNlbGVjdEFsbChvcHRpb25zOiB7IGZpbHRlckJ5OiBTZWxlY3RPcHRpb25zPEU+WydmaWx0ZXJCeSddOyBsaW1pdFRvPzogbnVtYmVyOyBzb3J0Qnk/OiBTb3J0Qnk8RT47IHNvcnRCeU9yZGVyPzogT3JkZXIgfSk6IE9ic2VydmFibGU8RVtdPjtcbiAgc2VsZWN0QWxsKG9wdGlvbnM6IHsgYXNPYmplY3Q6IHRydWU7IGxpbWl0VG8/OiBudW1iZXI7IHNvcnRCeT86IHVuZGVmaW5lZDsgc29ydEJ5T3JkZXI/OiB1bmRlZmluZWQgfSk6IE9ic2VydmFibGU8SGFzaE1hcDxFPj47XG4gIHNlbGVjdEFsbChvcHRpb25zOiB7IGxpbWl0VG8/OiBudW1iZXI7IHNvcnRCeT86IFNvcnRCeTxFPjsgc29ydEJ5T3JkZXI/OiBPcmRlciB9KTogT2JzZXJ2YWJsZTxFW10+O1xuICBzZWxlY3RBbGwob3B0aW9uczogeyBhc09iamVjdDogZmFsc2U7IGZpbHRlckJ5PzogU2VsZWN0T3B0aW9uczxFPlsnZmlsdGVyQnknXTsgbGltaXRUbz86IG51bWJlcjsgc29ydEJ5PzogU29ydEJ5PEU+OyBzb3J0QnlPcmRlcj86IE9yZGVyIH0pOiBPYnNlcnZhYmxlPEVbXT47XG4gIHNlbGVjdEFsbCgpOiBPYnNlcnZhYmxlPEVbXT47XG4gIHNlbGVjdEFsbChcbiAgICBvcHRpb25zOiBTZWxlY3RPcHRpb25zPEU+ID0ge1xuICAgICAgYXNPYmplY3Q6IGZhbHNlXG4gICAgfVxuICApOiBPYnNlcnZhYmxlPEVbXSB8IEhhc2hNYXA8RT4+IHtcbiAgICBjb25zdCBzZWxlY3RTdGF0ZSQgPSB0aGlzLnNlbGVjdChzdGF0ZSA9PiBzdGF0ZSk7XG4gICAgY29uc3Qgc2VsZWN0RW50aXRpZXMkID0gdGhpcy5zZWxlY3Qoc3RhdGUgPT4gc3RhdGUuZW50aXRpZXMpO1xuXG4gICAgdGhpcy5zb3J0QnlPcHRpb25zKG9wdGlvbnMpO1xuXG4gICAgcmV0dXJuIHNlbGVjdEVudGl0aWVzJC5waXBlKFxuICAgICAgd2l0aExhdGVzdEZyb20oc2VsZWN0U3RhdGUkLCAoZW50aXRpZXM6IEhhc2hNYXA8RT4sIHN0YXRlOiBTKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgaWRzIH0gPSBzdGF0ZTtcbiAgICAgICAgaWYgKG9wdGlvbnMuYXNPYmplY3QpIHtcbiAgICAgICAgICByZXR1cm4gdG9NYXAoaWRzLCBlbnRpdGllcywgb3B0aW9ucyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCFvcHRpb25zLmZpbHRlckJ5ICYmICFvcHRpb25zLnNvcnRCeSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1lbW9pemVkKSB7XG4gICAgICAgICAgICAgIHRoaXMubWVtb2l6ZWQgPSBtZW1vaXplT25lKHRvQXJyYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVtb2l6ZWQoc3RhdGUsIG9wdGlvbnMpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB0b0FycmF5KHN0YXRlLCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgZW50aXJlIHN0b3JlJ3MgZW50aXR5IGNvbGxlY3Rpb24uXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMuc3RvcmUuZ2V0QWxsKCk7XG4gICAqL1xuICBnZXRBbGwob3B0aW9uczogeyBhc09iamVjdDogdHJ1ZTsgZmlsdGVyQnk/OiBTZWxlY3RPcHRpb25zPEU+WydmaWx0ZXJCeSddOyBsaW1pdFRvPzogbnVtYmVyOyBzb3J0Qnk/OiB1bmRlZmluZWQ7IHNvcnRCeU9yZGVyPzogdW5kZWZpbmVkIH0pOiBIYXNoTWFwPEU+O1xuICBnZXRBbGwob3B0aW9uczogeyBmaWx0ZXJCeTogU2VsZWN0T3B0aW9uczxFPlsnZmlsdGVyQnknXTsgbGltaXRUbz86IG51bWJlcjsgc29ydEJ5PzogU29ydEJ5PEU+OyBzb3J0QnlPcmRlcj86IE9yZGVyIH0pOiBFW107XG4gIGdldEFsbChvcHRpb25zOiB7IGFzT2JqZWN0OiB0cnVlOyBsaW1pdFRvPzogbnVtYmVyOyBzb3J0Qnk/OiB1bmRlZmluZWQ7IHNvcnRCeU9yZGVyPzogdW5kZWZpbmVkIH0pOiBIYXNoTWFwPEU+O1xuICBnZXRBbGwob3B0aW9uczogeyBsaW1pdFRvPzogbnVtYmVyOyBzb3J0Qnk/OiBTb3J0Qnk8RT47IHNvcnRCeU9yZGVyPzogT3JkZXIgfSk6IEVbXTtcbiAgZ2V0QWxsKG9wdGlvbnM6IHsgYXNPYmplY3Q6IGZhbHNlOyBmaWx0ZXJCeT86IFNlbGVjdE9wdGlvbnM8RT5bJ2ZpbHRlckJ5J107IGxpbWl0VG8/OiBudW1iZXI7IHNvcnRCeT86IFNvcnRCeTxFPjsgc29ydEJ5T3JkZXI/OiBPcmRlciB9KTogRVtdO1xuICBnZXRBbGwoKTogRVtdO1xuICBnZXRBbGwob3B0aW9uczogU2VsZWN0T3B0aW9uczxFPiA9IHsgYXNPYmplY3Q6IGZhbHNlLCBmaWx0ZXJCeTogdW5kZWZpbmVkLCBsaW1pdFRvOiB1bmRlZmluZWQgfSk6IEVbXSB8IEhhc2hNYXA8RT4ge1xuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5nZXRTbmFwc2hvdCgpO1xuXG4gICAgaWYgKG9wdGlvbnMuYXNPYmplY3QpIHtcbiAgICAgIHJldHVybiB0b01hcChzdGF0ZS5pZHMsIHN0YXRlLmVudGl0aWVzLCBvcHRpb25zLCB0cnVlKTtcbiAgICB9XG5cbiAgICB0aGlzLnNvcnRCeU9wdGlvbnMob3B0aW9ucyk7XG5cbiAgICByZXR1cm4gdG9BcnJheShzdGF0ZSwgb3B0aW9ucyk7XG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0IG11bHRpcGxlIGVudGl0aWVzIGZyb20gdGhlIHN0b3JlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB0aGlzLnN0b3JlLnNlbGVjdE1hbnkoWzEsMl0pO1xuICAgKi9cbiAgc2VsZWN0TWFueShpZHM6IEFjdGl2ZUVudGl0eVtdLCBvcHRpb25zOiB7IGZpbHRlclVuZGVmaW5lZD86IGJvb2xlYW4gfSA9IHt9KTogT2JzZXJ2YWJsZTxFW10+IHtcbiAgICBjb25zdCBmaWx0ZXJVbmRlZmluZWQgPSBpc1VuZGVmaW5lZChvcHRpb25zLmZpbHRlclVuZGVmaW5lZCkgPyB0cnVlIDogb3B0aW9ucy5maWx0ZXJVbmRlZmluZWQ7XG4gICAgY29uc3QgZW50aXRpZXMgPSBpZHMubWFwKGlkID0+IHRoaXMuc2VsZWN0RW50aXR5KGlkKSk7XG5cbiAgICByZXR1cm4gY29tYmluZUxhdGVzdChlbnRpdGllcykucGlwZShcbiAgICAgIG1hcChlbnRpdGllcyA9PiB7XG4gICAgICAgIHJldHVybiBmaWx0ZXJVbmRlZmluZWQgPyBlbnRpdGllcy5maWx0ZXIodmFsID0+ICFpc1VuZGVmaW5lZCh2YWwpKSA6IGVudGl0aWVzO1xuICAgICAgfSksXG4gICAgICBhdWRpdFRpbWUoMClcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdCBhbiBlbnRpdHkgb3IgYSBzbGljZSBvZiBhbiBlbnRpdHkuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHRoaXMucGFnZXNTdG9yZS5zZWxlY3RFbnRpdHkoMSlcbiAgICogdGhpcy5wYWdlc1N0b3JlLnNlbGVjdEVudGl0eSgxLCBlbnRpdHkgPT4gZW50aXR5LmNvbmZpZy5kYXRlKVxuICAgKlxuICAgKi9cbiAgc2VsZWN0RW50aXR5PFI+KGlkOiBBY3RpdmVFbnRpdHkpOiBPYnNlcnZhYmxlPEU+O1xuICBzZWxlY3RFbnRpdHk8Uj4oaWQ6IEFjdGl2ZUVudGl0eSwgcHJvamVjdDogKGVudGl0eTogRSkgPT4gUik6IE9ic2VydmFibGU8Uj47XG4gIHNlbGVjdEVudGl0eTxSPihpZDogQWN0aXZlRW50aXR5LCBwcm9qZWN0PzogKGVudGl0eTogRSkgPT4gUik6IE9ic2VydmFibGU8UiB8IEU+IHtcbiAgICBpZiAoIXByb2plY3QpIHtcbiAgICAgIHJldHVybiB0aGlzLl9ieUlkKGlkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5zZWxlY3Qoc3RhdGUgPT4ge1xuICAgICAgaWYgKHRoaXMuaGFzRW50aXR5KGlkKSkge1xuICAgICAgICByZXR1cm4gcHJvamVjdCh0aGlzLmdldEVudGl0eShpZCkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbiBlbnRpdHkgYnkgaWRcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdGhpcy5zdG9yZS5nZXRFbnRpdHkoMSk7XG4gICAqL1xuICBnZXRFbnRpdHkoaWQ6IEFjdGl2ZUVudGl0eSk6IEUge1xuICAgIHJldHVybiB0aGlzLmdldFNuYXBzaG90KCkuZW50aXRpZXNbaWQgYXMgYW55XTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY3QgdGhlIGFjdGl2ZSBlbnRpdHkncyBpZC5cbiAgICovXG4gIHNlbGVjdEFjdGl2ZUlkKCk6IE9ic2VydmFibGU8QWN0aXZlRW50aXR5PiB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0KHN0YXRlID0+IChzdGF0ZSBhcyBTICYgQWN0aXZlU3RhdGU8QWN0aXZlRW50aXR5PikuYWN0aXZlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGFjdGl2ZSBpZFxuICAgKi9cbiAgZ2V0QWN0aXZlSWQoKTogQWN0aXZlRW50aXR5IHtcbiAgICByZXR1cm4gKHRoaXMuZ2V0U25hcHNob3QoKSBhcyBTICYgQWN0aXZlU3RhdGU8QWN0aXZlRW50aXR5PikuYWN0aXZlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdCB0aGUgYWN0aXZlIGVudGl0eS5cbiAgICovXG4gIHNlbGVjdEFjdGl2ZTxSPigpOiBPYnNlcnZhYmxlPEU+O1xuICBzZWxlY3RBY3RpdmU8Uj4ocHJvamVjdDogKGVudGl0eTogRSkgPT4gUik6IE9ic2VydmFibGU8Uj47XG4gIHNlbGVjdEFjdGl2ZTxSPihwcm9qZWN0PzogKGVudGl0eTogRSkgPT4gUik6IE9ic2VydmFibGU8UiB8IEU+IHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RBY3RpdmVJZCgpLnBpcGUoc3dpdGNoTWFwKGFjdGl2ZUlkID0+IHRoaXMuc2VsZWN0RW50aXR5KGFjdGl2ZUlkLCBwcm9qZWN0KSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgYWN0aXZlIGVudGl0eS5cbiAgICovXG4gIGdldEFjdGl2ZSgpOiBFIHtcbiAgICBjb25zdCBhY3RpdmVJZDogQWN0aXZlRW50aXR5ID0gdGhpcy5nZXRBY3RpdmVJZCgpO1xuICAgIHJldHVybiB0b0Jvb2xlYW4oYWN0aXZlSWQpID8gdGhpcy5nZXRFbnRpdHkoYWN0aXZlSWQpIDogdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbGVjdCB0aGUgc3RvcmUncyBlbnRpdHkgY29sbGVjdGlvbiBsZW5ndGguXG4gICAqL1xuICBzZWxlY3RDb3VudChwcmVkaWNhdGU/OiAoZW50aXR5OiBFLCBpbmRleDogbnVtYmVyKSA9PiBib29sZWFuKTogT2JzZXJ2YWJsZTxudW1iZXI+IHtcbiAgICBpZiAoaXNGdW5jdGlvbihwcmVkaWNhdGUpKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZWxlY3RBbGwoe1xuICAgICAgICBmaWx0ZXJCeTogcHJlZGljYXRlXG4gICAgICB9KS5waXBlKG1hcChlbnRpdGllcyA9PiBlbnRpdGllcy5sZW5ndGgpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5zZWxlY3Qoc3RvcmUgPT4gc3RvcmUuaWRzLmxlbmd0aCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBzdG9yZSdzIGVudGl0eSBjb2xsZWN0aW9uIGxlbmd0aC5cbiAgICovXG4gIGdldENvdW50KHByZWRpY2F0ZT86IChlbnRpdHk6IEUsIGluZGV4OiBudW1iZXIpID0+IGJvb2xlYW4pOiBudW1iZXIge1xuICAgIGlmIChpc0Z1bmN0aW9uKHByZWRpY2F0ZSkpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldEFsbCgpLmZpbHRlcihwcmVkaWNhdGUpLmxlbmd0aDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZ2V0U25hcHNob3QoKS5pZHMubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgd2hldGhlciBlbnRpdHkgZXhpc3RzLlxuICAgKi9cbiAgaGFzRW50aXR5KGlkOiBBY3RpdmVFbnRpdHkpOiBib29sZWFuO1xuICBoYXNFbnRpdHkoaWQ6IEFjdGl2ZUVudGl0eVtdKTogYm9vbGVhbjtcbiAgaGFzRW50aXR5KHByb2plY3Q6IChlbnRpdHk6IEUpID0+IGJvb2xlYW4pOiBib29sZWFuO1xuICBoYXNFbnRpdHkocHJvamVjdE9ySWRzOiBBY3RpdmVFbnRpdHkgfCBBY3RpdmVFbnRpdHlbXSB8ICgoZW50aXR5OiBFKSA9PiBib29sZWFuKSk6IGJvb2xlYW4ge1xuICAgIGlmIChpc0Z1bmN0aW9uKHByb2plY3RPcklkcykpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldEFsbCgpLnNvbWUocHJvamVjdE9ySWRzKTtcbiAgICB9XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9qZWN0T3JJZHMpKSB7XG4gICAgICByZXR1cm4gcHJvamVjdE9ySWRzLmV2ZXJ5KGlkID0+IChpZCBhcyBhbnkpIGluIHRoaXMuc3RvcmUuZW50aXRpZXMpO1xuICAgIH1cblxuICAgIHJldHVybiAocHJvamVjdE9ySWRzIGFzIGFueSkgaW4gdGhpcy5zdG9yZS5lbnRpdGllcztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHdoZXRoZXIgZW50aXR5IHN0b3JlIGhhcyBhbiBhY3RpdmUgZW50aXR5LlxuICAgKi9cbiAgaGFzQWN0aXZlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmdldFNuYXBzaG90KCkuYWN0aXZlICE9IG51bGw7XG4gIH1cblxuICBpc0VtcHR5KCkge1xuICAgIHJldHVybiB0aGlzLmdldFNuYXBzaG90KCkuaWRzLmxlbmd0aCA9PT0gMDtcbiAgfVxuXG4gIHByaXZhdGUgX2J5SWQoaWQ6IEFjdGl2ZUVudGl0eSk6IE9ic2VydmFibGU8RT4ge1xuICAgIHJldHVybiB0aGlzLnNlbGVjdChzdGF0ZSA9PiB0aGlzLmdldEVudGl0eShpZCkpO1xuICB9XG5cbiAgcHJpdmF0ZSBzb3J0QnlPcHRpb25zKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zLnNvcnRCeSA9IG9wdGlvbnMuc29ydEJ5IHx8ICh0aGlzLmNvbmZpZyAmJiAodGhpcy5jb25maWcuc29ydEJ5IGFzIFNvcnRCeTxFPikpO1xuICAgIG9wdGlvbnMuc29ydEJ5T3JkZXIgPSBvcHRpb25zLnNvcnRCeU9yZGVyIHx8ICh0aGlzLmNvbmZpZyAmJiB0aGlzLmNvbmZpZy5zb3J0QnlPcmRlcik7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLm1lbW9pemVkID0gbnVsbDtcbiAgfVxufVxuXG5mdW5jdGlvbiB0b0FycmF5PEUsIFMgZXh0ZW5kcyBFbnRpdHlTdGF0ZT4oc3RhdGU6IFMsIG9wdGlvbnM6IFNlbGVjdE9wdGlvbnM8RT4pOiBFW10ge1xuICBsZXQgYXJyID0gW107XG4gIGNvbnN0IHsgaWRzLCBlbnRpdGllcyB9ID0gc3RhdGU7XG4gIGNvbnN0IHsgZmlsdGVyQnksIGxpbWl0VG8sIHNvcnRCeSwgc29ydEJ5T3JkZXIgfSA9IG9wdGlvbnM7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBpZCA9IGlkc1tpXTtcblxuICAgIGlmICghZW50aXR5RXhpc3RzKGlkLCBlbnRpdGllcykpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmICghZmlsdGVyQnkpIHtcbiAgICAgIGFyci5wdXNoKGVudGl0aWVzW2lkXSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXJCeSkpIHtcbiAgICAgIGNvbnN0IGFsbFBhc3MgPSBmaWx0ZXJCeS5ldmVyeShmbiA9PiBmbihlbnRpdGllc1tpZF0sIGkpKTtcbiAgICAgIGlmIChhbGxQYXNzKSB7XG4gICAgICAgIGFyci5wdXNoKGVudGl0aWVzW2lkXSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChmaWx0ZXJCeShlbnRpdGllc1tpZF0sIGkpKSB7XG4gICAgICAgIGFyci5wdXNoKGVudGl0aWVzW2lkXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKHNvcnRCeSkge1xuICAgIGxldCBfc29ydEJ5OiBhbnkgPSBpc0Z1bmN0aW9uKHNvcnRCeSkgPyBzb3J0QnkgOiBjb21wYXJlVmFsdWVzKHNvcnRCeSwgc29ydEJ5T3JkZXIpO1xuICAgIGFyciA9IGFyci5zb3J0KChhLCBiKSA9PiBfc29ydEJ5KGEsIGIsIHN0YXRlKSk7XG4gIH1cbiAgY29uc3QgbGVuZ3RoID0gTWF0aC5taW4obGltaXRUbyB8fCBhcnIubGVuZ3RoLCBhcnIubGVuZ3RoKTtcblxuICByZXR1cm4gbGVuZ3RoID09PSBhcnIubGVuZ3RoID8gYXJyIDogYXJyLnNsaWNlKDAsIGxlbmd0aCk7XG59XG5cbmZ1bmN0aW9uIHRvTWFwPEU+KGlkczogYW55W10sIGVudGl0aWVzOiBIYXNoTWFwPEU+LCBvcHRpb25zOiBTZWxlY3RPcHRpb25zPEU+LCBnZXQgPSBmYWxzZSk6IEhhc2hNYXA8RT4ge1xuICBjb25zdCBtYXAgPSB7fTtcbiAgY29uc3QgeyBmaWx0ZXJCeSwgbGltaXRUbyB9ID0gb3B0aW9ucztcblxuICBpZiAoZ2V0ICYmICFmaWx0ZXJCeSAmJiAhbGltaXRUbykge1xuICAgIHJldHVybiBlbnRpdGllcztcbiAgfVxuXG4gIGNvbnN0IGxlbmd0aCA9IE1hdGgubWluKGxpbWl0VG8gfHwgaWRzLmxlbmd0aCwgaWRzLmxlbmd0aCk7XG5cbiAgaWYgKGZpbHRlckJ5ICYmIGlzVW5kZWZpbmVkKGxpbWl0VG8pID09PSBmYWxzZSkge1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IGlkcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGNvdW50ID09PSBsaW1pdFRvKSBicmVhaztcbiAgICAgIGNvbnN0IGlkID0gaWRzW2ldO1xuICAgICAgaWYgKCFlbnRpdHlFeGlzdHMoaWQsIGVudGl0aWVzKSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGZpbHRlckJ5KSkge1xuICAgICAgICBjb25zdCBhbGxQYXNzID0gZmlsdGVyQnkuZXZlcnkoZm4gPT4gZm4oZW50aXRpZXNbaWRdLCBpKSk7XG4gICAgICAgIGlmIChhbGxQYXNzKSB7XG4gICAgICAgICAgbWFwW2lkXSA9IGVudGl0aWVzW2lkXTtcbiAgICAgICAgICBjb3VudCsrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZmlsdGVyQnkoZW50aXRpZXNbaWRdLCBpKSkge1xuICAgICAgICAgIG1hcFtpZF0gPSBlbnRpdGllc1tpZF07XG4gICAgICAgICAgY291bnQrKztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBpZCA9IGlkc1tpXTtcblxuICAgICAgaWYgKCFlbnRpdHlFeGlzdHMoaWQsIGVudGl0aWVzKSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFmaWx0ZXJCeSkge1xuICAgICAgICBtYXBbaWRdID0gZW50aXRpZXNbaWRdO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZmlsdGVyQnkpKSB7XG4gICAgICAgIGNvbnN0IGFsbFBhc3MgPSBmaWx0ZXJCeS5ldmVyeShmbiA9PiBmbihlbnRpdGllc1tpZF0sIGkpKTtcbiAgICAgICAgaWYgKGFsbFBhc3MpIHtcbiAgICAgICAgICBtYXBbaWRdID0gZW50aXRpZXNbaWRdO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZmlsdGVyQnkoZW50aXRpZXNbaWRdLCBpKSkge1xuICAgICAgICAgIG1hcFtpZF0gPSBlbnRpdGllc1tpZF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWFwO1xufVxuIiwiaW1wb3J0IHsgZW5kQmF0Y2gsIHN0YXJ0QmF0Y2ggfSBmcm9tICcuLi9pbnRlcm5hbC90cmFuc2FjdGlvbi5pbnRlcm5hbCc7XG5cbi8qKlxuICogIEEgbG9naWNhbCB0cmFuc2FjdGlvbi5cbiAqICBVc2UgdGhpcyB0cmFuc2FjdGlvbiB0byBvcHRpbWl6ZSB0aGUgZGlzcGF0Y2ggb2YgYWxsIHRoZSBzdG9yZXMuXG4gKiAgVGhlIGZvbGxvd2luZyBjb2RlIHdpbGwgdXBkYXRlIHRoZSBzdG9yZSwgQlVUICBlbWl0cyBvbmx5IG9uY2VcbiAqXG4gKiAgQGV4YW1wbGVcbiAqICBhcHBseVRyYW5zYWN0aW9uKCgpID0+IHtcbiAqICAgIHRoaXMudG9kb3NTdG9yZS5hZGQobmV3IFRvZG8oMSwgdGl0bGUpKTtcbiAqICAgIHRoaXMudG9kb3NTdG9yZS5hZGQobmV3IFRvZG8oMiwgdGl0bGUpKTtcbiAqICB9KTtcbiAqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcHBseVRyYW5zYWN0aW9uPFQ+KGFjdGlvbjogKCkgPT4gVCwgdGhpc0FyZyA9IHVuZGVmaW5lZCk6IFQge1xuICBzdGFydEJhdGNoKCk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGFjdGlvbi5hcHBseSh0aGlzQXJnKTtcbiAgfSBmaW5hbGx5IHtcbiAgICBlbmRCYXRjaCgpO1xuICB9XG59XG5cbi8qKlxuICogIEEgbG9naWNhbCB0cmFuc2FjdGlvbi5cbiAqICBVc2UgdGhpcyB0cmFuc2FjdGlvbiB0byBvcHRpbWl6ZSB0aGUgZGlzcGF0Y2ggb2YgYWxsIHRoZSBzdG9yZXMuXG4gKlxuICogIFRoZSBmb2xsb3dpbmcgY29kZSB3aWxsIHVwZGF0ZSB0aGUgc3RvcmUsIEJVVCAgZW1pdHMgb25seSBvbmNlLlxuICpcbiAqICBAZXhhbXBsZVxuICogIEB0cmFuc2FjdGlvblxuICogIGFkZFRvZG9zKCkge1xuICogICAgdGhpcy50b2Rvc1N0b3JlLmFkZChuZXcgVG9kbygxLCB0aXRsZSkpO1xuICogICAgdGhpcy50b2Rvc1N0b3JlLmFkZChuZXcgVG9kbygyLCB0aXRsZSkpO1xuICogIH1cbiAqXG4gKlxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJhbnNhY3Rpb24oKSB7XG4gIHJldHVybiBmdW5jdGlvbih0YXJnZXQ6IGFueSwgcHJvcGVydHlLZXk6IHN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XG4gICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuXG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICAgIHJldHVybiBhcHBseVRyYW5zYWN0aW9uKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIG9yaWdpbmFsTWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfTtcblxuICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICB9O1xufVxuIiwiaW1wb3J0IHsgaXNPYmplY3QgfSBmcm9tICcuLi9pbnRlcm5hbC91dGlscyc7XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nZW9yYXBib3gvaW1tdXRhYmxlLWFycmF5c1xuXG4vKipcbiAqIEFkZHMgb25lIG9yIG1vcmUgZWxlbWVudHMgdG8gdGhlIGVuZCBvZiBhbiBhcnJheSBieSByZXR1cm5pbmdcbiAqIGEgbmV3IGFycmF5IGluc3RlYWQgb2YgbXV0YXRpbmcgdGhlIG9yaWdpbmFsIG9uZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHB1c2gob3JpZ2luYWxBcnJheSwgJ2YnLCAnZycpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZScsICdmJywgJ2cnXVxuICovXG5leHBvcnQgZnVuY3Rpb24gcHVzaDxUPihhcnJheTogVFtdLCAuLi5lbGVtZW50TjogVFtdKTogVFtdIHtcbiAgcmV0dXJuIFsuLi5hcnJheSwgLi4uZWxlbWVudE5dO1xufVxuXG4vKipcbiAqIERlbGV0ZXMgYW4gZWxlbWVudCBmcm9tIGFuIGFycmF5IGJ5IGl0cyBpbmRleCBpbiB0aGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGNvbnN0IG9yaWdpbmFsQXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSByZW1vdmUob3JpZ2luYWxBcnJheSwgMik7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnYScsICdiJywgJ2QnLCAnZSddXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmU8VD4oYXJyYXk6IFRbXSwgaW5kZXg6IG51bWJlcik6IFRbXSB7XG4gIHJldHVybiBpbmRleCA+PSAwID8gWy4uLmFycmF5LnNsaWNlKDAsIGluZGV4KSwgLi4uYXJyYXkuc2xpY2UoaW5kZXggKyAxKV0gOiBbLi4uYXJyYXldO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgdGhlIGxhc3QgZWxlbWVudCBmcm9tIGFuIGFycmF5IGJ5IHJldHVybmluZ1xuICogYSBuZXcgYXJyYXkgaW5zdGVhZCBvZiBtdXRhdGluZyB0aGUgb3JpZ2luYWwgb25lLlxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gcG9wKG9yaWdpbmFsQXJyYXkpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnXVxuICovXG5leHBvcnQgZnVuY3Rpb24gcG9wPFQ+KGFycmF5OiBUW10pOiBUW10ge1xuICByZXR1cm4gYXJyYXkuc2xpY2UoMCwgLTEpO1xufVxuXG4vKipcbiAqIEFkZHMgb25lIG9yIG1vcmUgZWxlbWVudHMgdG8gdGhlIGJlZ2lubmluZyBvZiBhbiBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHVuc2hpZnQob3JpZ2luYWxBcnJheSwgJ2YnLCAnZycpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2YnLCAnZycsICdhJywgJ2InLCAnYycsICdkJywgJ2UnXVxuICovXG5leHBvcnQgZnVuY3Rpb24gdW5zaGlmdDxUPihhcnJheTogVFtdLCAuLi5lbGVtZW50TjogVFtdKTogVFtdIHtcbiAgcmV0dXJuIFsuLi5lbGVtZW50TiwgLi4uYXJyYXldO1xufVxuXG4vKipcbiAqIFNvcnRzIHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSAobm90IGluIHBsYWNlKSBhbmQgcmV0dXJucyBhIHNvcnRlZCBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3QgbnVtYmVyQXJyYXkgPSBbMjAsIDMsIDQsIDEwLCAtMywgMSwgMCwgNV07XG4gKiBjb25zdCBzdHJpbmdBcnJheSA9IFsnQmx1ZScsICdIdW1wYmFjaycsICdCZWx1Z2EnXTtcbiAqXG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNvcnQobnVtYmVyQXJyYXksIChhLCBiKSA9PiBhIC0gYik7XG4gKiAvLyAtPiBudW1iZXJBcnJheSBbMjAsIDMsIDQsIDEwLCAtMywgMSwgMCwgNV1cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFstMywgMCwgMSwgMywgNCwgNSwgMTAsIDIwXVxuICpcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gc29ydChudW1iZXJBcnJheSwgKGEsIGIpID0+IGIgLSBhKTtcbiAqIC8vIC0+IG51bWJlckFycmF5IFsyMCwgMywgNCwgMTAsIC0zLCAxLCAwLCA1XVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWzIwLCAxMCwgNSwgNCwgMywgMSwgMCwgLTNdXG4gKlxuICogY29uc3QgcmVzdWx0QXJyYXkgPSBzb3J0KHN0cmluZ0FycmF5KTtcbiAqIC8vIC0+IHN0cmluZ0FycmF5IFsnQmx1ZScsICdIdW1wYmFjaycsICdCZWx1Z2EnXVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWydCZWx1Z2EnLCAnQmx1ZScsICdIdW1wYmFjayddXG4gKlxuICogY29uc3QgcmVzdWx0QXJyYXkgPSBzb3J0KHN0cmluZ0FycmF5LCAoYSwgYikgPT4gYS50b0xvd2VyQ2FzZSgpIDwgYi50b0xvd2VyQ2FzZSgpKTtcbiAqIC8vIC0+IHN0cmluZ0FycmF5IFsnQmx1ZScsICdIdW1wYmFjaycsICdCZWx1Z2EnXVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWydIdW1wYmFjaycsICdCbHVlJywgJ0JlbHVnYSddXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzb3J0PFQ+KGFycmF5OiBUW10sIGNvbXBhcmVGdW5jdGlvbj86IChhOiBULCBiOiBUKSA9PiBudW1iZXIpOiBUW10ge1xuICByZXR1cm4gWy4uLmFycmF5XS5zb3J0KGNvbXBhcmVGdW5jdGlvbik7XG59XG5cbi8qKlxuICogUmV2ZXJzZXMgYW4gYXJyYXkgKG5vdCBpbiBwbGFjZSkuXG4gKiBUaGUgZmlyc3QgYXJyYXkgZWxlbWVudCBiZWNvbWVzIHRoZSBsYXN0LCBhbmQgdGhlIGxhc3QgYXJyYXkgZWxlbWVudCBiZWNvbWVzIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHJldmVyc2Uob3JpZ2luYWxBcnJheSk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnZScsICdkJywgJ2MnLCAnYicsICdhJ11cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJldmVyc2U8VD4oYXJyYXk6IFRbXSk6IFRbXSB7XG4gIHJldHVybiBbLi4uYXJyYXldLnJldmVyc2UoKTtcbn1cblxuLyoqXG4gKiBTd2FwIGl0ZW1zIGluIHRoZSBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gc3dhcChvcmlnaW5hbEFycmF5LCAxLCA0KTtcbiAqIC8vIC0+IG9yaWdpbmFsQXJyYXkgWydhJywgJ2InLCAnYycsICdkJywgJ2UnXVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWydhJywgJ2UnLCAnYycsICdkJywgJ2InXVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3dhcDxUPihhcnJheTogVFtdLCBmaXJzdEluZGV4OiBudW1iZXIsIHNlY29uZEluZGV4OiBudW1iZXIpOiBUW10ge1xuICBjb25zdCByZXN1bHRzID0gYXJyYXkuc2xpY2UoKTtcbiAgY29uc3QgZmlyc3RJdGVtID0gYXJyYXlbZmlyc3RJbmRleF07XG4gIHJlc3VsdHNbZmlyc3RJbmRleF0gPSBhcnJheVtzZWNvbmRJbmRleF07XG4gIHJlc3VsdHNbc2Vjb25kSW5kZXhdID0gZmlyc3RJdGVtO1xuXG4gIHJldHVybiByZXN1bHRzO1xufVxuXG4vKipcbiAqIFVwZGF0ZSBpdGVtIGluIHRoZSBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gdXBkYXRlKG9yaWdpbmFsQXJyYXksIDEsICduZXdJdGVtJyk7XG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2EnLCAnbmV3SXRlbScsICdjJywgJ2QnLCAnYiddXG4gKlxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFt7dGl0bGU6IDF9LCB7dGl0bGU6IDJ9XTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gdXBkYXRlKG9yaWdpbmFsQXJyYXksIG9yaWdpbmFsQXJyYXlbMF0sIHt0aXRsZTogM30pO1xuICogLy8gLT4gcmVzdWx0QXJyYXkgIFt7dGl0bGU6IDN9LCB7dGl0bGU6IDJ9XTtcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZTxUPihhcnJheTogVFtdLCBpbmRleE9ySXRlbTogbnVtYmVyIHwgb2JqZWN0LCB1cGRhdGVkOiBUKTogVFtdIHtcbiAgcmV0dXJuIGFycmF5Lm1hcCgoY3VycmVudCwgaWR4KSA9PiB7XG4gICAgaWYgKHR5cGVvZiBpbmRleE9ySXRlbSA9PT0gJ251bWJlcicgJiYgaWR4ID09PSBpbmRleE9ySXRlbSkge1xuICAgICAgcmV0dXJuIHVwZGF0ZWQ7XG4gICAgfVxuXG4gICAgaWYgKGlzT2JqZWN0KGluZGV4T3JJdGVtKSAmJiAoaW5kZXhPckl0ZW0gYXMgYW55KSA9PT0gY3VycmVudCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uKGluZGV4T3JJdGVtIGFzIG9iamVjdCksXG4gICAgICAgIC4uLih1cGRhdGVkIGFzIGFueSlcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIGN1cnJlbnQ7XG4gIH0pO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgZXhpc3RpbmcgZWxlbWVudHMgYW5kL29yIGFkZHMgbmV3IGVsZW1lbnRzIHRvIGFuIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBvcmlnaW5hbEFycmF5ID0gWydhJywgJ2InLCAnYycsICdkJywgJ2UnXTtcbiAqIGNvbnN0IHJlc3VsdEFycmF5ID0gc3BsaWNlKG9yaWdpbmFsQXJyYXksIDApO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbXVxuICpcbiAqIGNvbnN0IG9yaWdpbmFsQXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSBzcGxpY2Uob3JpZ2luYWxBcnJheSwgMCwgMSk7XG4gKiAvLyAtPiBvcmlnaW5hbEFycmF5IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ11cbiAqIC8vIC0+IHJlc3VsdEFycmF5IFsnYicsICdjJywgJ2QnLCAnZSddXG4gKlxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNwbGljZShvcmlnaW5hbEFycmF5LCAwLCAzKTtcbiAqIC8vIC0+IG9yaWdpbmFsQXJyYXkgWydhJywgJ2InLCAnYycsICdkJywgJ2UnXVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWydkJywgJ2UnXVxuICpcbiAqIGNvbnN0IG9yaWdpbmFsQXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSBzcGxpY2Uob3JpZ2luYWxBcnJheSwgMCwgb3JpZ2luYWxBcnJheS5sZW5ndGgpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbXVxuICpcbiAqIGNvbnN0IG9yaWdpbmFsQXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSBzcGxpY2Uob3JpZ2luYWxBcnJheSwgMCwgLTMpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKlxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNwbGljZShvcmlnaW5hbEFycmF5LCAwLCAwLCAnbG9yZW0nLCAnaXBzdW0nKTtcbiAqIC8vIC0+IG9yaWdpbmFsQXJyYXkgWydhJywgJ2InLCAnYycsICdkJywgJ2UnXVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWydsb3JlbScsICdpcHN1bScsICdhJywgJ2InLCAnYycsICdkJywgJ2UnXVxuICpcbiAqIGNvbnN0IG9yaWdpbmFsQXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddO1xuICogY29uc3QgcmVzdWx0QXJyYXkgPSBzcGxpY2Uob3JpZ2luYWxBcnJheSwgb3JpZ2luYWxBcnJheS5sZW5ndGgsIDAsICdsb3JlbScsICdpcHN1bScpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZScsICdsb3JlbScsICdpcHN1bSddXG4gKlxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNwbGljZShvcmlnaW5hbEFycmF5LCAwLCAyLCAnbG9yZW0nLCAnaXBzdW0nKTtcbiAqIC8vIC0+IG9yaWdpbmFsQXJyYXkgWydhJywgJ2InLCAnYycsICdkJywgJ2UnXVxuICogLy8gLT4gcmVzdWx0QXJyYXkgWydsb3JlbScsICdpcHN1bScsICdjJywgJ2QnLCAnZSddXG4gKlxuICogY29uc3Qgb3JpZ2luYWxBcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJ107XG4gKiBjb25zdCByZXN1bHRBcnJheSA9IHNwbGljZShvcmlnaW5hbEFycmF5LCBvcmlnaW5hbEFycmF5Lmxlbmd0aCAtIDIsIDIsICdsb3JlbScsICdpcHN1bScpO1xuICogLy8gLT4gb3JpZ2luYWxBcnJheSBbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddXG4gKiAvLyAtPiByZXN1bHRBcnJheSBbJ2EnLCAnYicsICdjJywgJ2xvcmVtJywgJ2lwc3VtJ11cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNwbGljZTxUPihhcnJheTogVFtdLCBzdGFydCA9IGFycmF5Lmxlbmd0aCwgZGVsZXRlQ291bnQgPSBhcnJheS5sZW5ndGggLSBzdGFydCwgLi4uZWxlbWVudE46IFRbXSk6IFRbXSB7XG4gIHJldHVybiBbLi4uYXJyYXkuc2xpY2UoMCwgc3RhcnQpLCAuLi5lbGVtZW50TiwgLi4uYXJyYXkuc2xpY2Uoc3RhcnQgKyAoZGVsZXRlQ291bnQgPCAwID8gMCA6IGRlbGV0ZUNvdW50KSldO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlPFQ+KGFycjogVFtdLCBpdGVtOiBUKSB7XG4gIHJldHVybiBhcnIuaW5kZXhPZihpdGVtKSA+IC0xID8gYXJyLmZpbHRlcihjdXJyZW50ID0+IGl0ZW0gIT09IGN1cnJlbnQpIDogcHVzaChhcnIsIGl0ZW0pO1xufVxuIiwiLyoqIENoZWNrcyBpZiB2YWx1ZSBpcyBudWxsIG9yIHVuZGVmaW5lZCAqL1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5leHBvcnQgY29uc3QgZmlsdGVyTmlsID0gPFQ+KHNvdXJjZTogT2JzZXJ2YWJsZTxUPikgPT4gc291cmNlLnBpcGUoZmlsdGVyKHZhbHVlID0+IHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpKTtcbiIsImltcG9ydCB7IEFjdGlvbiwgX19nbG9iYWxTdGF0ZSB9IGZyb20gJy4vZ2xvYmFsLXN0YXRlJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5QWN0aW9uPFQ+KGZ1bmM6ICgpID0+IFQsIGFjdGlvbjogQWN0aW9uLCB0aGlzQXJnID0gdW5kZWZpbmVkKTogVCB7XG4gIF9fZ2xvYmFsU3RhdGUuc2V0Q3VzdG9tQWN0aW9uKGFjdGlvbiwgdHJ1ZSk7XG4gIHJldHVybiBmdW5jLmFwcGx5KHRoaXNBcmcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWN0aW9uKGFjdGlvbjogQWN0aW9uLCBza2lwVHJhbnNhY3Rpb25Nc2cgPSB0cnVlKSB7XG4gIHJldHVybiBmdW5jdGlvbih0YXJnZXQ6IGFueSwgcHJvcGVydHlLZXk6IHN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XG4gICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgIGRlc2NyaXB0b3IudmFsdWUgPSBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgICBfX2dsb2JhbFN0YXRlLnNldEN1c3RvbUFjdGlvbihhY3Rpb24sIHNraXBUcmFuc2FjdGlvbk1zZyk7XG4gICAgICByZXR1cm4gb3JpZ2luYWxNZXRob2QuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfTtcblxuICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICB9O1xufVxuIiwiaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuXG5mdW5jdGlvbiBzZXJpYWxpemUob2JqZWN0KSB7XG4gIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmplY3QsIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlV29ya2VyKCkge1xuICBjb25zdCBibG9iID0gbmV3IEJsb2IoXG4gICAgW1xuICAgICAgYHNlbGYub25tZXNzYWdlID0gZnVuY3Rpb24oZSkge1xuXG4gICAgICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShzdHIpIHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyIHx8ICcnLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XG4gICAgICAgICAgaWYgKHZhbHVlICYmXG4gICAgICAgICAgICB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgICAgIHZhbHVlLnN1YnN0cigwLCA4KSA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHZhciBzdGFydEJvZHkgPSB2YWx1ZS5pbmRleE9mKCd7JykgKyAxO1xuICAgICAgICAgICAgdmFyIGVuZEJvZHkgPSB2YWx1ZS5sYXN0SW5kZXhPZignfScpO1xuICAgICAgICAgICAgdmFyIHN0YXJ0QXJncyA9IHZhbHVlLmluZGV4T2YoJygnKSArIDE7XG4gICAgICAgICAgICB2YXIgZW5kQXJncyA9IHZhbHVlLmluZGV4T2YoJyknKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24odmFsdWUuc3Vic3RyaW5nKHN0YXJ0QXJncywgZW5kQXJncyksIHZhbHVlLnN1YnN0cmluZyhzdGFydEJvZHksIGVuZEJvZHkpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdmFyIGRlc2VyaWFsaXplZCA9IGRlc2VyaWFsaXplKGUuZGF0YSk7XG4gICAgICB2YXIgbWFwcGVkID0gZGVzZXJpYWxpemVkLmRhdGEubWFwKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgcmV0dXJuIGRlc2VyaWFsaXplZC5mYWN0b3J5KGQpO1xuICAgICAgfSk7XG5cbiAgICAgIHNlbGYucG9zdE1lc3NhZ2UobWFwcGVkKTtcbiAgICB9YFxuICAgIF0sXG4gICAge1xuICAgICAgdHlwZTogJ3RleHQvamF2YXNjcmlwdCdcbiAgICB9XG4gICk7XG5cbiAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgcmV0dXJuIG5ldyBXb3JrZXIodXJsKTtcbn1cblxuLyoqXG4gKiAgQGV4YW1wbGVcbiAqICAgY29uc3QgbW9ja1RvZG9zID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiAxMDAwMH0sIChfLCB4KSA9PiAoe2lkOiB4fSkpO1xuICpcbiAqICAgb2YobW9ja1RvZG9zKS5waXBlKG1hcEluV29ya2VyPFRvZG8+KGNyZWF0ZVRvZG8pKVxuICogICAuc3Vic2NyaWJlKHJlcyA9PiBjb25zb2xlLmxvZyhyZXMpKTtcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcEluV29ya2VyPFQ+KGZhY3RvcnlGbjogRnVuY3Rpb24pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHNvdXJjZSk6IE9ic2VydmFibGU8VFtdPiB7XG4gICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKG9ic2VydmVyID0+IHtcbiAgICAgIGNvbnN0IHdvcmtlciA9IGNyZWF0ZVdvcmtlcigpO1xuXG4gICAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24oZSkge1xuICAgICAgICBvYnNlcnZlci5uZXh0KGUuZGF0YSk7XG4gICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgIHdvcmtlci50ZXJtaW5hdGUoKTtcbiAgICAgIH07XG5cbiAgICAgIHdvcmtlci5vbmVycm9yID0gZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgIG9ic2VydmVyLmVycm9yKGVycik7XG4gICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgIHdvcmtlci50ZXJtaW5hdGUoKTtcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKHZhbHVlID0+IHtcbiAgICAgICAgY29uc3QgaW5wdXQgPSB7XG4gICAgICAgICAgZmFjdG9yeTogZmFjdG9yeUZuLFxuICAgICAgICAgIGRhdGE6IHZhbHVlXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHNlcmlhbGl6ZWQgPSBzZXJpYWxpemUoaW5wdXQpO1xuXG4gICAgICAgIHdvcmtlci5wb3N0TWVzc2FnZShzZXJpYWxpemVkKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xufVxuIiwiaW1wb3J0IHsgX19zdG9yZXNfXyB9IGZyb20gJy4vc3RvcmUnO1xuaW1wb3J0IHsgaXNTdHJpbmcgfSBmcm9tICcuLi9pbnRlcm5hbC91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBTbmFwc2hvdE1hbmFnZXIge1xuICAvKipcbiAgICogR2V0IGEgc25hcHNob3Qgb2YgdGhlIHdob2xlIHN0YXRlIG9yIGEgc3BlY2lmaWMgc3RvcmVzXG4gICAqIFVzZSBpdCBPTkxZIGZvciB0aGluZ3MgbGlrZSBzYXZpbmcgdGhlIHN0YXRlIGluIHRoZSBzZXJ2ZXJcbiAgICovXG4gIGdldFN0b3Jlc1NuYXBzaG90KHN0b3Jlczogc3RyaW5nW10gPSBbXSkge1xuICAgIGxldCBhY2MgPSB7fTtcbiAgICBjb25zdCBoYXNJbmNsdWRlID0gc3RvcmVzLmxlbmd0aCA+IDA7XG4gICAgY29uc3Qga2V5cyA9IGhhc0luY2x1ZGUgPyBzdG9yZXMgOiBPYmplY3Qua2V5cyhfX3N0b3Jlc19fKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBzdG9yZU5hbWUgPSBrZXlzW2ldO1xuICAgICAgYWNjW3N0b3JlTmFtZV0gPSBfX3N0b3Jlc19fW3N0b3JlTmFtZV0uX3ZhbHVlKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFjYztcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgc25hcHNob3Qgd2UgZ2V0IGZyb20gdGhlIHNlcnZlclxuICAgKi9cbiAgc2V0U3RvcmVzU25hcHNob3Qoc3RvcmVzOiB7IFtzdG9yZU5hbWU6IHN0cmluZ106IGFueSB9IHwgc3RyaW5nKSB7XG4gICAgbGV0IG5vcm1hbGl6ZWRTdG9yZXMgPSBzdG9yZXM7XG4gICAgaWYgKGlzU3RyaW5nKHN0b3JlcykpIHtcbiAgICAgIG5vcm1hbGl6ZWRTdG9yZXMgPSBKU09OLnBhcnNlKG5vcm1hbGl6ZWRTdG9yZXMgYXMgc3RyaW5nKTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gMCwga2V5cyA9IE9iamVjdC5rZXlzKG5vcm1hbGl6ZWRTdG9yZXMpOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgc3RvcmVOYW1lID0ga2V5c1tpXTtcbiAgICAgIGlmIChfX3N0b3Jlc19fW3N0b3JlTmFtZV0pIHtcbiAgICAgICAgX19zdG9yZXNfX1tzdG9yZU5hbWVdLnNldFN0YXRlKCgpID0+IG5vcm1hbGl6ZWRTdG9yZXNbc3RvcmVOYW1lXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBzbmFwc2hvdE1hbmFnZXIgPSBuZXcgU25hcHNob3RNYW5hZ2VyKCk7XG4iLCJpbXBvcnQgeyBRdWVyeUVudGl0eSB9IGZyb20gJy4uL2FwaS9xdWVyeS1lbnRpdHknO1xuaW1wb3J0IHsgUXVlcnkgfSBmcm9tICcuLi9hcGkvcXVlcnknO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyTmlsIH0gZnJvbSAnLi4vYXBpL29wZXJhdG9ycyc7XG5pbXBvcnQgeyB0b0Jvb2xlYW4gfSBmcm9tICcuLi9pbnRlcm5hbC91dGlscyc7XG5pbXBvcnQgeyBJRCB9IGZyb20gJy4uL2FwaS90eXBlcyc7XG5pbXBvcnQgeyBnZXRBa2l0YUNvbmZpZyB9IGZyb20gJy4uL2FwaS9jb25maWcnO1xuXG5leHBvcnQgdHlwZSBRdWVyaWVzPEUsIFM+ID0gUXVlcnk8Uz4gfCBRdWVyeUVudGl0eTxTLCBFPjtcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFraXRhUGx1Z2luPEUgPSBhbnksIFMgPSBhbnk+IHtcbiAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBxdWVyeTogUXVlcmllczxFLCBTPiwgY29uZmlnPzogeyByZXNldEZuPzogRnVuY3Rpb24gfSkge1xuICAgIGlmIChjb25maWcgJiYgY29uZmlnLnJlc2V0Rm4pIHtcbiAgICAgIGlmIChnZXRBa2l0YUNvbmZpZygpLnJlc2V0dGFibGUpIHtcbiAgICAgICAgdGhpcy5vblJlc2V0KGNvbmZpZy5yZXNldEZuKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKiogVGhpcyBtZXRob2QgaXMgcmVzcG9uc2libGUgZm9yIGdldHRpbmcgYWNjZXNzIHRvIHRoZSBxdWVyeS4gKi9cbiAgcHJvdGVjdGVkIGdldFF1ZXJ5KCk6IFF1ZXJpZXM8RSwgUz4ge1xuICAgIHJldHVybiB0aGlzLnF1ZXJ5O1xuICB9XG5cbiAgLyoqIFRoaXMgbWV0aG9kIGlzIHJlc3BvbnNpYmxlIGZvciBnZXR0aW5nIGFjY2VzcyB0byB0aGUgc3RvcmUuICovXG4gIHByb3RlY3RlZCBnZXRTdG9yZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRRdWVyeSgpLl9fc3RvcmVfXztcbiAgfVxuXG4gIC8qKiBUaGlzIG1ldGhvZCBpcyByZXNwb25zaWJsZSBmb3IgY2xlYW5pbmcuICovXG4gIHB1YmxpYyBhYnN0cmFjdCBkZXN0cm95KCk7XG5cbiAgLyoqIFRoaXMgbWV0aG9kIGlzIHJlc3BvbnNpYmxlIHRlbGxzIHdoZXRoZXIgdGhlIHBsdWdpbiBpcyBlbnRpdHlCYXNlZCBvciBub3QuICAqL1xuICBwcm90ZWN0ZWQgaXNFbnRpdHlCYXNlZChlbnRpdHlJZDogSUQpIHtcbiAgICByZXR1cm4gdG9Cb29sZWFuKGVudGl0eUlkKTtcbiAgfVxuXG4gIC8qKiBUaGlzIG1ldGhvZCBpcyByZXNwb25zaWJsZSBmb3Igc2VsZWN0aW5nIHRoZSBzb3VyY2U7IGl0IGNhbiBiZSB0aGUgd2hvbGUgc3RvcmUgb3Igb25lIGVudGl0eS4gKi9cbiAgcHJvdGVjdGVkIHNlbGVjdFNvdXJjZShlbnRpdHlJZDogSUQpOiBPYnNlcnZhYmxlPFMgfCBFPiB7XG4gICAgaWYgKHRoaXMuaXNFbnRpdHlCYXNlZChlbnRpdHlJZCkpIHtcbiAgICAgIHJldHVybiAodGhpcy5nZXRRdWVyeSgpIGFzIFF1ZXJ5RW50aXR5PFMsIEU+KS5zZWxlY3RFbnRpdHkoZW50aXR5SWQpLnBpcGUoZmlsdGVyTmlsKTtcbiAgICB9XG5cbiAgICByZXR1cm4gKHRoaXMuZ2V0UXVlcnkoKSBhcyBRdWVyeTxTPikuc2VsZWN0KHN0YXRlID0+IHN0YXRlKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBnZXRTb3VyY2UoZW50aXR5SWQ6IElEKTogUyB8IEUge1xuICAgIGlmICh0aGlzLmlzRW50aXR5QmFzZWQoZW50aXR5SWQpKSB7XG4gICAgICByZXR1cm4gKHRoaXMuZ2V0UXVlcnkoKSBhcyBRdWVyeUVudGl0eTxTLCBFPikuZ2V0RW50aXR5KGVudGl0eUlkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5nZXRRdWVyeSgpLmdldFNuYXBzaG90KCk7XG4gIH1cblxuICAvKiogVGhpcyBtZXRob2QgaXMgcmVzcG9uc2libGUgZm9yIHVwZGF0aW5nIHRoZSBzdG9yZSBvciBvbmUgZW50aXR5OyBpdCBjYW4gYmUgdGhlIHdob2xlIHN0b3JlIG9yIG9uZSBlbnRpdHkuICovXG4gIHByb3RlY3RlZCB1cGRhdGVTdG9yZShuZXdTdGF0ZSwgZW50aXR5SWQ/KSB7XG4gICAgaWYgKHRoaXMuaXNFbnRpdHlCYXNlZChlbnRpdHlJZCkpIHtcbiAgICAgIHRoaXMuZ2V0U3RvcmUoKS51cGRhdGUoZW50aXR5SWQsIG5ld1N0YXRlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5nZXRTdG9yZSgpLnNldFN0YXRlKHN0YXRlID0+ICh7IC4uLnN0YXRlLCAuLi5uZXdTdGF0ZSB9KSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZ1bmN0aW9uIHRvIGludm9rZSB1cG9uIHJlc2V0XG4gICAqL1xuICBwcml2YXRlIG9uUmVzZXQoZm46IEZ1bmN0aW9uKSB7XG4gICAgY29uc3Qgb3JpZ2luYWwgPSB0aGlzLmdldFN0b3JlKCkucmVzZXQ7XG4gICAgdGhpcy5nZXRTdG9yZSgpLnJlc2V0ID0gKC4uLnBhcmFtcykgPT4ge1xuICAgICAgLyoqIEl0IHNob3VsZCBydW4gYWZ0ZXIgdGhlIHBsdWdpbiBkZXN0cm95IG1ldGhvZCAqL1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIG9yaWdpbmFsLmFwcGx5KHRoaXMuZ2V0U3RvcmUoKSwgcGFyYW1zKTtcbiAgICAgICAgZm4oKTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH1cbn1cbiIsImltcG9ydCB7IFF1ZXJ5RW50aXR5IH0gZnJvbSAnLi4vLi4vYXBpL3F1ZXJ5LWVudGl0eSc7XG5pbXBvcnQgeyBkZWxheSwgbWFwLCBzd2l0Y2hNYXAsIHRha2UgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIGZyb20sIE9ic2VydmFibGUsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgaXNPYnNlcnZhYmxlLCBpc1VuZGVmaW5lZCB9IGZyb20gJy4uLy4uL2ludGVybmFsL3V0aWxzJztcbmltcG9ydCB7IElEIH0gZnJvbSAnLi4vLi4vYXBpL3R5cGVzJztcbmltcG9ydCB7IEFraXRhUGx1Z2luIH0gZnJvbSAnLi4vcGx1Z2luJztcbmltcG9ydCB7IGFwcGx5VHJhbnNhY3Rpb24gfSBmcm9tICcuLi8uLi9hcGkvdHJhbnNhY3Rpb24nO1xuaW1wb3J0IHsgYWN0aW9uLCBhcHBseUFjdGlvbiB9IGZyb20gJy4uLy4uL2ludGVybmFsL2FjdGlvbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFnaW5hdGlvblJlc3BvbnNlPEU+IHtcbiAgY3VycmVudFBhZ2U6IG51bWJlcjtcbiAgcGVyUGFnZTogbnVtYmVyO1xuICBsYXN0UGFnZTogbnVtYmVyO1xuICBkYXRhOiBFW107XG4gIHRvdGFsPzogbnVtYmVyO1xuICBmcm9tPzogbnVtYmVyO1xuICB0bz86IG51bWJlcjtcbiAgcGFnZUNvbnRyb2xzPzogbnVtYmVyW107XG59XG5cbmV4cG9ydCB0eXBlIFBhZ2luYXRvckNvbmZpZyA9IHtcbiAgcGFnZXNDb250cm9scz86IGJvb2xlYW47XG4gIHJhbmdlPzogYm9vbGVhbjtcbiAgc3RhcnRXaXRoPzogbnVtYmVyO1xuICBjYWNoZVRpbWVvdXQ/OiBPYnNlcnZhYmxlPG51bWJlcj47XG59O1xuXG5jb25zdCBwYWdpbmF0b3JEZWZhdWx0czogUGFnaW5hdG9yQ29uZmlnID0ge1xuICBwYWdlc0NvbnRyb2xzOiBmYWxzZSxcbiAgcmFuZ2U6IGZhbHNlLFxuICBzdGFydFdpdGg6IDEsXG4gIGNhY2hlVGltZW91dDogdW5kZWZpbmVkXG59O1xuXG5leHBvcnQgY2xhc3MgUGFnaW5hdG9yUGx1Z2luPEU+IGV4dGVuZHMgQWtpdGFQbHVnaW48RT4ge1xuICAvKiogU2F2ZSBjdXJyZW50IGZpbHRlcnMsIHNvcnRpbmcsIGV0Yy4gaW4gY2FjaGUgKi9cbiAgbWV0YWRhdGEgPSBuZXcgTWFwKCk7XG5cbiAgcHJpdmF0ZSBwYWdlOiBCZWhhdmlvclN1YmplY3Q8bnVtYmVyPjtcbiAgcHJpdmF0ZSBwYWdlcyA9IG5ldyBNYXA8bnVtYmVyLCB7IGlkczogSURbXSB9PigpO1xuICBwcml2YXRlIHJlYWRvbmx5IGNsZWFyQ2FjaGVTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcblxuICBwcml2YXRlIHBhZ2luYXRpb246IFBhZ2luYXRpb25SZXNwb25zZTxFPiA9IHtcbiAgICBjdXJyZW50UGFnZTogMSxcbiAgICBwZXJQYWdlOiAwLFxuICAgIHRvdGFsOiAwLFxuICAgIGxhc3RQYWdlOiAwLFxuICAgIGRhdGE6IFtdXG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIHVzZXIgbmF2aWdhdGVzIHRvIGEgZGlmZmVyZW50IHBhZ2UgYW5kIHJldHVyblxuICAgKiB3ZSBkb24ndCB3YW50IHRvIGNhbGwgYGNsZWFyQ2FjaGVgIG9uIGZpcnN0IHRpbWUuXG4gICAqL1xuICBwcml2YXRlIGluaXRpYWwgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgcXVlcnk6IFF1ZXJ5RW50aXR5PGFueSwgRT4sIHB1YmxpYyBjb25maWc6IFBhZ2luYXRvckNvbmZpZyA9IHt9KSB7XG4gICAgc3VwZXIocXVlcnksIHtcbiAgICAgIHJlc2V0Rm46ICgpID0+IHtcbiAgICAgICAgdGhpcy5pbml0aWFsID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZGVzdHJveSh7IGNsZWFyQ2FjaGU6IHRydWUsIGN1cnJlbnRQYWdlOiAxIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuY29uZmlnID0gT2JqZWN0LmFzc2lnbihwYWdpbmF0b3JEZWZhdWx0cywgY29uZmlnKTtcbiAgICBjb25zdCB7IHN0YXJ0V2l0aCwgY2FjaGVUaW1lb3V0IH0gPSB0aGlzLmNvbmZpZztcbiAgICB0aGlzLnBhZ2UgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KHN0YXJ0V2l0aCk7XG4gICAgaWYgKGlzT2JzZXJ2YWJsZShjYWNoZVRpbWVvdXQpKSB7XG4gICAgICB0aGlzLmNsZWFyQ2FjaGVTdWJzY3JpcHRpb24gPSBjYWNoZVRpbWVvdXQuc3Vic2NyaWJlKF8gPT4gdGhpcy5jbGVhckNhY2hlKCkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQcm94eSB0byB0aGUgcXVlcnkgbG9hZGluZ1xuICAgKi9cbiAgaXNMb2FkaW5nJCA9IHRoaXMucXVlcnkuc2VsZWN0TG9hZGluZygpLnBpcGUoZGVsYXkoMCkpO1xuXG4gIC8qKlxuICAgKiBMaXN0ZW4gdG8gcGFnZSBjaGFuZ2VzXG4gICAqL1xuICBnZXQgcGFnZUNoYW5nZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFnZS5hc09ic2VydmFibGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgcGFnZSBudW1iZXJcbiAgICovXG4gIGdldCBjdXJyZW50UGFnZSgpIHtcbiAgICByZXR1cm4gdGhpcy5wYWdpbmF0aW9uLmN1cnJlbnRQYWdlO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGN1cnJlbnQgcGFnZSBpcyB0aGUgZmlyc3Qgb25lXG4gICAqL1xuICBnZXQgaXNGaXJzdCgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50UGFnZSA9PT0gMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBjdXJyZW50IHBhZ2UgaXMgdGhlIGxhc3Qgb25lXG4gICAqL1xuICBnZXQgaXNMYXN0KCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRQYWdlID09PSB0aGlzLnBhZ2luYXRpb24ubGFzdFBhZ2U7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0byBnZW5lcmF0ZSBhbiBhcnJheSBvZiBwYWdlcyBmb3IgKm5nRm9yXG4gICAqIFsxLCAyLCAzLCA0XVxuICAgKi9cbiAgd2l0aENvbnRyb2xzKCkge1xuICAgIHRoaXMuY29uZmlnLnBhZ2VzQ29udHJvbHMgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gZ2VuZXJhdGUgdGhlIGBmcm9tYCBhbmQgYHRvYCBrZXlzXG4gICAqIFsxLCAyLCAzLCA0XVxuICAgKi9cbiAgd2l0aFJhbmdlKCkge1xuICAgIHRoaXMuY29uZmlnLnJhbmdlID0gdHJ1ZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIGxvYWRpbmcgc3RhdGVcbiAgICovXG4gIHNldExvYWRpbmcodmFsdWUgPSB0cnVlKSB7XG4gICAgdGhpcy5nZXRTdG9yZSgpLnNldExvYWRpbmcodmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgcGFnaW5hdGlvbiBvYmplY3QgYW5kIGFkZCB0aGUgcGFnZVxuICAgKi9cbiAgQGFjdGlvbih7IHR5cGU6ICdAUGFnaW5hdGlvbiAtIE5ldyBQYWdlJyB9LCB0cnVlKVxuICB1cGRhdGUocmVzcG9uc2U6IFBhZ2luYXRpb25SZXNwb25zZTxFPikge1xuICAgIHRoaXMucGFnaW5hdGlvbiA9IHJlc3BvbnNlO1xuICAgIHRoaXMuYWRkUGFnZShyZXNwb25zZS5kYXRhKTtcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBTZXQgdGhlIGlkcyBhbmQgYWRkIHRoZSBwYWdlIHRvIHN0b3JlXG4gICAqL1xuICBhZGRQYWdlKGRhdGE6IEVbXSkge1xuICAgIHRoaXMucGFnZXMuc2V0KHRoaXMuY3VycmVudFBhZ2UsIHsgaWRzOiBkYXRhLm1hcChlbnRpdHkgPT4gZW50aXR5W3RoaXMuZ2V0U3RvcmUoKS5pZEtleV0pIH0pO1xuICAgIHRoaXMuZ2V0U3RvcmUoKS5hZGQoZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgdGhlIGNhY2hlLlxuICAgKi9cbiAgY2xlYXJDYWNoZSgpIHtcbiAgICBpZiAoIXRoaXMuaW5pdGlhbCkge1xuICAgICAgYXBwbHlBY3Rpb24oXG4gICAgICAgICgpID0+IHtcbiAgICAgICAgICB0aGlzLmdldFN0b3JlKCkucmVtb3ZlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHsgdHlwZTogJ0BQYWdpbmF0aW9uIC0gQ2xlYXIgQ2FjaGUnIH1cbiAgICAgICk7XG4gICAgICB0aGlzLnBhZ2VzID0gbmV3IE1hcCgpO1xuICAgICAgdGhpcy5tZXRhZGF0YSA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgdGhpcy5pbml0aWFsID0gZmFsc2U7XG4gIH1cblxuICBjbGVhclBhZ2UocGFnZTogbnVtYmVyKSB7XG4gICAgdGhpcy5wYWdlcy5kZWxldGUocGFnZSk7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgdGhlIGNhY2hlIHRpbWVvdXQgYW5kIG9wdGlvbmFsbHkgdGhlIHBhZ2VzXG4gICAqL1xuICBkZXN0cm95KHsgY2xlYXJDYWNoZSwgY3VycmVudFBhZ2UgfTogeyBjbGVhckNhY2hlPzogYm9vbGVhbjsgY3VycmVudFBhZ2U/OiBudW1iZXIgfSA9IHt9KSB7XG4gICAgaWYgKHRoaXMuY2xlYXJDYWNoZVN1YnNjcmlwdGlvbikge1xuICAgICAgdGhpcy5jbGVhckNhY2hlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICAgIGlmIChjbGVhckNhY2hlKSB7XG4gICAgICB0aGlzLmNsZWFyQ2FjaGUoKTtcbiAgICB9XG4gICAgaWYgKCFpc1VuZGVmaW5lZChjdXJyZW50UGFnZSkpIHtcbiAgICAgIHRoaXMuc2V0UGFnZShjdXJyZW50UGFnZSk7XG4gICAgfVxuICAgIHRoaXMuaW5pdGlhbCA9IHRydWU7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciB0aGUgcHJvdmlkZWQgcGFnZSBpcyBhY3RpdmVcbiAgICovXG4gIGlzUGFnZUFjdGl2ZShwYWdlOiBudW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50UGFnZSA9PT0gcGFnZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIGN1cnJlbnQgcGFnZVxuICAgKi9cbiAgc2V0UGFnZShwYWdlOiBudW1iZXIpIHtcbiAgICBpZiAocGFnZSAhPT0gdGhpcy5jdXJyZW50UGFnZSB8fCAhdGhpcy5oYXNQYWdlKHBhZ2UpKSB7XG4gICAgICB0aGlzLnBhZ2UubmV4dCgodGhpcy5wYWdpbmF0aW9uLmN1cnJlbnRQYWdlID0gcGFnZSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBJbmNyZW1lbnQgY3VycmVudCBwYWdlXG4gICAqL1xuICBuZXh0UGFnZSgpIHtcbiAgICBpZiAodGhpcy5jdXJyZW50UGFnZSAhPT0gdGhpcy5wYWdpbmF0aW9uLmxhc3RQYWdlKSB7XG4gICAgICB0aGlzLnNldFBhZ2UodGhpcy5wYWdpbmF0aW9uLmN1cnJlbnRQYWdlICsgMSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERlY3JlbWVudCBjdXJyZW50IHBhZ2VcbiAgICovXG4gIHByZXZQYWdlKCkge1xuICAgIGlmICh0aGlzLnBhZ2luYXRpb24uY3VycmVudFBhZ2UgPiAxKSB7XG4gICAgICB0aGlzLnNldFBhZ2UodGhpcy5wYWdpbmF0aW9uLmN1cnJlbnRQYWdlIC0gMSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNldCBjdXJyZW50IHBhZ2UgdG8gbGFzdFxuICAgKi9cbiAgc2V0TGFzdFBhZ2UoKSB7XG4gICAgdGhpcy5zZXRQYWdlKHRoaXMucGFnaW5hdGlvbi5sYXN0UGFnZSk7XG4gIH1cblxuICAvKipcbiAgICogU2V0IGN1cnJlbnQgcGFnZSB0byBmaXJzdFxuICAgKi9cbiAgc2V0Rmlyc3RQYWdlKCkge1xuICAgIHRoaXMuc2V0UGFnZSgxKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBwYWdlIGV4aXN0cyBpbiBjYWNoZVxuICAgKi9cbiAgaGFzUGFnZShwYWdlOiBudW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy5wYWdlcy5oYXMocGFnZSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IHBhZ2UgaWYgaXQncyBpbiBjYWNoZSwgb3RoZXJ3aXNlIGludm9rZSB0aGUgcmVxdWVzdFxuICAgKi9cbiAgZ2V0UGFnZShyZXE6ICgpID0+IE9ic2VydmFibGU8UGFnaW5hdGlvblJlc3BvbnNlPEU+Pikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2luYXRpb24uY3VycmVudFBhZ2U7XG4gICAgaWYgKHRoaXMuaGFzUGFnZShwYWdlKSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0UGFnZShwYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXRMb2FkaW5nKHRydWUpO1xuICAgICAgcmV0dXJuIGZyb20ocmVxKCkpLnBpcGUoXG4gICAgICAgIHN3aXRjaE1hcCgoY29uZmlnOiBQYWdpbmF0aW9uUmVzcG9uc2U8RT4pID0+IHtcbiAgICAgICAgICBhcHBseVRyYW5zYWN0aW9uKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZShjb25maWcpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdFBhZ2UocGFnZSk7XG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGdldFF1ZXJ5KCk6IFF1ZXJ5RW50aXR5PGFueSwgRT4ge1xuICAgIHJldHVybiB0aGlzLnF1ZXJ5O1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRGcm9tKCkge1xuICAgIGlmICh0aGlzLmlzRmlyc3QpIHtcbiAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICByZXR1cm4gKHRoaXMuY3VycmVudFBhZ2UgLSAxKSAqIHRoaXMucGFnaW5hdGlvbi5wZXJQYWdlICsgMTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VG8oKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFBhZ2UgKiB0aGlzLnBhZ2luYXRpb24ucGVyUGFnZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY3QgdGhlIHBhZ2VcbiAgICovXG4gIHByaXZhdGUgc2VsZWN0UGFnZShwYWdlOiBudW1iZXIpOiBPYnNlcnZhYmxlPFBhZ2luYXRpb25SZXNwb25zZTxFPj4ge1xuICAgIHJldHVybiB0aGlzLnF1ZXJ5LnNlbGVjdEFsbCh7IGFzT2JqZWN0OiB0cnVlIH0pLnBpcGUoXG4gICAgICB0YWtlKDEpLFxuICAgICAgbWFwKGVudGl0aWVzID0+IHtcbiAgICAgICAgbGV0IHJlc3BvbnNlOiBQYWdpbmF0aW9uUmVzcG9uc2U8RT4gPSB7XG4gICAgICAgICAgLi4udGhpcy5wYWdpbmF0aW9uLFxuICAgICAgICAgIGRhdGE6IHRoaXMucGFnZXMuZ2V0KHBhZ2UpLmlkcy5tYXAoaWQgPT4gZW50aXRpZXNbaWRdKVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHsgcmFuZ2UsIHBhZ2VzQ29udHJvbHMgfSA9IHRoaXMuY29uZmlnO1xuXG4gICAgICAgIC8qKiBJZiBubyB0b3RhbCAtIGNhbGMgaXQgKi9cbiAgICAgICAgaWYgKGlzTmFOKHRoaXMucGFnaW5hdGlvbi50b3RhbCkpIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2UubGFzdFBhZ2UgPT09IDEpIHtcbiAgICAgICAgICAgIHJlc3BvbnNlLnRvdGFsID0gcmVzcG9uc2UuZGF0YSA/IHJlc3BvbnNlLmRhdGEubGVuZ3RoIDogMDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzcG9uc2UudG90YWwgPSByZXNwb25zZS5wZXJQYWdlICogcmVzcG9uc2UubGFzdFBhZ2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMucGFnaW5hdGlvbi50b3RhbCA9IHJlc3BvbnNlLnRvdGFsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJhbmdlKSB7XG4gICAgICAgICAgcmVzcG9uc2UuZnJvbSA9IHRoaXMuZ2V0RnJvbSgpO1xuICAgICAgICAgIHJlc3BvbnNlLnRvID0gdGhpcy5nZXRUbygpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhZ2VzQ29udHJvbHMpIHtcbiAgICAgICAgICByZXNwb25zZS5wYWdlQ29udHJvbHMgPSBnZW5lcmF0ZVBhZ2VzKHRoaXMucGFnaW5hdGlvbi50b3RhbCwgdGhpcy5wYWdpbmF0aW9uLnBlclBhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgICAgfSlcbiAgICApO1xuICB9XG59XG5cbi8qKlxuICogR2VuZXJhdGUgYW4gYXJyYXkgc28gd2UgY2FuIG5nRm9yIHRoZW0gdG8gbmF2aWdhdGUgYmV0d2VlbiBwYWdlc1xuICovXG5mdW5jdGlvbiBnZW5lcmF0ZVBhZ2VzKHRvdGFsOiBudW1iZXIsIHBlclBhZ2U6IG51bWJlcikge1xuICBjb25zdCBsZW4gPSBNYXRoLmNlaWwodG90YWwgLyBwZXJQYWdlKTtcbiAgbGV0IGFyciA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgYXJyLnB1c2goaSArIDEpO1xuICB9XG4gIHJldHVybiBhcnI7XG59XG5cbi8qKiBiYWNrd2FyZCBjb21wYXRpYmlsaXR5ICovXG5leHBvcnQgY29uc3QgUGFnaW5hdG9yID0gUGFnaW5hdG9yUGx1Z2luO1xuIiwiaW1wb3J0IHsgQWtpdGFQbHVnaW4gfSBmcm9tICcuLi9wbHVnaW4nO1xuaW1wb3J0IHsgUXVlcnkgfSBmcm9tICcuLi8uLi9hcGkvcXVlcnknO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBkZWJvdW5jZVRpbWUgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBfX2dsb2JhbFN0YXRlIH0gZnJvbSAnLi4vLi4vaW50ZXJuYWwvZ2xvYmFsLXN0YXRlJztcbmltcG9ydCB7IGdldFZhbHVlLCBpc1N0cmluZywgc2V0VmFsdWUsIHRvQm9vbGVhbiB9IGZyb20gJy4uLy4uL2ludGVybmFsL3V0aWxzJztcblxuZXhwb3J0IHR5cGUgRm9ybUdyb3VwTGlrZSA9IHtcbiAgcGF0Y2hWYWx1ZTogRnVuY3Rpb247XG4gIHNldFZhbHVlOiBGdW5jdGlvbjtcbiAgdmFsdWU6IGFueTtcbiAgZ2V0OiBGdW5jdGlvbjtcbiAgdmFsdWVDaGFuZ2VzOiBPYnNlcnZhYmxlPGFueT47XG4gIGNvbnRyb2xzOiBhbnk7XG59O1xuXG5leHBvcnQgdHlwZSBBa2l0YUZvcm1Qcm9wPFQ+ID0ge1xuICBba2V5OiBzdHJpbmddOiBUO1xufTtcblxuZXhwb3J0IHR5cGUgUGVyc2lzdEZvcm1QYXJhbXMgPSB7XG4gIGRlYm91bmNlVGltZT86IG51bWJlcjtcbiAgZm9ybUtleT86IHN0cmluZztcbiAgZW1pdEV2ZW50PzogYm9vbGVhbjtcbiAgYXJyQ29udHJvbEZhY3Rvcnk/OiBBcnJheUNvbnRyb2xGYWN0b3J5O1xufTtcblxuZXhwb3J0IHR5cGUgQXJyYXlDb250cm9sRmFjdG9yeSA9ICh2YWx1ZTogYW55KSA9PiBhbnk7IC8vIFRvZG86IFJldHVybiAgQWJzdHJhY3RDb250cm9sIGludGVyZmFjZVxuXG5leHBvcnQgY2xhc3MgUGVyc2lzdE5nRm9ybVBsdWdpbjxUID0gYW55PiBleHRlbmRzIEFraXRhUGx1Z2luIHtcbiAgZm9ybUNoYW5nZXM6IFN1YnNjcmlwdGlvbjtcbiAgcHJpdmF0ZSBpc1Jvb3RLZXlzOiBib29sZWFuO1xuICBwcml2YXRlIGZvcm06IEZvcm1Hcm91cExpa2U7XG4gIHByaXZhdGUgaXNLZXlCYXNlZDogYm9vbGVhbjtcbiAgcHJpdmF0ZSBpbml0aWFsVmFsdWU7XG4gIHByaXZhdGUgYnVpbGRlcjtcblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgcXVlcnk6IFF1ZXJ5PGFueT4sIHByaXZhdGUgZmFjdG9yeUZuT3JQYXRoPzogRnVuY3Rpb24gfCBzdHJpbmcsIHByaXZhdGUgcGFyYW1zOiBQZXJzaXN0Rm9ybVBhcmFtcyA9IHt9KSB7XG4gICAgc3VwZXIocXVlcnkpO1xuICAgIHRoaXMucGFyYW1zID0geyAuLi57IGRlYm91bmNlVGltZTogMzAwLCBmb3JtS2V5OiAnYWtpdGFGb3JtJywgZW1pdEV2ZW50OiBmYWxzZSwgYXJyQ29udHJvbEZhY3Rvcnk6IHYgPT4gdGhpcy5idWlsZGVyLmNvbnRyb2wodikgfSwgLi4ucGFyYW1zIH07XG4gICAgdGhpcy5pc1Jvb3RLZXlzID0gdG9Cb29sZWFuKGZhY3RvcnlGbk9yUGF0aCkgPT09IGZhbHNlO1xuICAgIHRoaXMuaXNLZXlCYXNlZCA9IGlzU3RyaW5nKGZhY3RvcnlGbk9yUGF0aCkgfHwgdGhpcy5pc1Jvb3RLZXlzO1xuICB9XG5cbiAgc2V0Rm9ybShmb3JtOiBGb3JtR3JvdXBMaWtlLCBidWlsZGVyPykge1xuICAgIHRoaXMuZm9ybSA9IGZvcm07XG4gICAgdGhpcy5idWlsZGVyID0gYnVpbGRlcjtcbiAgICB0aGlzLmFjdGl2YXRlKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICByZXNldChpbml0aWFsU3RhdGU/OiBUKSB7XG4gICAgbGV0IHZhbHVlO1xuICAgIGlmIChpbml0aWFsU3RhdGUpIHtcbiAgICAgIHZhbHVlID0gaW5pdGlhbFN0YXRlO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZSA9IHRoaXMuaXNLZXlCYXNlZCA/IHRoaXMuaW5pdGlhbFZhbHVlIDogKHRoaXMgYXMgYW55KS5mYWN0b3J5Rm5PclBhdGgoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0tleUJhc2VkKSB7XG4gICAgICBPYmplY3Qua2V5cyh0aGlzLmluaXRpYWxWYWx1ZSkuZm9yRWFjaChzdGF0ZUtleSA9PiB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5pbml0aWFsVmFsdWVbc3RhdGVLZXldO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdGhpcy5idWlsZGVyKSB7XG4gICAgICAgICAgY29uc3QgZm9ybUFycmF5ID0gdGhpcy5mb3JtLmNvbnRyb2xzW3N0YXRlS2V5XTtcbiAgICAgICAgICB0aGlzLmNsZWFuQXJyYXkoZm9ybUFycmF5KTtcbiAgICAgICAgICB2YWx1ZS5mb3JFYWNoKCh2LCBpKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZvcm0uZ2V0KHN0YXRlS2V5KS5pbnNlcnQoaSwgKHRoaXMucGFyYW1zLmFyckNvbnRyb2xGYWN0b3J5IGFzIEZ1bmN0aW9uKSh2KSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLmZvcm0ucGF0Y2hWYWx1ZSh2YWx1ZSwgeyBlbWl0RXZlbnQ6IHRoaXMucGFyYW1zLmVtaXRFdmVudCB9KTtcblxuICAgIGNvbnN0IHN0b3JlVmFsdWUgPSB0aGlzLmlzS2V5QmFzZWQgPyBzZXRWYWx1ZSh0aGlzLmdldFF1ZXJ5KCkuZ2V0U25hcHNob3QoKSwgYCR7dGhpcy5nZXRTdG9yZSgpLnN0b3JlTmFtZX0uJHt0aGlzLmZhY3RvcnlGbk9yUGF0aH1gLCB2YWx1ZSkgOiB7IFt0aGlzLnBhcmFtcy5mb3JtS2V5XTogdmFsdWUgfTtcbiAgICB0aGlzLnVwZGF0ZVN0b3JlKHN0b3JlVmFsdWUpO1xuICB9XG5cbiAgcHJpdmF0ZSBjbGVhbkFycmF5KGNvbnRyb2wpIHtcbiAgICB3aGlsZSAoY29udHJvbC5sZW5ndGggIT09IDApIHtcbiAgICAgIGNvbnRyb2wucmVtb3ZlQXQoMCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZXNvbHZlSW5pdGlhbFZhbHVlKGZvcm1WYWx1ZSwgcm9vdCkge1xuICAgIGlmICghZm9ybVZhbHVlKSByZXR1cm47XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKGZvcm1WYWx1ZSkucmVkdWNlKChhY2MsIHN0YXRlS2V5KSA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJvb3Rbc3RhdGVLZXldO1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHRoaXMuYnVpbGRlcikge1xuICAgICAgICBjb25zdCBmYWN0b3J5ID0gdGhpcy5wYXJhbXMuYXJyQ29udHJvbEZhY3Rvcnk7XG4gICAgICAgIHRoaXMuY2xlYW5BcnJheSh0aGlzLmZvcm0uZ2V0KHN0YXRlS2V5KSk7XG4gICAgICAgIHZhbHVlLmZvckVhY2goKHYsIGkpID0+IHtcbiAgICAgICAgICB0aGlzLmZvcm0uZ2V0KHN0YXRlS2V5KS5pbnNlcnQoaSwgKGZhY3RvcnkgYXMgRnVuY3Rpb24pKHYpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhY2Nbc3RhdGVLZXldID0gcm9vdFtzdGF0ZUtleV07XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbiAgfVxuXG4gIHByaXZhdGUgYWN0aXZhdGUoKSB7XG4gICAgbGV0IHBhdGg7XG5cbiAgICBpZiAodGhpcy5pc0tleUJhc2VkKSB7XG4gICAgICBpZiAodGhpcy5pc1Jvb3RLZXlzKSB7XG4gICAgICAgIHRoaXMuaW5pdGlhbFZhbHVlID0gdGhpcy5yZXNvbHZlSW5pdGlhbFZhbHVlKHRoaXMuZm9ybS52YWx1ZSwgdGhpcy5nZXRRdWVyeSgpLmdldFNuYXBzaG90KCkpO1xuICAgICAgICB0aGlzLmZvcm0ucGF0Y2hWYWx1ZSh0aGlzLmluaXRpYWxWYWx1ZSwgeyBlbWl0RXZlbnQ6IHRoaXMucGFyYW1zLmVtaXRFdmVudCB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhdGggPSBgJHt0aGlzLmdldFN0b3JlKCkuc3RvcmVOYW1lfS4ke3RoaXMuZmFjdG9yeUZuT3JQYXRofWA7XG4gICAgICAgIGNvbnN0IHJvb3QgPSBnZXRWYWx1ZSh0aGlzLmdldFF1ZXJ5KCkuZ2V0U25hcHNob3QoKSwgcGF0aCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbFZhbHVlID0gdGhpcy5yZXNvbHZlSW5pdGlhbFZhbHVlKHJvb3QsIHJvb3QpO1xuICAgICAgICB0aGlzLmZvcm0ucGF0Y2hWYWx1ZSh0aGlzLmluaXRpYWxWYWx1ZSwgeyBlbWl0RXZlbnQ6IHRoaXMucGFyYW1zLmVtaXRFdmVudCB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCEodGhpcy5nZXRRdWVyeSgpLmdldFNuYXBzaG90KCkgYXMgQWtpdGFGb3JtUHJvcDxUPilbdGhpcy5wYXJhbXMuZm9ybUtleV0pIHtcbiAgICAgICAgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnQFBlcnNpc3ROZ0Zvcm1QbHVnaW4gYWN0aXZhdGUnIH0pO1xuICAgICAgICB0aGlzLnVwZGF0ZVN0b3JlKHsgW3RoaXMucGFyYW1zLmZvcm1LZXldOiAodGhpcyBhcyBhbnkpLmZhY3RvcnlGbk9yUGF0aCgpIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0UXVlcnkoKS5nZXRTbmFwc2hvdCgpW3RoaXMucGFyYW1zLmZvcm1LZXldO1xuICAgICAgdGhpcy5mb3JtLnBhdGNoVmFsdWUodmFsdWUpO1xuICAgIH1cblxuICAgIHRoaXMuZm9ybUNoYW5nZXMgPSB0aGlzLmZvcm0udmFsdWVDaGFuZ2VzLnBpcGUoZGVib3VuY2VUaW1lKHRoaXMucGFyYW1zLmRlYm91bmNlVGltZSkpLnN1YnNjcmliZSh2YWx1ZSA9PiB7XG4gICAgICBfX2dsb2JhbFN0YXRlLnNldEFjdGlvbih7IHR5cGU6ICdAUGVyc2lzdEZvcm0gLSBVcGRhdGUnIH0pO1xuICAgICAgbGV0IG5ld1N0YXRlO1xuICAgICAgaWYgKHRoaXMuaXNLZXlCYXNlZCkge1xuICAgICAgICBpZiAodGhpcy5pc1Jvb3RLZXlzKSB7XG4gICAgICAgICAgbmV3U3RhdGUgPSBzdGF0ZSA9PiAoeyAuLi5zdGF0ZSwgLi4udmFsdWUgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3U3RhdGUgPSBzdGF0ZSA9PiBzZXRWYWx1ZShzdGF0ZSwgcGF0aCwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdTdGF0ZSA9ICgpID0+ICh7IFt0aGlzLnBhcmFtcy5mb3JtS2V5XTogdmFsdWUgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLnVwZGF0ZVN0b3JlKG5ld1N0YXRlKHRoaXMuZ2V0UXVlcnkoKS5nZXRTbmFwc2hvdCgpKSk7XG4gICAgfSk7XG4gIH1cblxuICBkZXN0cm95KCkge1xuICAgIHRoaXMuZm9ybUNoYW5nZXMgJiYgdGhpcy5mb3JtQ2hhbmdlcy51bnN1YnNjcmliZSgpO1xuICAgIHRoaXMuZm9ybSA9IG51bGw7XG4gICAgdGhpcy5idWlsZGVyID0gbnVsbDtcbiAgfVxufVxuIiwiaW1wb3J0IHsgQWtpdGFFcnJvciB9IGZyb20gJy4uL2ludGVybmFsL2Vycm9yJztcbmltcG9ydCB7IF9fc3RvcmVzX18sIEFjdGlvbnMsIHJvb3REaXNwYXRjaGVyIH0gZnJvbSAnLi4vYXBpL3N0b3JlJztcbmltcG9ydCB7IHNraXAsIGZpbHRlciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IGdldFZhbHVlLCBzZXRWYWx1ZSB9IGZyb20gJy4uL2ludGVybmFsL3V0aWxzJztcbmltcG9ydCB7IF9fZ2xvYmFsU3RhdGUgfSBmcm9tICcuLi9pbnRlcm5hbC9nbG9iYWwtc3RhdGUnO1xuXG5jb25zdCBub3RCcyA9IHR5cGVvZiBsb2NhbFN0b3JhZ2UgPT09ICd1bmRlZmluZWQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFBlcnNpc3RTdGF0ZVBhcmFtcyB7XG4gIC8qKiBUaGUgc3RvcmFnZSBrZXkgKi9cbiAga2V5OiBzdHJpbmc7XG4gIC8qKiBTdG9yYWdlIHN0cmF0ZWd5IHRvIHVzZS4gVGhpcyBkZWZhdWx0cyB0byBMb2NhbFN0b3JhZ2UgYnV0IHlvdSBjYW4gcGFzcyBTZXNzaW9uU3RvcmFnZSBvciBhbnl0aGluZyB0aGF0IGltcGxlbWVudHMgdGhlIFN0b3JhZ2VFbmdpbmUgQVBJLiAqL1xuICBzdG9yYWdlOiBTdG9yYWdlO1xuICAvKiogQ3VzdG9tIGRlc2VyaWFsaXplci4gRGVmYXVsdHMgdG8gSlNPTi5wYXJzZSAqL1xuICBkZXNlcmlhbGl6ZTogRnVuY3Rpb247XG4gIC8qKiBDdXN0b20gc2VyaWFsaXplciwgZGVmYXVsdHMgdG8gSlNPTi5zdHJpbmdpZnkgKi9cbiAgc2VyaWFsaXplOiBGdW5jdGlvbjtcbiAgLyoqXG4gICAqIEJ5IGRlZmF1bHQgdGhlIHdob2xlIHN0YXRlIGlzIHNhdmVkIHRvIHN0b3JhZ2UsIHVzZSB0aGlzIHBhcmFtIHRvIGluY2x1ZGUgb25seSB0aGUgc3RvcmVzIHlvdSBuZWVkLlxuICAgKiBQYXkgYXR0ZW50aW9uIHRoYXQgeW91IGNhbid0IHVzZSBib3RoIGluY2x1ZGUgYW5kIGV4Y2x1ZGVcbiAgICovXG4gIGluY2x1ZGU6IHN0cmluZ1tdO1xuICAvKipcbiAgICogIEJ5IGRlZmF1bHQgdGhlIHdob2xlIHN0YXRlIGlzIHNhdmVkIHRvIHN0b3JhZ2UsIHVzZSB0aGlzIHBhcmFtIHRvIGV4Y2x1ZGUgc3RvcmVzIHRoYXQgeW91IGRvbid0IG5lZWQuXG4gICAqICBQYXkgYXR0ZW50aW9uIHRoYXQgeW91IGNhbid0IHVzZSBib3RoIGluY2x1ZGUgYW5kIGV4Y2x1ZGVcbiAgICovXG4gIGV4Y2x1ZGU6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGVyc2lzdFN0YXRlKHBhcmFtcz86IFBhcnRpYWw8UGVyc2lzdFN0YXRlUGFyYW1zPikge1xuICBpZiAobm90QnMpIHJldHVybjtcblxuICBjb25zdCBkZWZhdWx0czogUGVyc2lzdFN0YXRlUGFyYW1zID0ge1xuICAgIGtleTogJ0FraXRhU3RvcmVzJyxcbiAgICBzdG9yYWdlOiBsb2NhbFN0b3JhZ2UsXG4gICAgZGVzZXJpYWxpemU6IEpTT04ucGFyc2UsXG4gICAgc2VyaWFsaXplOiBKU09OLnN0cmluZ2lmeSxcbiAgICBpbmNsdWRlOiBbXSxcbiAgICBleGNsdWRlOiBbXVxuICB9O1xuICBjb25zdCB7IHN0b3JhZ2UsIGRlc2VyaWFsaXplLCBzZXJpYWxpemUsIGluY2x1ZGUsIGV4Y2x1ZGUsIGtleSB9ID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdHMsIHBhcmFtcyk7XG5cbiAgY29uc3QgaGFzSW5jbHVkZSA9IGluY2x1ZGUubGVuZ3RoID4gMDtcbiAgY29uc3QgaGFzRXhjbHVkZSA9IGV4Y2x1ZGUubGVuZ3RoID4gMDtcbiAgbGV0IGluY2x1ZGVTdG9yZXM7XG5cbiAgaWYgKGhhc0luY2x1ZGUgJiYgaGFzRXhjbHVkZSkge1xuICAgIHRocm93IG5ldyBBa2l0YUVycm9yKFwiWW91IGNhbid0IHVzZSBib3RoIGluY2x1ZGUgYW5kIGV4Y2x1ZGVcIik7XG4gIH1cblxuICBpZiAoaGFzSW5jbHVkZSkge1xuICAgIGluY2x1ZGVTdG9yZXMgPSBpbmNsdWRlLnJlZHVjZSgoYWNjLCBwYXRoKSA9PiB7XG4gICAgICBjb25zdCBzdG9yZU5hbWUgPSBwYXRoLnNwbGl0KCcuJylbMF07XG4gICAgICBhY2Nbc3RvcmVOYW1lXSA9IHBhdGg7XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbiAgfVxuXG4gIGNvbnN0IHN0b3JhZ2VTdGF0ZSA9IGRlc2VyaWFsaXplKHN0b3JhZ2UuZ2V0SXRlbShrZXkpIHx8ICd7fScpO1xuXG4gIGxldCBzdG9yZXMgPSB7fTtcbiAgbGV0IGFjYyA9IHt9O1xuXG4gIGZ1bmN0aW9uIHNhdmUoKSB7XG4gICAgc3RvcmFnZS5zZXRJdGVtKGtleSwgc2VyaWFsaXplKE9iamVjdC5hc3NpZ24oe30sIHN0b3JhZ2VTdGF0ZSwgYWNjKSkpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3Vic2NyaWJlKHN0b3JlTmFtZSwgcGF0aCkge1xuICAgIHN0b3Jlc1tzdG9yZU5hbWVdID0gX19zdG9yZXNfX1tzdG9yZU5hbWVdXG4gICAgICAuX3NlbGVjdChzdGF0ZSA9PiBnZXRWYWx1ZShzdGF0ZSwgcGF0aCkpXG4gICAgICAucGlwZShza2lwKDEpKVxuICAgICAgLnN1YnNjcmliZShkYXRhID0+IHtcbiAgICAgICAgYWNjW3N0b3JlTmFtZV0gPSBkYXRhO1xuICAgICAgICBzYXZlKCk7XG4gICAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEluaXRpYWwoc3RvcmVOYW1lLCBzdG9yZSwgcGF0aCkge1xuICAgIGlmIChzdG9yYWdlU3RhdGVbc3RvcmVOYW1lXSkge1xuICAgICAgX19nbG9iYWxTdGF0ZS5zZXRBY3Rpb24oeyB0eXBlOiAnQFBlcnNpc3RTdGF0ZScgfSk7XG4gICAgICBzdG9yZS5zZXRTdGF0ZShzdGF0ZSA9PiB7XG4gICAgICAgIHJldHVybiBzZXRWYWx1ZShzdGF0ZSwgcGF0aCwgc3RvcmFnZVN0YXRlW3N0b3JlTmFtZV0pO1xuICAgICAgfSk7XG4gICAgICBpZiAoc3RvcmUuc2V0RGlydHkpIHtcbiAgICAgICAgc3RvcmUuc2V0RGlydHkoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBjb25zdCBzdWJzY3JpcHRpb24gPSByb290RGlzcGF0Y2hlci5waXBlKGZpbHRlcihhY3Rpb24gPT4gYWN0aW9uLnR5cGUgPT09IEFjdGlvbnMuTkVXX1NUT1JFKSkuc3Vic2NyaWJlKGFjdGlvbiA9PiB7XG4gICAgbGV0IGN1cnJlbnRTdG9yZU5hbWUgPSBhY3Rpb24ucGF5bG9hZC5zdG9yZS5zdG9yZU5hbWU7XG5cbiAgICBpZiAoaGFzRXhjbHVkZSAmJiBleGNsdWRlLmluY2x1ZGVzKGN1cnJlbnRTdG9yZU5hbWUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGhhc0luY2x1ZGUpIHtcbiAgICAgIGNvbnN0IHBhdGggPSBpbmNsdWRlU3RvcmVzW2N1cnJlbnRTdG9yZU5hbWVdO1xuICAgICAgaWYgKCFwYXRoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHNldEluaXRpYWwoY3VycmVudFN0b3JlTmFtZSwgYWN0aW9uLnBheWxvYWQuc3RvcmUsIHBhdGgpO1xuICAgICAgc3Vic2NyaWJlKGN1cnJlbnRTdG9yZU5hbWUsIHBhdGgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXRJbml0aWFsKGN1cnJlbnRTdG9yZU5hbWUsIGFjdGlvbi5wYXlsb2FkLnN0b3JlLCBjdXJyZW50U3RvcmVOYW1lKTtcbiAgICAgIHN1YnNjcmliZShjdXJyZW50U3RvcmVOYW1lLCBjdXJyZW50U3RvcmVOYW1lKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgZGVzdHJveSgpIHtcbiAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGtleXMgPSBPYmplY3Qua2V5cyhzdG9yZXMpOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBzdG9yZU5hbWUgPSBrZXlzW2ldO1xuICAgICAgICBzdG9yZXNbc3RvcmVOYW1lXS51bnN1YnNjcmliZSgpO1xuICAgICAgfVxuICAgICAgc3RvcmVzID0ge307XG4gICAgfSxcbiAgICBjbGVhcigpIHtcbiAgICAgIHN0b3JhZ2UuY2xlYXIoKTtcbiAgICB9LFxuICAgIGNsZWFyU3RvcmUoc3RvcmVOYW1lOiBzdHJpbmcpIHtcbiAgICAgIGNvbnN0IHN0b3JhZ2VTdGF0ZSA9IGRlc2VyaWFsaXplKHN0b3JhZ2UuZ2V0SXRlbShrZXkpIHx8ICd7fScpO1xuXG4gICAgICBpZiAoc3RvcmFnZVN0YXRlW3N0b3JlTmFtZV0pIHtcbiAgICAgICAgZGVsZXRlIHN0b3JhZ2VTdGF0ZVtzdG9yZU5hbWVdO1xuICAgICAgICBzdG9yYWdlLnNldEl0ZW0oa2V5LCBzZXJpYWxpemUoc3RvcmFnZVN0YXRlKSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuIiwiaW1wb3J0IHsgX19zdG9yZXNfXywgQWN0aW9ucywgcm9vdERpc3BhdGNoZXIgfSBmcm9tICcuLi9hcGkvc3RvcmUnO1xuaW1wb3J0IHsgX19nbG9iYWxTdGF0ZSB9IGZyb20gJy4uL2ludGVybmFsL2dsb2JhbC1zdGF0ZSc7XG5pbXBvcnQgeyBpc0RlZmluZWQgfSBmcm9tICcuLi9pbnRlcm5hbC91dGlscyc7XG5cbmV4cG9ydCB0eXBlIERldnRvb2xzT3B0aW9ucyA9IHtcbiAgLyoqICBtYXhpbXVtIGFsbG93ZWQgYWN0aW9ucyB0byBiZSBzdG9yZWQgaW4gdGhlIGhpc3RvcnkgdHJlZSAqL1xuICBtYXhBZ2U6IG51bWJlcjtcbiAgbGF0ZW5jeTogbnVtYmVyO1xuICBhY3Rpb25zQmxhY2tsaXN0OiBzdHJpbmdbXTtcbiAgYWN0aW9uc1doaXRlbGlzdDogc3RyaW5nW107XG4gIHNob3VsZENhdGNoRXJyb3JzOiBib29sZWFuO1xuICBsb2dUcmFjZTogYm9vbGVhbjtcbiAgcHJlZGljYXRlOiAoc3RhdGU6IGFueSwgYWN0aW9uOiBhbnkpID0+IGJvb2xlYW47XG59O1xubGV0IHJvb3REaXNwYXRjaGVyU3ViLCBkZXZ0b29sc1N1YjtcblxuZXhwb3J0IHR5cGUgTmdab25lTGlrZSA9IHsgcnVuOiBhbnkgfTtcblxuZXhwb3J0IGZ1bmN0aW9uIGFraXRhRGV2dG9vbHMobmdab25lOiBOZ1pvbmVMaWtlLCBvcHRpb25zPzogUGFydGlhbDxEZXZ0b29sc09wdGlvbnM+KTtcbmV4cG9ydCBmdW5jdGlvbiBha2l0YURldnRvb2xzKG9wdGlvbnM/OiBQYXJ0aWFsPERldnRvb2xzT3B0aW9ucz4pO1xuZXhwb3J0IGZ1bmN0aW9uIGFraXRhRGV2dG9vbHMobmdab25lT3JPcHRpb25zPzogTmdab25lTGlrZSB8IFBhcnRpYWw8RGV2dG9vbHNPcHRpb25zPiwgb3B0aW9uczogUGFydGlhbDxEZXZ0b29sc09wdGlvbnM+ID0ge30pIHtcbiAgaWYgKCEod2luZG93IGFzIGFueSkuX19SRURVWF9ERVZUT09MU19FWFRFTlNJT05fXykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHJvb3REaXNwYXRjaGVyU3ViICYmIHJvb3REaXNwYXRjaGVyU3ViLnVuc3Vic2NyaWJlKCk7XG4gIGRldnRvb2xzU3ViICYmIGRldnRvb2xzU3ViKCk7XG5cbiAgY29uc3QgaXNBbmd1bGFyID0gbmdab25lT3JPcHRpb25zICYmIG5nWm9uZU9yT3B0aW9uc1sncnVuJ107XG5cbiAgaWYgKCFpc0FuZ3VsYXIpIHtcbiAgICBuZ1pvbmVPck9wdGlvbnMgPSBuZ1pvbmVPck9wdGlvbnMgfHwge307XG4gICAgKG5nWm9uZU9yT3B0aW9ucyBhcyBhbnkpLnJ1biA9IGNiID0+IGNiKCk7XG4gICAgb3B0aW9ucyA9IG5nWm9uZU9yT3B0aW9ucyBhcyBQYXJ0aWFsPERldnRvb2xzT3B0aW9ucz47XG4gIH1cblxuICBjb25zdCBkZWZhdWx0T3B0aW9uczogUGFydGlhbDxEZXZ0b29sc09wdGlvbnM+ICYgeyBuYW1lOiBzdHJpbmcgfSA9IHsgbmFtZTogJ0FraXRhJyB9O1xuICBjb25zdCBtZXJnZWQgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgY29uc3QgZGV2VG9vbHMgPSAod2luZG93IGFzIGFueSkuX19SRURVWF9ERVZUT09MU19FWFRFTlNJT05fXy5jb25uZWN0KG1lcmdlZCk7XG4gIGxldCBhcHBTdGF0ZSA9IHt9O1xuXG4gIHJvb3REaXNwYXRjaGVyU3ViID0gcm9vdERpc3BhdGNoZXIuc3Vic2NyaWJlKGFjdGlvbiA9PiB7XG4gICAgaWYgKGFjdGlvbi50eXBlID09PSBBY3Rpb25zLkRFTEVURV9TVE9SRSkge1xuICAgICAgY29uc3Qgc3RvcmVOYW1lID0gYWN0aW9uLnBheWxvYWQuc3RvcmVOYW1lO1xuICAgICAgZGVsZXRlIGFwcFN0YXRlW3N0b3JlTmFtZV07XG4gICAgICBkZXZUb29scy5zZW5kKHsgdHlwZTogYFske3N0b3JlTmFtZX1dIC0gRGVsZXRlIFN0b3JlYCB9LCBhcHBTdGF0ZSk7XG4gICAgfVxuXG4gICAgaWYgKGFjdGlvbi50eXBlID09PSBBY3Rpb25zLk5FV19TVEFURSkge1xuICAgICAgaWYgKF9fZ2xvYmFsU3RhdGUuc2tpcEFjdGlvbikge1xuICAgICAgICBfX2dsb2JhbFN0YXRlLnNldFNraXBBY3Rpb24oZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGFwcFN0YXRlID0ge1xuICAgICAgICAuLi5hcHBTdGF0ZSxcbiAgICAgICAgW2FjdGlvbi5wYXlsb2FkLm5hbWVdOiBfX3N0b3Jlc19fW2FjdGlvbi5wYXlsb2FkLm5hbWVdLl92YWx1ZSgpXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB7IHR5cGUsIGVudGl0eUlkIH0gPSBfX2dsb2JhbFN0YXRlLmN1cnJlbnRBY3Rpb247XG4gICAgICBjb25zdCBzdG9yZU5hbWUgPSBjYXBpdGFsaXplKGFjdGlvbi5wYXlsb2FkLm5hbWUpO1xuICAgICAgbGV0IG1zZyA9IGlzRGVmaW5lZChlbnRpdHlJZCkgPyBgWyR7c3RvcmVOYW1lfV0gLSAke3R5cGV9IChpZHM6ICR7ZW50aXR5SWR9KWAgOiBgWyR7c3RvcmVOYW1lfV0gLSAke3R5cGV9YDtcblxuICAgICAgaWYgKG9wdGlvbnMubG9nVHJhY2UpIHtcbiAgICAgICAgY29uc29sZS5ncm91cChtc2cpO1xuICAgICAgICBjb25zb2xlLnRyYWNlKCk7XG4gICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKTtcbiAgICAgIH1cblxuICAgICAgZGV2VG9vbHMuc2VuZCh7IHR5cGU6IG1zZywgdHJhbnNhY3Rpb246IF9fZ2xvYmFsU3RhdGUuY3VycmVudFQubWFwKHQgPT4gdC50eXBlKSB9LCBhcHBTdGF0ZSk7XG4gICAgfVxuICB9KTtcblxuICBkZXZ0b29sc1N1YiA9IGRldlRvb2xzLnN1YnNjcmliZShtZXNzYWdlID0+IHtcbiAgICBpZiAobWVzc2FnZS50eXBlID09PSAnQUNUSU9OJykge1xuICAgICAgY29uc3QgW3N0b3JlTmFtZV0gPSBtZXNzYWdlLnBheWxvYWQuc3BsaXQoJy4nKTtcblxuICAgICAgaWYgKF9fc3RvcmVzX19bc3RvcmVOYW1lXSkge1xuICAgICAgICAobmdab25lT3JPcHRpb25zIGFzIE5nWm9uZUxpa2UpLnJ1bigoKSA9PiB7XG4gICAgICAgICAgY29uc3QgZnVuY0NhbGwgPSBtZXNzYWdlLnBheWxvYWQucmVwbGFjZShzdG9yZU5hbWUsIGB0aGlzWycke3N0b3JlTmFtZX0nXWApO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBuZXcgRnVuY3Rpb24oYCR7ZnVuY0NhbGx9YCkuY2FsbChfX3N0b3Jlc19fKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1Vua25vd24gTWV0aG9kIMOiwpjCucOvwrjCjycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gJ0RJU1BBVENIJykge1xuICAgICAgY29uc3QgcGF5bG9hZFR5cGUgPSBtZXNzYWdlLnBheWxvYWQudHlwZTtcblxuICAgICAgaWYgKHBheWxvYWRUeXBlID09PSAnQ09NTUlUJykge1xuICAgICAgICBkZXZUb29scy5pbml0KGFwcFN0YXRlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAobWVzc2FnZS5zdGF0ZSkge1xuICAgICAgICBjb25zdCByb290U3RhdGUgPSBKU09OLnBhcnNlKG1lc3NhZ2Uuc3RhdGUpO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwga2V5cyA9IE9iamVjdC5rZXlzKHJvb3RTdGF0ZSk7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3Qgc3RvcmVOYW1lID0ga2V5c1tpXTtcbiAgICAgICAgICBpZiAoX19zdG9yZXNfX1tzdG9yZU5hbWVdKSB7XG4gICAgICAgICAgICAobmdab25lT3JPcHRpb25zIGFzIE5nWm9uZUxpa2UpLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgIF9fc3RvcmVzX19bc3RvcmVOYW1lXS5zZXRTdGF0ZSgoKSA9PiByb290U3RhdGVbc3RvcmVOYW1lXSwgZmFsc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gY2FwaXRhbGl6ZShzdHJpbmcpIHtcbiAgcmV0dXJuIHN0cmluZyAmJiBzdHJpbmcuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHJpbmcuc2xpY2UoMSk7XG59XG4iLCJpbXBvcnQge2NvZXJjZUFycmF5LCBpc0Z1bmN0aW9uLCBpc1VuZGVmaW5lZCwgdG9Cb29sZWFufSBmcm9tICcuLi9pbnRlcm5hbC91dGlscyc7XG5pbXBvcnQge1F1ZXJ5RW50aXR5fSBmcm9tICcuLi9hcGkvcXVlcnktZW50aXR5JztcbmltcG9ydCB7SUQsIElEU30gZnJvbSAnLi4vYXBpL3R5cGVzJztcbmltcG9ydCB7T2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5cbi8qKlxuICogRWFjaCBwbHVnaW4gdGhhdCB3YW50cyB0byBhZGQgc3VwcG9ydCBmb3IgZW50aXRpZXMgc2hvdWxkIGV4dGVuZCB0aGlzIGludGVyZmFjZS5cbiAqL1xuZXhwb3J0IHR5cGUgRW50aXR5UGFyYW0gPSBJRDtcblxuZXhwb3J0IHR5cGUgRW50aXR5Q29sbGVjdGlvblBhcmFtcyA9IElEIHwgSURbXTtcblxuZXhwb3J0IHR5cGUgUmViYXNlQWN0aW9uczxQID0gYW55PiA9IHsgYmVmb3JlUmVtb3ZlPzogRnVuY3Rpb247IGJlZm9yZUFkZD86IEZ1bmN0aW9uOyBhZnRlckFkZD86IChwbHVnaW46IFApID0+IGFueTsgfTtcblxuY29uc3QgZGVmYXVsdEFjdGlvbnM6IFJlYmFzZUFjdGlvbnMgPSB7YmVmb3JlUmVtb3ZlOiBwbHVnaW4gPT4gcGx1Z2luLmRlc3Ryb3koKX07XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBFbnRpdHlDb2xsZWN0aW9uUGx1Z2luPEUsIFA+IHtcbiAgcHJvdGVjdGVkIGVudGl0aWVzID0gbmV3IE1hcDxJRCwgUD4oKTtcblxuICBwcm90ZWN0ZWQgY29uc3RydWN0b3IocHJvdGVjdGVkIHF1ZXJ5OiBRdWVyeUVudGl0eTxhbnksIEU+LCBwcml2YXRlIGVudGl0eUlkczogRW50aXR5Q29sbGVjdGlvblBhcmFtcykge31cblxuICAvKipcbiAgICogR2V0IHRoZSBlbnRpdHkgcGx1Z2luIGluc3RhbmNlLlxuICAgKi9cbiAgcHJvdGVjdGVkIGdldEVudGl0eShpZDogSUQpOiBQIHtcbiAgICByZXR1cm4gdGhpcy5lbnRpdGllcy5nZXQoaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIGVudGl0eSBwbHVnaW4gZXhpc3QuXG4gICAqL1xuICBwcm90ZWN0ZWQgaGFzRW50aXR5KGlkOiBJRCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmVudGl0aWVzLmhhcyhpZCk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSBlbnRpdHkgcGx1Z2luIGluc3RhbmNlLlxuICAgKi9cbiAgcHJvdGVjdGVkIHJlbW92ZUVudGl0eShpZDogSUQpIHtcbiAgICByZXR1cm4gdGhpcy5lbnRpdGllcy5kZWxldGUoaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgZW50aXR5IHBsdWdpbiBpbnN0YW5jZS5cbiAgICovXG4gIHByb3RlY3RlZCBjcmVhdGVFbnRpdHkoaWQ6IElELCBwbHVnaW46IFApIHtcbiAgICByZXR1cm4gdGhpcy5lbnRpdGllcy5zZXQoaWQsIHBsdWdpbik7XG4gIH1cblxuICAvKipcbiAgICogSWYgdGhlIHVzZXIgcGFzc2VzIGBlbnRpdHlJZHNgIHdlIHRha2UgdGhlbTsgb3RoZXJ3aXNlLCB3ZSB0YWtlIGFsbC5cbiAgICovXG4gIHByb3RlY3RlZCBnZXRJZHMoKTogSURbXSB7XG4gICAgcmV0dXJuIGlzVW5kZWZpbmVkKHRoaXMuZW50aXR5SWRzKSA/IHRoaXMucXVlcnkuZ2V0U25hcHNob3QoKS5pZHMgOiBjb2VyY2VBcnJheSh0aGlzLmVudGl0eUlkcyk7XG4gIH1cblxuICAvKipcbiAgICogV2hlbiB5b3UgY2FsbCBvbmUgb2YgdGhlIHBsdWdpbiBtZXRob2RzLCB5b3UgY2FuIHBhc3MgaWQvaWRzIG9yIHVuZGVmaW5lZCB3aGljaCBtZWFucyBhbGwuXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVzb2x2ZWRJZHMoaWRzPyk6IElEW10ge1xuICAgIHJldHVybiBpc1VuZGVmaW5lZChpZHMpID8gdGhpcy5nZXRJZHMoKSA6IGNvZXJjZUFycmF5KGlkcyk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCB0aGlzIG1ldGhvZCB3aGVuIHlvdSB3YW50IHRvIGFjdGl2YXRlIHRoZSBwbHVnaW4gb24gaW5pdCBvciB3aGVuIHlvdSBuZWVkIHRvIGxpc3RlbiB0byBhZGQvcmVtb3ZlIG9mIGVudGl0aWVzIGR5bmFtaWNhbGx5LlxuICAgKlxuICAgKiBGb3IgZXhhbXBsZSBpbiB5b3VyIHBsdWdpbiB5b3UgbWF5IGRvIHRoZSBmb2xsb3dpbmc6XG4gICAqXG4gICAqIHRoaXMucXVlcnkuc2VsZWN0KHN0YXRlID0+IHN0YXRlLmlkcykucGlwZShza2lwKDEpKS5zdWJzY3JpYmUoaWRzID0+IHRoaXMuYWN0aXZhdGUoaWRzKSk7XG4gICAqL1xuICBwcm90ZWN0ZWQgcmViYXNlKGlkczogSURbXSwgYWN0aW9uczogUmViYXNlQWN0aW9uczxQPiA9IGRlZmF1bHRBY3Rpb25zKSB7XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBJZiB0aGUgdXNlciBwYXNzZXMgYGVudGl0eUlkc2AgJiB3ZSBoYXZlIG5ldyBpZHMgY2hlY2sgaWYgd2UgbmVlZCB0byBhZGQvcmVtb3ZlIGluc3RhbmNlcy5cbiAgICAgKlxuICAgICAqIFRoaXMgcGhhc2Ugd2lsbCBiZSBjYWxsZWQgb25seSB1cG9uIHVwZGF0ZS5cbiAgICAgKi9cbiAgICBpZiAodG9Cb29sZWFuKGlkcykpIHtcbiAgICAgIC8qKlxuICAgICAgICogV2hpY2ggbWVhbnMgYWxsXG4gICAgICAgKi9cbiAgICAgIGlmIChpc1VuZGVmaW5lZCh0aGlzLmVudGl0eUlkcykpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGlkcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIGNvbnN0IGVudGl0eUlkID0gaWRzW2ldO1xuICAgICAgICAgIGlmICh0aGlzLmhhc0VudGl0eShlbnRpdHlJZCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBpc0Z1bmN0aW9uKGFjdGlvbnMuYmVmb3JlQWRkKSAmJiBhY3Rpb25zLmJlZm9yZUFkZChlbnRpdHlJZCk7XG4gICAgICAgICAgICBjb25zdCBwbHVnaW4gPSB0aGlzLmluc3RhbnRpYXRlUGx1Z2luKGVudGl0eUlkKTtcbiAgICAgICAgICAgIHRoaXMuZW50aXRpZXMuc2V0KGVudGl0eUlkLCBwbHVnaW4pO1xuICAgICAgICAgICAgaXNGdW5jdGlvbihhY3Rpb25zLmFmdGVyQWRkKSAmJiBhY3Rpb25zLmFmdGVyQWRkKHBsdWdpbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbnRpdGllcy5mb3JFYWNoKChwbHVnaW4sIGVudGl0eUlkKSA9PiB7XG4gICAgICAgICAgaWYgKGlkcy5pbmRleE9mKGVudGl0eUlkKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIGlzRnVuY3Rpb24oYWN0aW9ucy5iZWZvcmVSZW1vdmUpICYmIGFjdGlvbnMuYmVmb3JlUmVtb3ZlKHBsdWdpbik7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUVudGl0eShlbnRpdHlJZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGljaCBtZWFucyB0aGUgdXNlciBwYXNzZXMgc3BlY2lmaWMgaWRzXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdCBfaWRzID0gY29lcmNlQXJyYXkodGhpcy5lbnRpdHlJZHMpO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gX2lkcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIGNvbnN0IGVudGl0eUlkID0gX2lkc1tpXTtcbiAgICAgICAgICAvKiogVGhlIEVudGl0eSBpbiBjdXJyZW50IGlkcyBhbmQgZG9lc24ndCBleGlzdCwgYWRkIGl0LiAqL1xuICAgICAgICAgIGlmIChpZHMuaW5kZXhPZihlbnRpdHlJZCkgPiAtMSAmJiB0aGlzLmhhc0VudGl0eShlbnRpdHlJZCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBpc0Z1bmN0aW9uKGFjdGlvbnMuYmVmb3JlQWRkKSAmJiBhY3Rpb25zLmJlZm9yZUFkZChlbnRpdHlJZCk7XG4gICAgICAgICAgICBjb25zdCBwbHVnaW4gPSB0aGlzLmluc3RhbnRpYXRlUGx1Z2luKGVudGl0eUlkKTtcbiAgICAgICAgICAgIHRoaXMuZW50aXRpZXMuc2V0KGVudGl0eUlkLCBwbHVnaW4pO1xuICAgICAgICAgICAgaXNGdW5jdGlvbihhY3Rpb25zLmFmdGVyQWRkKSAmJiBhY3Rpb25zLmFmdGVyQWRkKHBsdWdpbik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZW50aXRpZXMuZm9yRWFjaCgocGx1Z2luLCBlbnRpdHlJZCkgPT4ge1xuICAgICAgICAgICAgICAvKiogVGhlIEVudGl0eSBub3QgaW4gY3VycmVudCBpZHMgYW5kIGV4aXN0cywgcmVtb3ZlIGl0LiAqL1xuICAgICAgICAgICAgICBpZiAoaWRzLmluZGV4T2YoZW50aXR5SWQpID09PSAtMSAmJiB0aGlzLmhhc0VudGl0eShlbnRpdHlJZCkgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBpc0Z1bmN0aW9uKGFjdGlvbnMuYmVmb3JlUmVtb3ZlKSAmJiBhY3Rpb25zLmJlZm9yZVJlbW92ZShwbHVnaW4pO1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRW50aXR5KGVudGl0eUlkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8qKlxuICAgICAgICogT3RoZXJ3aXNlLCBzdGFydCB3aXRoIHRoZSBwcm92aWRlZCBpZHMgb3IgYWxsLlxuICAgICAgICovXG4gICAgICB0aGlzLmdldElkcygpLmZvckVhY2goaWQgPT4ge1xuICAgICAgICBpZiAoIXRoaXMuaGFzRW50aXR5KGlkKSkgdGhpcy5jcmVhdGVFbnRpdHkoaWQsIHRoaXMuaW5zdGFudGlhdGVQbHVnaW4oaWQpKVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIExpc3RlbiBmb3IgYWRkL3JlbW92ZSBlbnRpdGllcy5cbiAgICovXG4gIHByb3RlY3RlZCBzZWxlY3RJZHMoKTogT2JzZXJ2YWJsZTxJRFtdPiB7XG4gICAgcmV0dXJuIHRoaXMucXVlcnkuc2VsZWN0KHN0YXRlID0+IHN0YXRlLmlkcyk7XG4gIH1cblxuICAvKipcbiAgICogQmFzZSBtZXRob2QgZm9yIGFjdGl2YXRpb24sIHlvdSBjYW4gb3ZlcnJpZGUgaXQgaWYgeW91IG5lZWQgdG8uXG4gICAqL1xuICBwcm90ZWN0ZWQgYWN0aXZhdGUoaWRzPzogSURbXSkge1xuICAgIHRoaXMucmViYXNlKGlkcyk7XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBtZXRob2QgaXMgcmVzcG9uc2libGUgZm9yIHBsdWdpbiBpbnN0YW50aWF0aW9uLlxuICAgKlxuICAgKiBGb3IgZXhhbXBsZTpcbiAgICogcmV0dXJuIG5ldyBTdGF0ZUhpc3RvcnkodGhpcy5xdWVyeSwgdGhpcy5wYXJhbXMsIGlkKSBhcyBQO1xuICAgKi9cbiAgcHJvdGVjdGVkIGFic3RyYWN0IGluc3RhbnRpYXRlUGx1Z2luKGlkOiBJRCk6IFA7XG5cbiAgLyoqXG4gICAqIFRoaXMgbWV0aG9kIGlzIHJlc3BvbnNpYmxlIGZvciBjbGVhbmluZy5cbiAgICovXG4gIHB1YmxpYyBhYnN0cmFjdCBkZXN0cm95KGlkPzogSUQpO1xuXG4gIC8qKlxuICAgKiBMb29wIG92ZXIgZWFjaCBpZCBhbmQgaW52b2tlIHRoZSBwbHVnaW4gbWV0aG9kLlxuICAgKi9cbiAgcHJvdGVjdGVkIGZvckVhY2hJZChpZHM6IElEUywgY2I6IChlbnRpdHk6IFApID0+IGFueSkge1xuICAgIGNvbnN0IF9pZHMgPSB0aGlzLnJlc29sdmVkSWRzKGlkcyk7XG5cbiAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gX2lkcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgY29uc3QgaWQgPSBfaWRzW2ldO1xuICAgICAgaWYgKHRoaXMuaGFzRW50aXR5KGlkKSkge1xuICAgICAgICBjYih0aGlzLmdldEVudGl0eShpZCkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgZmlsdGVyLCBwYWlyd2lzZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IF9fZ2xvYmFsU3RhdGUgfSBmcm9tICcuLi8uLi9pbnRlcm5hbC9nbG9iYWwtc3RhdGUnO1xuaW1wb3J0IHsgdG9Cb29sZWFuIH0gZnJvbSAnLi4vLi4vaW50ZXJuYWwvdXRpbHMnO1xuaW1wb3J0IHsgQWtpdGFQbHVnaW4sIFF1ZXJpZXMgfSBmcm9tICcuLi9wbHVnaW4nO1xuaW1wb3J0IHsgRW50aXR5UGFyYW0gfSBmcm9tICcuLi9lbnRpdHktY29sbGVjdGlvbi1wbHVnaW4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRlSGlzdG9yeVBhcmFtcyB7XG4gIG1heEFnZT86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIFN0YXRlSGlzdG9yeVBsdWdpbjxFID0gYW55LCBTID0gYW55PiBleHRlbmRzIEFraXRhUGx1Z2luPEUsIFM+IHtcbiAgLyoqIEFsbG93IHNraXBwaW5nIGFuIHVwZGF0ZSBmcm9tIG91dHNpZGUgKi9cbiAgcHJpdmF0ZSBza2lwID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBoaXN0b3J5ID0ge1xuICAgIHBhc3Q6IFtdLFxuICAgIHByZXNlbnQ6IG51bGwsXG4gICAgZnV0dXJlOiBbXVxuICB9O1xuXG4gIC8qKiBTa2lwIHRoZSB1cGRhdGUgd2hlbiByZWRvL3VuZG8gKi9cbiAgcHJpdmF0ZSBza2lwVXBkYXRlID0gZmFsc2U7XG4gIHByaXZhdGUgc3Vic2NyaXB0aW9uO1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBxdWVyeTogUXVlcmllczxFLCBTPiwgcHJpdmF0ZSBwYXJhbXM6IFN0YXRlSGlzdG9yeVBhcmFtcyA9IHt9LCBwcml2YXRlIF9lbnRpdHlJZD86IEVudGl0eVBhcmFtKSB7XG4gICAgc3VwZXIocXVlcnksIHtcbiAgICAgIHJlc2V0Rm46ICgpID0+IHRoaXMuY2xlYXIoKVxuICAgIH0pO1xuICAgIHBhcmFtcy5tYXhBZ2UgPSB0b0Jvb2xlYW4ocGFyYW1zLm1heEFnZSkgPyBwYXJhbXMubWF4QWdlIDogMTA7XG4gICAgdGhpcy5hY3RpdmF0ZSgpO1xuICB9XG5cbiAgZ2V0IGhhc1Bhc3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGlzdG9yeS5wYXN0Lmxlbmd0aCA+IDA7XG4gIH1cblxuICBnZXQgaGFzRnV0dXJlKCkge1xuICAgIHJldHVybiB0aGlzLmhpc3RvcnkuZnV0dXJlLmxlbmd0aCA+IDA7XG4gIH1cblxuICBhY3RpdmF0ZSgpIHtcbiAgICB0aGlzLmhpc3RvcnkucHJlc2VudCA9IHRoaXMuZ2V0U291cmNlKHRoaXMuX2VudGl0eUlkKTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbiA9IHRoaXMuc2VsZWN0U291cmNlKHRoaXMuX2VudGl0eUlkKVxuICAgICAgLnBpcGUocGFpcndpc2UoKSlcbiAgICAgIC5zdWJzY3JpYmUoKFtwYXN0LCBwcmVzZW50XSkgPT4ge1xuICAgICAgICBpZiAodGhpcy5za2lwKSB7XG4gICAgICAgICAgdGhpcy5za2lwID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5za2lwVXBkYXRlKSB7XG4gICAgICAgICAgaWYgKHRoaXMuaGlzdG9yeS5wYXN0Lmxlbmd0aCA9PT0gdGhpcy5wYXJhbXMubWF4QWdlKSB7XG4gICAgICAgICAgICB0aGlzLmhpc3RvcnkucGFzdCA9IHRoaXMuaGlzdG9yeS5wYXN0LnNsaWNlKDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmhpc3RvcnkucGFzdCA9IFsuLi50aGlzLmhpc3RvcnkucGFzdCwgcGFzdF07XG4gICAgICAgICAgdGhpcy5oaXN0b3J5LnByZXNlbnQgPSBwcmVzZW50O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxuXG4gIHVuZG8oKSB7XG4gICAgaWYgKHRoaXMuaGlzdG9yeS5wYXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHsgcGFzdCwgcHJlc2VudCwgZnV0dXJlIH0gPSB0aGlzLmhpc3Rvcnk7XG4gICAgICBjb25zdCBwcmV2aW91cyA9IHBhc3RbcGFzdC5sZW5ndGggLSAxXTtcbiAgICAgIGNvbnN0IG5ld1Bhc3QgPSBwYXN0LnNsaWNlKDAsIHBhc3QubGVuZ3RoIC0gMSk7XG5cbiAgICAgIHRoaXMuaGlzdG9yeS5wYXN0ID0gbmV3UGFzdDtcbiAgICAgIHRoaXMuaGlzdG9yeS5wcmVzZW50ID0gcHJldmlvdXM7XG4gICAgICB0aGlzLmhpc3RvcnkuZnV0dXJlID0gW3ByZXNlbnQsIC4uLnRoaXMuaGlzdG9yeS5mdXR1cmVdO1xuICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9XG4gIH1cblxuICByZWRvKCkge1xuICAgIGlmICh0aGlzLmhpc3RvcnkuZnV0dXJlLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHsgcGFzdCwgcHJlc2VudCwgZnV0dXJlIH0gPSB0aGlzLmhpc3Rvcnk7XG4gICAgICBjb25zdCBuZXh0ID0gdGhpcy5oaXN0b3J5LmZ1dHVyZVswXTtcbiAgICAgIGNvbnN0IG5ld0Z1dHVyZSA9IHRoaXMuaGlzdG9yeS5mdXR1cmUuc2xpY2UoMSk7XG4gICAgICB0aGlzLmhpc3RvcnkucGFzdCA9IFsuLi5wYXN0LCBwcmVzZW50XTtcbiAgICAgIHRoaXMuaGlzdG9yeS5wcmVzZW50ID0gbmV4dDtcbiAgICAgIHRoaXMuaGlzdG9yeS5mdXR1cmUgPSBuZXdGdXR1cmU7XG4gICAgICB0aGlzLnVwZGF0ZSgnUmVkbycpO1xuICAgIH1cbiAgfVxuXG4gIGp1bXBUb1Bhc3QoaW5kZXg6IG51bWJlcikge1xuICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5oaXN0b3J5LnBhc3QubGVuZ3RoKSByZXR1cm47XG5cbiAgICBjb25zdCB7IHBhc3QsIGZ1dHVyZSB9ID0gdGhpcy5oaXN0b3J5O1xuICAgIC8qKlxuICAgICAqXG4gICAgICogY29uc3QgcGFzdCA9IFsxLCAyLCAzLCA0LCA1XTtcbiAgICAgKlxuICAgICAqIG5ld1Bhc3QgPSBwYXN0LnNsaWNlKDAsIDIpID0gWzEsIDJdO1xuICAgICAqIHByZXNlbnQgPSBwYXN0W2luZGV4XSA9IDM7XG4gICAgICogWy4uLnBhc3Quc2xpY2UoMiArIDEpLCAuLi5mdXR1cmVdID0gWzQsIDVdO1xuICAgICAqXG4gICAgICovXG4gICAgY29uc3QgbmV3UGFzdCA9IHBhc3Quc2xpY2UoMCwgaW5kZXgpO1xuICAgIGNvbnN0IG5ld0Z1dHVyZSA9IFsuLi5wYXN0LnNsaWNlKGluZGV4ICsgMSksIC4uLmZ1dHVyZV07XG4gICAgY29uc3QgbmV3UHJlc2VudCA9IHBhc3RbaW5kZXhdO1xuICAgIHRoaXMuaGlzdG9yeS5wYXN0ID0gbmV3UGFzdDtcbiAgICB0aGlzLmhpc3RvcnkucHJlc2VudCA9IG5ld1ByZXNlbnQ7XG4gICAgdGhpcy5oaXN0b3J5LmZ1dHVyZSA9IG5ld0Z1dHVyZTtcbiAgICB0aGlzLnVwZGF0ZSgpO1xuICB9XG5cbiAganVtcFRvRnV0dXJlKGluZGV4OiBudW1iZXIpIHtcbiAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMuaGlzdG9yeS5mdXR1cmUubGVuZ3RoKSByZXR1cm47XG5cbiAgICBjb25zdCB7IHBhc3QsIGZ1dHVyZSB9ID0gdGhpcy5oaXN0b3J5O1xuXG4gICAgY29uc3QgbmV3UGFzdCA9IFsuLi5wYXN0LCAuLi5mdXR1cmUuc2xpY2UoMCwgaW5kZXgpXTtcbiAgICBjb25zdCBuZXdQcmVzZW50ID0gZnV0dXJlW2luZGV4XTtcbiAgICBjb25zdCBuZXdGdXR1cmUgPSBmdXR1cmUuc2xpY2UoaW5kZXggKyAxKTtcblxuICAgIHRoaXMuaGlzdG9yeS5wYXN0ID0gbmV3UGFzdDtcbiAgICB0aGlzLmhpc3RvcnkucHJlc2VudCA9IG5ld1ByZXNlbnQ7XG4gICAgdGhpcy5oaXN0b3J5LmZ1dHVyZSA9IG5ld0Z1dHVyZTtcbiAgICB0aGlzLnVwZGF0ZSgnUmVkbycpO1xuICB9XG5cbiAgY2xlYXIoKSB7XG4gICAgdGhpcy5oaXN0b3J5ID0ge1xuICAgICAgcGFzdDogW10sXG4gICAgICBwcmVzZW50OiBudWxsLFxuICAgICAgZnV0dXJlOiBbXVxuICAgIH07XG4gIH1cblxuICBkZXN0cm95KGNsZWFySGlzdG9yeSA9IGZhbHNlKSB7XG4gICAgaWYgKGNsZWFySGlzdG9yeSkge1xuICAgICAgdGhpcy5jbGVhcigpO1xuICAgIH1cbiAgICB0aGlzLnN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICB9XG5cbiAgaWdub3JlTmV4dCgpIHtcbiAgICB0aGlzLnNraXAgPSB0cnVlO1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGUoYWN0aW9uID0gJ1VuZG8nKSB7XG4gICAgdGhpcy5za2lwVXBkYXRlID0gdHJ1ZTtcbiAgICBfX2dsb2JhbFN0YXRlLnNldEN1c3RvbUFjdGlvbih7IHR5cGU6IGBAU3RhdGVIaXN0b3J5IC0gJHthY3Rpb259YCB9KTtcbiAgICB0aGlzLnVwZGF0ZVN0b3JlKHRoaXMuaGlzdG9yeS5wcmVzZW50LCB0aGlzLl9lbnRpdHlJZCk7XG4gICAgdGhpcy5za2lwVXBkYXRlID0gZmFsc2U7XG4gIH1cbn1cbiIsImltcG9ydCB7IElELCBJRFMgfSBmcm9tICcuLi8uLi9hcGkvdHlwZXMnO1xuaW1wb3J0IHsgUXVlcnlFbnRpdHkgfSBmcm9tICcuLi8uLi9hcGkvcXVlcnktZW50aXR5JztcbmltcG9ydCB7IFN0YXRlSGlzdG9yeVBsdWdpbiwgU3RhdGVIaXN0b3J5UGFyYW1zIH0gZnJvbSAnLi9zdGF0ZS1oaXN0b3J5LXBsdWdpbic7XG5pbXBvcnQgeyB0b0Jvb2xlYW4gfSBmcm9tICcuLi8uLi9pbnRlcm5hbC91dGlscyc7XG5pbXBvcnQgeyBza2lwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgRW50aXR5Q29sbGVjdGlvblBsdWdpbiwgRW50aXR5Q29sbGVjdGlvblBhcmFtcyB9IGZyb20gJy4uL2VudGl0eS1jb2xsZWN0aW9uLXBsdWdpbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGVIaXN0b3J5RW50aXR5UGFyYW1zIGV4dGVuZHMgU3RhdGVIaXN0b3J5UGFyYW1zIHtcbiAgZW50aXR5SWRzPzogRW50aXR5Q29sbGVjdGlvblBhcmFtcztcbn1cblxuZXhwb3J0IGNsYXNzIEVudGl0eVN0YXRlSGlzdG9yeVBsdWdpbjxFLCBQIGV4dGVuZHMgU3RhdGVIaXN0b3J5UGx1Z2luPEUsIGFueT4gPSBTdGF0ZUhpc3RvcnlQbHVnaW48RSwgYW55Pj4gZXh0ZW5kcyBFbnRpdHlDb2xsZWN0aW9uUGx1Z2luPEUsIFA+IHtcbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIHF1ZXJ5OiBRdWVyeUVudGl0eTxhbnksIEU+LCBwcm90ZWN0ZWQgcmVhZG9ubHkgcGFyYW1zOiBTdGF0ZUhpc3RvcnlFbnRpdHlQYXJhbXMgPSB7fSkge1xuICAgIHN1cGVyKHF1ZXJ5LCBwYXJhbXMuZW50aXR5SWRzKTtcbiAgICBwYXJhbXMubWF4QWdlID0gdG9Cb29sZWFuKHBhcmFtcy5tYXhBZ2UpID8gcGFyYW1zLm1heEFnZSA6IDEwO1xuICAgIHRoaXMuYWN0aXZhdGUoKTtcbiAgICB0aGlzLnNlbGVjdElkcygpXG4gICAgICAucGlwZShza2lwKDEpKVxuICAgICAgLnN1YnNjcmliZShpZHMgPT4gdGhpcy5hY3RpdmF0ZShpZHMpKTtcbiAgfVxuXG4gIHJlZG8oaWRzPzogSURTKSB7XG4gICAgdGhpcy5mb3JFYWNoSWQoaWRzLCBlID0+IGUucmVkbygpKTtcbiAgfVxuXG4gIHVuZG8oaWRzPzogSURTKSB7XG4gICAgdGhpcy5mb3JFYWNoSWQoaWRzLCBlID0+IGUudW5kbygpKTtcbiAgfVxuXG4gIGhhc1Bhc3QoaWQ6IElEKSB7XG4gICAgaWYgKHRoaXMuaGFzRW50aXR5KGlkKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0RW50aXR5KGlkKS5oYXNQYXN0O1xuICAgIH1cbiAgfVxuXG4gIGhhc0Z1dHVyZShpZDogSUQpIHtcbiAgICBpZiAodGhpcy5oYXNFbnRpdHkoaWQpKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRFbnRpdHkoaWQpLmhhc0Z1dHVyZTtcbiAgICB9XG4gIH1cblxuICBqdW1wVG9GdXR1cmUoaWRzOiBJRFMsIGluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLmZvckVhY2hJZChpZHMsIGUgPT4gZS5qdW1wVG9GdXR1cmUoaW5kZXgpKTtcbiAgfVxuXG4gIGp1bXBUb1Bhc3QoaWRzOiBJRFMsIGluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLmZvckVhY2hJZChpZHMsIGUgPT4gZS5qdW1wVG9QYXN0KGluZGV4KSk7XG4gIH1cblxuICBjbGVhcihpZHM/OiBJRFMpIHtcbiAgICB0aGlzLmZvckVhY2hJZChpZHMsIGUgPT4gZS5jbGVhcigpKTtcbiAgfVxuXG4gIGRlc3Ryb3koaWRzPzogSURTLCBjbGVhckhpc3RvcnkgPSBmYWxzZSkge1xuICAgIHRoaXMuZm9yRWFjaElkKGlkcywgZSA9PiBlLmRlc3Ryb3koY2xlYXJIaXN0b3J5KSk7XG4gIH1cblxuICBpZ25vcmVOZXh0KGlkcz86IElEUykge1xuICAgIHRoaXMuZm9yRWFjaElkKGlkcywgZSA9PiBlLmlnbm9yZU5leHQoKSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgaW5zdGFudGlhdGVQbHVnaW4oaWQ6IElEKSB7XG4gICAgcmV0dXJuIG5ldyBTdGF0ZUhpc3RvcnlQbHVnaW48RSwgYW55Pih0aGlzLnF1ZXJ5LCB0aGlzLnBhcmFtcywgaWQpIGFzIFA7XG4gIH1cbn1cbiIsImltcG9ydCB7IEFraXRhUGx1Z2luLCBRdWVyaWVzIH0gZnJvbSAnLi4vcGx1Z2luJztcbmltcG9ydCB7IFF1ZXJ5RW50aXR5IH0gZnJvbSAnLi4vLi4vYXBpL3F1ZXJ5LWVudGl0eSc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUsIFN1YmplY3QsIFN1YnNjcmlwdGlvbiwgY29tYmluZUxhdGVzdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZGlzdGluY3RVbnRpbENoYW5nZWQsIG1hcCwgc2tpcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IGNvZXJjZUFycmF5LCBpc0Z1bmN0aW9uLCBpc1VuZGVmaW5lZCwgdG9Cb29sZWFuIH0gZnJvbSAnLi4vLi4vaW50ZXJuYWwvdXRpbHMnO1xuaW1wb3J0IHsgRW50aXR5UGFyYW0gfSBmcm9tICcuLi9lbnRpdHktY29sbGVjdGlvbi1wbHVnaW4nO1xuaW1wb3J0IHsgX19nbG9iYWxTdGF0ZSB9IGZyb20gJy4uLy4uL2ludGVybmFsL2dsb2JhbC1zdGF0ZSc7XG5pbXBvcnQgeyBRdWVyeSB9IGZyb20gJy4uLy4uL2FwaS9xdWVyeSc7XG5cbnR5cGUgSGVhZDxTdG9yZVN0YXRlID0gYW55LCBFbnRpdHkgPSBhbnk+ID0gU3RvcmVTdGF0ZSB8IFBhcnRpYWw8U3RvcmVTdGF0ZT4gfCBFbnRpdHk7XG5cbmV4cG9ydCB0eXBlIERpcnR5Q2hlY2tDb21wYXJhdG9yPEVudGl0eT4gPSAoaGVhZDogRW50aXR5LCBjdXJyZW50OiBFbnRpdHkpID0+IGJvb2xlYW47XG5cbmV4cG9ydCB0eXBlIERpcnR5Q2hlY2tQYXJhbXM8U3RvcmVTdGF0ZSA9IGFueT4gPSB7XG4gIGNvbXBhcmF0b3I/OiBEaXJ0eUNoZWNrQ29tcGFyYXRvcjxTdG9yZVN0YXRlPjtcbiAgd2F0Y2hQcm9wZXJ0eT86IGtleW9mIFN0b3JlU3RhdGUgfCAoa2V5b2YgU3RvcmVTdGF0ZSlbXTtcbn07XG5cbmV4cG9ydCBjb25zdCBkaXJ0eUNoZWNrRGVmYXVsdFBhcmFtcyA9IHtcbiAgY29tcGFyYXRvcjogKGhlYWQsIGN1cnJlbnQpID0+IEpTT04uc3RyaW5naWZ5KGhlYWQpICE9PSBKU09OLnN0cmluZ2lmeShjdXJyZW50KVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldE5lc3RlZFBhdGgobmVzdGVkT2JqLCBwYXRoOiBzdHJpbmcpIHtcbiAgY29uc3QgcGF0aEFzQXJyYXk6IHN0cmluZ1tdID0gcGF0aC5zcGxpdCgnLicpO1xuICByZXR1cm4gcGF0aEFzQXJyYXkucmVkdWNlKChvYmosIGtleSkgPT4gKG9iaiAmJiBvYmpba2V5XSAhPT0gJ3VuZGVmaW5lZCcgPyBvYmpba2V5XSA6IHVuZGVmaW5lZCksIG5lc3RlZE9iaik7XG59XG5cbmV4cG9ydCB0eXBlIERpcnR5Q2hlY2tSZXNldFBhcmFtczxTdG9yZVN0YXRlID0gYW55PiA9IHtcbiAgdXBkYXRlRm4/OiBTdG9yZVN0YXRlIHwgKChoZWFkOiBTdG9yZVN0YXRlLCBjdXJyZW50OiBTdG9yZVN0YXRlKSA9PiBhbnkpO1xufTtcblxuZXhwb3J0IGNsYXNzIERpcnR5Q2hlY2tQbHVnaW48RW50aXR5ID0gYW55LCBTdG9yZVN0YXRlID0gYW55PiBleHRlbmRzIEFraXRhUGx1Z2luPEVudGl0eSwgU3RvcmVTdGF0ZT4ge1xuICBwcml2YXRlIGhlYWQ6IEhlYWQ8U3RvcmVTdGF0ZSwgRW50aXR5PjtcbiAgcHJpdmF0ZSBkaXJ0eSA9IG5ldyBCZWhhdmlvclN1YmplY3QoZmFsc2UpO1xuICBwcml2YXRlIHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuICBwcml2YXRlIGFjdGl2ZSA9IGZhbHNlO1xuICBwcml2YXRlIF9yZXNldCA9IG5ldyBTdWJqZWN0KCk7XG5cbiAgaXNEaXJ0eSQ6IE9ic2VydmFibGU8Ym9vbGVhbj4gPSB0aGlzLmRpcnR5LmFzT2JzZXJ2YWJsZSgpLnBpcGUoZGlzdGluY3RVbnRpbENoYW5nZWQoKSk7XG4gIHJlc2V0JCA9IHRoaXMuX3Jlc2V0LmFzT2JzZXJ2YWJsZSgpO1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBxdWVyeTogUXVlcmllczxFbnRpdHksIFN0b3JlU3RhdGU+LCBwcml2YXRlIHBhcmFtcz86IERpcnR5Q2hlY2tQYXJhbXMsIHByaXZhdGUgX2VudGl0eUlkPzogRW50aXR5UGFyYW0pIHtcbiAgICBzdXBlcihxdWVyeSk7XG4gICAgdGhpcy5wYXJhbXMgPSB7IC4uLmRpcnR5Q2hlY2tEZWZhdWx0UGFyYW1zLCAuLi5wYXJhbXMgfTtcbiAgICBpZiAodGhpcy5wYXJhbXMud2F0Y2hQcm9wZXJ0eSkge1xuICAgICAgbGV0IHdhdGNoUHJvcCA9IGNvZXJjZUFycmF5KHRoaXMucGFyYW1zLndhdGNoUHJvcGVydHkpIGFzIGFueVtdO1xuICAgICAgaWYgKHF1ZXJ5IGluc3RhbmNlb2YgUXVlcnlFbnRpdHkgJiYgd2F0Y2hQcm9wLmluY2x1ZGVzKCdlbnRpdGllcycpICYmICF3YXRjaFByb3AuaW5jbHVkZXMoJ2lkcycpKSB7XG4gICAgICAgIHdhdGNoUHJvcC5wdXNoKCdpZHMnKTtcbiAgICAgIH1cbiAgICAgIHRoaXMucGFyYW1zLndhdGNoUHJvcGVydHkgPSB3YXRjaFByb3A7XG4gICAgfVxuICB9XG5cbiAgcmVzZXQocGFyYW1zOiBEaXJ0eUNoZWNrUmVzZXRQYXJhbXMgPSB7fSkge1xuICAgIGxldCBjdXJyZW50VmFsdWUgPSB0aGlzLmhlYWQ7XG4gICAgaWYgKGlzRnVuY3Rpb24ocGFyYW1zLnVwZGF0ZUZuKSkge1xuICAgICAgaWYgKHRoaXMuaXNFbnRpdHlCYXNlZCh0aGlzLl9lbnRpdHlJZCkpIHtcbiAgICAgICAgY3VycmVudFZhbHVlID0gcGFyYW1zLnVwZGF0ZUZuKHRoaXMuaGVhZCwgKHRoaXMuZ2V0UXVlcnkoKSBhcyBRdWVyeUVudGl0eTxTdG9yZVN0YXRlLCBFbnRpdHk+KS5nZXRFbnRpdHkodGhpcy5fZW50aXR5SWQpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnRWYWx1ZSA9IHBhcmFtcy51cGRhdGVGbih0aGlzLmhlYWQsICh0aGlzLmdldFF1ZXJ5KCkgYXMgUXVlcnk8U3RvcmVTdGF0ZT4pLmdldFNuYXBzaG90KCkpO1xuICAgICAgfVxuICAgIH1cbiAgICBfX2dsb2JhbFN0YXRlLnNldEN1c3RvbUFjdGlvbih7IHR5cGU6IGBARGlydHlDaGVjayAtIFJldmVydGAgfSk7XG4gICAgdGhpcy51cGRhdGVTdG9yZShjdXJyZW50VmFsdWUsIHRoaXMuX2VudGl0eUlkKTtcbiAgICB0aGlzLl9yZXNldC5uZXh0KCk7XG4gIH1cblxuICBzZXRIZWFkKCkge1xuICAgIGlmICghdGhpcy5hY3RpdmUpIHtcbiAgICAgIHRoaXMuYWN0aXZhdGUoKTtcbiAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5oZWFkID0gdGhpcy5fZ2V0SGVhZCgpO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZURpcnRpbmVzcyhmYWxzZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBpc0RpcnR5KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0b0Jvb2xlYW4odGhpcy5kaXJ0eS52YWx1ZSk7XG4gIH1cblxuICBoYXNIZWFkKCkge1xuICAgIHJldHVybiB0b0Jvb2xlYW4odGhpcy5nZXRIZWFkKCkpO1xuICB9XG5cbiAgZGVzdHJveSgpIHtcbiAgICB0aGlzLmhlYWQgPSBudWxsO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uICYmIHRoaXMuc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgdGhpcy5fcmVzZXQgJiYgdGhpcy5fcmVzZXQuY29tcGxldGUoKTtcbiAgfVxuXG4gIGlzUGF0aERpcnR5KHBhdGg6IHN0cmluZykge1xuICAgIGNvbnN0IGhlYWQgPSB0aGlzLmdldEhlYWQoKTtcbiAgICBjb25zdCBjdXJyZW50ID0gKHRoaXMuZ2V0UXVlcnkoKSBhcyBRdWVyeTxTdG9yZVN0YXRlPikuZ2V0U25hcHNob3QoKTtcbiAgICBjb25zdCBjdXJyZW50UGF0aFZhbHVlID0gZ2V0TmVzdGVkUGF0aChjdXJyZW50LCBwYXRoKTtcbiAgICBjb25zdCBoZWFkUGF0aFZhbHVlID0gZ2V0TmVzdGVkUGF0aChoZWFkLCBwYXRoKTtcblxuICAgIHJldHVybiB0aGlzLnBhcmFtcy5jb21wYXJhdG9yKGN1cnJlbnRQYXRoVmFsdWUsIGhlYWRQYXRoVmFsdWUpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldEhlYWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGVhZDtcbiAgfVxuXG4gIHByaXZhdGUgYWN0aXZhdGUoKSB7XG4gICAgdGhpcy5oZWFkID0gdGhpcy5fZ2V0SGVhZCgpO1xuICAgIC8qKiBpZiB3ZSBhcmUgdHJhY2tpbmcgc3BlY2lmaWMgcHJvcGVydGllcyBzZWxlY3Qgb25seSB0aGUgcmVsZXZhbnQgb25lcyAqL1xuICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMucGFyYW1zLndhdGNoUHJvcGVydHlcbiAgICAgID8gKHRoaXMucGFyYW1zLndhdGNoUHJvcGVydHkgYXMgKGtleW9mIFN0b3JlU3RhdGUpW10pLm1hcChwcm9wID0+XG4gICAgICAgICAgdGhpcy5xdWVyeS5zZWxlY3Qoc3RhdGUgPT4gc3RhdGVbcHJvcF0pLnBpcGUoXG4gICAgICAgICAgICBtYXAodmFsID0+ICh7XG4gICAgICAgICAgICAgIHZhbCxcbiAgICAgICAgICAgICAgX19ha2l0YUtleTogcHJvcFxuICAgICAgICAgICAgfSkpXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICA6IFt0aGlzLnNlbGVjdFNvdXJjZSh0aGlzLl9lbnRpdHlJZCldO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gY29tYmluZUxhdGVzdCguLi5zb3VyY2UpXG4gICAgICAucGlwZShza2lwKDEpKVxuICAgICAgLnN1YnNjcmliZSgoY3VycmVudFN0YXRlOiBhbnlbXSkgPT4ge1xuICAgICAgICBpZiAoaXNVbmRlZmluZWQodGhpcy5oZWFkKSkgcmV0dXJuO1xuICAgICAgICAvKiogX19ha2l0YUtleSBpcyB1c2VkIHRvIGRldGVybWluZSBpZiB3ZSBhcmUgdHJhY2tpbmcgYSBzcGVjaWZpYyBwcm9wZXJ0eSBvciBhIHN0b3JlIGNoYW5nZSAqL1xuICAgICAgICBjb25zdCBpc0NoYW5nZSA9IGN1cnJlbnRTdGF0ZS5zb21lKHN0YXRlID0+IHtcbiAgICAgICAgICBjb25zdCBoZWFkID0gc3RhdGUuX19ha2l0YUtleSA/IHRoaXMuaGVhZFtzdGF0ZS5fX2FraXRhS2V5IGFzIGFueV0gOiB0aGlzLmhlYWQ7XG4gICAgICAgICAgY29uc3QgY29tcGFyZVRvID0gc3RhdGUuX19ha2l0YUtleSA/IHN0YXRlLnZhbCA6IHN0YXRlO1xuXG4gICAgICAgICAgcmV0dXJuIHRoaXMucGFyYW1zLmNvbXBhcmF0b3IoaGVhZCwgY29tcGFyZVRvKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVEaXJ0aW5lc3MoaXNDaGFuZ2UpO1xuICAgICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZURpcnRpbmVzcyhpc0RpcnR5OiBib29sZWFuKSB7XG4gICAgdGhpcy5kaXJ0eS5uZXh0KGlzRGlydHkpO1xuICB9XG5cbiAgcHJpdmF0ZSBfZ2V0SGVhZCgpOiBIZWFkPFN0b3JlU3RhdGUsIEVudGl0eT4ge1xuICAgIGxldCBoZWFkOiBIZWFkPFN0b3JlU3RhdGUsIEVudGl0eT4gPSB0aGlzLmdldFNvdXJjZSh0aGlzLl9lbnRpdHlJZCk7XG4gICAgaWYgKHRoaXMucGFyYW1zLndhdGNoUHJvcGVydHkpIHtcbiAgICAgIGhlYWQgPSB0aGlzLmdldFdhdGNoZWRWYWx1ZXMoaGVhZCBhcyBTdG9yZVN0YXRlKTtcbiAgICB9XG4gICAgcmV0dXJuIGhlYWQ7XG4gIH1cblxuICBwcml2YXRlIGdldFdhdGNoZWRWYWx1ZXMoc291cmNlOiBTdG9yZVN0YXRlKTogUGFydGlhbDxTdG9yZVN0YXRlPiB7XG4gICAgcmV0dXJuICh0aGlzLnBhcmFtcy53YXRjaFByb3BlcnR5IGFzIChrZXlvZiBTdG9yZVN0YXRlKVtdKS5yZWR1Y2UoXG4gICAgICAod2F0Y2hlZCwgcHJvcCkgPT4ge1xuICAgICAgICB3YXRjaGVkW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgICByZXR1cm4gd2F0Y2hlZDtcbiAgICAgIH0sXG4gICAgICB7fSBhcyBQYXJ0aWFsPFN0b3JlU3RhdGU+XG4gICAgKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgSGFzaE1hcCwgSUQsIElEUyB9IGZyb20gJy4uLy4uL2FwaS90eXBlcyc7XG5pbXBvcnQge1xuICBEaXJ0eUNoZWNrQ29tcGFyYXRvcixcbiAgZGlydHlDaGVja0RlZmF1bHRQYXJhbXMsXG4gIERpcnR5Q2hlY2tQbHVnaW4sXG4gIERpcnR5Q2hlY2tSZXNldFBhcmFtcyxcbiAgZ2V0TmVzdGVkUGF0aFxufSBmcm9tICcuL2RpcnR5LWNoZWNrLXBsdWdpbic7XG5pbXBvcnQgeyBRdWVyeUVudGl0eSB9IGZyb20gJy4uLy4uL2FwaS9xdWVyeS1lbnRpdHknO1xuaW1wb3J0IHsgRW50aXR5Q29sbGVjdGlvblBsdWdpbiB9IGZyb20gJy4uL2VudGl0eS1jb2xsZWN0aW9uLXBsdWdpbic7XG5pbXBvcnQgeyBtYXAsIHNraXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5cbmV4cG9ydCB0eXBlIERpcnR5Q2hlY2tDb2xsZWN0aW9uUGFyYW1zPEU+ID0ge1xuICBjb21wYXJhdG9yPzogRGlydHlDaGVja0NvbXBhcmF0b3I8RT47XG4gIGVudGl0eUlkcz86IElEIHwgSURbXTtcbn07XG5cbmV4cG9ydCBjbGFzcyBFbnRpdHlEaXJ0eUNoZWNrUGx1Z2luPEUsIFAgZXh0ZW5kcyBEaXJ0eUNoZWNrUGx1Z2luPEUsIGFueT4gPSBEaXJ0eUNoZWNrUGx1Z2luPEUsIGFueT4+IGV4dGVuZHMgRW50aXR5Q29sbGVjdGlvblBsdWdpbjxFLCBQPiB7XG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZCBVc2Ugc29tZURpcnR5JCBpbnN0ZWFkXG4gICAqL1xuICBpc1NvbWVEaXJ0eSQ6IE9ic2VydmFibGU8Ym9vbGVhbj4gPSB0aGlzLnF1ZXJ5LnNlbGVjdChzdGF0ZSA9PiBzdGF0ZS5lbnRpdGllcykucGlwZShtYXAoKGVudGl0aWVzOiBhbnkpID0+IHRoaXMuY2hlY2tTb21lRGlydHkoZW50aXRpZXMpKSk7XG5cbiAgc29tZURpcnR5JCA9IHRoaXMuaXNTb21lRGlydHkkO1xuICBzb21lRGlydHkgPSB0aGlzLmlzU29tZURpcnR5O1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBxdWVyeTogUXVlcnlFbnRpdHk8YW55LCBFPiwgcHJpdmF0ZSByZWFkb25seSBwYXJhbXM6IERpcnR5Q2hlY2tDb2xsZWN0aW9uUGFyYW1zPEU+ID0ge30pIHtcbiAgICBzdXBlcihxdWVyeSwgcGFyYW1zLmVudGl0eUlkcyk7XG4gICAgdGhpcy5wYXJhbXMgPSB7IC4uLmRpcnR5Q2hlY2tEZWZhdWx0UGFyYW1zLCAuLi5wYXJhbXMgfTtcbiAgICB0aGlzLmFjdGl2YXRlKCk7XG4gICAgdGhpcy5zZWxlY3RJZHMoKVxuICAgICAgLnBpcGUoc2tpcCgxKSlcbiAgICAgIC5zdWJzY3JpYmUoaWRzID0+IHtcbiAgICAgICAgdGhpcy5yZWJhc2UoaWRzLCB7IGFmdGVyQWRkOiBwbHVnaW4gPT4gcGx1Z2luLnNldEhlYWQoKSB9KTtcbiAgICAgIH0pO1xuICB9XG5cbiAgc2V0SGVhZChpZHM/OiBJRFMpIHtcbiAgICB0aGlzLmZvckVhY2hJZChpZHMsIGUgPT4gZS5zZXRIZWFkKCkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgaGFzSGVhZChpZDogSUQpOiBib29sZWFuIHtcbiAgICBpZiAodGhpcy5lbnRpdGllcy5oYXMoaWQpKSB7XG4gICAgICBjb25zdCBlbnRpdHkgPSB0aGlzLmdldEVudGl0eShpZCk7XG4gICAgICByZXR1cm4gZW50aXR5Lmhhc0hlYWQoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXNldChpZHM/OiBJRFMsIHBhcmFtczogRGlydHlDaGVja1Jlc2V0UGFyYW1zID0ge30pIHtcbiAgICB0aGlzLmZvckVhY2hJZChpZHMsIGUgPT4gZS5yZXNldChwYXJhbXMpKTtcbiAgfVxuXG4gIGlzRGlydHkoaWQ6IElEKTogT2JzZXJ2YWJsZTxib29sZWFuPjtcbiAgaXNEaXJ0eShpZDogSUQsIGFzT2JzZXJ2YWJsZTogdHJ1ZSk6IE9ic2VydmFibGU8Ym9vbGVhbj47XG4gIGlzRGlydHkoaWQ6IElELCBhc09ic2VydmFibGU6IGZhbHNlKTogYm9vbGVhbjtcbiAgaXNEaXJ0eShpZDogSUQsIGFzT2JzZXJ2YWJsZSA9IHRydWUpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHwgYm9vbGVhbiB7XG4gICAgaWYgKHRoaXMuZW50aXRpZXMuaGFzKGlkKSkge1xuICAgICAgY29uc3QgZW50aXR5ID0gdGhpcy5nZXRFbnRpdHkoaWQpO1xuICAgICAgcmV0dXJuIGFzT2JzZXJ2YWJsZSA/IGVudGl0eS5pc0RpcnR5JCA6IGVudGl0eS5pc0RpcnR5KCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkIFVzZSBzb21lRGlydHkoKSBpbnN0ZWFkXG4gICAqL1xuICBpc1NvbWVEaXJ0eSgpOiBib29sZWFuIHtcbiAgICBjb25zdCBlbnRpdGllcyA9IHRoaXMucXVlcnkuZ2V0QWxsKHsgYXNPYmplY3Q6IHRydWUgfSk7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2tTb21lRGlydHkoZW50aXRpZXMpO1xuICB9XG5cbiAgaXNQYXRoRGlydHkoaWQ6IElELCBwYXRoOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5lbnRpdGllcy5oYXMoaWQpKSB7XG4gICAgICBjb25zdCBoZWFkID0gKHRoaXMuZ2V0RW50aXR5KGlkKSBhcyBhbnkpLmdldEhlYWQoKTtcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLnF1ZXJ5LmdldEVudGl0eShpZCk7XG4gICAgICBjb25zdCBjdXJyZW50UGF0aFZhbHVlID0gZ2V0TmVzdGVkUGF0aChjdXJyZW50LCBwYXRoKTtcbiAgICAgIGNvbnN0IGhlYWRQYXRoVmFsdWUgPSBnZXROZXN0ZWRQYXRoKGhlYWQsIHBhdGgpO1xuXG4gICAgICByZXR1cm4gdGhpcy5wYXJhbXMuY29tcGFyYXRvcihjdXJyZW50UGF0aFZhbHVlLCBoZWFkUGF0aFZhbHVlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGRlc3Ryb3koaWRzPzogSURTKSB7XG4gICAgdGhpcy5mb3JFYWNoSWQoaWRzLCBlID0+IGUuZGVzdHJveSgpKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBpbnN0YW50aWF0ZVBsdWdpbihpZDogSUQpOiBQIHtcbiAgICByZXR1cm4gbmV3IERpcnR5Q2hlY2tQbHVnaW4odGhpcy5xdWVyeSwgdGhpcy5wYXJhbXMsIGlkKSBhcyBQO1xuICB9XG5cbiAgcHJpdmF0ZSBjaGVja1NvbWVEaXJ0eShlbnRpdGllczogSGFzaE1hcDxFPik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGVudGl0aWVzSWRzID0gdGhpcy5yZXNvbHZlZElkcygpO1xuICAgIGZvciAoY29uc3QgaWQgb2YgZW50aXRpZXNJZHMpIHtcbiAgICAgIGNvbnN0IGRpcnR5ID0gdGhpcy5wYXJhbXMuY29tcGFyYXRvcigodGhpcy5nZXRFbnRpdHkoaWQpIGFzIGFueSkuZ2V0SGVhZCgpLCBlbnRpdGllc1tpZF0pO1xuICAgICAgaWYgKGRpcnR5KSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiIsImltcG9ydCB7IGlzTnVtYmVyIH0gZnJvbSAnLi4vaW50ZXJuYWwvdXRpbHMnO1xuaW1wb3J0IHsgX19zdG9yZXNfXyB9IGZyb20gJy4vc3RvcmUnO1xuaW1wb3J0IHsgYXBwbHlUcmFuc2FjdGlvbiB9IGZyb20gJy4vdHJhbnNhY3Rpb24nO1xuXG4vKipcbiAqIEBleGFtcGxlXG4gKlxuICogdGhpcy5wZW9wbGVTdG9yZS51cGRhdGUoaWQsIHBlcnNvbiA9PiAoe1xuICogICBndWVzdHM6IGluY3JlbWVudChwZXJzb24uZ3Vlc3RzKVxuICogfSkpO1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5jcmVtZW50KHZhbHVlOiBudW1iZXIsIHBhcmFtczogeyBtYXhWYWx1ZTogbnVtYmVyIHwgdW5kZWZpbmVkIH0gPSB7IG1heFZhbHVlOiB1bmRlZmluZWQgfSkge1xuICBpZiAoaXNOdW1iZXIodmFsdWUpID09PSBmYWxzZSkgcmV0dXJuO1xuICBpZiAocGFyYW1zLm1heFZhbHVlICYmIHZhbHVlID09PSBwYXJhbXMubWF4VmFsdWUpIHJldHVybiB2YWx1ZTtcbiAgcmV0dXJuIHZhbHVlICsgMTtcbn1cblxuLyoqXG4gKiBAZXhhbXBsZVxuICpcbiAqIHRoaXMucGVvcGxlU3RvcmUudXBkYXRlKGlkLCBwZXJzb24gPT4gKHtcbiAqICAgZ3Vlc3RzOiBkZWNyZW1lbnQocGVyc29uLmd1ZXN0cylcbiAqIH0pKTtcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlY3JlbWVudCh2YWx1ZSwgcGFyYW1zOiB7IGFsbG93TmVnYXRpdmU6IGJvb2xlYW4gfSA9IHsgYWxsb3dOZWdhdGl2ZTogZmFsc2UgfSkge1xuICBpZiAoaXNOdW1iZXIodmFsdWUpID09PSBmYWxzZSkgcmV0dXJuO1xuICBpZiAocGFyYW1zLmFsbG93TmVnYXRpdmUgPT09IGZhbHNlICYmIHZhbHVlID09PSAwKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIHJldHVybiB2YWx1ZSAtIDE7XG59XG5cbi8qKlxuICogR2VuZXJhdGUgcmFuZG9tIGd1aWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGd1aWQoKSB7XG4gIHJldHVybiAneHh4eHh4NHh5eCcucmVwbGFjZSgvW3h5XS9nLCBjID0+IHtcbiAgICBjb25zdCByID0gKE1hdGgucmFuZG9tKCkgKiAxNikgfCAwLFxuICAgICAgdiA9IGMgPT0gJ3gnID8gciA6IChyICYgMHgzKSB8IDB4ODtcbiAgICByZXR1cm4gdi50b1N0cmluZygxNik7XG4gIH0pO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlc2V0U3RvcmVzUGFyYW1zIHtcbiAgLyoqXG4gICAqICBCeSBkZWZhdWx0IHRoZSB3aG9sZSBzdGF0ZSBpcyByZXNldHRlZCwgdXNlIHRoaXMgcGFyYW0gdG8gZXhjbHVkZSBzdG9yZXMgdGhhdCB5b3UgZG9uJ3Qgd2FudCB0byByZXNldC5cbiAgICovXG4gIGV4Y2x1ZGU6IHN0cmluZ1tdO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0gb3B0aW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRTdG9yZXMob3B0aW9ucz86IFBhcnRpYWw8UmVzZXRTdG9yZXNQYXJhbXM+KSB7XG4gIGNvbnN0IGRlZmF1bHRzOiBSZXNldFN0b3Jlc1BhcmFtcyA9IHtcbiAgICBleGNsdWRlOiBbXVxuICB9O1xuXG4gIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0cywgb3B0aW9ucyk7XG4gIGNvbnN0IHN0b3JlcyA9IE9iamVjdC5rZXlzKF9fc3RvcmVzX18pO1xuXG4gIGFwcGx5VHJhbnNhY3Rpb24oKCkgPT4ge1xuICAgIGZvciAoY29uc3Qgc3RvcmUgb2Ygc3RvcmVzKSB7XG4gICAgICBjb25zdCBzID0gX19zdG9yZXNfX1tzdG9yZV07XG4gICAgICBpZiAoIW9wdGlvbnMuZXhjbHVkZSkge1xuICAgICAgICBzLnJlc2V0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAob3B0aW9ucy5leGNsdWRlLmluZGV4T2Yocy5zdG9yZU5hbWUpID09PSAtMSkge1xuICAgICAgICAgIHMucmVzZXQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG4iXSwibmFtZXMiOlsiT2JzZXJ2YWJsZSIsInRzbGliXzEuX19leHRlbmRzIiwiU3ViamVjdCIsIm9mIiwiUmVwbGF5U3ViamVjdCIsIm1hcCIsImRpc3RpbmN0VW50aWxDaGFuZ2VkIiwiQmVoYXZpb3JTdWJqZWN0IiwidGFrZSIsIndpdGhMYXRlc3RGcm9tIiwiY29tYmluZUxhdGVzdCIsImF1ZGl0VGltZSIsInN3aXRjaE1hcCIsInRzbGliXzEuX19zcHJlYWQiLCJmaWx0ZXIiLCJkZWxheSIsImZyb20iLCJ0c2xpYl8xLl9fZGVjb3JhdGUiLCJkZWJvdW5jZVRpbWUiLCJza2lwIiwicGFpcndpc2UiLCJ0c2xpYl8xLl9fdmFsdWVzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7SUFBQTs7Ozs7Ozs7Ozs7Ozs7SUFjQTtJQUVBLElBQUksYUFBYSxHQUFHLFVBQVMsQ0FBQyxFQUFFLENBQUM7UUFDN0IsYUFBYSxHQUFHLE1BQU0sQ0FBQyxjQUFjO2FBQ2hDLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRSxZQUFZLEtBQUssSUFBSSxVQUFVLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQzVFLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxJQUFJLENBQUM7Z0JBQUUsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQztvQkFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUMvRSxPQUFPLGFBQWEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDL0IsQ0FBQyxDQUFDO0FBRUYsYUFBZ0IsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQzFCLGFBQWEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDcEIsU0FBUyxFQUFFLEtBQUssSUFBSSxDQUFDLFdBQVcsR0FBRyxDQUFDLENBQUMsRUFBRTtRQUN2QyxDQUFDLENBQUMsU0FBUyxHQUFHLENBQUMsS0FBSyxJQUFJLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3pGLENBQUM7QUFFRCxJQUFPLElBQUksUUFBUSxHQUFHO1FBQ2xCLFFBQVEsR0FBRyxNQUFNLENBQUMsTUFBTSxJ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