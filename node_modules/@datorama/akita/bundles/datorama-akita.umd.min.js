!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@datorama/akita",["exports","rxjs","rxjs/operators"],e):e((t.datorama=t.datorama||{},t.datorama.akita={}),t.rxjs,t.rxjs.operators)}(this,function(t,a,m){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function c(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var b=function(){return(b=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function P(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&(n[i[r]]=t[i[r]])}return n}function e(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function p(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function S(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}return s}function f(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(S(arguments[e]));return t}function h(t){return Array.isArray(t)?t:[t]}function l(t){return"[object Object]"===Object.prototype.toString.call(t)}function O(t){return y(t)&&"Object"===t.constructor.name}function A(t){return"function"==typeof t}function y(t){return null!=t&&""+t!="false"}function d(t){return t===undefined}function s(t){return null===t||t===undefined}function g(t,e){return e.hasOwnProperty(t)}function v(t){return y(t)&&A(t.subscribe)}function o(t){return"string"==typeof t}function n(t){return"number"==typeof t}function _(t){return null!=t}function E(t){return r(t)&&!1===g(t.active,t.entities)}function r(t){return t.hasOwnProperty("active")}var w=function(t,e,i){var n=e.split(".");if(1===n.length)return i;t=b({},t);var r=n.length-2;return e.split(".").slice(1).reduce(function(t,e,n){return t[e]=n===r?i:b({},t[e]),t&&t[e]},t),t},j=function(t,e){return 1===e.split(".").length?t:e.split(".").slice(1).join(".").split(".").reduce(function(t,e){return t&&t[e]},t)},x=function(e){function t(t){return e.call(this,t)||this}return c(t,e),t}(Error),u=function(e){function t(t){return e.call(this,"The new state should be immutable. Make sure to return a new immutable state. \n store: \n "+t)||this}return c(t,e),t}(x),k=function(e){function t(t){return e.call(this,"Entity "+t+" does not exists")||this}return c(t,e),t}(x),I=function(t){function e(){return t.call(this,"Active is null/undefined")||this}return c(e,t),e}(x),T=function(t){function e(){return t.call(this,"Entity state is invalid")||this}return c(e,t),e}(x),C=function(t){function e(){return t.call(this,"Updating entity id is not permitted when updating many entities")||this}return c(e,t),e}(x);function N(t,e){if(!g(t,e))throw new k(t)}var D=new(function(){function t(){}return t.prototype._set=function(t,e,n,i){var r,o;if(e.ids&&e.entities)r=e.ids,o=e.entities;else{var s=Array.isArray(e);o=e,s?o=this.keyBy(e,n,i):function u(t){if(!l(t))throw new T}(e),r=s?e.map(function(t){return t[i]}):Object.keys(o).map(function(t){return e[t][i]})}var a=b({},t,{entities:o,ids:r,loading:!1});return E(a)&&(a.active=null),a},t.prototype._replaceEntity=function(t,e,n){var i;return b({},t,{entities:b({},t.entities,(i={},i[e]=n,i))})},t.prototype._add=function(t,e,n,i){void 0===i&&(i={});for(var r={},o=[],s=0;s<e.length;s++){var a=e[s],u=a[n];g(u,t.entities)||(r[u]=a,i.prepend?o.unshift(u):o.push(u))}return b({},t,{entities:b({},t.entities,r),ids:i.prepend?f(o,t.ids):f(t.ids,o)})},t.prototype._update=function(t,e,n,i){for(var r,o={},s=!1,a=0;a<e.length;a++){var u=e[a];N(r=u,t.entities);var c=t.entities[u],p=A(n)?n(c):n;if(p.hasOwnProperty(i)&&p[i]!==c[i]){if(1<e.length)throw new C;s=!0,r=p[i]}var f=void 0,h=b({},c,p);f=O(c)?h:O(p)?new c.constructor(h):new p.constructor(h),o[r]=f}var l=t.ids,y=t.entities;if(s){var d=S(e,1)[0],g=t.entities,v=d;g[v];y=P(g,["symbol"==typeof v?v:v+""]),l=t.ids.map(function(t){return t===d?r:t})}return b({},t,{entities:b({},y,o),ids:l})},t.prototype._remove=function(t,e){if(!e)return this._removeAll(t);var n=e.reduce(function(t,e){var n=e;t[n];return P(t,["symbol"==typeof n?n:n+""])},t.entities),i=b({},t,{entities:n,ids:t.ids.filter(function(t){return-1===e.indexOf(t)})});return E(i)&&(i.active=null),i},t.prototype._removeAll=function(t){return b({},t,{entities:{},ids:[],active:null})},t.prototype.keyBy=function(t,e,n){void 0===n&&(n="id");for(var i={},r=0,o=t.length;r<o;r++){var s=t[r];i[s[n]]=e?new e(s):s}return i},t}()),B=function(){function t(){this.skipAction=!1,this.skipTransactionMsg=!1,this.currentT=[],this.activeTransactions=0}return t.prototype.setAction=function(t){this.customAction?(this.currentAction=this.customAction,this.customAction=null,this.skipTransactionMsg=!1):0===this.activeTransactions&&(this.currentAction=t),0<this.activeTransactions&&this.currentT.push(t)},t.prototype.setCustomAction=function(t,e){void 0===e&&(e=!1),this.currentAction=this.customAction=t,this.skipTransactionMsg=e},t.prototype.setSkipAction=function(t){void 0===t&&(t=!0),this.skipAction=t},t}(),F=new B;function R(){return 0<F.activeTransactions}var K="akitaConfig";var V={resettable:!1};function M(){return V}var U=!0,q="undefined"==typeof window,Q={},H=new a.ReplaySubject;function L(t,e){return void 0===e&&(e=!1),{type:2,payload:{name:t,initialState:e}}}function z(){return U}var W=function(){function t(t,e){void 0===e&&(e={}),this.options=e,this.inTransaction=!1,this._isPristine=!0,this.destroy=this.ngOnDestroy,F.setAction({type:"@@INIT"}),(Q[this.storeName]=this).setState(function(){return t}),H.next({type:0,payload:{store:this}}),z()&&function n(t,e){t||console.error("@StoreConfig({ name }) is missing in "+e)}(this.storeName,this.constructor.name),this.isRessetable()&&(this._initialState=t)}return t.prototype.setLoading=function(e){void 0===e&&(e=!1),e!==this._value().loading&&(z()&&F.setAction({type:"Set Loading"}),this.setState(function(t){return b({},t,{loading:e})}))},t.prototype.setError=function(e){e!==this._value().error&&(z()&&F.setAction({type:"Set Error"}),this.setState(function(t){return b({},t,{error:e})}))},t.prototype._select=function(t){return this.store$.pipe(m.map(t),m.distinctUntilChanged())},t.prototype._value=function(){return this.storeValue},Object.defineProperty(t.prototype,"config",{get:function(){return this.constructor[K]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storeName",{get:function(){return this.options.storeName||this.config&&this.config.storeName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idKey",{get:function(){var t=this.config&&this.config.idKey;return t||(this.options.idKey||"id")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPristine",{get:function(){return this._isPristine},enumerable:!0,configurable:!0}),t.prototype.setState=function(t,e){void 0===e&&(e=!0);var n=this._value();if(this.storeValue=U?function r(e){Object.freeze(e);var n="function"==typeof e,i=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(e).forEach(function(t){!i.call(e,t)||n&&("caller"===t||"callee"===t||"arguments"===t)||null===e[t]||"object"!=typeof e[t]&&"function"!=typeof e[t]||Object.isFrozen(e[t])||r(e[t])}),e}(t(this._value())):t(this._value()),n===this.storeValue)throw new u(this.storeName);if(!this.store)return this.store=new a.BehaviorSubject(this.storeValue),void H.next(L(this.storeName,!0));R()?this.handleTransaction():this.dispatch(this.storeValue,e)},t.prototype.reset=function(){var t=this;if(!this.isRessetable())throw new x("You need to enable the reset functionality");F.setAction({type:"Reset Store"}),this.setState(function(){return Object.assign({},t._initialState)}),this.setPristine()},t.prototype.update=function(i,t){F.setAction({type:"Update Store"}),this.setState(function(t){var e=A(i)?i(t):i,n=Object.assign({},t,e);return O(t)?n:new t.constructor(n)}),this.setDirty()},t.prototype.setPristine=function(){this._isPristine=!0},t.prototype.setDirty=function(){this._isPristine=!1},t.prototype.dispatch=function(t,e){void 0===e&&(e=!0),this.store.next(t),e&&(H.next(L(this.storeName)),z()&&F.setAction({type:"Set State"}))},Object.defineProperty(t.prototype,"store$",{get:function(){return this.store.asObservable()},enumerable:!0,configurable:!0}),t.prototype.watchTransaction=function(){var t=this;(function e(){return F.batchTransaction?F.batchTransaction.asObservable():a.of(!0)})().subscribe(function(){t.inTransaction=!1,z()&&!F.skipTransactionMsg&&F.setAction({type:"@Transaction"}),t.dispatch(t._value()),F.currentT=[],F.skipTransactionMsg=!1})},t.prototype.isRessetable=function(){return this.config.resettable||M().resettable},t.prototype.handleTransaction=function(){this.inTransaction||(this.watchTransaction(),this.inTransaction=!0)},t.prototype.ngOnDestroy=function(){q||window.hmrEnabled||this!==Q[this.storeName]||(delete Q[this.storeName],H.next({type:1,payload:{storeName:this.storeName}}))},t}(),$=function(n){function t(t,e){return void 0===t&&(t={}),void 0===e&&(e={}),n.call(this,b({},J(),t),e)||this}return c(t,n),Object.defineProperty(t.prototype,"entities",{get:function(){return this._value().entities},enumerable:!0,configurable:!0}),t.prototype.set=function(e,n){var i=this;void 0===n&&(n={}),z()&&F.setAction({type:"Set Entities"}),this.setState(function(t){return D._set(t,s(e)?[]:e,n.entityClass,i.idKey)}),this.setDirty()},t.prototype.createOrReplace=function(e,n){g(e,this._value().entities)?(z()&&F.setAction({type:"Create or Replace Entity",entityId:[e]}),this.setState(function(t){return D._replaceEntity(t,e,n)})):this.addWhenNotExists(e,n)},t.prototype.upsert=function(t,e){if(g(t,this._value().entities))this.update(t,e);else{var n=A(e)?e({}):e;this.addWhenNotExists(t,n)}},t.prototype.add=function(t,e){var n=this,i=h(t);0!==i.length&&(i.every(function(t){return-1<n._value().ids.indexOf(t[n.idKey])})||(z()&&F.setAction({type:"Add Entity"}),this.setState(function(t){return D._add(t,i,n.idKey,e)})))},t.prototype.update=function(t,e){var n=this,i=[],r=this._value().ids;if(A(t))for(var o=0,s=r.length;o<s;o++){var a=r[o],u=this._value().entities[a];u&&t(u)&&i.push(a)}else i=y(t)?h(t):r;0!==i.length&&(z()&&F.setAction({type:"Update Entity",entityId:i}),this.setState(function(t){return D._update(t,i,e,n.idKey)}))},t.prototype.updateAll=function(t){0!==this._value().ids.length&&this.update(null,t)},t.prototype.updateRoot=function(t,e){var n=A(t)?t(this._value()):t;if(n===this._value())throw new u(this.storeName);z()&&F.setAction(e||{type:"Update Root"}),this.setState(function(t){return b({},t,n)})},t.prototype.remove=function(t){var e=this._value().ids;if(0!==e.length){var n=y(t);n||this.setPristine();var i=[];if(A(t))for(var r=0,o=e.length;r<o;r++){var s=e[r],a=this._value().entities[s];a&&t(a)&&i.push(s)}else i=n?h(t):null;i&&0===i.length||(z()&&F.setAction({type:"Remove Entity",entityId:i}),this.setState(function(t){return D._remove(t,i)}))}},t.prototype.updateActive=function(i){var r=this;!function e(t){if(!y(t.active))throw new I}(this._value()),z()&&F.setAction({type:"Update Active Entity",entityId:this._value().active}),this.setState(function(t){var e=t.active,n=A(i)?i(t.entities[e]):i;if(n===t)throw new u(r.storeName);return D._update(t,[e],n,r.idKey)})},t.prototype.setActive=function(t){var e;if(l(t)){if(s(this._value().active))return;t=Object.assign({wrap:!0},t);var n=this._value().ids,i=n.indexOf(this._value().active);if(t.prev){var r=0===i;if(r&&!t.wrap)return;e=r?n[n.length-1]:n[i-1]}else if(t.next){var o=n.length===i+1;if(o&&!t.wrap)return;e=o?n[0]:n[i+1]}}else{if(t===this._value().active)return;e=t}z()&&F.setAction({type:"Set Active Entity",entityId:e}),this.setState(function(t){return b({},t,{active:e})})},t.prototype.addWhenNotExists=function(t,e){e[this.idKey]||(e[this.idKey]=t),this.add(e)},t}(W),J=function(){return{entities:{},ids:[],loading:!0,error:null}},X={ASC:"asc",DESC:"desc"};function Y(o,s){return void 0===s&&(s=X.ASC),function(t,e){if(!t.hasOwnProperty(o)||!e.hasOwnProperty(o))return 0;var n="string"==typeof t[o]?t[o].toUpperCase():t[o],i="string"==typeof e[o]?e[o].toUpperCase():e[o],r=0;return i<n?r=1:n<i&&(r=-1),s==X.DESC?-1*r:r}}function G(n){var i,r,o=!1,s=!0;return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return i&&(o=i[1]!==t[1]||i[0]!==t[0]),(s||o&&!s)&&(r=n.apply(this,t)),s=!1,i=t,r}}var Z="akitaQueryConfig";var tt=function(){function t(t){this.store=t,this.__store__=t}return t.prototype.select=function(t){var e=t||function(t){return t};return this.store._select(e)},t.prototype.selectOnce=function(t){return this.select(t).pipe(m.take(1))},t.prototype.selectLoading=function(){return this.select(function(t){return t.loading})},t.prototype.selectError=function(){return this.select(function(t){return t.error})},t.prototype.getSnapshot=function(){return this.store._value()},Object.defineProperty(t.prototype,"isPristine",{get:function(){return this.store.isPristine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return!this.store.isPristine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this.constructor[Z]},enumerable:!0,configurable:!0}),t}(),et=function(n){function t(t){var e=n.call(this,t)||this;return e.__store__=t,e}return c(t,n),t.prototype.selectAll=function(i){var r=this;void 0===i&&(i={asObject:!1});var t=this.select(function(t){return t}),e=this.select(function(t){return t.entities});return this.sortByOptions(i),e.pipe(m.withLatestFrom(t,function(t,e){var n=e.ids;return i.asObject?it(n,t,i):i.filterBy||i.sortBy?nt(e,i):(r.memoized||(r.memoized=G(nt)),r.memoized(e,i))}))},t.prototype.getAll=function(t){void 0===t&&(t={asObject:!1,filterBy:undefined,limitTo:undefined});var e=this.getSnapshot();return t.asObject?it(e.ids,e.entities,t,!0):(this.sortByOptions(t),nt(e,t))},t.prototype.selectMany=function(t,e){var n=this;void 0===e&&(e={});var i=!!d(e.filterUndefined)||e.filterUndefined,r=t.map(function(t){return n.selectEntity(t)});return a.combineLatest(r).pipe(m.map(function(t){return i?t.filter(function(t){return!d(t)}):t}),m.auditTime(0))},t.prototype.selectEntity=function(e,n){var i=this;return n?this.select(function(t){return i.hasEntity(e)?n(i.getEntity(e)):undefined}):this._byId(e)},t.prototype.getEntity=function(t){return this.getSnapshot().entities[t]},t.prototype.selectActiveId=function(){return this.select(function(t){return t.active})},t.prototype.getActiveId=function(){return this.getSnapshot().active},t.prototype.selectActive=function(e){var n=this;return this.selectActiveId().pipe(m.switchMap(function(t){return n.selectEntity(t,e)}))},t.prototype.getActive=function(){var t=this.getActiveId();return y(t)?this.getEntity(t):undefined},t.prototype.selectCount=function(t){return A(t)?this.selectAll({filterBy:t}).pipe(m.map(function(t){return t.length})):this.select(function(t){return t.ids.length})},t.prototype.getCount=function(t){return A(t)?this.getAll().filter(t).length:this.getSnapshot().ids.length},t.prototype.hasEntity=function(t){var e=this;return A(t)?this.getAll().some(t):Array.isArray(t)?t.every(function(t){return t in e.store.entities}):t in this.store.entities},t.prototype.hasActive=function(){return null!=this.getSnapshot().active},t.prototype.isEmpty=function(){return 0===this.getSnapshot().ids.length},t.prototype._byId=function(e){var n=this;return this.select(function(t){return n.getEntity(e)})},t.prototype.sortByOptions=function(t){t.sortBy=t.sortBy||this.config&&this.config.sortBy,t.sortByOrder=t.sortByOrder||this.config&&this.config.sortByOrder},t.prototype.ngOnDestroy=function(){this.memoized=null},t}(tt);function nt(n,t){for(var i=[],r=n.ids,o=n.entities,s=t.filterBy,e=t.limitTo,a=t.sortBy,u=t.sortByOrder,c=function(e){var n=r[e];if(!g(n,o))return"continue";if(!s)return i.push(o[n]),"continue";Array.isArray(s)?s.every(function(t){return t(o[n],e)})&&i.push(o[n]):s(o[n],e)&&i.push(o[n])},p=0;p<r.length;p++)c(p);if(a){var f=A(a)?a:Y(a,u);i=i.sort(function(t,e){return f(t,e,n)})}var h=Math.min(e||i.length,i.length);return h===i.length?i:i.slice(0,h)}function it(i,r,t,e){void 0===e&&(e=!1);var o={},s=t.filterBy,a=t.limitTo;if(e&&!s&&!a)return r;var n=Math.min(a||i.length,i.length);if(s&&!1===d(a))for(var u=0,c=function(e,t){if(u===a)return"break";var n=i[e];if(!g(n,r))return"continue";Array.isArray(s)?s.every(function(t){return t(r[n],e)})&&(o[n]=r[n],u++):s(r[n],e)&&(o[n]=r[n],u++)},p=0,f=i.length;p<f;p++){if("break"===c(p))break}else{var h=function(e){var n=i[e];if(!g(n,r))return"continue";if(!s)return o[n]=r[n],"continue";Array.isArray(s)?s.every(function(t){return t(r[n],e)})&&(o[n]=r[n]):s(r[n],e)&&(o[n]=r[n])};for(p=0;p<n;p++)h(p)}return o}function rt(t,e){void 0===e&&(e=undefined),function n(){R()||(F.batchTransaction=new a.Subject),F.activeTransactions++}();try{return t.apply(e)}finally{!function i(){0==--F.activeTransactions&&(F.batchTransaction.next(!0),F.batchTransaction.complete())}()}}function ot(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return f(t,e)}var st=function(t){return t.pipe(m.filter(function(t){return null!=t}))};function at(t,e,n){return void 0===n&&(n=undefined),F.setCustomAction(e,!0),t.apply(n)}function ut(r,o){return void 0===o&&(o=!0),function(t,e,n){var i=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return F.setCustomAction(r,o),i.apply(this,t)},n}}var ct=function(){function t(){}return t.prototype.getStoresSnapshot=function(t){void 0===t&&(t=[]);for(var e={},n=0<t.length?t:Object.keys(Q),i=0;i<n.length;i++){var r=n[i];e[r]=Q[r]._value()}return e},t.prototype.setStoresSnapshot=function(t){var i=t;o(t)&&(i=JSON.parse(i));for(var e=function(t,e){var n=e[t];Q[n]&&Q[n].setState(function(){return i[n]})},n=0,r=Object.keys(i);n<r.length;n++)e(n,r)},t}(),pt=new ct,ft=function(){function t(t,e){this.query=t,e&&e.resetFn&&M().resettable&&this.onReset(e.resetFn)}return t.prototype.getQuery=function(){return this.query},t.prototype.getStore=function(){return this.getQuery().__store__},t.prototype.isEntityBased=function(t){return y(t)},t.prototype.selectSource=function(t){return this.isEntityBased(t)?this.getQuery().selectEntity(t).pipe(st):this.getQuery().select(function(t){return t})},t.prototype.getSource=function(t){return this.isEntityBased(t)?this.getQuery().getEntity(t):this.getQuery().getSnapshot()},t.prototype.updateStore=function(e,t){this.isEntityBased(t)?this.getStore().update(t,e):this.getStore().setState(function(t){return b({},t,e)})},t.prototype.onReset=function(n){var i=this,r=this.getStore().reset;this.getStore().reset=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];setTimeout(function(){r.apply(i.getStore(),t),n()})}},t}(),ht={pagesControls:!1,range:!1,startWith:1,cacheTimeout:undefined},lt=function(s){function t(t,e){void 0===e&&(e={});var n=s.call(this,t,{resetFn:function(){n.initial=!1,n.destroy({clearCache:!0,currentPage:1})}})||this;n.query=t,n.config=e,n.metadata=new Map,n.pages=new Map,n.pagination={currentPage:1,perPage:0,total:0,lastPage:0,data:[]},n.initial=!1,n.isLoading$=n.query.selectLoading().pipe(m.delay(0)),n.config=Object.assign(ht,e);var i=n.config,r=i.startWith,o=i.cacheTimeout;return n.page=new a.BehaviorSubject(r),v(o)&&(n.clearCacheSubscription=o.subscribe(function(t){return n.clearCache()})),n}return c(t,s),Object.defineProperty(t.prototype,"pageChanges",{get:function(){return this.page.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPage",{get:function(){return this.pagination.currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFirst",{get:function(){return 1===this.currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLast",{get:function(){return this.currentPage===this.pagination.lastPage},enumerable:!0,configurable:!0}),t.prototype.withControls=function(){return this.config.pagesControls=!0,this},t.prototype.withRange=function(){return this.config.range=!0,this},t.prototype.setLoading=function(t){void 0===t&&(t=!0),this.getStore().setLoading(t)},t.prototype.update=function(t){this.pagination=t,this.addPage(t.data)},t.prototype.addPage=function(t){var e=this;this.pages.set(this.currentPage,{ids:t.map(function(t){return t[e.getStore().idKey]})}),this.getStore().add(t)},t.prototype.clearCache=function(){var t=this;this.initial||(at(function(){t.getStore().remove()},{type:"@Pagination - Clear Cache"}),this.pages=new Map,this.metadata=new Map),this.initial=!1},t.prototype.clearPage=function(t){this.pages["delete"](t)},t.prototype.destroy=function(t){var e=void 0===t?{}:t,n=e.clearCache,i=e.currentPage;this.clearCacheSubscription&&this.clearCacheSubscription.unsubscribe(),n&&this.clearCache(),d(i)||this.setPage(i),this.initial=!0},t.prototype.isPageActive=function(t){return this.currentPage===t},t.prototype.setPage=function(t){t===this.currentPage&&this.hasPage(t)||this.page.next(this.pagination.currentPage=t)},t.prototype.nextPage=function(){this.currentPage!==this.pagination.lastPage&&this.setPage(this.pagination.currentPage+1)},t.prototype.prevPage=function(){1<this.pagination.currentPage&&this.setPage(this.pagination.currentPage-1)},t.prototype.setLastPage=function(){this.setPage(this.pagination.lastPage)},t.prototype.setFirstPage=function(){this.setPage(1)},t.prototype.hasPage=function(t){return this.pages.has(t)},t.prototype.getPage=function(t){var e=this,n=this.pagination.currentPage;return this.hasPage(n)?this.selectPage(n):(this.setLoading(!0),a.from(t()).pipe(m.switchMap(function(t){return rt(function(){e.setLoading(!1),e.update(t)}),e.selectPage(n)})))},t.prototype.getQuery=function(){return this.query},t.prototype.getFrom=function(){return this.isFirst?1:(this.currentPage-1)*this.pagination.perPage+1},t.prototype.getTo=function(){return this.currentPage*this.pagination.perPage},t.prototype.selectPage=function(s){var a=this;return this.query.selectAll({asObject:!0}).pipe(m.take(1),m.map(function(e){var t=b({},a.pagination,{data:a.pages.get(s).ids.map(function(t){return e[t]})}),n=a.config,i=n.range,r=n.pagesControls;return isNaN(a.pagination.total)&&(1===t.lastPage?t.total=t.data?t.data.length:0:t.total=t.perPage*t.lastPage,a.pagination.total=t.total),i&&(t.from=a.getFrom(),t.to=a.getTo()),r&&(t.pageControls=function o(t,e){for(var n=Math.ceil(t/e),i=[],r=0;r<n;r++)i.push(r+1);return i}(a.pagination.total,a.pagination.perPage)),t}))},function u(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;0<=a;a--)(r=t[a])&&(s=(o<3?r(s):3<o?r(e,n,s):r(e,n))||s);return 3<o&&s&&Object.defineProperty(e,n,s),s}([ut({type:"@Pagination - New Page"},!0),e("design:type",Function),e("design:paramtypes",[Object]),e("design:returntype",void 0)],t.prototype,"update",null),t}(ft);var yt,dt,gt=lt,vt=function(r){function t(t,e,n){void 0===n&&(n={});var i=r.call(this,t)||this;return i.query=t,i.factoryFnOrPath=e,i.params=n,i.params=b({debounceTime:300,formKey:"akitaForm",emitEvent:!1,arrControlFactory:function(t){return i.builder.control(t)}},n),i.isRootKeys=!1===y(e),i.isKeyBased=o(e)||i.isRootKeys,i}return c(t,r),t.prototype.setForm=function(t,e){return this.form=t,this.builder=e,this.activate(),this},t.prototype.reset=function(t){var e,n,i=this;n=t||(this.isKeyBased?this.initialValue:this.factoryFnOrPath()),this.isKeyBased&&Object.keys(this.initialValue).forEach(function(n){var t=i.initialValue[n];if(Array.isArray(t)&&i.builder){var e=i.form.controls[n];i.cleanArray(e),t.forEach(function(t,e){i.form.get(n).insert(e,i.params.arrControlFactory(t))})}}),this.form.patchValue(n,{emitEvent:this.params.emitEvent});var r=this.isKeyBased?w(this.getQuery().getSnapshot(),this.getStore().storeName+"."+this.factoryFnOrPath,n):((e={})[this.params.formKey]=n,e);this.updateStore(r)},t.prototype.cleanArray=function(t){for(;0!==t.length;)t.removeAt(0)},t.prototype.resolveInitialValue=function(t,r){var o=this;if(t)return Object.keys(t).reduce(function(t,n){var e=r[n];if(Array.isArray(e)&&o.builder){var i=o.params.arrControlFactory;o.cleanArray(o.form.get(n)),e.forEach(function(t,e){o.form.get(n).insert(e,i(t))})}return t[n]=r[n],t},{})},t.prototype.activate=function(){var t,n,i=this;if(this.isKeyBased)if(this.isRootKeys)this.initialValue=this.resolveInitialValue(this.form.value,this.getQuery().getSnapshot()),this.form.patchValue(this.initialValue,{emitEvent:this.params.emitEvent});else{n=this.getStore().storeName+"."+this.factoryFnOrPath;var e=j(this.getQuery().getSnapshot(),n);this.initialValue=this.resolveInitialValue(e,e),this.form.patchValue(this.initialValue,{emitEvent:this.params.emitEvent})}else{this.getQuery().getSnapshot()[this.params.formKey]||(F.setAction({type:"@PersistNgFormPlugin activate"}),this.updateStore(((t={})[this.params.formKey]=this.factoryFnOrPath(),t)));var r=this.getQuery().getSnapshot()[this.params.formKey];this.form.patchValue(r)}this.formChanges=this.form.valueChanges.pipe(m.debounceTime(this.params.debounceTime)).subscribe(function(e){var t;F.setAction({type:"@PersistForm - Update"}),t=i.isKeyBased?i.isRootKeys?function(t){return b({},t,e)}:function(t){return w(t,n,e)}:function(){var t;return(t={})[i.params.formKey]=e,t},i.updateStore(t(i.getQuery().getSnapshot()))})},t.prototype.destroy=function(){this.formChanges&&this.formChanges.unsubscribe(),this.form=null,this.builder=null},t}(ft),mt="undefined"==typeof localStorage;var bt={beforeRemove:function(t){return t.destroy()}},Pt=function(){function t(t,e){this.query=t,this.entityIds=e,this.entities=new Map}return t.prototype.getEntity=function(t){return this.entities.get(t)},t.prototype.hasEntity=function(t){return this.entities.has(t)},t.prototype.removeEntity=function(t){return this.entities["delete"](t)},t.prototype.createEntity=function(t,e){return this.entities.set(t,e)},t.prototype.getIds=function(){return d(this.entityIds)?this.query.getSnapshot().ids:h(this.entityIds)},t.prototype.resolvedIds=function(t){return d(t)?this.getIds():h(t)},t.prototype.rebase=function(n,i){var r=this;if(void 0===i&&(i=bt),y(n))if(d(this.entityIds)){for(var t=0,e=n.length;t<e;t++){var o=n[t];if(!1===this.hasEntity(o)){A(i.beforeAdd)&&i.beforeAdd(o);var s=this.instantiatePlugin(o);this.entities.set(o,s),A(i.afterAdd)&&i.afterAdd(s)}}this.entities.forEach(function(t,e){-1===n.indexOf(e)&&(A(i.beforeRemove)&&i.beforeRemove(t),r.removeEntity(e))})}else{var a=h(this.entityIds);for(t=0,e=a.length;t<e;t++){o=a[t];if(-1<n.indexOf(o)&&!1===this.hasEntity(o)){A(i.beforeAdd)&&i.beforeAdd(o);s=this.instantiatePlugin(o);this.entities.set(o,s),A(i.afterAdd)&&i.afterAdd(s)}else this.entities.forEach(function(t,e){-1===n.indexOf(e)&&!0===r.hasEntity(e)&&(A(i.beforeRemove)&&i.beforeRemove(t),r.removeEntity(e))})}}else this.getIds().forEach(function(t){r.hasEntity(t)||r.createEntity(t,r.instantiatePlugin(t))})},t.prototype.selectIds=function(){return this.query.select(function(t){return t.ids})},t.prototype.activate=function(t){this.rebase(t)},t.prototype.forEachId=function(t,e){for(var n=this.resolvedIds(t),i=0,r=n.length;i<r;i++){var o=n[i];this.hasEntity(o)&&e(this.getEntity(o))}},t}(),St=function(r){function t(t,e,n){void 0===e&&(e={});var i=r.call(this,t,{resetFn:function(){return i.clear()}})||this;return i.query=t,i.params=e,i._entityId=n,i.skip=!1,i.history={past:[],present:null,future:[]},i.skipUpdate=!1,e.maxAge=y(e.maxAge)?e.maxAge:10,i.activate(),i}return c(t,r),Object.defineProperty(t.prototype,"hasPast",{get:function(){return 0<this.history.past.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasFuture",{get:function(){return 0<this.history.future.length},enumerable:!0,configurable:!0}),t.prototype.activate=function(){var r=this;this.history.present=this.getSource(this._entityId),this.subscription=this.selectSource(this._entityId).pipe(m.pairwise()).subscribe(function(t){var e=S(t,2),n=e[0],i=e[1];r.skip?r.skip=!1:r.skipUpdate||(r.history.past.length===r.params.maxAge&&(r.history.past=r.history.past.slice(1)),r.history.past=f(r.history.past,[n]),r.history.present=i)})},t.prototype.undo=function(){if(0<this.history.past.length){var t=this.history,e=t.past,n=t.present,i=(t.future,e[e.length-1]),r=e.slice(0,e.length-1);this.history.past=r,this.history.present=i,this.history.future=f([n],this.history.future),this.update()}},t.prototype.redo=function(){if(0<this.history.future.length){var t=this.history,e=t.past,n=t.present,i=(t.future,this.history.future[0]),r=this.history.future.slice(1);this.history.past=f(e,[n]),this.history.present=i,this.history.future=r,this.update("Redo")}},t.prototype.jumpToPast=function(t){if(!(t<0||t>=this.history.past.length)){var e=this.history,n=e.past,i=e.future,r=n.slice(0,t),o=f(n.slice(t+1),i),s=n[t];this.history.past=r,this.history.present=s,this.history.future=o,this.update()}},t.prototype.jumpToFuture=function(t){if(!(t<0||t>=this.history.future.length)){var e=this.history,n=e.past,i=e.future,r=f(n,i.slice(0,t)),o=i[t],s=i.slice(t+1);this.history.past=r,this.history.present=o,this.history.future=s,this.update("Redo")}},t.prototype.clear=function(){this.history={past:[],present:null,future:[]}},t.prototype.destroy=function(t){void 0===t&&(t=!1),t&&this.clear(),this.subscription.unsubscribe()},t.prototype.ignoreNext=function(){this.skip=!0},t.prototype.update=function(t){void 0===t&&(t="Undo"),this.skipUpdate=!0,F.setCustomAction({type:"@StateHistory - "+t}),this.updateStore(this.history.present,this._entityId),this.skipUpdate=!1},t}(ft),Ot=function(i){function t(t,e){void 0===e&&(e={});var n=i.call(this,t,e.entityIds)||this;return n.query=t,(n.params=e).maxAge=y(e.maxAge)?e.maxAge:10,n.activate(),n.selectIds().pipe(m.skip(1)).subscribe(function(t){return n.activate(t)}),n}return c(t,i),t.prototype.redo=function(t){this.forEachId(t,function(t){return t.redo()})},t.prototype.undo=function(t){this.forEachId(t,function(t){return t.undo()})},t.prototype.hasPast=function(t){if(this.hasEntity(t))return this.getEntity(t).hasPast},t.prototype.hasFuture=function(t){if(this.hasEntity(t))return this.getEntity(t).hasFuture},t.prototype.jumpToFuture=function(t,e){this.forEachId(t,function(t){return t.jumpToFuture(e)})},t.prototype.jumpToPast=function(t,e){this.forEachId(t,function(t){return t.jumpToPast(e)})},t.prototype.clear=function(t){this.forEachId(t,function(t){return t.clear()})},t.prototype.destroy=function(t,e){void 0===e&&(e=!1),this.forEachId(t,function(t){return t.destroy(e)})},t.prototype.ignoreNext=function(t){this.forEachId(t,function(t){return t.ignoreNext()})},t.prototype.instantiatePlugin=function(t){return new St(this.query,this.params,t)},t}(Pt),At={comparator:function(t,e){return JSON.stringify(t)!==JSON.stringify(e)}};function _t(t,e){return e.split(".").reduce(function(t,e){return t&&"undefined"!==t[e]?t[e]:undefined},t)}var Et=function(o){function t(t,e,n){var i=o.call(this,t)||this;if(i.query=t,i.params=e,i._entityId=n,i.dirty=new a.BehaviorSubject(!1),i.active=!1,i._reset=new a.Subject,i.isDirty$=i.dirty.asObservable().pipe(m.distinctUntilChanged()),i.reset$=i._reset.asObservable(),i.params=b({},At,e),i.params.watchProperty){var r=h(i.params.watchProperty);t instanceof et&&r.includes("entities")&&!r.includes("ids")&&r.push("ids"),i.params.watchProperty=r}return i}return c(t,o),t.prototype.reset=function(t){void 0===t&&(t={});var e=this.head;A(t.updateFn)&&(e=this.isEntityBased(this._entityId)?t.updateFn(this.head,this.getQuery().getEntity(this._entityId)):t.updateFn(this.head,this.getQuery().getSnapshot())),F.setCustomAction({type:"@DirtyCheck - Revert"}),this.updateStore(e,this._entityId),this._reset.next()},t.prototype.setHead=function(){return this.active?this.head=this._getHead():(this.activate(),this.active=!0),this.updateDirtiness(!1),this},t.prototype.isDirty=function(){return y(this.dirty.value)},t.prototype.hasHead=function(){return y(this.getHead())},t.prototype.destroy=function(){this.head=null,this.subscription&&this.subscription.unsubscribe(),this._reset&&this._reset.complete()},t.prototype.isPathDirty=function(t){var e=this.getHead(),n=_t(this.getQuery().getSnapshot(),t),i=_t(e,t);return this.params.comparator(n,i)},t.prototype.getHead=function(){return this.head},t.prototype.activate=function(){var i=this;this.head=this._getHead();var t=this.params.watchProperty?this.params.watchProperty.map(function(e){return i.query.select(function(t){return t[e]}).pipe(m.map(function(t){return{val:t,__akitaKey:e}}))}):[this.selectSource(this._entityId)];this.subscription=a.combineLatest.apply(void 0,f(t)).pipe(m.skip(1)).subscribe(function(t){if(!d(i.head)){var e=t.some(function(t){var e=t.__akitaKey?i.head[t.__akitaKey]:i.head,n=t.__akitaKey?t.val:t;return i.params.comparator(e,n)});i.updateDirtiness(e)}})},t.prototype.updateDirtiness=function(t){this.dirty.next(t)},t.prototype._getHead=function(){var t=this.getSource(this._entityId);return this.params.watchProperty&&(t=this.getWatchedValues(t)),t},t.prototype.getWatchedValues=function(n){return this.params.watchProperty.reduce(function(t,e){return t[e]=n[e],t},{})},t}(ft),wt=function(i){function t(t,e){void 0===e&&(e={});var n=i.call(this,t,e.entityIds)||this;return n.query=t,n.params=e,n.isSomeDirty$=n.query.select(function(t){return t.entities}).pipe(m.map(function(t){return n.checkSomeDirty(t)})),n.someDirty$=n.isSomeDirty$,n.someDirty=n.isSomeDirty,n.params=b({},At,e),n.activate(),n.selectIds().pipe(m.skip(1)).subscribe(function(t){n.rebase(t,{afterAdd:function(t){return t.setHead()}})}),n}return c(t,i),t.prototype.setHead=function(t){return this.forEachId(t,function(t){return t.setHead()}),this},t.prototype.hasHead=function(t){return!!this.entities.has(t)&&this.getEntity(t).hasHead()},t.prototype.reset=function(t,e){void 0===e&&(e={}),this.forEachId(t,function(t){return t.reset(e)})},t.prototype.isDirty=function(t,e){if(void 0===e&&(e=!0),this.entities.has(t)){var n=this.getEntity(t);return e?n.isDirty$:n.isDirty()}return!1},t.prototype.isSomeDirty=function(){var t=this.query.getAll({asObject:!0});return this.checkSomeDirty(t)},t.prototype.isPathDirty=function(t,e){if(this.entities.has(t)){var n=this.getEntity(t).getHead(),i=_t(this.query.getEntity(t),e),r=_t(n,e);return this.params.comparator(i,r)}return null},t.prototype.destroy=function(t){this.forEachId(t,function(t){return t.destroy()})},t.prototype.instantiatePlugin=function(t){return new Et(this.query,this.params,t)},t.prototype.checkSomeDirty=function(t){var e,n,i=this.resolvedIds();try{for(var r=p(i),o=r.next();!o.done;o=r.next()){var s=o.value;if(this.params.comparator(this.getEntity(s).getHead(),t[s]))return!0}}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(e)throw e.error}}return!1},t}(Pt);t.__globalState=F,t.EntityStore=$,t.getInitialEntitiesState=J,t.getInitialActiveState=function(){return{active:null}},t.QueryEntity=et,t.Query=tt,t.enableAkitaProdMode=function jt(){U=!1},t.isDev=z,t.__stores__=Q,t.rootDispatcher=H,t.Store=W,t.applyTransaction=rt,t.transaction=function xt(){return function(t,e,n){var i=n.value;return n.value=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return rt(function(){return i.apply(t,e)},this)},n}},t.push=ot,t.remove=function kt(t,e){return 0<=e?f(t.slice(0,e),t.slice(e+1)):f(t)},t.pop=function It(t){return t.slice(0,-1)},t.unshift=function Tt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return f(e,t)},t.sort=function Ct(t,e){return f(t).sort(e)},t.reverse=function Nt(t){return f(t).reverse()},t.swap=function Dt(t,e,n){var i=t.slice(),r=t[e];return i[e]=t[n],i[n]=r,i},t.update=function Bt(t,n,i){return t.map(function(t,e){return"number"==typeof n&&e===n?i:l(n)&&n===t?b({},n,i):t})},t.splice=function Ft(t,e,n){void 0===e&&(e=t.length),void 0===n&&(n=t.length-e);for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];return f(t.slice(0,e),i,t.slice(e+(n<0?0:n)))},t.toggle=function Rt(t,e){return-1<t.indexOf(e)?t.filter(function(t){return e!==t}):ot(t,e)},t.filterNil=st,t.coerceArray=h,t.isObject=l,t.isPlainObject=O,t.isFunction=A,t.toBoolean=y,t.isUndefined=d,t.isNil=s,t.entityExists=g,t.noop=function Kt(){return new a.Observable(function(t){t.next(),t.complete()})},t.isObservable=v,t.isString=o,t.isNumber=n,t.isDefined=_,t.resetActive=E,t.isActiveState=r,t.setValue=w,t.getValue=j,t.applyAction=at,t.action=ut,t.mapInWorker=function Vt(r){return function(t){return new a.Observable(function(e){var i=function n(){var t=new Blob(["self.onmessage = function(e) {\n\n      function deserialize(str) {\n        return JSON.parse(str || '', function(key, value) {\n          if (value &&\n            typeof value === \"string\" &&\n            value.substr(0, 8) == \"function\") {\n            var startBody = value.indexOf('{') + 1;\n            var endBody = value.lastIndexOf('}');\n            var startArgs = value.indexOf('(') + 1;\n            var endArgs = value.indexOf(')');\n            return new Function(value.substring(startArgs, endArgs), value.substring(startBody, endBody));\n          }\n          return value;\n        });\n      }\n\n      var deserialized = deserialize(e.data);\n      var mapped = deserialized.data.map(function(d) {\n        return deserialized.factory(d);\n      });\n\n      self.postMessage(mapped);\n    }"],{type:"text/javascript"}),e=URL.createObjectURL(t);return new Worker(e)}();return i.onmessage=function(t){e.next(t.data),e.complete(),i.terminate()},i.onerror=function(t){e.error(t),e.complete(),i.terminate()},t.subscribe(function(t){var e=function n(t){return JSON.stringify(t,function(t,e){return"function"==typeof e?e.toString():e})}({factory:r,data:t});i.postMessage(e)})})}},t.memoizeOne=G,t.SnapshotManager=ct,t.snapshotManager=pt,t.StoreConfig=function Mt(r){return function(t){t[K]={idKey:"id"};for(var e=0,n=Object.keys(r);e<n.length;e++){var i=n[e];"name"===i?t[K].storeName=r[i]:t[K][i]=r[i]}}},t.configKey=K,t.QueryConfig=function Ut(r){return function(t){t[Z]={};for(var e=0,n=Object.keys(r);e<n.length;e++){var i=n[e];t[Z][i]=r[i]}}},t.queryConfigKey=Z,t.akitaConfig=function qt(t){V=b({},V,t)},t.getAkitaConfig=M,t.compareValues=Y,t.Order=X,t.AkitaPlugin=ft,t.PaginatorPlugin=lt,t.Paginator=gt,t.PersistNgFormPlugin=vt,t.persistState=function Qt(t){if(!mt){var i,e={key:"AkitaStores",storage:localStorage,deserialize:JSON.parse,serialize:JSON.stringify,include:[],exclude:[]},n=Object.assign({},e,t),r=n.storage,o=n.deserialize,s=n.serialize,a=n.include,u=n.exclude,c=n.key,p=0<a.length,f=0<u.length;if(p&&f)throw new x("You can't use both include and exclude");p&&(i=a.reduce(function(t,e){return t[e.split(".")[0]]=e,t},{}));var h=o(r.getItem(c)||"{}"),l={},y={},d=H.pipe(m.filter(function(t){return 0===t.type})).subscribe(function(t){var e=t.payload.store.storeName;if(!f||!u.includes(e))if(p){var n=i[e];if(!n)return;v(e,t.payload.store,n),g(e,n)}else v(e,t.payload.store,e),g(e,e)});return{destroy:function(){d.unsubscribe();for(var t=0,e=Object.keys(l);t<e.length;t++){var n=e[t];l[n].unsubscribe()}l={}},clear:function(){r.clear()},clearStore:function(t){var e=o(r.getItem(c)||"{}");e[t]&&(delete e[t],r.setItem(c,s(e)))}}}function g(n,e){l[n]=Q[n]._select(function(t){return j(t,e)}).pipe(m.skip(1)).subscribe(function(t){y[n]=t,function e(){r.setItem(c,s(Object.assign({},h,y)))}()})}function v(e,t,n){h[e]&&(F.setAction({type:"@PersistState"}),t.setState(function(t){return w(t,n,h[e])}),t.setDirty&&t.setDirty())}},t.akitaDevtools=function Ht(s,u){if(void 0===u&&(u={}),window.__REDUX_DEVTOOLS_EXTENSION__){yt&&yt.unsubscribe(),dt&&dt(),s&&s.run||((s=s||{}).run=function(t){return t()},u=s);var t=Object.assign({},{name:"Akita"},u),c=window.__REDUX_DEVTOOLS_EXTENSION__.connect(t),p={};yt=H.subscribe(function(t){var e;if(1===t.type){var n=t.payload.storeName;delete p[n],c.send({type:"["+n+"] - Delete Store"},p)}if(2===t.type){if(F.skipAction)return void F.setSkipAction(!1);p=b({},p,((e={})[t.payload.name]=Q[t.payload.name]._value(),e));var i=F.currentAction,r=i.type,o=i.entityId,s=(n=function a(t){return t&&t.charAt(0).toUpperCase()+t.slice(1)}(t.payload.name),_(o)?"["+n+"] - "+r+" (ids: "+o+")":"["+n+"] - "+r);u.logTrace&&(console.group(s),console.trace(),console.groupEnd()),c.send({type:s,transaction:F.currentT.map(function(t){return t.type})},p)}}),dt=c.subscribe(function(n){if("ACTION"===n.type){var i=S(n.payload.split("."),1)[0];Q[i]&&s.run(function(){var t=n.payload.replace(i,"this['"+i+"']");try{new Function(""+t).call(Q)}catch(e){console.warn("Unknown Method ☹️")}})}if("DISPATCH"===n.type){if("COMMIT"===n.payload.type)return void c.init(p);if(n.state)for(var r=JSON.parse(n.state),t=function(t,e){var n=e[t];Q[n]&&s.run(function(){Q[n].setState(function(){return r[n]},!1)})},e=0,o=Object.keys(r);e<o.length;e++)t(e,o)}})}},t.EntityCollectionPlugin=Pt,t.StateHistoryPlugin=St,t.EntityStateHistoryPlugin=Ot,t.getNestedPath=_t,t.dirtyCheckDefaultParams=At,t.DirtyCheckPlugin=Et,t.EntityDirtyCheckPlugin=wt,t.increment=function Lt(t,e){if(void 0===e&&(e={maxValue:undefined}),!1!==n(t))return e.maxValue&&t===e.maxValue?t:t+1},t.decrement=function zt(t,e){if(void 0===e&&(e={allowNegative:!1}),!1!==n(t))return!1===e.allowNegative&&0===t?t:t-1},t.guid=function Wt(){return"xxxxxx4xyx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},t.resetStores=function $t(a){a=Object.assign({},{exclude:[]},a);var u=Object.keys(Q);rt(function(){var t,e;try{for(var n=p(u),i=n.next();!i.done;i=n.next()){var r=i.value,o=Q[r];a.exclude?-1===a.exclude.indexOf(o.storeName)&&o.reset():o.reset()}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=n["return"])&&e.call(n)}finally{if(t)throw t.error}}})},t.ɵa=B,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=datorama-akita.umd.min.js.map