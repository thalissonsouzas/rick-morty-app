/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
import { __globalState } from './global-state';
import { Subject, of } from 'rxjs';
/**
 * Start a new transaction batch
 * @return {?}
 */
export function startBatch() {
    if (!isTransactionInProcess()) {
        __globalState.batchTransaction = new Subject();
    }
    __globalState.activeTransactions++;
}
/**
 * End the transaction
 * @return {?}
 */
export function endBatch() {
    if (--__globalState.activeTransactions === 0) {
        __globalState.batchTransaction.next(true);
        __globalState.batchTransaction.complete();
    }
}
/**
 * Whether we're inside batch
 * @return {?}
 */
export function isTransactionInProcess() {
    return __globalState.activeTransactions > 0;
}
/**
 *
 * @return {?}
 */
export function commit() {
    return __globalState.batchTransaction ? __globalState.batchTransaction.asObservable() : of(true);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNhY3Rpb24uaW50ZXJuYWwuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZGF0b3JhbWEvYWtpdGEvIiwic291cmNlcyI6WyJzcmMvaW50ZXJuYWwvdHJhbnNhY3Rpb24uaW50ZXJuYWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMvQyxPQUFPLEVBQWMsT0FBTyxFQUFFLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQzs7Ozs7QUFLL0MsTUFBTSxVQUFVLFVBQVU7SUFDeEIsSUFBSSxDQUFDLHNCQUFzQixFQUFFLEVBQUU7UUFDN0IsYUFBYSxDQUFDLGdCQUFnQixHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7S0FDaEQ7SUFDRCxhQUFhLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztBQUNyQyxDQUFDOzs7OztBQUtELE1BQU0sVUFBVSxRQUFRO0lBQ3RCLElBQUksRUFBRSxhQUFhLENBQUMsa0JBQWtCLEtBQUssQ0FBQyxFQUFFO1FBQzVDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUMsYUFBYSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxDQUFDO0tBQzNDO0FBQ0gsQ0FBQzs7Ozs7QUFLRCxNQUFNLFVBQVUsc0JBQXNCO0lBQ3BDLE9BQU8sYUFBYSxDQUFDLGtCQUFrQixHQUFHLENBQUMsQ0FBQztBQUM5QyxDQUFDOzs7OztBQUlELE1BQU0sVUFBVSxNQUFNO0lBQ3BCLE9BQU8sYUFBYSxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNuRyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgX19nbG9iYWxTdGF0ZSB9IGZyb20gJy4vZ2xvYmFsLXN0YXRlJztcbmltcG9ydCB7IE9ic2VydmFibGUsIFN1YmplY3QsIG9mIH0gZnJvbSAncnhqcyc7XG5cbi8qKlxuICogU3RhcnQgYSBuZXcgdHJhbnNhY3Rpb24gYmF0Y2hcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0QmF0Y2goKSB7XG4gIGlmICghaXNUcmFuc2FjdGlvbkluUHJvY2VzcygpKSB7XG4gICAgX19nbG9iYWxTdGF0ZS5iYXRjaFRyYW5zYWN0aW9uID0gbmV3IFN1YmplY3QoKTtcbiAgfVxuICBfX2dsb2JhbFN0YXRlLmFjdGl2ZVRyYW5zYWN0aW9ucysrO1xufVxuXG4vKipcbiAqIEVuZCB0aGUgdHJhbnNhY3Rpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuZEJhdGNoKCkge1xuICBpZiAoLS1fX2dsb2JhbFN0YXRlLmFjdGl2ZVRyYW5zYWN0aW9ucyA9PT0gMCkge1xuICAgIF9fZ2xvYmFsU3RhdGUuYmF0Y2hUcmFuc2FjdGlvbi5uZXh0KHRydWUpO1xuICAgIF9fZ2xvYmFsU3RhdGUuYmF0Y2hUcmFuc2FjdGlvbi5jb21wbGV0ZSgpO1xuICB9XG59XG5cbi8qKlxuICogV2hldGhlciB3ZSdyZSBpbnNpZGUgYmF0Y2hcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzVHJhbnNhY3Rpb25JblByb2Nlc3MoKSB7XG4gIHJldHVybiBfX2dsb2JhbFN0YXRlLmFjdGl2ZVRyYW5zYWN0aW9ucyA+IDA7XG59XG5cbi8qKlxuICovXG5leHBvcnQgZnVuY3Rpb24gY29tbWl0KCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xuICByZXR1cm4gX19nbG9iYWxTdGF0ZS5iYXRjaFRyYW5zYWN0aW9uID8gX19nbG9iYWxTdGF0ZS5iYXRjaFRyYW5zYWN0aW9uLmFzT2JzZXJ2YWJsZSgpIDogb2YodHJ1ZSk7XG59XG4iXX0=